/*! For license information please see main.6d1d9ac0.js.LICENSE.txt */
(()=>{var e={16:(e,t,n)=>{"use strict";e.exports=n(958)},24:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII="},43:(e,t,n)=>{"use strict";e.exports=n(202)},62:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,o=r>>>1;i<o;){var a=2*(i+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<r&&0>s(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<r&&0>s(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,p=3,g=!1,f=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,C="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function S(e){if(m=!1,w(e),!f)if(null!==i(c))f=!0,L(b);else{var t=i(u);null!==t&&I(S,t.startTime-e)}}function b(e,n){f=!1,m&&(m=!1,y(E),E=-1),g=!0;var s=p;try{for(w(n),d=i(c);null!==d&&(!(d.expirationTime>n)||e&&!P());){var o=d.callback;if("function"===typeof o){d.callback=null,p=d.priorityLevel;var a=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===i(c)&&r(c),w(n)}else r(c);d=i(c)}if(null!==d)var l=!0;else{var h=i(u);null!==h&&I(S,h.startTime-n),l=!1}return l}finally{d=null,p=s,g=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x,_=!1,M=null,E=-1,R=5,T=-1;function P(){return!(t.unstable_now()-T<R)}function A(){if(null!==M){var e=t.unstable_now();T=e;var n=!0;try{n=M(!0,e)}finally{n?x():(_=!1,M=null)}}else _=!1}if("function"===typeof C)x=function(){C(A)};else if("undefined"!==typeof MessageChannel){var F=new MessageChannel,D=F.port2;F.port1.onmessage=A,x=function(){D.postMessage(null)}}else x=function(){v(A,0)};function L(e){M=e,_||(_=!0,x())}function I(e,n){E=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||g||(f=!0,L(b))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:r,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===i(c)&&e===i(u)&&(m?(y(E),E=-1):m=!0,I(S,s-o))):(e.sortIndex=a,n(c,e),f||g||(f=!0,L(b))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},71:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC"},153:(e,t,n)=>{"use strict";var i=n(43),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,s={},c=null,u=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,i)&&!l.hasOwnProperty(i)&&(s[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===s[i]&&(s[i]=t[i]);return{$$typeof:r,type:e,key:c,ref:u,props:s,_owner:a.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||g}function y(){}function C(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||g}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=C.prototype=new y;w.constructor=C,f(w,v.prototype),w.isPureReactComponent=!0;var S=Array.isArray,b=Object.prototype.hasOwnProperty,x={current:null},_={key:!0,ref:!0,__self:!0,__source:!0};function M(e,t,i){var r,s={},o=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)b.call(t,r)&&!_.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:x.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var R=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(e,t,r,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return o=o(l=e),e=""===s?"."+T(l,0):s,S(o)?(r="",null!=e&&(r=e.replace(R,"$&/")+"/"),P(o,t,r,"",(function(e){return e}))):null!=o&&(E(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,r+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(R,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",S(e))for(var c=0;c<e.length;c++){var u=s+T(a=e[c],c);l+=P(a,t,r,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=P(a=a.value,t,r,u=s+T(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,n){if(null==e)return e;var i=[],r=0;return P(e,i,"","",(function(e){return t.call(n,e,r++)})),i}function F(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},L={transition:null},I={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:L,ReactCurrentOwner:x};t.Children={map:A,forEach:function(e,t,n){A(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=r,t.Profiler=o,t.PureComponent=C,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=f({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=x.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)b.call(t,c)&&!_.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:r,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=M,t.createFactory=function(e){var t=M.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:F}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=L.transition;L.transition={};try{e()}finally{L.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.2.0"},205:(e,t,n)=>{"use strict";e.exports=n(302)},228:function(e,t){!function(e){"use strict";var t="1.9.4";function n(e){var t,n,i,r;for(n=1,i=arguments.length;n<i;n++)for(t in r=arguments[n])e[t]=r[t];return e}var i=Object.create||function(){function e(){}return function(t){return e.prototype=t,new e}}();function r(e,t){var n=Array.prototype.slice;if(e.bind)return e.bind.apply(e,n.call(arguments,1));var i=n.call(arguments,2);return function(){return e.apply(t,i.length?i.concat(n.call(arguments)):arguments)}}var s=0;function o(e){return"_leaflet_id"in e||(e._leaflet_id=++s),e._leaflet_id}function a(e,t,n){var i,r,s,o;return o=function(){i=!1,r&&(s.apply(n,r),r=!1)},s=function(){i?r=arguments:(e.apply(n,arguments),setTimeout(o,t),i=!0)},s}function l(e,t,n){var i=t[1],r=t[0],s=i-r;return e===i&&n?e:((e-r)%s+s)%s+r}function c(){return!1}function u(e,t){if(!1===t)return e;var n=Math.pow(10,void 0===t?6:t);return Math.round(e*n)/n}function h(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function d(e){return h(e).split(/\s+/)}function p(e,t){for(var n in Object.prototype.hasOwnProperty.call(e,"options")||(e.options=e.options?i(e.options):{}),t)e.options[n]=t[n];return e.options}function g(e,t,n){var i=[];for(var r in e)i.push(encodeURIComponent(n?r.toUpperCase():r)+"="+encodeURIComponent(e[r]));return(t&&-1!==t.indexOf("?")?"&":"?")+i.join("&")}var f=/\{ *([\w_ -]+) *\}/g;function m(e,t){return e.replace(f,(function(e,n){var i=t[n];if(void 0===i)throw new Error("No value provided for variable "+e);return"function"===typeof i&&(i=i(t)),i}))}var v=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function y(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}var C="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function w(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}var S=0;function b(e){var t=+new Date,n=Math.max(0,16-(t-S));return S=t+n,window.setTimeout(e,n)}var x=window.requestAnimationFrame||w("RequestAnimationFrame")||b,_=window.cancelAnimationFrame||w("CancelAnimationFrame")||w("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)};function M(e,t,n){if(!n||x!==b)return x.call(window,r(e,t));e.call(t)}function E(e){e&&_.call(window,e)}var R={__proto__:null,extend:n,create:i,bind:r,get lastId(){return s},stamp:o,throttle:a,wrapNum:l,falseFn:c,formatNum:u,trim:h,splitWords:d,setOptions:p,getParamString:g,template:m,isArray:v,indexOf:y,emptyImageUrl:C,requestFn:x,cancelFn:_,requestAnimFrame:M,cancelAnimFrame:E};function T(){}function P(e){if("undefined"!==typeof L&&L&&L.Mixin){e=v(e)?e:[e];for(var t=0;t<e.length;t++)e[t]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}T.extend=function(e){var t=function(){p(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},r=t.__super__=this.prototype,s=i(r);for(var o in s.constructor=t,t.prototype=s,this)Object.prototype.hasOwnProperty.call(this,o)&&"prototype"!==o&&"__super__"!==o&&(t[o]=this[o]);return e.statics&&n(t,e.statics),e.includes&&(P(e.includes),n.apply(null,[s].concat(e.includes))),n(s,e),delete s.statics,delete s.includes,s.options&&(s.options=r.options?i(r.options):{},n(s.options,e.options)),s._initHooks=[],s.callInitHooks=function(){if(!this._initHooksCalled){r.callInitHooks&&r.callInitHooks.call(this),this._initHooksCalled=!0;for(var e=0,t=s._initHooks.length;e<t;e++)s._initHooks[e].call(this)}},t},T.include=function(e){var t=this.prototype.options;return n(this.prototype,e),e.options&&(this.prototype.options=t,this.mergeOptions(e.options)),this},T.mergeOptions=function(e){return n(this.prototype.options,e),this},T.addInitHook=function(e){var t=Array.prototype.slice.call(arguments,1),n="function"===typeof e?e:function(){this[e].apply(this,t)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var A={on:function(e,t,n){if("object"===typeof e)for(var i in e)this._on(i,e[i],t);else for(var r=0,s=(e=d(e)).length;r<s;r++)this._on(e[r],t,n);return this},off:function(e,t,n){if(arguments.length)if("object"===typeof e)for(var i in e)this._off(i,e[i],t);else{e=d(e);for(var r=1===arguments.length,s=0,o=e.length;s<o;s++)r?this._off(e[s]):this._off(e[s],t,n)}else delete this._events;return this},_on:function(e,t,n,i){if("function"===typeof t){if(!1===this._listens(e,t,n)){n===this&&(n=void 0);var r={fn:t,ctx:n};i&&(r.once=!0),this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(r)}}else console.warn("wrong listener type: "+typeof t)},_off:function(e,t,n){var i,r,s;if(this._events&&(i=this._events[e]))if(1!==arguments.length)if("function"===typeof t){var o=this._listens(e,t,n);if(!1!==o){var a=i[o];this._firingCount&&(a.fn=c,this._events[e]=i=i.slice()),i.splice(o,1)}}else console.warn("wrong listener type: "+typeof t);else{if(this._firingCount)for(r=0,s=i.length;r<s;r++)i[r].fn=c;delete this._events[e]}},fire:function(e,t,i){if(!this.listens(e,i))return this;var r=n({},t,{type:e,target:this,sourceTarget:t&&t.sourceTarget||this});if(this._events){var s=this._events[e];if(s){this._firingCount=this._firingCount+1||1;for(var o=0,a=s.length;o<a;o++){var l=s[o],c=l.fn;l.once&&this.off(e,c,l.ctx),c.call(l.ctx||this,r)}this._firingCount--}}return i&&this._propagateEvent(r),this},listens:function(e,t,n,i){"string"!==typeof e&&console.warn('"string" type argument expected');var r=t;"function"!==typeof t&&(i=!!t,r=void 0,n=void 0);var s=this._events&&this._events[e];if(s&&s.length&&!1!==this._listens(e,r,n))return!0;if(i)for(var o in this._eventParents)if(this._eventParents[o].listens(e,t,n,i))return!0;return!1},_listens:function(e,t,n){if(!this._events)return!1;var i=this._events[e]||[];if(!t)return!!i.length;n===this&&(n=void 0);for(var r=0,s=i.length;r<s;r++)if(i[r].fn===t&&i[r].ctx===n)return r;return!1},once:function(e,t,n){if("object"===typeof e)for(var i in e)this._on(i,e[i],t,!0);else for(var r=0,s=(e=d(e)).length;r<s;r++)this._on(e[r],t,n,!0);return this},addEventParent:function(e){return this._eventParents=this._eventParents||{},this._eventParents[o(e)]=e,this},removeEventParent:function(e){return this._eventParents&&delete this._eventParents[o(e)],this},_propagateEvent:function(e){for(var t in this._eventParents)this._eventParents[t].fire(e.type,n({layer:e.target,propagatedFrom:e.target},e),!0)}};A.addEventListener=A.on,A.removeEventListener=A.clearAllEventListeners=A.off,A.addOneTimeEventListener=A.once,A.fireEvent=A.fire,A.hasEventListeners=A.listens;var F=T.extend(A);function D(e,t,n){this.x=n?Math.round(e):e,this.y=n?Math.round(t):t}var I=Math.trunc||function(e){return e>0?Math.floor(e):Math.ceil(e)};function k(e,t,n){return e instanceof D?e:v(e)?new D(e[0],e[1]):void 0===e||null===e?e:"object"===typeof e&&"x"in e&&"y"in e?new D(e.x,e.y):new D(e,t,n)}function O(e,t){if(e)for(var n=t?[e,t]:e,i=0,r=n.length;i<r;i++)this.extend(n[i])}function N(e,t){return!e||e instanceof O?e:new O(e,t)}function B(e,t){if(e)for(var n=t?[e,t]:e,i=0,r=n.length;i<r;i++)this.extend(n[i])}function z(e,t){return e instanceof B?e:new B(e,t)}function H(e,t,n){if(isNaN(e)||isNaN(t))throw new Error("Invalid LatLng object: ("+e+", "+t+")");this.lat=+e,this.lng=+t,void 0!==n&&(this.alt=+n)}function G(e,t,n){return e instanceof H?e:v(e)&&"object"!==typeof e[0]?3===e.length?new H(e[0],e[1],e[2]):2===e.length?new H(e[0],e[1]):null:void 0===e||null===e?e:"object"===typeof e&&"lat"in e?new H(e.lat,"lng"in e?e.lng:e.lon,e.alt):void 0===t?null:new H(e,t,n)}D.prototype={clone:function(){return new D(this.x,this.y)},add:function(e){return this.clone()._add(k(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(k(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},scaleBy:function(e){return new D(this.x*e.x,this.y*e.y)},unscaleBy:function(e){return new D(this.x/e.x,this.y/e.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=I(this.x),this.y=I(this.y),this},distanceTo:function(e){var t=(e=k(e)).x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)},equals:function(e){return(e=k(e)).x===this.x&&e.y===this.y},contains:function(e){return e=k(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+u(this.x)+", "+u(this.y)+")"}},O.prototype={extend:function(e){var t,n;if(!e)return this;if(e instanceof D||"number"===typeof e[0]||"x"in e)t=n=k(e);else if(t=(e=N(e)).min,n=e.max,!t||!n)return this;return this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(n.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(n.y,this.max.y)):(this.min=t.clone(),this.max=n.clone()),this},getCenter:function(e){return k((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return k(this.min.x,this.max.y)},getTopRight:function(){return k(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var t,n;return(e="number"===typeof e[0]||e instanceof D?k(e):N(e))instanceof O?(t=e.min,n=e.max):t=n=e,t.x>=this.min.x&&n.x<=this.max.x&&t.y>=this.min.y&&n.y<=this.max.y},intersects:function(e){e=N(e);var t=this.min,n=this.max,i=e.min,r=e.max,s=r.x>=t.x&&i.x<=n.x,o=r.y>=t.y&&i.y<=n.y;return s&&o},overlaps:function(e){e=N(e);var t=this.min,n=this.max,i=e.min,r=e.max,s=r.x>t.x&&i.x<n.x,o=r.y>t.y&&i.y<n.y;return s&&o},isValid:function(){return!(!this.min||!this.max)},pad:function(e){var t=this.min,n=this.max,i=Math.abs(t.x-n.x)*e,r=Math.abs(t.y-n.y)*e;return N(k(t.x-i,t.y-r),k(n.x+i,n.y+r))},equals:function(e){return!!e&&(e=N(e),this.min.equals(e.getTopLeft())&&this.max.equals(e.getBottomRight()))}},B.prototype={extend:function(e){var t,n,i=this._southWest,r=this._northEast;if(e instanceof H)t=e,n=e;else{if(!(e instanceof B))return e?this.extend(G(e)||z(e)):this;if(t=e._southWest,n=e._northEast,!t||!n)return this}return i||r?(i.lat=Math.min(t.lat,i.lat),i.lng=Math.min(t.lng,i.lng),r.lat=Math.max(n.lat,r.lat),r.lng=Math.max(n.lng,r.lng)):(this._southWest=new H(t.lat,t.lng),this._northEast=new H(n.lat,n.lng)),this},pad:function(e){var t=this._southWest,n=this._northEast,i=Math.abs(t.lat-n.lat)*e,r=Math.abs(t.lng-n.lng)*e;return new B(new H(t.lat-i,t.lng-r),new H(n.lat+i,n.lng+r))},getCenter:function(){return new H((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new H(this.getNorth(),this.getWest())},getSouthEast:function(){return new H(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){e="number"===typeof e[0]||e instanceof H||"lat"in e?G(e):z(e);var t,n,i=this._southWest,r=this._northEast;return e instanceof B?(t=e.getSouthWest(),n=e.getNorthEast()):t=n=e,t.lat>=i.lat&&n.lat<=r.lat&&t.lng>=i.lng&&n.lng<=r.lng},intersects:function(e){e=z(e);var t=this._southWest,n=this._northEast,i=e.getSouthWest(),r=e.getNorthEast(),s=r.lat>=t.lat&&i.lat<=n.lat,o=r.lng>=t.lng&&i.lng<=n.lng;return s&&o},overlaps:function(e){e=z(e);var t=this._southWest,n=this._northEast,i=e.getSouthWest(),r=e.getNorthEast(),s=r.lat>t.lat&&i.lat<n.lat,o=r.lng>t.lng&&i.lng<n.lng;return s&&o},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e,t){return!!e&&(e=z(e),this._southWest.equals(e.getSouthWest(),t)&&this._northEast.equals(e.getNorthEast(),t))},isValid:function(){return!(!this._southWest||!this._northEast)}},H.prototype={equals:function(e,t){return!!e&&(e=G(e),Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng))<=(void 0===t?1e-9:t))},toString:function(e){return"LatLng("+u(this.lat,e)+", "+u(this.lng,e)+")"},distanceTo:function(e){return V.distance(this,G(e))},wrap:function(){return V.wrapLatLng(this)},toBounds:function(e){var t=180*e/40075017,n=t/Math.cos(Math.PI/180*this.lat);return z([this.lat-t,this.lng-n],[this.lat+t,this.lng+n])},clone:function(){return new H(this.lat,this.lng,this.alt)}};var U={latLngToPoint:function(e,t){var n=this.projection.project(e),i=this.scale(t);return this.transformation._transform(n,i)},pointToLatLng:function(e,t){var n=this.scale(t),i=this.transformation.untransform(e,n);return this.projection.unproject(i)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return 256*Math.pow(2,e)},zoom:function(e){return Math.log(e/256)/Math.LN2},getProjectedBounds:function(e){if(this.infinite)return null;var t=this.projection.bounds,n=this.scale(e);return new O(this.transformation.transform(t.min,n),this.transformation.transform(t.max,n))},infinite:!1,wrapLatLng:function(e){var t=this.wrapLng?l(e.lng,this.wrapLng,!0):e.lng;return new H(this.wrapLat?l(e.lat,this.wrapLat,!0):e.lat,t,e.alt)},wrapLatLngBounds:function(e){var t=e.getCenter(),n=this.wrapLatLng(t),i=t.lat-n.lat,r=t.lng-n.lng;if(0===i&&0===r)return e;var s=e.getSouthWest(),o=e.getNorthEast();return new B(new H(s.lat-i,s.lng-r),new H(o.lat-i,o.lng-r))}},V=n({},U,{wrapLng:[-180,180],R:6371e3,distance:function(e,t){var n=Math.PI/180,i=e.lat*n,r=t.lat*n,s=Math.sin((t.lat-e.lat)*n/2),o=Math.sin((t.lng-e.lng)*n/2),a=s*s+Math.cos(i)*Math.cos(r)*o*o,l=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*l}}),W=6378137,j={R:W,MAX_LATITUDE:85.0511287798,project:function(e){var t=Math.PI/180,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,e.lat),-n),r=Math.sin(i*t);return new D(this.R*e.lng*t,this.R*Math.log((1+r)/(1-r))/2)},unproject:function(e){var t=180/Math.PI;return new H((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*t,e.x*t/this.R)},bounds:function(){var e=W*Math.PI;return new O([-e,-e],[e,e])}()};function q(e,t,n,i){if(v(e))return this._a=e[0],this._b=e[1],this._c=e[2],void(this._d=e[3]);this._a=e,this._b=t,this._c=n,this._d=i}function X(e,t,n,i){return new q(e,t,n,i)}q.prototype={transform:function(e,t){return this._transform(e.clone(),t)},_transform:function(e,t){return t=t||1,e.x=t*(this._a*e.x+this._b),e.y=t*(this._c*e.y+this._d),e},untransform:function(e,t){return t=t||1,new D((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}};var K=n({},V,{code:"EPSG:3857",projection:j,transformation:function(){var e=.5/(Math.PI*j.R);return X(e,.5,-e,.5)}()}),$=n({},K,{code:"EPSG:900913"});function Z(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Y(e,t){var n,i,r,s,o,a,l="";for(n=0,r=e.length;n<r;n++){for(i=0,s=(o=e[n]).length;i<s;i++)l+=(i?"L":"M")+(a=o[i]).x+" "+a.y;l+=t?Oe.svg?"z":"x":""}return l||"M0 0"}var J=document.documentElement.style,Q="ActiveXObject"in window,ee=Q&&!document.addEventListener,te="msLaunchUri"in navigator&&!("documentMode"in document),ne=ke("webkit"),ie=ke("android"),re=ke("android 2")||ke("android 3"),se=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),oe=ie&&ke("Google")&&se<537&&!("AudioNode"in window),ae=!!window.opera,le=!te&&ke("chrome"),ce=ke("gecko")&&!ne&&!ae&&!Q,ue=!le&&ke("safari"),he=ke("phantom"),de="OTransition"in J,pe=0===navigator.platform.indexOf("Win"),ge=Q&&"transition"in J,fe="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!re,me="MozPerspective"in J,ve=!window.L_DISABLE_3D&&(ge||fe||me)&&!de&&!he,ye="undefined"!==typeof orientation||ke("mobile"),Ce=ye&&ne,we=ye&&fe,Se=!window.PointerEvent&&window.MSPointerEvent,be=!(!window.PointerEvent&&!Se),xe="ontouchstart"in window||!!window.TouchEvent,_e=!window.L_NO_TOUCH&&(xe||be),Me=ye&&ae,Ee=ye&&ce,Re=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Te=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassiveEventSupport",c,t),window.removeEventListener("testPassiveEventSupport",c,t)}catch(n){}return e}(),Pe=!!document.createElement("canvas").getContext,Ae=!(!document.createElementNS||!Z("svg").createSVGRect),Fe=!!Ae&&function(){var e=document.createElement("div");return e.innerHTML="<svg/>","http://www.w3.org/2000/svg"===(e.firstChild&&e.firstChild.namespaceURI)}(),De=!Ae&&function(){try{var e=document.createElement("div");e.innerHTML='<v:shape adj="1"/>';var t=e.firstChild;return t.style.behavior="url(#default#VML)",t&&"object"===typeof t.adj}catch(n){return!1}}(),Le=0===navigator.platform.indexOf("Mac"),Ie=0===navigator.platform.indexOf("Linux");function ke(e){return navigator.userAgent.toLowerCase().indexOf(e)>=0}var Oe={ie:Q,ielt9:ee,edge:te,webkit:ne,android:ie,android23:re,androidStock:oe,opera:ae,chrome:le,gecko:ce,safari:ue,phantom:he,opera12:de,win:pe,ie3d:ge,webkit3d:fe,gecko3d:me,any3d:ve,mobile:ye,mobileWebkit:Ce,mobileWebkit3d:we,msPointer:Se,pointer:be,touch:_e,touchNative:xe,mobileOpera:Me,mobileGecko:Ee,retina:Re,passiveEvents:Te,canvas:Pe,svg:Ae,vml:De,inlineSvg:Fe,mac:Le,linux:Ie},Ne=Oe.msPointer?"MSPointerDown":"pointerdown",Be=Oe.msPointer?"MSPointerMove":"pointermove",ze=Oe.msPointer?"MSPointerUp":"pointerup",He=Oe.msPointer?"MSPointerCancel":"pointercancel",Ge={touchstart:Ne,touchmove:Be,touchend:ze,touchcancel:He},Ue={touchstart:Je,touchmove:Ye,touchend:Ye,touchcancel:Ye},Ve={},We=!1;function je(e,t,n){return"touchstart"===t&&Ze(),Ue[t]?(n=Ue[t].bind(this,n),e.addEventListener(Ge[t],n,!1),n):(console.warn("wrong event specified:",t),c)}function qe(e,t,n){Ge[t]?e.removeEventListener(Ge[t],n,!1):console.warn("wrong event specified:",t)}function Xe(e){Ve[e.pointerId]=e}function Ke(e){Ve[e.pointerId]&&(Ve[e.pointerId]=e)}function $e(e){delete Ve[e.pointerId]}function Ze(){We||(document.addEventListener(Ne,Xe,!0),document.addEventListener(Be,Ke,!0),document.addEventListener(ze,$e,!0),document.addEventListener(He,$e,!0),We=!0)}function Ye(e,t){if(t.pointerType!==(t.MSPOINTER_TYPE_MOUSE||"mouse")){for(var n in t.touches=[],Ve)t.touches.push(Ve[n]);t.changedTouches=[t],e(t)}}function Je(e,t){t.MSPOINTER_TYPE_TOUCH&&t.pointerType===t.MSPOINTER_TYPE_TOUCH&&Xt(t),Ye(e,t)}function Qe(e){var t,n,i={};for(n in e)t=e[n],i[n]=t&&t.bind?t.bind(e):t;return e=i,i.type="dblclick",i.detail=2,i.isTrusted=!1,i._simulated=!0,i}var et=200;function tt(e,t){e.addEventListener("dblclick",t);var n,i=0;function r(e){if(1===e.detail){if("mouse"!==e.pointerType&&(!e.sourceCapabilities||e.sourceCapabilities.firesTouchEvents)){var r=$t(e);if(!r.some((function(e){return e instanceof HTMLLabelElement&&e.attributes.for}))||r.some((function(e){return e instanceof HTMLInputElement||e instanceof HTMLSelectElement}))){var s=Date.now();s-i<=et?2===++n&&t(Qe(e)):n=1,i=s}}}else n=e.detail}return e.addEventListener("click",r),{dblclick:t,simDblclick:r}}function nt(e,t){e.removeEventListener("dblclick",t.dblclick),e.removeEventListener("click",t.simDblclick)}var it,rt,st,ot,at,lt=Mt(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ct=Mt(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ut="webkitTransition"===ct||"OTransition"===ct?ct+"End":"transitionend";function ht(e){return"string"===typeof e?document.getElementById(e):e}function dt(e,t){var n=e.style[t]||e.currentStyle&&e.currentStyle[t];if((!n||"auto"===n)&&document.defaultView){var i=document.defaultView.getComputedStyle(e,null);n=i?i[t]:null}return"auto"===n?null:n}function pt(e,t,n){var i=document.createElement(e);return i.className=t||"",n&&n.appendChild(i),i}function gt(e){var t=e.parentNode;t&&t.removeChild(e)}function ft(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function mt(e){var t=e.parentNode;t&&t.lastChild!==e&&t.appendChild(e)}function vt(e){var t=e.parentNode;t&&t.firstChild!==e&&t.insertBefore(e,t.firstChild)}function yt(e,t){if(void 0!==e.classList)return e.classList.contains(t);var n=bt(e);return n.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(n)}function Ct(e,t){if(void 0!==e.classList)for(var n=d(t),i=0,r=n.length;i<r;i++)e.classList.add(n[i]);else if(!yt(e,t)){var s=bt(e);St(e,(s?s+" ":"")+t)}}function wt(e,t){void 0!==e.classList?e.classList.remove(t):St(e,h((" "+bt(e)+" ").replace(" "+t+" "," ")))}function St(e,t){void 0===e.className.baseVal?e.className=t:e.className.baseVal=t}function bt(e){return e.correspondingElement&&(e=e.correspondingElement),void 0===e.className.baseVal?e.className:e.className.baseVal}function xt(e,t){"opacity"in e.style?e.style.opacity=t:"filter"in e.style&&_t(e,t)}function _t(e,t){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=e.filters.item(i)}catch(r){if(1===t)return}t=Math.round(100*t),n?(n.Enabled=100!==t,n.Opacity=t):e.style.filter+=" progid:"+i+"(opacity="+t+")"}function Mt(e){for(var t=document.documentElement.style,n=0;n<e.length;n++)if(e[n]in t)return e[n];return!1}function Et(e,t,n){var i=t||new D(0,0);e.style[lt]=(Oe.ie3d?"translate("+i.x+"px,"+i.y+"px)":"translate3d("+i.x+"px,"+i.y+"px,0)")+(n?" scale("+n+")":"")}function Rt(e,t){e._leaflet_pos=t,Oe.any3d?Et(e,t):(e.style.left=t.x+"px",e.style.top=t.y+"px")}function Tt(e){return e._leaflet_pos||new D(0,0)}if("onselectstart"in document)it=function(){Nt(window,"selectstart",Xt)},rt=function(){zt(window,"selectstart",Xt)};else{var Pt=Mt(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);it=function(){if(Pt){var e=document.documentElement.style;st=e[Pt],e[Pt]="none"}},rt=function(){Pt&&(document.documentElement.style[Pt]=st,st=void 0)}}function At(){Nt(window,"dragstart",Xt)}function Ft(){zt(window,"dragstart",Xt)}function Dt(e){for(;-1===e.tabIndex;)e=e.parentNode;e.style&&(Lt(),ot=e,at=e.style.outlineStyle,e.style.outlineStyle="none",Nt(window,"keydown",Lt))}function Lt(){ot&&(ot.style.outlineStyle=at,ot=void 0,at=void 0,zt(window,"keydown",Lt))}function It(e){do{e=e.parentNode}while((!e.offsetWidth||!e.offsetHeight)&&e!==document.body);return e}function kt(e){var t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t}}var Ot={__proto__:null,TRANSFORM:lt,TRANSITION:ct,TRANSITION_END:ut,get:ht,getStyle:dt,create:pt,remove:gt,empty:ft,toFront:mt,toBack:vt,hasClass:yt,addClass:Ct,removeClass:wt,setClass:St,getClass:bt,setOpacity:xt,testProp:Mt,setTransform:Et,setPosition:Rt,getPosition:Tt,get disableTextSelection(){return it},get enableTextSelection(){return rt},disableImageDrag:At,enableImageDrag:Ft,preventOutline:Dt,restoreOutline:Lt,getSizedParentNode:It,getScale:kt};function Nt(e,t,n,i){if(t&&"object"===typeof t)for(var r in t)Ut(e,r,t[r],n);else for(var s=0,o=(t=d(t)).length;s<o;s++)Ut(e,t[s],n,i);return this}var Bt="_leaflet_events";function zt(e,t,n,i){if(1===arguments.length)Ht(e),delete e[Bt];else if(t&&"object"===typeof t)for(var r in t)Vt(e,r,t[r],n);else if(t=d(t),2===arguments.length)Ht(e,(function(e){return-1!==y(t,e)}));else for(var s=0,o=t.length;s<o;s++)Vt(e,t[s],n,i);return this}function Ht(e,t){for(var n in e[Bt]){var i=n.split(/\d/)[0];t&&!t(i)||Vt(e,i,null,null,n)}}var Gt={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ut(e,t,n,i){var r=t+o(n)+(i?"_"+o(i):"");if(e[Bt]&&e[Bt][r])return this;var s=function(t){return n.call(i||e,t||window.event)},a=s;!Oe.touchNative&&Oe.pointer&&0===t.indexOf("touch")?s=je(e,t,s):Oe.touch&&"dblclick"===t?s=tt(e,s):"addEventListener"in e?"touchstart"===t||"touchmove"===t||"wheel"===t||"mousewheel"===t?e.addEventListener(Gt[t]||t,s,!!Oe.passiveEvents&&{passive:!1}):"mouseenter"===t||"mouseleave"===t?(s=function(t){t=t||window.event,Qt(e,t)&&a(t)},e.addEventListener(Gt[t],s,!1)):e.addEventListener(t,a,!1):e.attachEvent("on"+t,s),e[Bt]=e[Bt]||{},e[Bt][r]=s}function Vt(e,t,n,i,r){r=r||t+o(n)+(i?"_"+o(i):"");var s=e[Bt]&&e[Bt][r];if(!s)return this;!Oe.touchNative&&Oe.pointer&&0===t.indexOf("touch")?qe(e,t,s):Oe.touch&&"dblclick"===t?nt(e,s):"removeEventListener"in e?e.removeEventListener(Gt[t]||t,s,!1):e.detachEvent("on"+t,s),e[Bt][r]=null}function Wt(e){return e.stopPropagation?e.stopPropagation():e.originalEvent?e.originalEvent._stopped=!0:e.cancelBubble=!0,this}function jt(e){return Ut(e,"wheel",Wt),this}function qt(e){return Nt(e,"mousedown touchstart dblclick contextmenu",Wt),e._leaflet_disable_click=!0,this}function Xt(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this}function Kt(e){return Xt(e),Wt(e),this}function $t(e){if(e.composedPath)return e.composedPath();for(var t=[],n=e.target;n;)t.push(n),n=n.parentNode;return t}function Zt(e,t){if(!t)return new D(e.clientX,e.clientY);var n=kt(t),i=n.boundingClientRect;return new D((e.clientX-i.left)/n.x-t.clientLeft,(e.clientY-i.top)/n.y-t.clientTop)}var Yt=Oe.linux&&Oe.chrome?window.devicePixelRatio:Oe.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Jt(e){return Oe.edge?e.wheelDeltaY/2:e.deltaY&&0===e.deltaMode?-e.deltaY/Yt:e.deltaY&&1===e.deltaMode?20*-e.deltaY:e.deltaY&&2===e.deltaMode?60*-e.deltaY:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?20*-e.detail:e.detail?e.detail/-32765*60:0}function Qt(e,t){var n=t.relatedTarget;if(!n)return!0;try{for(;n&&n!==e;)n=n.parentNode}catch(i){return!1}return n!==e}var en={__proto__:null,on:Nt,off:zt,stopPropagation:Wt,disableScrollPropagation:jt,disableClickPropagation:qt,preventDefault:Xt,stop:Kt,getPropagationPath:$t,getMousePosition:Zt,getWheelDelta:Jt,isExternalTarget:Qt,addListener:Nt,removeListener:zt},tn=F.extend({run:function(e,t,n,i){this.stop(),this._el=e,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=Tt(e),this._offset=t.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=M(this._animate,this),this._step()},_step:function(e){var t=+new Date-this._startTime,n=1e3*this._duration;t<n?this._runFrame(this._easeOut(t/n),e):(this._runFrame(1),this._complete())},_runFrame:function(e,t){var n=this._startPos.add(this._offset.multiplyBy(e));t&&n._round(),Rt(this._el,n),this.fire("step")},_complete:function(){E(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}}),nn=F.extend({options:{crs:K,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(e,t){t=p(this,t),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(e),this._initLayout(),this._onResize=r(this._onResize,this),this._initEvents(),t.maxBounds&&this.setMaxBounds(t.maxBounds),void 0!==t.zoom&&(this._zoom=this._limitZoom(t.zoom)),t.center&&void 0!==t.zoom&&this.setView(G(t.center),t.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ct&&Oe.any3d&&!Oe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Nt(this._proxy,ut,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(e,t,i){return t=void 0===t?this._zoom:this._limitZoom(t),e=this._limitCenter(G(e),t,this.options.maxBounds),i=i||{},this._stop(),this._loaded&&!i.reset&&!0!==i&&(void 0!==i.animate&&(i.zoom=n({animate:i.animate},i.zoom),i.pan=n({animate:i.animate,duration:i.duration},i.pan)),this._zoom!==t?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,t,i.zoom):this._tryAnimatedPan(e,i.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(e,t,i.pan&&i.pan.noMoveStart),this)},setZoom:function(e,t){return this._loaded?this.setView(this.getCenter(),e,{zoom:t}):(this._zoom=e,this)},zoomIn:function(e,t){return e=e||(Oe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+e,t)},zoomOut:function(e,t){return e=e||(Oe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-e,t)},setZoomAround:function(e,t,n){var i=this.getZoomScale(t),r=this.getSize().divideBy(2),s=(e instanceof D?e:this.latLngToContainerPoint(e)).subtract(r).multiplyBy(1-1/i),o=this.containerPointToLatLng(r.add(s));return this.setView(o,t,{zoom:n})},_getBoundsCenterZoom:function(e,t){t=t||{},e=e.getBounds?e.getBounds():z(e);var n=k(t.paddingTopLeft||t.padding||[0,0]),i=k(t.paddingBottomRight||t.padding||[0,0]),r=this.getBoundsZoom(e,!1,n.add(i));if((r="number"===typeof t.maxZoom?Math.min(t.maxZoom,r):r)===1/0)return{center:e.getCenter(),zoom:r};var s=i.subtract(n).divideBy(2),o=this.project(e.getSouthWest(),r),a=this.project(e.getNorthEast(),r);return{center:this.unproject(o.add(a).divideBy(2).add(s),r),zoom:r}},fitBounds:function(e,t){if(!(e=z(e)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(e,t);return this.setView(n.center,n.zoom,t)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,t){return this.setView(e,this._zoom,{pan:t})},panBy:function(e,t){if(t=t||{},!(e=k(e).round()).x&&!e.y)return this.fire("moveend");if(!0!==t.animate&&!this.getSize().contains(e))return this._resetView(this.unproject(this.project(this.getCenter()).add(e)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new tn,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),t.noMoveStart||this.fire("movestart"),!1!==t.animate){Ct(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(e).round();this._panAnim.run(this._mapPane,n,t.duration||.25,t.easeLinearity)}else this._rawPanBy(e),this.fire("move").fire("moveend");return this},flyTo:function(e,t,n){if(!1===(n=n||{}).animate||!Oe.any3d)return this.setView(e,t,n);this._stop();var i=this.project(this.getCenter()),r=this.project(e),s=this.getSize(),o=this._zoom;e=G(e),t=void 0===t?o:t;var a=Math.max(s.x,s.y),l=a*this.getZoomScale(o,t),c=r.distanceTo(i)||1,u=1.42,h=u*u;function d(e){var t=(l*l-a*a+(e?-1:1)*h*h*c*c)/(2*(e?l:a)*h*c),n=Math.sqrt(t*t+1)-t;return n<1e-9?-18:Math.log(n)}function p(e){return(Math.exp(e)-Math.exp(-e))/2}function g(e){return(Math.exp(e)+Math.exp(-e))/2}function f(e){return p(e)/g(e)}var m=d(0);function v(e){return a*(g(m)/g(m+u*e))}function y(e){return a*(g(m)*f(m+u*e)-p(m))/h}function C(e){return 1-Math.pow(1-e,1.5)}var w=Date.now(),S=(d(1)-m)/u,b=n.duration?1e3*n.duration:1e3*S*.8;function x(){var n=(Date.now()-w)/b,s=C(n)*S;n<=1?(this._flyToFrame=M(x,this),this._move(this.unproject(i.add(r.subtract(i).multiplyBy(y(s)/c)),o),this.getScaleZoom(a/v(s),o),{flyTo:!0})):this._move(e,t)._moveEnd(!0)}return this._moveStart(!0,n.noMoveStart),x.call(this),this},flyToBounds:function(e,t){var n=this._getBoundsCenterZoom(e,t);return this.flyTo(n.center,n.zoom,t)},setMaxBounds:function(e){return e=z(e),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),e.isValid()?(this.options.maxBounds=e,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(e){var t=this.options.minZoom;return this.options.minZoom=e,this._loaded&&t!==e&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(e):this},setMaxZoom:function(e){var t=this.options.maxZoom;return this.options.maxZoom=e,this._loaded&&t!==e&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(e):this},panInsideBounds:function(e,t){this._enforcingBounds=!0;var n=this.getCenter(),i=this._limitCenter(n,this._zoom,z(e));return n.equals(i)||this.panTo(i,t),this._enforcingBounds=!1,this},panInside:function(e,t){var n=k((t=t||{}).paddingTopLeft||t.padding||[0,0]),i=k(t.paddingBottomRight||t.padding||[0,0]),r=this.project(this.getCenter()),s=this.project(e),o=this.getPixelBounds(),a=N([o.min.add(n),o.max.subtract(i)]),l=a.getSize();if(!a.contains(s)){this._enforcingBounds=!0;var c=s.subtract(a.getCenter()),u=a.extend(s).getSize().subtract(l);r.x+=c.x<0?-u.x:u.x,r.y+=c.y<0?-u.y:u.y,this.panTo(this.unproject(r),t),this._enforcingBounds=!1}return this},invalidateSize:function(e){if(!this._loaded)return this;e=n({animate:!1,pan:!0},!0===e?{animate:!0}:e);var t=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var i=this.getSize(),s=t.divideBy(2).round(),o=i.divideBy(2).round(),a=s.subtract(o);return a.x||a.y?(e.animate&&e.pan?this.panBy(a):(e.pan&&this._rawPanBy(a),this.fire("move"),e.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(r(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:t,newSize:i})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(e){if(e=this._locateOptions=n({timeout:1e4,watch:!1},e),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var t=r(this._handleGeolocationResponse,this),i=r(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(t,i,e):navigator.geolocation.getCurrentPosition(t,i,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(e){if(this._container._leaflet_id){var t=e.code,n=e.message||(1===t?"permission denied":2===t?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:t,message:"Geolocation error: "+n+"."})}},_handleGeolocationResponse:function(e){if(this._container._leaflet_id){var t=new H(e.coords.latitude,e.coords.longitude),n=t.toBounds(2*e.coords.accuracy),i=this._locateOptions;if(i.setView){var r=this.getBoundsZoom(n);this.setView(t,i.maxZoom?Math.min(r,i.maxZoom):r)}var s={latlng:t,bounds:n,timestamp:e.timestamp};for(var o in e.coords)"number"===typeof e.coords[o]&&(s[o]=e.coords[o]);this.fire("locationfound",s)}},addHandler:function(e,t){if(!t)return this;var n=this[e]=new t(this);return this._handlers.push(n),this.options[e]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var e;for(e in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),gt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(E(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[e].remove();for(e in this._panes)gt(this._panes[e]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(e,t){var n=pt("div","leaflet-pane"+(e?" leaflet-"+e.replace("Pane","")+"-pane":""),t||this._mapPane);return e&&(this._panes[e]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds();return new B(this.unproject(e.getBottomLeft()),this.unproject(e.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,t,n){e=z(e),n=k(n||[0,0]);var i=this.getZoom()||0,r=this.getMinZoom(),s=this.getMaxZoom(),o=e.getNorthWest(),a=e.getSouthEast(),l=this.getSize().subtract(n),c=N(this.project(a,i),this.project(o,i)).getSize(),u=Oe.any3d?this.options.zoomSnap:1,h=l.x/c.x,d=l.y/c.y,p=t?Math.max(h,d):Math.min(h,d);return i=this.getScaleZoom(p,i),u&&(i=Math.round(i/(u/100))*(u/100),i=t?Math.ceil(i/u)*u:Math.floor(i/u)*u),Math.max(r,Math.min(s,i))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new D(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(e,t){var n=this._getTopLeftPoint(e,t);return new O(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(e){return this.options.crs.getProjectedBounds(void 0===e?this.getZoom():e)},getPane:function(e){return"string"===typeof e?this._panes[e]:e},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e,t){var n=this.options.crs;return t=void 0===t?this._zoom:t,n.scale(e)/n.scale(t)},getScaleZoom:function(e,t){var n=this.options.crs;t=void 0===t?this._zoom:t;var i=n.zoom(e*n.scale(t));return isNaN(i)?1/0:i},project:function(e,t){return t=void 0===t?this._zoom:t,this.options.crs.latLngToPoint(G(e),t)},unproject:function(e,t){return t=void 0===t?this._zoom:t,this.options.crs.pointToLatLng(k(e),t)},layerPointToLatLng:function(e){var t=k(e).add(this.getPixelOrigin());return this.unproject(t)},latLngToLayerPoint:function(e){return this.project(G(e))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(e){return this.options.crs.wrapLatLng(G(e))},wrapLatLngBounds:function(e){return this.options.crs.wrapLatLngBounds(z(e))},distance:function(e,t){return this.options.crs.distance(G(e),G(t))},containerPointToLayerPoint:function(e){return k(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return k(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var t=this.containerPointToLayerPoint(k(e));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(G(e)))},mouseEventToContainerPoint:function(e){return Zt(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var t=this._container=ht(e);if(!t)throw new Error("Map container not found.");if(t._leaflet_id)throw new Error("Map container is already initialized.");Nt(t,"scroll",this._onScroll,this),this._containerId=o(t)},_initLayout:function(){var e=this._container;this._fadeAnimated=this.options.fadeAnimation&&Oe.any3d,Ct(e,"leaflet-container"+(Oe.touch?" leaflet-touch":"")+(Oe.retina?" leaflet-retina":"")+(Oe.ielt9?" leaflet-oldie":"")+(Oe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var t=dt(e,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&"sticky"!==t&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Rt(this._mapPane,new D(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ct(e.markerPane,"leaflet-zoom-hide"),Ct(e.shadowPane,"leaflet-zoom-hide"))},_resetView:function(e,t,n){Rt(this._mapPane,new D(0,0));var i=!this._loaded;this._loaded=!0,t=this._limitZoom(t),this.fire("viewprereset");var r=this._zoom!==t;this._moveStart(r,n)._move(e,t)._moveEnd(r),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(e,t){return e&&this.fire("zoomstart"),t||this.fire("movestart"),this},_move:function(e,t,n,i){void 0===t&&(t=this._zoom);var r=this._zoom!==t;return this._zoom=t,this._lastCenter=e,this._pixelOrigin=this._getNewPixelOrigin(e),i?n&&n.pinch&&this.fire("zoom",n):((r||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)),this},_moveEnd:function(e){return e&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return E(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(e){Rt(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){this._targets={},this._targets[o(this._container)]=this;var t=e?zt:Nt;t(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&t(window,"resize",this._onResize,this),Oe.any3d&&this.options.transform3DLimit&&(e?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){E(this._resizeRequest),this._resizeRequest=M((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var e=this._getMapPanePos();Math.max(Math.abs(e.x),Math.abs(e.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(e,t){for(var n,i=[],r="mouseout"===t||"mouseover"===t,s=e.target||e.srcElement,a=!1;s;){if((n=this._targets[o(s)])&&("click"===t||"preclick"===t)&&this._draggableMoved(n)){a=!0;break}if(n&&n.listens(t,!0)){if(r&&!Qt(s,e))break;if(i.push(n),r)break}if(s===this._container)break;s=s.parentNode}return i.length||a||r||!this.listens(t,!0)||(i=[this]),i},_isClickDisabled:function(e){for(;e&&e!==this._container;){if(e._leaflet_disable_click)return!0;e=e.parentNode}},_handleDOMEvent:function(e){var t=e.target||e.srcElement;if(!(!this._loaded||t._leaflet_disable_events||"click"===e.type&&this._isClickDisabled(t))){var n=e.type;"mousedown"===n&&Dt(t),this._fireDOMEvent(e,n)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(e,t,i){if("click"===e.type){var r=n({},e);r.type="preclick",this._fireDOMEvent(r,r.type,i)}var s=this._findEventTargets(e,t);if(i){for(var o=[],a=0;a<i.length;a++)i[a].listens(t,!0)&&o.push(i[a]);s=o.concat(s)}if(s.length){"contextmenu"===t&&Xt(e);var l=s[0],c={originalEvent:e};if("keypress"!==e.type&&"keydown"!==e.type&&"keyup"!==e.type){var u=l.getLatLng&&(!l._radius||l._radius<=10);c.containerPoint=u?this.latLngToContainerPoint(l.getLatLng()):this.mouseEventToContainerPoint(e),c.layerPoint=this.containerPointToLayerPoint(c.containerPoint),c.latlng=u?l.getLatLng():this.layerPointToLatLng(c.layerPoint)}for(a=0;a<s.length;a++)if(s[a].fire(t,c,!0),c.originalEvent._stopped||!1===s[a].options.bubblingMouseEvents&&-1!==y(this._mouseEvents,t))return}},_draggableMoved:function(e){return(e=e.dragging&&e.dragging.enabled()?e:this).dragging&&e.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var e=0,t=this._handlers.length;e<t;e++)this._handlers[e].disable()},whenReady:function(e,t){return this._loaded?e.call(t||this,{target:this}):this.on("load",e,t),this},_getMapPanePos:function(){return Tt(this._mapPane)||new D(0,0)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(e,t){return(e&&void 0!==t?this._getNewPixelOrigin(e,t):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(e,t){var n=this.getSize()._divideBy(2);return this.project(e,t)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(e,t,n){var i=this._getNewPixelOrigin(n,t);return this.project(e,t)._subtract(i)},_latLngBoundsToNewLayerBounds:function(e,t,n){var i=this._getNewPixelOrigin(n,t);return N([this.project(e.getSouthWest(),t)._subtract(i),this.project(e.getNorthWest(),t)._subtract(i),this.project(e.getSouthEast(),t)._subtract(i),this.project(e.getNorthEast(),t)._subtract(i)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,t,n){if(!n)return e;var i=this.project(e,t),r=this.getSize().divideBy(2),s=new O(i.subtract(r),i.add(r)),o=this._getBoundsOffset(s,n,t);return Math.abs(o.x)<=1&&Math.abs(o.y)<=1?e:this.unproject(i.add(o),t)},_limitOffset:function(e,t){if(!t)return e;var n=this.getPixelBounds(),i=new O(n.min.add(e),n.max.add(e));return e.add(this._getBoundsOffset(i,t))},_getBoundsOffset:function(e,t,n){var i=N(this.project(t.getNorthEast(),n),this.project(t.getSouthWest(),n)),r=i.min.subtract(e.min),s=i.max.subtract(e.max);return new D(this._rebound(r.x,-s.x),this._rebound(r.y,-s.y))},_rebound:function(e,t){return e+t>0?Math.round(e-t)/2:Math.max(0,Math.ceil(e))-Math.max(0,Math.floor(t))},_limitZoom:function(e){var t=this.getMinZoom(),n=this.getMaxZoom(),i=Oe.any3d?this.options.zoomSnap:1;return i&&(e=Math.round(e/i)*i),Math.max(t,Math.min(n,e))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){wt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(e,t){var n=this._getCenterOffset(e)._trunc();return!(!0!==(t&&t.animate)&&!this.getSize().contains(n))&&(this.panBy(n,t),!0)},_createAnimProxy:function(){var e=this._proxy=pt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(e),this.on("zoomanim",(function(e){var t=lt,n=this._proxy.style[t];Et(this._proxy,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),n===this._proxy.style[t]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){gt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var e=this.getCenter(),t=this.getZoom();Et(this._proxy,this.project(e,t),this.getZoomScale(t,1))},_catchTransitionEnd:function(e){this._animatingZoom&&e.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,t,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(t-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(t),r=this._getCenterOffset(e)._divideBy(1-1/i);return!(!0!==n.animate&&!this.getSize().contains(r))&&(M((function(){this._moveStart(!0,n.noMoveStart||!1)._animateZoom(e,t,!0)}),this),!0)},_animateZoom:function(e,t,n,i){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=e,this._animateToZoom=t,Ct(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:e,zoom:t,noUpdate:i}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(r(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&wt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function rn(e,t){return new nn(e,t)}var sn=T.extend({options:{position:"topright"},initialize:function(e){p(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var t=this._map;return t&&t.removeControl(this),this.options.position=e,t&&t.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this.remove(),this._map=e;var t=this._container=this.onAdd(e),n=this.getPosition(),i=e._controlCorners[n];return Ct(t,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(t,i.firstChild):i.appendChild(t),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(gt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(e){this._map&&e&&e.screenX>0&&e.screenY>0&&this._map.getContainer().focus()}}),on=function(e){return new sn(e)};nn.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.remove(),this},_initControlPos:function(){var e=this._controlCorners={},t="leaflet-",n=this._controlContainer=pt("div",t+"control-container",this._container);function i(i,r){var s=t+i+" "+t+r;e[i+r]=pt("div",s,n)}i("top","left"),i("top","right"),i("bottom","left"),i("bottom","right")},_clearControlPos:function(){for(var e in this._controlCorners)gt(this._controlCorners[e]);gt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var an=sn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(e,t,n,i){return n<i?-1:i<n?1:0}},initialize:function(e,t,n){for(var i in p(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1,e)this._addLayer(e[i],i);for(i in t)this._addLayer(t[i],i,!0)},onAdd:function(e){this._initLayout(),this._update(),this._map=e,e.on("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(e){return sn.prototype.addTo.call(this,e),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(e,t){return this._addLayer(e,t),this._map?this._update():this},addOverlay:function(e,t){return this._addLayer(e,t,!0),this._map?this._update():this},removeLayer:function(e){e.off("add remove",this._onLayerChange,this);var t=this._getLayer(o(e));return t&&this._layers.splice(this._layers.indexOf(t),1),this._map?this._update():this},expand:function(){Ct(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var e=this._map.getSize().y-(this._container.offsetTop+50);return e<this._section.clientHeight?(Ct(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=e+"px"):wt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return wt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var e="leaflet-control-layers",t=this._container=pt("div",e),n=this.options.collapsed;t.setAttribute("aria-haspopup",!0),qt(t),jt(t);var i=this._section=pt("section",e+"-list");n&&(this._map.on("click",this.collapse,this),Nt(t,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var r=this._layersLink=pt("a",e+"-toggle",t);r.href="#",r.title="Layers",r.setAttribute("role","button"),Nt(r,{keydown:function(e){13===e.keyCode&&this._expandSafely()},click:function(e){Xt(e),this._expandSafely()}},this),n||this.expand(),this._baseLayersList=pt("div",e+"-base",i),this._separator=pt("div",e+"-separator",i),this._overlaysList=pt("div",e+"-overlays",i),t.appendChild(i)},_getLayer:function(e){for(var t=0;t<this._layers.length;t++)if(this._layers[t]&&o(this._layers[t].layer)===e)return this._layers[t]},_addLayer:function(e,t,n){this._map&&e.on("add remove",this._onLayerChange,this),this._layers.push({layer:e,name:t,overlay:n}),this.options.sortLayers&&this._layers.sort(r((function(e,t){return this.options.sortFunction(e.layer,t.layer,e.name,t.name)}),this)),this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ft(this._baseLayersList),ft(this._overlaysList),this._layerControlInputs=[];var e,t,n,i,r=0;for(n=0;n<this._layers.length;n++)i=this._layers[n],this._addItem(i),t=t||i.overlay,e=e||!i.overlay,r+=i.overlay?0:1;return this.options.hideSingleBase&&(e=e&&r>1,this._baseLayersList.style.display=e?"":"none"),this._separator.style.display=t&&e?"":"none",this},_onLayerChange:function(e){this._handlingClick||this._update();var t=this._getLayer(o(e.target)),n=t.overlay?"add"===e.type?"overlayadd":"overlayremove":"add"===e.type?"baselayerchange":null;n&&this._map.fire(n,t)},_createRadioElement:function(e,t){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"'+(t?' checked="checked"':"")+"/>",i=document.createElement("div");return i.innerHTML=n,i.firstChild},_addItem:function(e){var t,n=document.createElement("label"),i=this._map.hasLayer(e.layer);e.overlay?((t=document.createElement("input")).type="checkbox",t.className="leaflet-control-layers-selector",t.defaultChecked=i):t=this._createRadioElement("leaflet-base-layers_"+o(this),i),this._layerControlInputs.push(t),t.layerId=o(e.layer),Nt(t,"click",this._onInputClick,this);var r=document.createElement("span");r.innerHTML=" "+e.name;var s=document.createElement("span");return n.appendChild(s),s.appendChild(t),s.appendChild(r),(e.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){if(!this._preventClick){var e,t,n=this._layerControlInputs,i=[],r=[];this._handlingClick=!0;for(var s=n.length-1;s>=0;s--)e=n[s],t=this._getLayer(e.layerId).layer,e.checked?i.push(t):e.checked||r.push(t);for(s=0;s<r.length;s++)this._map.hasLayer(r[s])&&this._map.removeLayer(r[s]);for(s=0;s<i.length;s++)this._map.hasLayer(i[s])||this._map.addLayer(i[s]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var e,t,n=this._layerControlInputs,i=this._map.getZoom(),r=n.length-1;r>=0;r--)e=n[r],t=this._getLayer(e.layerId).layer,e.disabled=void 0!==t.options.minZoom&&i<t.options.minZoom||void 0!==t.options.maxZoom&&i>t.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var e=this._section;this._preventClick=!0,Nt(e,"click",Xt),this.expand();var t=this;setTimeout((function(){zt(e,"click",Xt),t._preventClick=!1}))}}),ln=function(e,t,n){return new an(e,t,n)},cn=sn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(e){var t="leaflet-control-zoom",n=pt("div",t+" leaflet-bar"),i=this.options;return this._zoomInButton=this._createButton(i.zoomInText,i.zoomInTitle,t+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(i.zoomOutText,i.zoomOutTitle,t+"-out",n,this._zoomOut),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(e){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(e.shiftKey?3:1))},_zoomOut:function(e){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(e.shiftKey?3:1))},_createButton:function(e,t,n,i,r){var s=pt("a",n,i);return s.innerHTML=e,s.href="#",s.title=t,s.setAttribute("role","button"),s.setAttribute("aria-label",t),qt(s),Nt(s,"click",Kt),Nt(s,"click",r,this),Nt(s,"click",this._refocusOnMap,this),s},_updateDisabled:function(){var e=this._map,t="leaflet-disabled";wt(this._zoomInButton,t),wt(this._zoomOutButton,t),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||e._zoom===e.getMinZoom())&&(Ct(this._zoomOutButton,t),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||e._zoom===e.getMaxZoom())&&(Ct(this._zoomInButton,t),this._zoomInButton.setAttribute("aria-disabled","true"))}});nn.mergeOptions({zoomControl:!0}),nn.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new cn,this.addControl(this.zoomControl))}));var un=function(e){return new cn(e)},hn=sn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(e){var t="leaflet-control-scale",n=pt("div",t),i=this.options;return this._addScales(i,t+"-line",n),e.on(i.updateWhenIdle?"moveend":"move",this._update,this),e.whenReady(this._update,this),n},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,t,n){e.metric&&(this._mScale=pt("div",t,n)),e.imperial&&(this._iScale=pt("div",t,n))},_update:function(){var e=this._map,t=e.getSize().y/2,n=e.distance(e.containerPointToLatLng([0,t]),e.containerPointToLatLng([this.options.maxWidth,t]));this._updateScales(n)},_updateScales:function(e){this.options.metric&&e&&this._updateMetric(e),this.options.imperial&&e&&this._updateImperial(e)},_updateMetric:function(e){var t=this._getRoundNum(e),n=t<1e3?t+" m":t/1e3+" km";this._updateScale(this._mScale,n,t/e)},_updateImperial:function(e){var t,n,i,r=3.2808399*e;r>5280?(t=r/5280,n=this._getRoundNum(t),this._updateScale(this._iScale,n+" mi",n/t)):(i=this._getRoundNum(r),this._updateScale(this._iScale,i+" ft",i/r))},_updateScale:function(e,t,n){e.style.width=Math.round(this.options.maxWidth*n)+"px",e.innerHTML=t},_getRoundNum:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),n=e/t;return t*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),dn=function(e){return new hn(e)},pn='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',gn=sn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Oe.inlineSvg?pn+" ":"")+"Leaflet</a>"},initialize:function(e){p(this,e),this._attributions={}},onAdd:function(e){for(var t in e.attributionControl=this,this._container=pt("div","leaflet-control-attribution"),qt(this._container),e._layers)e._layers[t].getAttribution&&this.addAttribution(e._layers[t].getAttribution());return this._update(),e.on("layeradd",this._addAttribution,this),this._container},onRemove:function(e){e.off("layeradd",this._addAttribution,this)},_addAttribution:function(e){e.layer.getAttribution&&(this.addAttribution(e.layer.getAttribution()),e.layer.once("remove",(function(){this.removeAttribution(e.layer.getAttribution())}),this))},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):this},removeAttribution:function(e){return e?(this._attributions[e]&&(this._attributions[e]--,this._update()),this):this},_update:function(){if(this._map){var e=[];for(var t in this._attributions)this._attributions[t]&&e.push(t);var n=[];this.options.prefix&&n.push(this.options.prefix),e.length&&n.push(e.join(", ")),this._container.innerHTML=n.join(' <span aria-hidden="true">|</span> ')}}});nn.mergeOptions({attributionControl:!0}),nn.addInitHook((function(){this.options.attributionControl&&(new gn).addTo(this)}));var fn=function(e){return new gn(e)};sn.Layers=an,sn.Zoom=cn,sn.Scale=hn,sn.Attribution=gn,on.layers=ln,on.zoom=un,on.scale=dn,on.attribution=fn;var mn=T.extend({initialize:function(e){this._map=e},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});mn.addTo=function(e,t){return e.addHandler(t,this),this};var vn={Events:A},yn=Oe.touch?"touchstart mousedown":"mousedown",Cn=F.extend({options:{clickTolerance:3},initialize:function(e,t,n,i){p(this,i),this._element=e,this._dragStartTarget=t||e,this._preventOutline=n},enable:function(){this._enabled||(Nt(this._dragStartTarget,yn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Cn._dragging===this&&this.finishDrag(!0),zt(this._dragStartTarget,yn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(e){if(this._enabled&&(this._moved=!1,!yt(this._element,"leaflet-zoom-anim")))if(e.touches&&1!==e.touches.length)Cn._dragging===this&&this.finishDrag();else if(!(Cn._dragging||e.shiftKey||1!==e.which&&1!==e.button&&!e.touches)&&(Cn._dragging=this,this._preventOutline&&Dt(this._element),At(),it(),!this._moving)){this.fire("down");var t=e.touches?e.touches[0]:e,n=It(this._element);this._startPoint=new D(t.clientX,t.clientY),this._startPos=Tt(this._element),this._parentScale=kt(n);var i="mousedown"===e.type;Nt(document,i?"mousemove":"touchmove",this._onMove,this),Nt(document,i?"mouseup":"touchend touchcancel",this._onUp,this)}},_onMove:function(e){if(this._enabled)if(e.touches&&e.touches.length>1)this._moved=!0;else{var t=e.touches&&1===e.touches.length?e.touches[0]:e,n=new D(t.clientX,t.clientY)._subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(n.x/=this._parentScale.x,n.y/=this._parentScale.y,Xt(e),this._moved||(this.fire("dragstart"),this._moved=!0,Ct(document.body,"leaflet-dragging"),this._lastTarget=e.target||e.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ct(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,this._lastEvent=e,this._updatePosition()))}},_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire("predrag",e),Rt(this._element,this._newPos),this.fire("drag",e)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(e){wt(document.body,"leaflet-dragging"),this._lastTarget&&(wt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),zt(document,"mousemove touchmove",this._onMove,this),zt(document,"mouseup touchend touchcancel",this._onUp,this),Ft(),rt();var t=this._moved&&this._moving;this._moving=!1,Cn._dragging=!1,t&&this.fire("dragend",{noInertia:e,distance:this._newPos.distanceTo(this._startPos)})}});function wn(e,t,n){var i,r,s,o,a,l,c,u,h,d=[1,4,2,8];for(r=0,c=e.length;r<c;r++)e[r]._code=Ln(e[r],t);for(o=0;o<4;o++){for(u=d[o],i=[],r=0,s=(c=e.length)-1;r<c;s=r++)a=e[r],l=e[s],a._code&u?l._code&u||((h=Dn(l,a,u,t,n))._code=Ln(h,t),i.push(h)):(l._code&u&&((h=Dn(l,a,u,t,n))._code=Ln(h,t),i.push(h)),i.push(a));e=i}return e}function Sn(e,t){var n,i,r,s,o,a,l,c,u;if(!e||0===e.length)throw new Error("latlngs not passed");On(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var h=G([0,0]),d=z(e);d.getNorthWest().distanceTo(d.getSouthWest())*d.getNorthEast().distanceTo(d.getNorthWest())<1700&&(h=bn(e));var p=e.length,g=[];for(n=0;n<p;n++){var f=G(e[n]);g.push(t.project(G([f.lat-h.lat,f.lng-h.lng])))}for(a=l=c=0,n=0,i=p-1;n<p;i=n++)r=g[n],s=g[i],o=r.y*s.x-s.y*r.x,l+=(r.x+s.x)*o,c+=(r.y+s.y)*o,a+=3*o;u=0===a?g[0]:[l/a,c/a];var m=t.unproject(k(u));return G([m.lat+h.lat,m.lng+h.lng])}function bn(e){for(var t=0,n=0,i=0,r=0;r<e.length;r++){var s=G(e[r]);t+=s.lat,n+=s.lng,i++}return G([t/i,n/i])}var xn,_n={__proto__:null,clipPolygon:wn,polygonCenter:Sn,centroid:bn};function Mn(e,t){if(!t||!e.length)return e.slice();var n=t*t;return e=Tn(e=An(e,n),n)}function En(e,t,n){return Math.sqrt(kn(e,t,n,!0))}function Rn(e,t,n){return kn(e,t,n)}function Tn(e,t){var n=e.length,i=new(typeof Uint8Array!==void 0+""?Uint8Array:Array)(n);i[0]=i[n-1]=1,Pn(e,i,t,0,n-1);var r,s=[];for(r=0;r<n;r++)i[r]&&s.push(e[r]);return s}function Pn(e,t,n,i,r){var s,o,a,l=0;for(o=i+1;o<=r-1;o++)(a=kn(e[o],e[i],e[r],!0))>l&&(s=o,l=a);l>n&&(t[s]=1,Pn(e,t,n,i,s),Pn(e,t,n,s,r))}function An(e,t){for(var n=[e[0]],i=1,r=0,s=e.length;i<s;i++)In(e[i],e[r])>t&&(n.push(e[i]),r=i);return r<s-1&&n.push(e[s-1]),n}function Fn(e,t,n,i,r){var s,o,a,l=i?xn:Ln(e,n),c=Ln(t,n);for(xn=c;;){if(!(l|c))return[e,t];if(l&c)return!1;a=Ln(o=Dn(e,t,s=l||c,n,r),n),s===l?(e=o,l=a):(t=o,c=a)}}function Dn(e,t,n,i,r){var s,o,a=t.x-e.x,l=t.y-e.y,c=i.min,u=i.max;return 8&n?(s=e.x+a*(u.y-e.y)/l,o=u.y):4&n?(s=e.x+a*(c.y-e.y)/l,o=c.y):2&n?(s=u.x,o=e.y+l*(u.x-e.x)/a):1&n&&(s=c.x,o=e.y+l*(c.x-e.x)/a),new D(s,o,r)}function Ln(e,t){var n=0;return e.x<t.min.x?n|=1:e.x>t.max.x&&(n|=2),e.y<t.min.y?n|=4:e.y>t.max.y&&(n|=8),n}function In(e,t){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i}function kn(e,t,n,i){var r,s=t.x,o=t.y,a=n.x-s,l=n.y-o,c=a*a+l*l;return c>0&&((r=((e.x-s)*a+(e.y-o)*l)/c)>1?(s=n.x,o=n.y):r>0&&(s+=a*r,o+=l*r)),a=e.x-s,l=e.y-o,i?a*a+l*l:new D(s,o)}function On(e){return!v(e[0])||"object"!==typeof e[0][0]&&"undefined"!==typeof e[0][0]}function Nn(e){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),On(e)}function Bn(e,t){var n,i,r,s,o,a,l,c;if(!e||0===e.length)throw new Error("latlngs not passed");On(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var u=G([0,0]),h=z(e);h.getNorthWest().distanceTo(h.getSouthWest())*h.getNorthEast().distanceTo(h.getNorthWest())<1700&&(u=bn(e));var d=e.length,p=[];for(n=0;n<d;n++){var g=G(e[n]);p.push(t.project(G([g.lat-u.lat,g.lng-u.lng])))}for(n=0,i=0;n<d-1;n++)i+=p[n].distanceTo(p[n+1])/2;if(0===i)c=p[0];else for(n=0,s=0;n<d-1;n++)if(o=p[n],a=p[n+1],(s+=r=o.distanceTo(a))>i){l=(s-i)/r,c=[a.x-l*(a.x-o.x),a.y-l*(a.y-o.y)];break}var f=t.unproject(k(c));return G([f.lat+u.lat,f.lng+u.lng])}var zn={__proto__:null,simplify:Mn,pointToSegmentDistance:En,closestPointOnSegment:Rn,clipSegment:Fn,_getEdgeIntersection:Dn,_getBitCode:Ln,_sqClosestPointOnSegment:kn,isFlat:On,_flat:Nn,polylineCenter:Bn},Hn={project:function(e){return new D(e.lng,e.lat)},unproject:function(e){return new H(e.y,e.x)},bounds:new O([-180,-90],[180,90])},Gn={R:6378137,R_MINOR:6356752.314245179,bounds:new O([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(e){var t=Math.PI/180,n=this.R,i=e.lat*t,r=this.R_MINOR/n,s=Math.sqrt(1-r*r),o=s*Math.sin(i),a=Math.tan(Math.PI/4-i/2)/Math.pow((1-o)/(1+o),s/2);return i=-n*Math.log(Math.max(a,1e-10)),new D(e.lng*t*n,i)},unproject:function(e){for(var t,n=180/Math.PI,i=this.R,r=this.R_MINOR/i,s=Math.sqrt(1-r*r),o=Math.exp(-e.y/i),a=Math.PI/2-2*Math.atan(o),l=0,c=.1;l<15&&Math.abs(c)>1e-7;l++)t=s*Math.sin(a),t=Math.pow((1-t)/(1+t),s/2),a+=c=Math.PI/2-2*Math.atan(o*t)-a;return new H(a*n,e.x*n/i)}},Un={__proto__:null,LonLat:Hn,Mercator:Gn,SphericalMercator:j},Vn=n({},V,{code:"EPSG:3395",projection:Gn,transformation:function(){var e=.5/(Math.PI*Gn.R);return X(e,.5,-e,.5)}()}),Wn=n({},V,{code:"EPSG:4326",projection:Hn,transformation:X(1/180,1,-1/180,.5)}),jn=n({},U,{projection:Hn,transformation:X(1,0,-1,0),scale:function(e){return Math.pow(2,e)},zoom:function(e){return Math.log(e)/Math.LN2},distance:function(e,t){var n=t.lng-e.lng,i=t.lat-e.lat;return Math.sqrt(n*n+i*i)},infinite:!0});U.Earth=V,U.EPSG3395=Vn,U.EPSG3857=K,U.EPSG900913=$,U.EPSG4326=Wn,U.Simple=jn;var qn=F.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(e){return e.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(e){return e&&e.removeLayer(this),this},getPane:function(e){return this._map.getPane(e?this.options[e]||e:this.options.pane)},addInteractiveTarget:function(e){return this._map._targets[o(e)]=this,this},removeInteractiveTarget:function(e){return delete this._map._targets[o(e)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(e){var t=e.target;if(t.hasLayer(this)){if(this._map=t,this._zoomAnimated=t._zoomAnimated,this.getEvents){var n=this.getEvents();t.on(n,this),this.once("remove",(function(){t.off(n,this)}),this)}this.onAdd(t),this.fire("add"),t.fire("layeradd",{layer:this})}}});nn.include({addLayer:function(e){if(!e._layerAdd)throw new Error("The provided object is not a Layer.");var t=o(e);return this._layers[t]||(this._layers[t]=e,e._mapToAdd=this,e.beforeAdd&&e.beforeAdd(this),this.whenReady(e._layerAdd,e)),this},removeLayer:function(e){var t=o(e);return this._layers[t]?(this._loaded&&e.onRemove(this),delete this._layers[t],this._loaded&&(this.fire("layerremove",{layer:e}),e.fire("remove")),e._map=e._mapToAdd=null,this):this},hasLayer:function(e){return o(e)in this._layers},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},_addLayers:function(e){for(var t=0,n=(e=e?v(e)?e:[e]:[]).length;t<n;t++)this.addLayer(e[t])},_addZoomLimit:function(e){isNaN(e.options.maxZoom)&&isNaN(e.options.minZoom)||(this._zoomBoundLayers[o(e)]=e,this._updateZoomLevels())},_removeZoomLimit:function(e){var t=o(e);this._zoomBoundLayers[t]&&(delete this._zoomBoundLayers[t],this._updateZoomLevels())},_updateZoomLevels:function(){var e=1/0,t=-1/0,n=this._getZoomSpan();for(var i in this._zoomBoundLayers){var r=this._zoomBoundLayers[i].options;e=void 0===r.minZoom?e:Math.min(e,r.minZoom),t=void 0===r.maxZoom?t:Math.max(t,r.maxZoom)}this._layersMaxZoom=t===-1/0?void 0:t,this._layersMinZoom=e===1/0?void 0:e,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Xn=qn.extend({initialize:function(e,t){var n,i;if(p(this,t),this._layers={},e)for(n=0,i=e.length;n<i;n++)this.addLayer(e[n])},addLayer:function(e){var t=this.getLayerId(e);return this._layers[t]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var t=e in this._layers?e:this.getLayerId(e);return this._map&&this._layers[t]&&this._map.removeLayer(this._layers[t]),delete this._layers[t],this},hasLayer:function(e){return("number"===typeof e?e:this.getLayerId(e))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(e){var t,n,i=Array.prototype.slice.call(arguments,1);for(t in this._layers)(n=this._layers[t])[e]&&n[e].apply(n,i);return this},onAdd:function(e){this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e)},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];return this.eachLayer(e.push,e),e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return o(e)}}),Kn=function(e,t){return new Xn(e,t)},$n=Xn.extend({addLayer:function(e){return this.hasLayer(e)?this:(e.addEventParent(this),Xn.prototype.addLayer.call(this,e),this.fire("layeradd",{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),e.removeEventParent(this),Xn.prototype.removeLayer.call(this,e),this.fire("layerremove",{layer:e})):this},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new B;for(var t in this._layers){var n=this._layers[t];e.extend(n.getBounds?n.getBounds():n.getLatLng())}return e}}),Zn=function(e,t){return new $n(e,t)},Yn=T.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(e){p(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,t){var n=this._getIconUrl(e);if(!n){if("icon"===e)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i=this._createImg(n,t&&"IMG"===t.tagName?t:null);return this._setIconStyles(i,e),(this.options.crossOrigin||""===this.options.crossOrigin)&&(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),i},_setIconStyles:function(e,t){var n=this.options,i=n[t+"Size"];"number"===typeof i&&(i=[i,i]);var r=k(i),s=k("shadow"===t&&n.shadowAnchor||n.iconAnchor||r&&r.divideBy(2,!0));e.className="leaflet-marker-"+t+" "+(n.className||""),s&&(e.style.marginLeft=-s.x+"px",e.style.marginTop=-s.y+"px"),r&&(e.style.width=r.x+"px",e.style.height=r.y+"px")},_createImg:function(e,t){return(t=t||document.createElement("img")).src=e,t},_getIconUrl:function(e){return Oe.retina&&this.options[e+"RetinaUrl"]||this.options[e+"Url"]}});function Jn(e){return new Yn(e)}var Qn=Yn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(e){return"string"!==typeof Qn.imagePath&&(Qn.imagePath=this._detectIconPath()),(this.options.imagePath||Qn.imagePath)+Yn.prototype._getIconUrl.call(this,e)},_stripUrl:function(e){var t=function(e,t,n){var i=t.exec(e);return i&&i[n]};return(e=t(e,/^url\((['"])?(.+)\1\)$/,2))&&t(e,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var e=pt("div","leaflet-default-icon-path",document.body),t=dt(e,"background-image")||dt(e,"backgroundImage");if(document.body.removeChild(e),t=this._stripUrl(t))return t;var n=document.querySelector('link[href$="leaflet.css"]');return n?n.href.substring(0,n.href.length-11-1):""}}),ei=mn.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new Cn(e,e,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ct(e,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&wt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(e){var t=this._marker,n=t._map,i=this._marker.options.autoPanSpeed,r=this._marker.options.autoPanPadding,s=Tt(t._icon),o=n.getPixelBounds(),a=n.getPixelOrigin(),l=N(o.min._subtract(a).add(r),o.max._subtract(a).subtract(r));if(!l.contains(s)){var c=k((Math.max(l.max.x,s.x)-l.max.x)/(o.max.x-l.max.x)-(Math.min(l.min.x,s.x)-l.min.x)/(o.min.x-l.min.x),(Math.max(l.max.y,s.y)-l.max.y)/(o.max.y-l.max.y)-(Math.min(l.min.y,s.y)-l.min.y)/(o.min.y-l.min.y)).multiplyBy(i);n.panBy(c,{animate:!1}),this._draggable._newPos._add(c),this._draggable._startPos._add(c),Rt(t._icon,this._draggable._newPos),this._onDrag(e),this._panRequest=M(this._adjustPan.bind(this,e))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(e){this._marker.options.autoPan&&(E(this._panRequest),this._panRequest=M(this._adjustPan.bind(this,e)))},_onDrag:function(e){var t=this._marker,n=t._shadow,i=Tt(t._icon),r=t._map.layerPointToLatLng(i);n&&Rt(n,i),t._latlng=r,e.latlng=r,e.oldLatLng=this._oldLatLng,t.fire("move",e).fire("drag",e)},_onDragEnd:function(e){E(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",e)}}),ti=qn.extend({options:{icon:new Qn,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(e,t){p(this,t),this._latlng=G(e)},onAdd:function(e){this._zoomAnimated=this._zoomAnimated&&e.options.markerZoomAnimation,this._zoomAnimated&&e.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(e){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&e.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(e){var t=this._latlng;return this._latlng=G(e),this.update(),this.fire("move",{oldLatLng:t,latlng:this._latlng})},setZIndexOffset:function(e){return this.options.zIndexOffset=e,this.update()},getIcon:function(){return this.options.icon},setIcon:function(e){return this.options.icon=e,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}return this},_initIcon:function(){var e=this.options,t="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=e.icon.createIcon(this._icon),i=!1;n!==this._icon&&(this._icon&&this._removeIcon(),i=!0,e.title&&(n.title=e.title),"IMG"===n.tagName&&(n.alt=e.alt||"")),Ct(n,t),e.keyboard&&(n.tabIndex="0",n.setAttribute("role","button")),this._icon=n,e.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Nt(n,"focus",this._panOnFocus,this);var r=e.icon.createShadow(this._shadow),s=!1;r!==this._shadow&&(this._removeShadow(),s=!0),r&&(Ct(r,t),r.alt=""),this._shadow=r,e.opacity<1&&this._updateOpacity(),i&&this.getPane().appendChild(this._icon),this._initInteraction(),r&&s&&this.getPane(e.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&zt(this._icon,"focus",this._panOnFocus,this),gt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&gt(this._shadow),this._shadow=null},_setPos:function(e){this._icon&&Rt(this._icon,e),this._shadow&&Rt(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(e){this._icon&&(this._icon.style.zIndex=this._zIndex+e)},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(t)},_initInteraction:function(){if(this.options.interactive&&(Ct(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ei)){var e=this.options.draggable;this.dragging&&(e=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ei(this),e&&this.dragging.enable()}},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var e=this.options.opacity;this._icon&&xt(this._icon,e),this._shadow&&xt(this._shadow,e)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var e=this._map;if(e){var t=this.options.icon.options,n=t.iconSize?k(t.iconSize):k(0,0),i=t.iconAnchor?k(t.iconAnchor):k(0,0);e.panInside(this._latlng,{paddingTopLeft:i,paddingBottomRight:n.subtract(i)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ni(e,t){return new ti(e,t)}var ii=qn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(e){this._renderer=e.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(e){return p(this,e),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&e&&Object.prototype.hasOwnProperty.call(e,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ri=ii.extend({options:{fill:!0,radius:10},initialize:function(e,t){p(this,t),this._latlng=G(e),this._radius=this.options.radius},setLatLng:function(e){var t=this._latlng;return this._latlng=G(e),this.redraw(),this.fire("move",{oldLatLng:t,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(e){return this.options.radius=this._radius=e,this.redraw()},getRadius:function(){return this._radius},setStyle:function(e){var t=e&&e.radius||this._radius;return ii.prototype.setStyle.call(this,e),this.setRadius(t),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var e=this._radius,t=this._radiusY||e,n=this._clickTolerance(),i=[e+n,t+n];this._pxBounds=new O(this._point.subtract(i),this._point.add(i))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(e){return e.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function si(e,t){return new ri(e,t)}var oi=ri.extend({initialize:function(e,t,i){if("number"===typeof t&&(t=n({},i,{radius:t})),p(this,t),this._latlng=G(e),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(e){return this._mRadius=e,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var e=[this._radius,this._radiusY||this._radius];return new B(this._map.layerPointToLatLng(this._point.subtract(e)),this._map.layerPointToLatLng(this._point.add(e)))},setStyle:ii.prototype.setStyle,_project:function(){var e=this._latlng.lng,t=this._latlng.lat,n=this._map,i=n.options.crs;if(i.distance===V.distance){var r=Math.PI/180,s=this._mRadius/V.R/r,o=n.project([t+s,e]),a=n.project([t-s,e]),l=o.add(a).divideBy(2),c=n.unproject(l).lat,u=Math.acos((Math.cos(s*r)-Math.sin(t*r)*Math.sin(c*r))/(Math.cos(t*r)*Math.cos(c*r)))/r;(isNaN(u)||0===u)&&(u=s/Math.cos(Math.PI/180*t)),this._point=l.subtract(n.getPixelOrigin()),this._radius=isNaN(u)?0:l.x-n.project([c,e-u]).x,this._radiusY=l.y-o.y}else{var h=i.unproject(i.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(h).x}this._updateBounds()}});function ai(e,t,n){return new oi(e,t,n)}var li=ii.extend({options:{smoothFactor:1,noClip:!1},initialize:function(e,t){p(this,t),this._setLatLngs(e)},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._setLatLngs(e),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(e){for(var t,n,i=1/0,r=null,s=kn,o=0,a=this._parts.length;o<a;o++)for(var l=this._parts[o],c=1,u=l.length;c<u;c++){var h=s(e,t=l[c-1],n=l[c],!0);h<i&&(i=h,r=s(e,t,n))}return r&&(r.distance=Math.sqrt(i)),r},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Bn(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(e,t){return t=t||this._defaultShape(),e=G(e),t.push(e),this._bounds.extend(e),this.redraw()},_setLatLngs:function(e){this._bounds=new B,this._latlngs=this._convertLatLngs(e)},_defaultShape:function(){return On(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(e){for(var t=[],n=On(e),i=0,r=e.length;i<r;i++)n?(t[i]=G(e[i]),this._bounds.extend(t[i])):t[i]=this._convertLatLngs(e[i]);return t},_project:function(){var e=new O;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,e),this._bounds.isValid()&&e.isValid()&&(this._rawPxBounds=e,this._updateBounds())},_updateBounds:function(){var e=this._clickTolerance(),t=new D(e,e);this._rawPxBounds&&(this._pxBounds=new O([this._rawPxBounds.min.subtract(t),this._rawPxBounds.max.add(t)]))},_projectLatlngs:function(e,t,n){var i,r,s=e[0]instanceof H,o=e.length;if(s){for(r=[],i=0;i<o;i++)r[i]=this._map.latLngToLayerPoint(e[i]),n.extend(r[i]);t.push(r)}else for(i=0;i<o;i++)this._projectLatlngs(e[i],t,n)},_clipPoints:function(){var e=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(e))if(this.options.noClip)this._parts=this._rings;else{var t,n,i,r,s,o,a,l=this._parts;for(t=0,i=0,r=this._rings.length;t<r;t++)for(n=0,s=(a=this._rings[t]).length;n<s-1;n++)(o=Fn(a[n],a[n+1],e,n,!0))&&(l[i]=l[i]||[],l[i].push(o[0]),o[1]===a[n+1]&&n!==s-2||(l[i].push(o[1]),i++))}},_simplifyPoints:function(){for(var e=this._parts,t=this.options.smoothFactor,n=0,i=e.length;n<i;n++)e[n]=Mn(e[n],t)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(e,t){var n,i,r,s,o,a,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(n=0,s=this._parts.length;n<s;n++)for(i=0,r=(o=(a=this._parts[n]).length)-1;i<o;r=i++)if((t||0!==i)&&En(e,a[r],a[i])<=l)return!0;return!1}});function ci(e,t){return new li(e,t)}li._flat=Nn;var ui=li.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Sn(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(e){var t=li.prototype._convertLatLngs.call(this,e),n=t.length;return n>=2&&t[0]instanceof H&&t[0].equals(t[n-1])&&t.pop(),t},_setLatLngs:function(e){li.prototype._setLatLngs.call(this,e),On(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return On(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var e=this._renderer._bounds,t=this.options.weight,n=new D(t,t);if(e=new O(e.min.subtract(n),e.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(e))if(this.options.noClip)this._parts=this._rings;else for(var i,r=0,s=this._rings.length;r<s;r++)(i=wn(this._rings[r],e,!0)).length&&this._parts.push(i)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(e){var t,n,i,r,s,o,a,l,c=!1;if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(r=0,a=this._parts.length;r<a;r++)for(s=0,o=(l=(t=this._parts[r]).length)-1;s<l;o=s++)n=t[s],i=t[o],n.y>e.y!==i.y>e.y&&e.x<(i.x-n.x)*(e.y-n.y)/(i.y-n.y)+n.x&&(c=!c);return c||li.prototype._containsPoint.call(this,e,!0)}});function hi(e,t){return new ui(e,t)}var di=$n.extend({initialize:function(e,t){p(this,t),this._layers={},e&&this.addData(e)},addData:function(e){var t,n,i,r=v(e)?e:e.features;if(r){for(t=0,n=r.length;t<n;t++)((i=r[t]).geometries||i.geometry||i.features||i.coordinates)&&this.addData(i);return this}var s=this.options;if(s.filter&&!s.filter(e))return this;var o=pi(e,s);return o?(o.feature=wi(e),o.defaultOptions=o.options,this.resetStyle(o),s.onEachFeature&&s.onEachFeature(e,o),this.addLayer(o)):this},resetStyle:function(e){return void 0===e?this.eachLayer(this.resetStyle,this):(e.options=n({},e.defaultOptions),this._setLayerStyle(e,this.options.style),this)},setStyle:function(e){return this.eachLayer((function(t){this._setLayerStyle(t,e)}),this)},_setLayerStyle:function(e,t){e.setStyle&&("function"===typeof t&&(t=t(e.feature)),e.setStyle(t))}});function pi(e,t){var n,i,r,s,o="Feature"===e.type?e.geometry:e,a=o?o.coordinates:null,l=[],c=t&&t.pointToLayer,u=t&&t.coordsToLatLng||fi;if(!a&&!o)return null;switch(o.type){case"Point":return gi(c,e,n=u(a),t);case"MultiPoint":for(r=0,s=a.length;r<s;r++)n=u(a[r]),l.push(gi(c,e,n,t));return new $n(l);case"LineString":case"MultiLineString":return i=mi(a,"LineString"===o.type?0:1,u),new li(i,t);case"Polygon":case"MultiPolygon":return i=mi(a,"Polygon"===o.type?1:2,u),new ui(i,t);case"GeometryCollection":for(r=0,s=o.geometries.length;r<s;r++){var h=pi({geometry:o.geometries[r],type:"Feature",properties:e.properties},t);h&&l.push(h)}return new $n(l);case"FeatureCollection":for(r=0,s=o.features.length;r<s;r++){var d=pi(o.features[r],t);d&&l.push(d)}return new $n(l);default:throw new Error("Invalid GeoJSON object.")}}function gi(e,t,n,i){return e?e(t,n):new ti(n,i&&i.markersInheritOptions&&i)}function fi(e){return new H(e[1],e[0],e[2])}function mi(e,t,n){for(var i,r=[],s=0,o=e.length;s<o;s++)i=t?mi(e[s],t-1,n):(n||fi)(e[s]),r.push(i);return r}function vi(e,t){return void 0!==(e=G(e)).alt?[u(e.lng,t),u(e.lat,t),u(e.alt,t)]:[u(e.lng,t),u(e.lat,t)]}function yi(e,t,n,i){for(var r=[],s=0,o=e.length;s<o;s++)r.push(t?yi(e[s],On(e[s])?0:t-1,n,i):vi(e[s],i));return!t&&n&&r.length>0&&r.push(r[0].slice()),r}function Ci(e,t){return e.feature?n({},e.feature,{geometry:t}):wi(t)}function wi(e){return"Feature"===e.type||"FeatureCollection"===e.type?e:{type:"Feature",properties:{},geometry:e}}var Si={toGeoJSON:function(e){return Ci(this,{type:"Point",coordinates:vi(this.getLatLng(),e)})}};function bi(e,t){return new di(e,t)}ti.include(Si),oi.include(Si),ri.include(Si),li.include({toGeoJSON:function(e){var t=!On(this._latlngs);return Ci(this,{type:(t?"Multi":"")+"LineString",coordinates:yi(this._latlngs,t?1:0,!1,e)})}}),ui.include({toGeoJSON:function(e){var t=!On(this._latlngs),n=t&&!On(this._latlngs[0]),i=yi(this._latlngs,n?2:t?1:0,!0,e);return t||(i=[i]),Ci(this,{type:(n?"Multi":"")+"Polygon",coordinates:i})}}),Xn.include({toMultiPoint:function(e){var t=[];return this.eachLayer((function(n){t.push(n.toGeoJSON(e).geometry.coordinates)})),Ci(this,{type:"MultiPoint",coordinates:t})},toGeoJSON:function(e){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint(e);var n="GeometryCollection"===t,i=[];return this.eachLayer((function(t){if(t.toGeoJSON){var r=t.toGeoJSON(e);if(n)i.push(r.geometry);else{var s=wi(r);"FeatureCollection"===s.type?i.push.apply(i,s.features):i.push(s)}}})),n?Ci(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}});var xi=bi,_i=qn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(e,t,n){this._url=e,this._bounds=z(t),p(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ct(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){gt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(e){return this.options.opacity=e,this._image&&this._updateOpacity(),this},setStyle:function(e){return e.opacity&&this.setOpacity(e.opacity),this},bringToFront:function(){return this._map&&mt(this._image),this},bringToBack:function(){return this._map&&vt(this._image),this},setUrl:function(e){return this._url=e,this._image&&(this._image.src=e),this},setBounds:function(e){return this._bounds=z(e),this._map&&this._reset(),this},getEvents:function(){var e={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var e="IMG"===this._url.tagName,t=this._image=e?this._url:pt("img");Ct(t,"leaflet-image-layer"),this._zoomAnimated&&Ct(t,"leaflet-zoom-animated"),this.options.className&&Ct(t,this.options.className),t.onselectstart=c,t.onmousemove=c,t.onload=r(this.fire,this,"load"),t.onerror=r(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(t.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),e?this._url=t.src:(t.src=this._url,t.alt=this.options.alt)},_animateZoom:function(e){var t=this._map.getZoomScale(e.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,e.zoom,e.center).min;Et(this._image,n,t)},_reset:function(){var e=this._image,t=new O(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=t.getSize();Rt(e,t.min),e.style.width=n.x+"px",e.style.height=n.y+"px"},_updateOpacity:function(){xt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var e=this.options.errorOverlayUrl;e&&this._url!==e&&(this._url=e,this._image.src=e)},getCenter:function(){return this._bounds.getCenter()}}),Mi=function(e,t,n){return new _i(e,t,n)},Ei=_i.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var e="VIDEO"===this._url.tagName,t=this._image=e?this._url:pt("video");if(Ct(t,"leaflet-image-layer"),this._zoomAnimated&&Ct(t,"leaflet-zoom-animated"),this.options.className&&Ct(t,this.options.className),t.onselectstart=c,t.onmousemove=c,t.onloadeddata=r(this.fire,this,"load"),e){for(var n=t.getElementsByTagName("source"),i=[],s=0;s<n.length;s++)i.push(n[s].src);this._url=n.length>0?i:[t.src]}else{v(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(t.style,"objectFit")&&(t.style.objectFit="fill"),t.autoplay=!!this.options.autoplay,t.loop=!!this.options.loop,t.muted=!!this.options.muted,t.playsInline=!!this.options.playsInline;for(var o=0;o<this._url.length;o++){var a=pt("source");a.src=this._url[o],t.appendChild(a)}}}});function Ri(e,t,n){return new Ei(e,t,n)}var Ti=_i.extend({_initImage:function(){var e=this._image=this._url;Ct(e,"leaflet-image-layer"),this._zoomAnimated&&Ct(e,"leaflet-zoom-animated"),this.options.className&&Ct(e,this.options.className),e.onselectstart=c,e.onmousemove=c}});function Pi(e,t,n){return new Ti(e,t,n)}var Ai=qn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(e,t){e&&(e instanceof H||v(e))?(this._latlng=G(e),p(this,t)):(p(this,e),this._source=t),this.options.content&&(this._content=this.options.content)},openOn:function(e){return(e=arguments.length?e:this._source._map).hasLayer(this)||e.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(e){return this._map?this.close():(arguments.length?this._source=e:e=this._source,this._prepareOpen(),this.openOn(e._map)),this},onAdd:function(e){this._zoomAnimated=e._zoomAnimated,this._container||this._initLayout(),e._fadeAnimated&&xt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),e._fadeAnimated&&xt(this._container,1),this.bringToFront(),this.options.interactive&&(Ct(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(e){e._fadeAnimated?(xt(this._container,0),this._removeTimeout=setTimeout(r(gt,void 0,this._container),200)):gt(this._container),this.options.interactive&&(wt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=G(e),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(e){return this._content=e,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var e={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&mt(this._container),this},bringToBack:function(){return this._map&&vt(this._container),this},_prepareOpen:function(e){var t=this._source;if(!t._map)return!1;if(t instanceof $n){t=null;var n=this._source._layers;for(var i in n)if(n[i]._map){t=n[i];break}if(!t)return!1;this._source=t}if(!e)if(t.getCenter)e=t.getCenter();else if(t.getLatLng)e=t.getLatLng();else{if(!t.getBounds)throw new Error("Unable to get source layer LatLng.");e=t.getBounds().getCenter()}return this.setLatLng(e),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var e=this._contentNode,t="function"===typeof this._content?this._content(this._source||this):this._content;if("string"===typeof t)e.innerHTML=t;else{for(;e.hasChildNodes();)e.removeChild(e.firstChild);e.appendChild(t)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var e=this._map.latLngToLayerPoint(this._latlng),t=k(this.options.offset),n=this._getAnchor();this._zoomAnimated?Rt(this._container,e.add(n)):t=t.add(e).add(n);var i=this._containerBottom=-t.y,r=this._containerLeft=-Math.round(this._containerWidth/2)+t.x;this._container.style.bottom=i+"px",this._container.style.left=r+"px"}},_getAnchor:function(){return[0,0]}});nn.include({_initOverlay:function(e,t,n,i){var r=t;return r instanceof e||(r=new e(i).setContent(t)),n&&r.setLatLng(n),r}}),qn.include({_initOverlay:function(e,t,n,i){var r=n;return r instanceof e?(p(r,i),r._source=this):(r=t&&!i?t:new e(i,this)).setContent(n),r}});var Fi=Ai.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(e){return!(e=arguments.length?e:this._source._map).hasLayer(this)&&e._popup&&e._popup.options.autoClose&&e.removeLayer(e._popup),e._popup=this,Ai.prototype.openOn.call(this,e)},onAdd:function(e){Ai.prototype.onAdd.call(this,e),e.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ii||this._source.on("preclick",Wt))},onRemove:function(e){Ai.prototype.onRemove.call(this,e),e.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ii||this._source.off("preclick",Wt))},getEvents:function(){var e=Ai.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(e.preclick=this.close),this.options.keepInView&&(e.moveend=this._adjustPan),e},_initLayout:function(){var e="leaflet-popup",t=this._container=pt("div",e+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=pt("div",e+"-content-wrapper",t);if(this._contentNode=pt("div",e+"-content",n),qt(t),jt(this._contentNode),Nt(t,"contextmenu",Wt),this._tipContainer=pt("div",e+"-tip-container",t),this._tip=pt("div",e+"-tip",this._tipContainer),this.options.closeButton){var i=this._closeButton=pt("a",e+"-close-button",t);i.setAttribute("role","button"),i.setAttribute("aria-label","Close popup"),i.href="#close",i.innerHTML='<span aria-hidden="true">&#215;</span>',Nt(i,"click",(function(e){Xt(e),this.close()}),this)}},_updateLayout:function(){var e=this._contentNode,t=e.style;t.width="",t.whiteSpace="nowrap";var n=e.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),t.width=n+1+"px",t.whiteSpace="",t.height="";var i=e.offsetHeight,r=this.options.maxHeight,s="leaflet-popup-scrolled";r&&i>r?(t.height=r+"px",Ct(e,s)):wt(e,s),this._containerWidth=this._container.offsetWidth},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center),n=this._getAnchor();Rt(this._container,t.add(n))},_adjustPan:function(){if(this.options.autoPan)if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)this._autopanning=!1;else{var e=this._map,t=parseInt(dt(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+t,i=this._containerWidth,r=new D(this._containerLeft,-n-this._containerBottom);r._add(Tt(this._container));var s=e.layerPointToContainerPoint(r),o=k(this.options.autoPanPadding),a=k(this.options.autoPanPaddingTopLeft||o),l=k(this.options.autoPanPaddingBottomRight||o),c=e.getSize(),u=0,h=0;s.x+i+l.x>c.x&&(u=s.x+i-c.x+l.x),s.x-u-a.x<0&&(u=s.x-a.x),s.y+n+l.y>c.y&&(h=s.y+n-c.y+l.y),s.y-h-a.y<0&&(h=s.y-a.y),(u||h)&&(this.options.keepInView&&(this._autopanning=!0),e.fire("autopanstart").panBy([u,h]))}},_getAnchor:function(){return k(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Di=function(e,t){return new Fi(e,t)};nn.mergeOptions({closePopupOnClick:!0}),nn.include({openPopup:function(e,t,n){return this._initOverlay(Fi,e,t,n).openOn(this),this},closePopup:function(e){return(e=arguments.length?e:this._popup)&&e.close(),this}}),qn.include({bindPopup:function(e,t){return this._popup=this._initOverlay(Fi,this._popup,e,t),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(e){return this._popup&&(this instanceof $n||(this._popup._source=this),this._popup._prepareOpen(e||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(e){return this._popup&&this._popup.setContent(e),this},getPopup:function(){return this._popup},_openPopup:function(e){if(this._popup&&this._map){Kt(e);var t=e.layer||e.target;this._popup._source!==t||t instanceof ii?(this._popup._source=t,this.openPopup(e.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(e.latlng)}},_movePopup:function(e){this._popup.setLatLng(e.latlng)},_onKeyPress:function(e){13===e.originalEvent.keyCode&&this._openPopup(e)}});var Li=Ai.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(e){Ai.prototype.onAdd.call(this,e),this.setOpacity(this.options.opacity),e.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(e){Ai.prototype.onRemove.call(this,e),e.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var e=Ai.prototype.getEvents.call(this);return this.options.permanent||(e.preclick=this.close),e},_initLayout:function(){var e="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=pt("div",e),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+o(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(e){var t,n,i=this._map,r=this._container,s=i.latLngToContainerPoint(i.getCenter()),o=i.layerPointToContainerPoint(e),a=this.options.direction,l=r.offsetWidth,c=r.offsetHeight,u=k(this.options.offset),h=this._getAnchor();"top"===a?(t=l/2,n=c):"bottom"===a?(t=l/2,n=0):"center"===a?(t=l/2,n=c/2):"right"===a?(t=0,n=c/2):"left"===a?(t=l,n=c/2):o.x<s.x?(a="right",t=0,n=c/2):(a="left",t=l+2*(u.x+h.x),n=c/2),e=e.subtract(k(t,n,!0)).add(u).add(h),wt(r,"leaflet-tooltip-right"),wt(r,"leaflet-tooltip-left"),wt(r,"leaflet-tooltip-top"),wt(r,"leaflet-tooltip-bottom"),Ct(r,"leaflet-tooltip-"+a),Rt(r,e)},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng);this._setPosition(e)},setOpacity:function(e){this.options.opacity=e,this._container&&xt(this._container,e)},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPosition(t)},_getAnchor:function(){return k(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ii=function(e,t){return new Li(e,t)};nn.include({openTooltip:function(e,t,n){return this._initOverlay(Li,e,t,n).openOn(this),this},closeTooltip:function(e){return e.close(),this}}),qn.include({bindTooltip:function(e,t){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Li,this._tooltip,e,t),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(e){if(e||!this._tooltipHandlersAdded){var t=e?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,n.click=this._openTooltip,this._map?this._addFocusListeners():n.add=this._addFocusListeners),this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),this[t](n),this._tooltipHandlersAdded=!e}},openTooltip:function(e){return this._tooltip&&(this instanceof $n||(this._tooltip._source=this),this._tooltip._prepareOpen(e)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(e){return this._tooltip&&this._tooltip.setContent(e),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(e){var t="function"===typeof e.getElement&&e.getElement();t&&(Nt(t,"focus",(function(){this._tooltip._source=e,this.openTooltip()}),this),Nt(t,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(e){var t="function"===typeof e.getElement&&e.getElement();t&&t.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(e){if(this._tooltip&&this._map)if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var t=this;this._map.once("moveend",(function(){t._openOnceFlag=!1,t._openTooltip(e)}))}else this._tooltip._source=e.layer||e.target,this.openTooltip(this._tooltip.options.sticky?e.latlng:void 0)},_moveTooltip:function(e){var t,n,i=e.latlng;this._tooltip.options.sticky&&e.originalEvent&&(t=this._map.mouseEventToContainerPoint(e.originalEvent),n=this._map.containerPointToLayerPoint(t),i=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(i)}});var ki=Yn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(e){var t=e&&"DIV"===e.tagName?e:document.createElement("div"),n=this.options;if(n.html instanceof Element?(ft(t),t.appendChild(n.html)):t.innerHTML=!1!==n.html?n.html:"",n.bgPos){var i=k(n.bgPos);t.style.backgroundPosition=-i.x+"px "+-i.y+"px"}return this._setIconStyles(t,"icon"),t},createShadow:function(){return null}});function Oi(e){return new ki(e)}Yn.Default=Qn;var Ni=qn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Oe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(e){p(this,e)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(e){e._addZoomLimit(this)},onRemove:function(e){this._removeAllTiles(),gt(this._container),e._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(mt(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(vt(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var e=this._clampZoom(this._map.getZoom());e!==this._tileZoom&&(this._tileZoom=e,this._updateLevels()),this._update()}return this},getEvents:function(){var e={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=a(this._onMoveEnd,this.options.updateInterval,this)),e.move=this._onMove),this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},createTile:function(){return document.createElement("div")},getTileSize:function(){var e=this.options.tileSize;return e instanceof D?e:new D(e,e)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e){for(var t,n=this.getPane().children,i=-e(-1/0,1/0),r=0,s=n.length;r<s;r++)t=n[r].style.zIndex,n[r]!==this._container&&t&&(i=e(i,+t));isFinite(i)&&(this.options.zIndex=i+e(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Oe.ielt9){xt(this._container,this.options.opacity);var e=+new Date,t=!1,n=!1;for(var i in this._tiles){var r=this._tiles[i];if(r.current&&r.loaded){var s=Math.min(1,(e-r.loaded)/200);xt(r.el,s),s<1?t=!0:(r.active?n=!0:this._onOpaqueTile(r),r.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),t&&(E(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this))}},_onOpaqueTile:c,_initContainer:function(){this._container||(this._container=pt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var e=this._tileZoom,t=this.options.maxZoom;if(void 0!==e){for(var n in this._levels)n=Number(n),this._levels[n].el.children.length||n===e?(this._levels[n].el.style.zIndex=t-Math.abs(e-n),this._onUpdateLevel(n)):(gt(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var i=this._levels[e],r=this._map;return i||((i=this._levels[e]={}).el=pt("div","leaflet-tile-container leaflet-zoom-animated",this._container),i.el.style.zIndex=t,i.origin=r.project(r.unproject(r.getPixelOrigin()),e).round(),i.zoom=e,this._setZoomTransform(i,r.getCenter(),r.getZoom()),c(i.el.offsetWidth),this._onCreateLevel(i)),this._level=i,i}},_onUpdateLevel:c,_onRemoveLevel:c,_onCreateLevel:c,_pruneTiles:function(){if(this._map){var e,t,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(e in this._tiles)(t=this._tiles[e]).retain=t.current;for(e in this._tiles)if((t=this._tiles[e]).current&&!t.active){var i=t.coords;this._retainParent(i.x,i.y,i.z,i.z-5)||this._retainChildren(i.x,i.y,i.z,i.z+2)}for(e in this._tiles)this._tiles[e].retain||this._removeTile(e)}}},_removeTilesAtZoom:function(e){for(var t in this._tiles)this._tiles[t].coords.z===e&&this._removeTile(t)},_removeAllTiles:function(){for(var e in this._tiles)this._removeTile(e)},_invalidateAll:function(){for(var e in this._levels)gt(this._levels[e].el),this._onRemoveLevel(Number(e)),delete this._levels[e];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(e,t,n,i){var r=Math.floor(e/2),s=Math.floor(t/2),o=n-1,a=new D(+r,+s);a.z=+o;var l=this._tileCoordsToKey(a),c=this._tiles[l];return c&&c.active?(c.retain=!0,!0):(c&&c.loaded&&(c.retain=!0),o>i&&this._retainParent(r,s,o,i))},_retainChildren:function(e,t,n,i){for(var r=2*e;r<2*e+2;r++)for(var s=2*t;s<2*t+2;s++){var o=new D(r,s);o.z=n+1;var a=this._tileCoordsToKey(o),l=this._tiles[a];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),n+1<i&&this._retainChildren(r,s,n+1,i))}},_resetView:function(e){var t=e&&(e.pinch||e.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),t,t)},_animateZoom:function(e){this._setView(e.center,e.zoom,!0,e.noUpdate)},_clampZoom:function(e){var t=this.options;return void 0!==t.minNativeZoom&&e<t.minNativeZoom?t.minNativeZoom:void 0!==t.maxNativeZoom&&t.maxNativeZoom<e?t.maxNativeZoom:e},_setView:function(e,t,n,i){var r=Math.round(t);r=void 0!==this.options.maxZoom&&r>this.options.maxZoom||void 0!==this.options.minZoom&&r<this.options.minZoom?void 0:this._clampZoom(r);var s=this.options.updateWhenZooming&&r!==this._tileZoom;i&&!s||(this._tileZoom=r,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==r&&this._update(e),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(e,t)},_setZoomTransforms:function(e,t){for(var n in this._levels)this._setZoomTransform(this._levels[n],e,t)},_setZoomTransform:function(e,t,n){var i=this._map.getZoomScale(n,e.zoom),r=e.origin.multiplyBy(i).subtract(this._map._getNewPixelOrigin(t,n)).round();Oe.any3d?Et(e.el,r,i):Rt(e.el,r)},_resetGrid:function(){var e=this._map,t=e.options.crs,n=this._tileSize=this.getTileSize(),i=this._tileZoom,r=this._map.getPixelWorldBounds(this._tileZoom);r&&(this._globalTileRange=this._pxBoundsToTileRange(r)),this._wrapX=t.wrapLng&&!this.options.noWrap&&[Math.floor(e.project([0,t.wrapLng[0]],i).x/n.x),Math.ceil(e.project([0,t.wrapLng[1]],i).x/n.y)],this._wrapY=t.wrapLat&&!this.options.noWrap&&[Math.floor(e.project([t.wrapLat[0],0],i).y/n.x),Math.ceil(e.project([t.wrapLat[1],0],i).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(e){var t=this._map,n=t._animatingZoom?Math.max(t._animateToZoom,t.getZoom()):t.getZoom(),i=t.getZoomScale(n,this._tileZoom),r=t.project(e,this._tileZoom).floor(),s=t.getSize().divideBy(2*i);return new O(r.subtract(s),r.add(s))},_update:function(e){var t=this._map;if(t){var n=this._clampZoom(t.getZoom());if(void 0===e&&(e=t.getCenter()),void 0!==this._tileZoom){var i=this._getTiledPixelBounds(e),r=this._pxBoundsToTileRange(i),s=r.getCenter(),o=[],a=this.options.keepBuffer,l=new O(r.getBottomLeft().subtract([a,-a]),r.getTopRight().add([a,-a]));if(!(isFinite(r.min.x)&&isFinite(r.min.y)&&isFinite(r.max.x)&&isFinite(r.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var c in this._tiles){var u=this._tiles[c].coords;u.z===this._tileZoom&&l.contains(new D(u.x,u.y))||(this._tiles[c].current=!1)}if(Math.abs(n-this._tileZoom)>1)this._setView(e,n);else{for(var h=r.min.y;h<=r.max.y;h++)for(var d=r.min.x;d<=r.max.x;d++){var p=new D(d,h);if(p.z=this._tileZoom,this._isValidTile(p)){var g=this._tiles[this._tileCoordsToKey(p)];g?g.current=!0:o.push(p)}}if(o.sort((function(e,t){return e.distanceTo(s)-t.distanceTo(s)})),0!==o.length){this._loading||(this._loading=!0,this.fire("loading"));var f=document.createDocumentFragment();for(d=0;d<o.length;d++)this._addTile(o[d],f);this._level.el.appendChild(f)}}}}},_isValidTile:function(e){var t=this._map.options.crs;if(!t.infinite){var n=this._globalTileRange;if(!t.wrapLng&&(e.x<n.min.x||e.x>n.max.x)||!t.wrapLat&&(e.y<n.min.y||e.y>n.max.y))return!1}if(!this.options.bounds)return!0;var i=this._tileCoordsToBounds(e);return z(this.options.bounds).overlaps(i)},_keyToBounds:function(e){return this._tileCoordsToBounds(this._keyToTileCoords(e))},_tileCoordsToNwSe:function(e){var t=this._map,n=this.getTileSize(),i=e.scaleBy(n),r=i.add(n);return[t.unproject(i,e.z),t.unproject(r,e.z)]},_tileCoordsToBounds:function(e){var t=this._tileCoordsToNwSe(e),n=new B(t[0],t[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(e){return e.x+":"+e.y+":"+e.z},_keyToTileCoords:function(e){var t=e.split(":"),n=new D(+t[0],+t[1]);return n.z=+t[2],n},_removeTile:function(e){var t=this._tiles[e];t&&(gt(t.el),delete this._tiles[e],this.fire("tileunload",{tile:t.el,coords:this._keyToTileCoords(e)}))},_initTile:function(e){Ct(e,"leaflet-tile");var t=this.getTileSize();e.style.width=t.x+"px",e.style.height=t.y+"px",e.onselectstart=c,e.onmousemove=c,Oe.ielt9&&this.options.opacity<1&&xt(e,this.options.opacity)},_addTile:function(e,t){var n=this._getTilePos(e),i=this._tileCoordsToKey(e),s=this.createTile(this._wrapCoords(e),r(this._tileReady,this,e));this._initTile(s),this.createTile.length<2&&M(r(this._tileReady,this,e,null,s)),Rt(s,n),this._tiles[i]={el:s,coords:e,current:!0},t.appendChild(s),this.fire("tileloadstart",{tile:s,coords:e})},_tileReady:function(e,t,n){t&&this.fire("tileerror",{error:t,tile:n,coords:e});var i=this._tileCoordsToKey(e);(n=this._tiles[i])&&(n.loaded=+new Date,this._map._fadeAnimated?(xt(n.el,0),E(this._fadeFrame),this._fadeFrame=M(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),t||(Ct(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:e})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Oe.ielt9||!this._map._fadeAnimated?M(this._pruneTiles,this):setTimeout(r(this._pruneTiles,this),250)))},_getTilePos:function(e){return e.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(e){var t=new D(this._wrapX?l(e.x,this._wrapX):e.x,this._wrapY?l(e.y,this._wrapY):e.y);return t.z=e.z,t},_pxBoundsToTileRange:function(e){var t=this.getTileSize();return new O(e.min.unscaleBy(t).floor(),e.max.unscaleBy(t).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var e in this._tiles)if(!this._tiles[e].loaded)return!1;return!0}});function Bi(e){return new Ni(e)}var zi=Ni.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(e,t){this._url=e,(t=p(this,t)).detectRetina&&Oe.retina&&t.maxZoom>0?(t.tileSize=Math.floor(t.tileSize/2),t.zoomReverse?(t.zoomOffset--,t.minZoom=Math.min(t.maxZoom,t.minZoom+1)):(t.zoomOffset++,t.maxZoom=Math.max(t.minZoom,t.maxZoom-1)),t.minZoom=Math.max(0,t.minZoom)):t.zoomReverse?t.minZoom=Math.min(t.maxZoom,t.minZoom):t.maxZoom=Math.max(t.minZoom,t.maxZoom),"string"===typeof t.subdomains&&(t.subdomains=t.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(e,t){return this._url===e&&void 0===t&&(t=!0),this._url=e,t||this.redraw(),this},createTile:function(e,t){var n=document.createElement("img");return Nt(n,"load",r(this._tileOnLoad,this,t,n)),Nt(n,"error",r(this._tileOnError,this,t,n)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"===typeof this.options.referrerPolicy&&(n.referrerPolicy=this.options.referrerPolicy),n.alt="",n.src=this.getTileUrl(e),n},getTileUrl:function(e){var t={r:Oe.retina?"@2x":"",s:this._getSubdomain(e),x:e.x,y:e.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-e.y;this.options.tms&&(t.y=i),t["-y"]=i}return m(this._url,n(t,this.options))},_tileOnLoad:function(e,t){Oe.ielt9?setTimeout(r(e,this,null,t),0):e(null,t)},_tileOnError:function(e,t,n){var i=this.options.errorTileUrl;i&&t.getAttribute("src")!==i&&(t.src=i),e(n,t)},_onTileRemove:function(e){e.tile.onload=null},_getZoomForUrl:function(){var e=this._tileZoom,t=this.options.maxZoom;return this.options.zoomReverse&&(e=t-e),e+this.options.zoomOffset},_getSubdomain:function(e){var t=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[t]},_abortLoading:function(){var e,t;for(e in this._tiles)if(this._tiles[e].coords.z!==this._tileZoom&&((t=this._tiles[e].el).onload=c,t.onerror=c,!t.complete)){t.src=C;var n=this._tiles[e].coords;gt(t),delete this._tiles[e],this.fire("tileabort",{tile:t,coords:n})}},_removeTile:function(e){var t=this._tiles[e];if(t)return t.el.setAttribute("src",C),Ni.prototype._removeTile.call(this,e)},_tileReady:function(e,t,n){if(this._map&&(!n||n.getAttribute("src")!==C))return Ni.prototype._tileReady.call(this,e,t,n)}});function Hi(e,t){return new zi(e,t)}var Gi=zi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(e,t){this._url=e;var i=n({},this.defaultWmsParams);for(var r in t)r in this.options||(i[r]=t[r]);var s=(t=p(this,t)).detectRetina&&Oe.retina?2:1,o=this.getTileSize();i.width=o.x*s,i.height=o.y*s,this.wmsParams=i},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var t=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[t]=this._crs.code,zi.prototype.onAdd.call(this,e)},getTileUrl:function(e){var t=this._tileCoordsToNwSe(e),n=this._crs,i=N(n.project(t[0]),n.project(t[1])),r=i.min,s=i.max,o=(this._wmsVersion>=1.3&&this._crs===Wn?[r.y,r.x,s.y,s.x]:[r.x,r.y,s.x,s.y]).join(","),a=zi.prototype.getTileUrl.call(this,e);return a+g(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+o},setParams:function(e,t){return n(this.wmsParams,e),t||this.redraw(),this}});function Ui(e,t){return new Gi(e,t)}zi.WMS=Gi,Hi.wms=Ui;var Vi=qn.extend({options:{padding:.1},initialize:function(e){p(this,e),o(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ct(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var e={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(e.zoomanim=this._onAnimZoom),e},_onAnimZoom:function(e){this._updateTransform(e.center,e.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(e,t){var n=this._map.getZoomScale(t,this._zoom),i=this._map.getSize().multiplyBy(.5+this.options.padding),r=this._map.project(this._center,t),s=i.multiplyBy(-n).add(r).subtract(this._map._getNewPixelOrigin(e,t));Oe.any3d?Et(this._container,s,n):Rt(this._container,s)},_reset:function(){for(var e in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[e]._reset()},_onZoomEnd:function(){for(var e in this._layers)this._layers[e]._project()},_updatePaths:function(){for(var e in this._layers)this._layers[e]._update()},_update:function(){var e=this.options.padding,t=this._map.getSize(),n=this._map.containerPointToLayerPoint(t.multiplyBy(-e)).round();this._bounds=new O(n,n.add(t.multiplyBy(1+2*e)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Wi=Vi.extend({options:{tolerance:0},getEvents:function(){var e=Vi.prototype.getEvents.call(this);return e.viewprereset=this._onViewPreReset,e},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Vi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var e=this._container=document.createElement("canvas");Nt(e,"mousemove",this._onMouseMove,this),Nt(e,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Nt(e,"mouseout",this._handleMouseOut,this),e._leaflet_disable_events=!0,this._ctx=e.getContext("2d")},_destroyContainer:function(){E(this._redrawRequest),delete this._ctx,gt(this._container),zt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var e in this._redrawBounds=null,this._layers)this._layers[e]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){Vi.prototype._update.call(this);var e=this._bounds,t=this._container,n=e.getSize(),i=Oe.retina?2:1;Rt(t,e.min),t.width=i*n.x,t.height=i*n.y,t.style.width=n.x+"px",t.style.height=n.y+"px",Oe.retina&&this._ctx.scale(2,2),this._ctx.translate(-e.min.x,-e.min.y),this.fire("update")}},_reset:function(){Vi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(e){this._updateDashArray(e),this._layers[o(e)]=e;var t=e._order={layer:e,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=t),this._drawLast=t,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(e){this._requestRedraw(e)},_removePath:function(e){var t=e._order,n=t.next,i=t.prev;n?n.prev=i:this._drawLast=i,i?i.next=n:this._drawFirst=n,delete e._order,delete this._layers[o(e)],this._requestRedraw(e)},_updatePath:function(e){this._extendRedrawBounds(e),e._project(),e._update(),this._requestRedraw(e)},_updateStyle:function(e){this._updateDashArray(e),this._requestRedraw(e)},_updateDashArray:function(e){if("string"===typeof e.options.dashArray){var t,n,i=e.options.dashArray.split(/[, ]+/),r=[];for(n=0;n<i.length;n++){if(t=Number(i[n]),isNaN(t))return;r.push(t)}e.options._dashArray=r}else e.options._dashArray=e.options.dashArray},_requestRedraw:function(e){this._map&&(this._extendRedrawBounds(e),this._redrawRequest=this._redrawRequest||M(this._redraw,this))},_extendRedrawBounds:function(e){if(e._pxBounds){var t=(e.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new O,this._redrawBounds.extend(e._pxBounds.min.subtract([t,t])),this._redrawBounds.extend(e._pxBounds.max.add([t,t]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var e=this._redrawBounds;if(e){var t=e.getSize();this._ctx.clearRect(e.min.x,e.min.y,t.x,t.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var e,t=this._redrawBounds;if(this._ctx.save(),t){var n=t.getSize();this._ctx.beginPath(),this._ctx.rect(t.min.x,t.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var i=this._drawFirst;i;i=i.next)e=i.layer,(!t||e._pxBounds&&e._pxBounds.intersects(t))&&e._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(e,t){if(this._drawing){var n,i,r,s,o=e._parts,a=o.length,l=this._ctx;if(a){for(l.beginPath(),n=0;n<a;n++){for(i=0,r=o[n].length;i<r;i++)s=o[n][i],l[i?"lineTo":"moveTo"](s.x,s.y);t&&l.closePath()}this._fillStroke(l,e)}}},_updateCircle:function(e){if(this._drawing&&!e._empty()){var t=e._point,n=this._ctx,i=Math.max(Math.round(e._radius),1),r=(Math.max(Math.round(e._radiusY),1)||i)/i;1!==r&&(n.save(),n.scale(1,r)),n.beginPath(),n.arc(t.x,t.y/r,i,0,2*Math.PI,!1),1!==r&&n.restore(),this._fillStroke(n,e)}},_fillStroke:function(e,t){var n=t.options;n.fill&&(e.globalAlpha=n.fillOpacity,e.fillStyle=n.fillColor||n.color,e.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(e.setLineDash&&e.setLineDash(t.options&&t.options._dashArray||[]),e.globalAlpha=n.opacity,e.lineWidth=n.weight,e.strokeStyle=n.color,e.lineCap=n.lineCap,e.lineJoin=n.lineJoin,e.stroke())},_onClick:function(e){for(var t,n,i=this._map.mouseEventToLayerPoint(e),r=this._drawFirst;r;r=r.next)(t=r.layer).options.interactive&&t._containsPoint(i)&&("click"!==e.type&&"preclick"!==e.type||!this._map._draggableMoved(t))&&(n=t);this._fireEvent(!!n&&[n],e)},_onMouseMove:function(e){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var t=this._map.mouseEventToLayerPoint(e);this._handleMouseHover(e,t)}},_handleMouseOut:function(e){var t=this._hoveredLayer;t&&(wt(this._container,"leaflet-interactive"),this._fireEvent([t],e,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(e,t){if(!this._mouseHoverThrottled){for(var n,i,s=this._drawFirst;s;s=s.next)(n=s.layer).options.interactive&&n._containsPoint(t)&&(i=n);i!==this._hoveredLayer&&(this._handleMouseOut(e),i&&(Ct(this._container,"leaflet-interactive"),this._fireEvent([i],e,"mouseover"),this._hoveredLayer=i)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],e),this._mouseHoverThrottled=!0,setTimeout(r((function(){this._mouseHoverThrottled=!1}),this),32)}},_fireEvent:function(e,t,n){this._map._fireDOMEvent(t,n||t.type,e)},_bringToFront:function(e){var t=e._order;if(t){var n=t.next,i=t.prev;n&&(n.prev=i,i?i.next=n:n&&(this._drawFirst=n),t.prev=this._drawLast,this._drawLast.next=t,t.next=null,this._drawLast=t,this._requestRedraw(e))}},_bringToBack:function(e){var t=e._order;if(t){var n=t.next,i=t.prev;i&&(i.next=n,n?n.prev=i:i&&(this._drawLast=i),t.prev=null,t.next=this._drawFirst,this._drawFirst.prev=t,this._drawFirst=t,this._requestRedraw(e))}}});function ji(e){return Oe.canvas?new Wi(e):null}var qi=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<lvml:"+e+' class="lvml">')}}catch(e){}return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Xi={_initContainer:function(){this._container=pt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Vi.prototype._update.call(this),this.fire("update"))},_initPath:function(e){var t=e._container=qi("shape");Ct(t,"leaflet-vml-shape "+(this.options.className||"")),t.coordsize="1 1",e._path=qi("path"),t.appendChild(e._path),this._updateStyle(e),this._layers[o(e)]=e},_addPath:function(e){var t=e._container;this._container.appendChild(t),e.options.interactive&&e.addInteractiveTarget(t)},_removePath:function(e){var t=e._container;gt(t),e.removeInteractiveTarget(t),delete this._layers[o(e)]},_updateStyle:function(e){var t=e._stroke,n=e._fill,i=e.options,r=e._container;r.stroked=!!i.stroke,r.filled=!!i.fill,i.stroke?(t||(t=e._stroke=qi("stroke")),r.appendChild(t),t.weight=i.weight+"px",t.color=i.color,t.opacity=i.opacity,i.dashArray?t.dashStyle=v(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):t.dashStyle="",t.endcap=i.lineCap.replace("butt","flat"),t.joinstyle=i.lineJoin):t&&(r.removeChild(t),e._stroke=null),i.fill?(n||(n=e._fill=qi("fill")),r.appendChild(n),n.color=i.fillColor||i.color,n.opacity=i.fillOpacity):n&&(r.removeChild(n),e._fill=null)},_updateCircle:function(e){var t=e._point.round(),n=Math.round(e._radius),i=Math.round(e._radiusY||n);this._setPath(e,e._empty()?"M0 0":"AL "+t.x+","+t.y+" "+n+","+i+" 0,23592600")},_setPath:function(e,t){e._path.v=t},_bringToFront:function(e){mt(e._container)},_bringToBack:function(e){vt(e._container)}},Ki=Oe.vml?qi:Z,$i=Vi.extend({_initContainer:function(){this._container=Ki("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ki("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){gt(this._container),zt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){Vi.prototype._update.call(this);var e=this._bounds,t=e.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(t)||(this._svgSize=t,n.setAttribute("width",t.x),n.setAttribute("height",t.y)),Rt(n,e.min),n.setAttribute("viewBox",[e.min.x,e.min.y,t.x,t.y].join(" ")),this.fire("update")}},_initPath:function(e){var t=e._path=Ki("path");e.options.className&&Ct(t,e.options.className),e.options.interactive&&Ct(t,"leaflet-interactive"),this._updateStyle(e),this._layers[o(e)]=e},_addPath:function(e){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(e._path),e.addInteractiveTarget(e._path)},_removePath:function(e){gt(e._path),e.removeInteractiveTarget(e._path),delete this._layers[o(e)]},_updatePath:function(e){e._project(),e._update()},_updateStyle:function(e){var t=e._path,n=e.options;t&&(n.stroke?(t.setAttribute("stroke",n.color),t.setAttribute("stroke-opacity",n.opacity),t.setAttribute("stroke-width",n.weight),t.setAttribute("stroke-linecap",n.lineCap),t.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?t.setAttribute("stroke-dasharray",n.dashArray):t.removeAttribute("stroke-dasharray"),n.dashOffset?t.setAttribute("stroke-dashoffset",n.dashOffset):t.removeAttribute("stroke-dashoffset")):t.setAttribute("stroke","none"),n.fill?(t.setAttribute("fill",n.fillColor||n.color),t.setAttribute("fill-opacity",n.fillOpacity),t.setAttribute("fill-rule",n.fillRule||"evenodd")):t.setAttribute("fill","none"))},_updatePoly:function(e,t){this._setPath(e,Y(e._parts,t))},_updateCircle:function(e){var t=e._point,n=Math.max(Math.round(e._radius),1),i="a"+n+","+(Math.max(Math.round(e._radiusY),1)||n)+" 0 1,0 ",r=e._empty()?"M0 0":"M"+(t.x-n)+","+t.y+i+2*n+",0 "+i+2*-n+",0 ";this._setPath(e,r)},_setPath:function(e,t){e._path.setAttribute("d",t)},_bringToFront:function(e){mt(e._path)},_bringToBack:function(e){vt(e._path)}});function Zi(e){return Oe.svg||Oe.vml?new $i(e):null}Oe.vml&&$i.include(Xi),nn.include({getRenderer:function(e){var t=e.options.renderer||this._getPaneRenderer(e.options.pane)||this.options.renderer||this._renderer;return t||(t=this._renderer=this._createRenderer()),this.hasLayer(t)||this.addLayer(t),t},_getPaneRenderer:function(e){if("overlayPane"===e||void 0===e)return!1;var t=this._paneRenderers[e];return void 0===t&&(t=this._createRenderer({pane:e}),this._paneRenderers[e]=t),t},_createRenderer:function(e){return this.options.preferCanvas&&ji(e)||Zi(e)}});var Yi=ui.extend({initialize:function(e,t){ui.prototype.initialize.call(this,this._boundsToLatLngs(e),t)},setBounds:function(e){return this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return[(e=z(e)).getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}});function Ji(e,t){return new Yi(e,t)}$i.create=Ki,$i.pointsToPath=Y,di.geometryToLayer=pi,di.coordsToLatLng=fi,di.coordsToLatLngs=mi,di.latLngToCoords=vi,di.latLngsToCoords=yi,di.getFeature=Ci,di.asFeature=wi,nn.mergeOptions({boxZoom:!0});var Qi=mn.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane,this._resetStateTimeout=0,e.on("unload",this._destroy,this)},addHooks:function(){Nt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){zt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){gt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(e){if(!e.shiftKey||1!==e.which&&1!==e.button)return!1;this._clearDeferredResetState(),this._resetState(),it(),At(),this._startPoint=this._map.mouseEventToContainerPoint(e),Nt(document,{contextmenu:Kt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(e){this._moved||(this._moved=!0,this._box=pt("div","leaflet-zoom-box",this._container),Ct(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(e);var t=new O(this._point,this._startPoint),n=t.getSize();Rt(this._box,t.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(gt(this._box),wt(this._container,"leaflet-crosshair")),rt(),Ft(),zt(document,{contextmenu:Kt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(e){if((1===e.which||1===e.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(r(this._resetState,this),0);var t=new B(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(t).fire("boxzoomend",{boxZoomBounds:t})}},_onKeyDown:function(e){27===e.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});nn.addInitHook("addHandler","boxZoom",Qi),nn.mergeOptions({doubleClickZoom:!0});var er=mn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(e){var t=this._map,n=t.getZoom(),i=t.options.zoomDelta,r=e.originalEvent.shiftKey?n-i:n+i;"center"===t.options.doubleClickZoom?t.setZoom(r):t.setZoomAround(e.containerPoint,r)}});nn.addInitHook("addHandler","doubleClickZoom",er),nn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var tr=mn.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new Cn(e._mapPane,e._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),e.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),e.on("zoomend",this._onZoomEnd,this),e.whenReady(this._onZoomEnd,this))}Ct(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){wt(this._map._container,"leaflet-grab"),wt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var e=this._map;if(e._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var t=z(this._map.options.maxBounds);this._offsetLimit=N(this._map.latLngToContainerPoint(t.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(t.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(e){if(this._map.options.inertia){var t=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(t),this._prunePositions(t)}this._map.fire("move",e).fire("drag",e)},_prunePositions:function(e){for(;this._positions.length>1&&e-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var e=this._map.getSize().divideBy(2),t=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=t.subtract(e).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(e,t){return e-(e-t)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var e=this._draggable._newPos.subtract(this._draggable._startPos),t=this._offsetLimit;e.x<t.min.x&&(e.x=this._viscousLimit(e.x,t.min.x)),e.y<t.min.y&&(e.y=this._viscousLimit(e.y,t.min.y)),e.x>t.max.x&&(e.x=this._viscousLimit(e.x,t.max.x)),e.y>t.max.y&&(e.y=this._viscousLimit(e.y,t.max.y)),this._draggable._newPos=this._draggable._startPos.add(e)}},_onPreDragWrap:function(){var e=this._worldWidth,t=Math.round(e/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,r=(i-t+n)%e+t-n,s=(i+t+n)%e-t-n,o=Math.abs(r+n)<Math.abs(s+n)?r:s;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=o},_onDragEnd:function(e){var t=this._map,n=t.options,i=!n.inertia||e.noInertia||this._times.length<2;if(t.fire("dragend",e),i)t.fire("moveend");else{this._prunePositions(+new Date);var r=this._lastPos.subtract(this._positions[0]),s=(this._lastTime-this._times[0])/1e3,o=n.easeLinearity,a=r.multiplyBy(o/s),l=a.distanceTo([0,0]),c=Math.min(n.inertiaMaxSpeed,l),u=a.multiplyBy(c/l),h=c/(n.inertiaDeceleration*o),d=u.multiplyBy(-h/2).round();d.x||d.y?(d=t._limitOffset(d,t.options.maxBounds),M((function(){t.panBy(d,{duration:h,easeLinearity:o,noMoveStart:!0,animate:!0})}))):t.fire("moveend")}}});nn.addInitHook("addHandler","dragging",tr),nn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var nr=mn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(e){this._map=e,this._setPanDelta(e.options.keyboardPanDelta),this._setZoomDelta(e.options.zoomDelta)},addHooks:function(){var e=this._map._container;e.tabIndex<=0&&(e.tabIndex="0"),Nt(e,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),zt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var e=document.body,t=document.documentElement,n=e.scrollTop||t.scrollTop,i=e.scrollLeft||t.scrollLeft;this._map._container.focus(),window.scrollTo(i,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(e){var t,n,i=this._panKeys={},r=this.keyCodes;for(t=0,n=r.left.length;t<n;t++)i[r.left[t]]=[-1*e,0];for(t=0,n=r.right.length;t<n;t++)i[r.right[t]]=[e,0];for(t=0,n=r.down.length;t<n;t++)i[r.down[t]]=[0,e];for(t=0,n=r.up.length;t<n;t++)i[r.up[t]]=[0,-1*e]},_setZoomDelta:function(e){var t,n,i=this._zoomKeys={},r=this.keyCodes;for(t=0,n=r.zoomIn.length;t<n;t++)i[r.zoomIn[t]]=e;for(t=0,n=r.zoomOut.length;t<n;t++)i[r.zoomOut[t]]=-e},_addHooks:function(){Nt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){zt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var t,n=e.keyCode,i=this._map;if(n in this._panKeys){if(!i._panAnim||!i._panAnim._inProgress)if(t=this._panKeys[n],e.shiftKey&&(t=k(t).multiplyBy(3)),i.options.maxBounds&&(t=i._limitOffset(k(t),i.options.maxBounds)),i.options.worldCopyJump){var r=i.wrapLatLng(i.unproject(i.project(i.getCenter()).add(t)));i.panTo(r)}else i.panBy(t)}else if(n in this._zoomKeys)i.setZoom(i.getZoom()+(e.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!i._popup||!i._popup.options.closeOnEscapeKey)return;i.closePopup()}Kt(e)}}});nn.addInitHook("addHandler","keyboard",nr),nn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ir=mn.extend({addHooks:function(){Nt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){zt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(e){var t=Jt(e),n=this._map.options.wheelDebounceTime;this._delta+=t,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var i=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(r(this._performZoom,this),i),Kt(e)},_performZoom:function(){var e=this._map,t=e.getZoom(),n=this._map.options.zoomSnap||0;e._stop();var i=this._delta/(4*this._map.options.wheelPxPerZoomLevel),r=4*Math.log(2/(1+Math.exp(-Math.abs(i))))/Math.LN2,s=n?Math.ceil(r/n)*n:r,o=e._limitZoom(t+(this._delta>0?s:-s))-t;this._delta=0,this._startTime=null,o&&("center"===e.options.scrollWheelZoom?e.setZoom(t+o):e.setZoomAround(this._lastMousePos,t+o))}});nn.addInitHook("addHandler","scrollWheelZoom",ir);var rr=600;nn.mergeOptions({tapHold:Oe.touchNative&&Oe.safari&&Oe.mobile,tapTolerance:15});var sr=mn.extend({addHooks:function(){Nt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){zt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(clearTimeout(this._holdTimeout),1===e.touches.length){var t=e.touches[0];this._startPos=this._newPos=new D(t.clientX,t.clientY),this._holdTimeout=setTimeout(r((function(){this._cancel(),this._isTapValid()&&(Nt(document,"touchend",Xt),Nt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",t))}),this),rr),Nt(document,"touchend touchcancel contextmenu",this._cancel,this),Nt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function e(){zt(document,"touchend",Xt),zt(document,"touchend touchcancel",e)},_cancel:function(){clearTimeout(this._holdTimeout),zt(document,"touchend touchcancel contextmenu",this._cancel,this),zt(document,"touchmove",this._onMove,this)},_onMove:function(e){var t=e.touches[0];this._newPos=new D(t.clientX,t.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(e,t){var n=new MouseEvent(e,{bubbles:!0,cancelable:!0,view:window,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY});n._simulated=!0,t.target.dispatchEvent(n)}});nn.addInitHook("addHandler","tapHold",sr),nn.mergeOptions({touchZoom:Oe.touch,bounceAtZoomLimits:!0});var or=mn.extend({addHooks:function(){Ct(this._map._container,"leaflet-touch-zoom"),Nt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){wt(this._map._container,"leaflet-touch-zoom"),zt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var t=this._map;if(e.touches&&2===e.touches.length&&!t._animatingZoom&&!this._zooming){var n=t.mouseEventToContainerPoint(e.touches[0]),i=t.mouseEventToContainerPoint(e.touches[1]);this._centerPoint=t.getSize()._divideBy(2),this._startLatLng=t.containerPointToLatLng(this._centerPoint),"center"!==t.options.touchZoom&&(this._pinchStartLatLng=t.containerPointToLatLng(n.add(i)._divideBy(2))),this._startDist=n.distanceTo(i),this._startZoom=t.getZoom(),this._moved=!1,this._zooming=!0,t._stop(),Nt(document,"touchmove",this._onTouchMove,this),Nt(document,"touchend touchcancel",this._onTouchEnd,this),Xt(e)}},_onTouchMove:function(e){if(e.touches&&2===e.touches.length&&this._zooming){var t=this._map,n=t.mouseEventToContainerPoint(e.touches[0]),i=t.mouseEventToContainerPoint(e.touches[1]),s=n.distanceTo(i)/this._startDist;if(this._zoom=t.getScaleZoom(s,this._startZoom),!t.options.bounceAtZoomLimits&&(this._zoom<t.getMinZoom()&&s<1||this._zoom>t.getMaxZoom()&&s>1)&&(this._zoom=t._limitZoom(this._zoom)),"center"===t.options.touchZoom){if(this._center=this._startLatLng,1===s)return}else{var o=n._add(i)._divideBy(2)._subtract(this._centerPoint);if(1===s&&0===o.x&&0===o.y)return;this._center=t.unproject(t.project(this._pinchStartLatLng,this._zoom).subtract(o),this._zoom)}this._moved||(t._moveStart(!0,!1),this._moved=!0),E(this._animRequest);var a=r(t._move,t,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=M(a,this,!0),Xt(e)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,E(this._animRequest),zt(document,"touchmove",this._onTouchMove,this),zt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});nn.addInitHook("addHandler","touchZoom",or),nn.BoxZoom=Qi,nn.DoubleClickZoom=er,nn.Drag=tr,nn.Keyboard=nr,nn.ScrollWheelZoom=ir,nn.TapHold=sr,nn.TouchZoom=or,e.Bounds=O,e.Browser=Oe,e.CRS=U,e.Canvas=Wi,e.Circle=oi,e.CircleMarker=ri,e.Class=T,e.Control=sn,e.DivIcon=ki,e.DivOverlay=Ai,e.DomEvent=en,e.DomUtil=Ot,e.Draggable=Cn,e.Evented=F,e.FeatureGroup=$n,e.GeoJSON=di,e.GridLayer=Ni,e.Handler=mn,e.Icon=Yn,e.ImageOverlay=_i,e.LatLng=H,e.LatLngBounds=B,e.Layer=qn,e.LayerGroup=Xn,e.LineUtil=zn,e.Map=nn,e.Marker=ti,e.Mixin=vn,e.Path=ii,e.Point=D,e.PolyUtil=_n,e.Polygon=ui,e.Polyline=li,e.Popup=Fi,e.PosAnimation=tn,e.Projection=Un,e.Rectangle=Yi,e.Renderer=Vi,e.SVG=$i,e.SVGOverlay=Ti,e.TileLayer=zi,e.Tooltip=Li,e.Transformation=q,e.Util=R,e.VideoOverlay=Ei,e.bind=r,e.bounds=N,e.canvas=ji,e.circle=ai,e.circleMarker=si,e.control=on,e.divIcon=Oi,e.extend=n,e.featureGroup=Zn,e.geoJSON=bi,e.geoJson=xi,e.gridLayer=Bi,e.icon=Jn,e.imageOverlay=Mi,e.latLng=G,e.latLngBounds=z,e.layerGroup=Kn,e.map=rn,e.marker=ni,e.point=k,e.polygon=hi,e.polyline=ci,e.popup=Di,e.rectangle=Ji,e.setOptions=p,e.stamp=o,e.svg=Zi,e.svgOverlay=Pi,e.tileLayer=Hi,e.tooltip=Ii,e.transformation=X,e.version=t,e.videoOverlay=Ri;var ar=window.L;e.noConflict=function(){return window.L=ar,this},window.L=e}(t)},234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,o=r>>>1;i<o;){var a=2*(i+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<r&&0>s(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<r&&0>s(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,p=3,g=!1,f=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,C="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function S(e){if(m=!1,w(e),!f)if(null!==i(c))f=!0,L(b);else{var t=i(u);null!==t&&I(S,t.startTime-e)}}function b(e,n){f=!1,m&&(m=!1,y(E),E=-1),g=!0;var s=p;try{for(w(n),d=i(c);null!==d&&(!(d.expirationTime>n)||e&&!P());){var o=d.callback;if("function"===typeof o){d.callback=null,p=d.priorityLevel;var a=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===i(c)&&r(c),w(n)}else r(c);d=i(c)}if(null!==d)var l=!0;else{var h=i(u);null!==h&&I(S,h.startTime-n),l=!1}return l}finally{d=null,p=s,g=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x,_=!1,M=null,E=-1,R=5,T=-1;function P(){return!(t.unstable_now()-T<R)}function A(){if(null!==M){var e=t.unstable_now();T=e;var n=!0;try{n=M(!0,e)}finally{n?x():(_=!1,M=null)}}else _=!1}if("function"===typeof C)x=function(){C(A)};else if("undefined"!==typeof MessageChannel){var F=new MessageChannel,D=F.port2;F.port1.onmessage=A,x=function(){D.postMessage(null)}}else x=function(){v(A,0)};function L(e){M=e,_||(_=!0,x())}function I(e,n){E=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||g||(f=!0,L(b))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:r,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===i(c)&&e===i(u)&&(m?(y(E),E=-1):m=!0,I(S,s-o))):(e.sortIndex=a,n(c,e),f||g||(f=!0,L(b))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},249:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg=="},302:(e,t)=>{"use strict";t.ConcurrentRoot=1,t.ContinuousEventPriority=4,t.DefaultEventPriority=16,t.DiscreteEventPriority=1},358:(e,t)=>{"use strict";const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,i=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,o=Object.prototype.toString,a=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function l(e,t,n){do{const n=e.charCodeAt(t);if(32!==n&&9!==n)return t}while(++t<n);return n}function c(e,t,n){for(;t>n;){const n=e.charCodeAt(--t);if(32!==n&&9!==n)return t+1}return n}function u(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},391:(e,t,n)=>{"use strict";var i=n(950);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},513:(e,t,n)=>{"use strict";e.exports=n(62)},579:(e,t,n)=>{"use strict";e.exports=n(153)},730:(e,t,n)=>{"use strict";var i=n(43),r=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},g={};function f(e,t,n,i,r,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new f(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new f(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new f(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new f(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new f(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new f(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function C(e,t,n,i){var r=m.hasOwnProperty(t)?m[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null===t||"undefined"===typeof t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!h.call(g,e)||!h.call(p,e)&&(d.test(e)?g[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new f(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);m[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=Symbol.for("react.element"),b=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),R=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var L=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var I=Symbol.iterator;function k(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=I&&e[I]||e["@@iterator"])?e:null}var O,N=Object.assign;function B(e){if(void 0===O)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return"\n"+O+e}var z=!1;function H(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),s=i.stack.split("\n"),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||r[o]!==s[a]){var l="\n"+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?B(e):""}function G(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=H(e.type,!1);case 11:return e=H(e.type.render,!1);case 1:return e=H(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case x:return"Fragment";case b:return"Portal";case M:return"Profiler";case _:return"StrictMode";case P:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case R:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case F:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return U(e(t))}catch(n){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function j(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=j(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=j(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var n=t.checked;return N({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Z(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&C(e,"checked",t,!1)}function J(e,t){Y(e,t);var n=W(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Q(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return N({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function se(e,t){var n=W(t.value),i=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ge=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=fe(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(pe).forEach((function(e){ge.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ve=N({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function Ce(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function Se(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var be=null,xe=null,_e=null;function Me(e){if(e=Cr(e)){if("function"!==typeof be)throw Error(s(280));var t=e.stateNode;t&&(t=Sr(t),be(e.stateNode,e.type,t))}}function Ee(e){xe?_e?_e.push(e):_e=[e]:xe=e}function Re(){if(xe){var e=xe,t=_e;if(_e=xe=null,Me(e),t)for(e=0;e<t.length;e++)Me(t[e])}}function Te(e,t){return e(t)}function Pe(){}var Ae=!1;function Fe(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Te(e,t,n)}finally{Ae=!1,(null!==xe||null!==_e)&&(Pe(),Re())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var i=Sr(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Le=!1;if(u)try{var Ie={};Object.defineProperty(Ie,"passive",{get:function(){Le=!0}}),window.addEventListener("test",Ie,Ie),window.removeEventListener("test",Ie,Ie)}catch(ue){Le=!1}function ke(e,t,n,i,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Oe=!1,Ne=null,Be=!1,ze=null,He={onError:function(e){Oe=!0,Ne=e}};function Ge(e,t,n,i,r,s,o,a,l){Oe=!1,Ne=null,ke.apply(He,arguments)}function Ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(Ue(e)!==e)throw Error(s(188))}function je(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return We(r),e;if(o===i)return We(r),t;o=o.sibling}throw Error(s(188))}if(n.return!==i.return)n=r,i=o;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,i=o;break}if(l===i){a=!0,i=r,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,i=r;break}if(l===i){a=!0,i=o,n=r;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==i)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Xe=r.unstable_scheduleCallback,Ke=r.unstable_cancelCallback,$e=r.unstable_shouldYield,Ze=r.unstable_requestPaint,Ye=r.unstable_now,Je=r.unstable_getCurrentPriorityLevel,Qe=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,it=r.unstable_IdlePriority,rt=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~r;0!==a?i=ht(a):0!==(s&=o)&&(i=ht(s))}else 0!==(o=n&~r)?i=ht(o):0!==s&&(i=ht(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-ot(t)),i|=e[n],t&=~r;return i}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function gt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-ot(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var Ct=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var St,bt,xt,_t,Mt,Et=!1,Rt=[],Tt=null,Pt=null,At=null,Ft=new Map,Dt=new Map,Lt=[],It="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kt(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Ft.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Ot(e,t,n,i,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=Cr(t))&&bt(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Nt(e){var t=yr(e.target);if(null!==t){var n=Ue(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void Mt(e.priority,(function(){xt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=Cr(n))&&bt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);we=i,n.target.dispatchEvent(i),we=null,t.shift()}return!0}function zt(e,t,n){Bt(e)&&n.delete(t)}function Ht(){Et=!1,null!==Tt&&Bt(Tt)&&(Tt=null),null!==Pt&&Bt(Pt)&&(Pt=null),null!==At&&Bt(At)&&(At=null),Ft.forEach(zt),Dt.forEach(zt)}function Gt(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ht)))}function Ut(e){function t(t){return Gt(t,e)}if(0<Rt.length){Gt(Rt[0],e);for(var n=1;n<Rt.length;n++){var i=Rt[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Tt&&Gt(Tt,e),null!==Pt&&Gt(Pt,e),null!==At&&Gt(At,e),Ft.forEach(t),Dt.forEach(t),n=0;n<Lt.length;n++)(i=Lt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<Lt.length&&null===(n=Lt[0]).blockedOn;)Nt(n),null===n.blockedOn&&Lt.shift()}var Vt=w.ReactCurrentBatchConfig,Wt=!0;function jt(e,t,n,i){var r=Ct,s=Vt.transition;Vt.transition=null;try{Ct=1,Xt(e,t,n,i)}finally{Ct=r,Vt.transition=s}}function qt(e,t,n,i){var r=Ct,s=Vt.transition;Vt.transition=null;try{Ct=4,Xt(e,t,n,i)}finally{Ct=r,Vt.transition=s}}function Xt(e,t,n,i){if(Wt){var r=$t(e,t,n,i);if(null===r)Wi(e,t,i,Kt,n),kt(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Tt=Ot(Tt,e,t,n,i,r),!0;case"dragenter":return Pt=Ot(Pt,e,t,n,i,r),!0;case"mouseover":return At=Ot(At,e,t,n,i,r),!0;case"pointerover":var s=r.pointerId;return Ft.set(s,Ot(Ft.get(s)||null,e,t,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Dt.set(s,Ot(Dt.get(s)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(kt(e,i),4&t&&-1<It.indexOf(e)){for(;null!==r;){var s=Cr(r);if(null!==s&&St(s),null===(s=$t(e,t,n,i))&&Wi(e,t,i,Kt,n),s===r)break;r=s}null!==r&&i.stopPropagation()}else Wi(e,t,i,null,n)}}var Kt=null;function $t(e,t,n,i){if(Kt=null,null!==(e=yr(e=Se(i))))if(null===(t=Ue(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Zt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Qe:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Yt=null,Jt=null,Qt=null;function en(){if(Qt)return Qt;var e,t,n=Jt,i=n.length,r="value"in Yt?Yt.value:Yt.textContent,s=r.length;for(e=0;e<i&&n[e]===r[e];e++);var o=i-e;for(t=1;t<=o&&n[i-t]===r[s-t];t++);return Qt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,i,r,s){for(var o in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return N(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),hn=N({},cn,{view:0,detail:0}),dn=sn(hn),pn=N({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),gn=sn(pn),fn=sn(N({},pn,{dataTransfer:0})),mn=sn(N({},hn,{relatedTarget:0})),vn=sn(N({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=N({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Cn=sn(yn),wn=sn(N({},cn,{data:0})),Sn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _n(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xn[e])&&!!t[e]}function Mn(){return _n}var En=N({},hn,{key:function(e){if(e.key){var t=Sn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?bn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Rn=sn(En),Tn=sn(N({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=sn(N({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mn})),An=sn(N({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Fn=N({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=sn(Fn),Ln=[9,13,27,32],In=u&&"CompositionEvent"in window,kn=null;u&&"documentMode"in document&&(kn=document.documentMode);var On=u&&"TextEvent"in window&&!kn,Nn=u&&(!In||kn&&8<kn&&11>=kn),Bn=String.fromCharCode(32),zn=!1;function Hn(e,t){switch(e){case"keyup":return-1!==Ln.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function jn(e,t,n,i){Ee(i),0<(t=qi(t,"onChange")).length&&(n=new un("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var qn=null,Xn=null;function Kn(e){Bi(e,0)}function $n(e){if(X(wr(e)))return e}function Zn(e,t){if("change"===e)return t}var Yn=!1;if(u){var Jn;if(u){var Qn="oninput"in document;if(!Qn){var ei=document.createElement("div");ei.setAttribute("oninput","return;"),Qn="function"===typeof ei.oninput}Jn=Qn}else Jn=!1;Yn=Jn&&(!document.documentMode||9<document.documentMode)}function ti(){qn&&(qn.detachEvent("onpropertychange",ni),Xn=qn=null)}function ni(e){if("value"===e.propertyName&&$n(Xn)){var t=[];jn(t,Xn,e,Se(e)),Fe(Kn,t)}}function ii(e,t,n){"focusin"===e?(ti(),Xn=n,(qn=t).attachEvent("onpropertychange",ni)):"focusout"===e&&ti()}function ri(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $n(Xn)}function si(e,t){if("click"===e)return $n(t)}function oi(e,t){if("input"===e||"change"===e)return $n(t)}var ai="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function li(e,t){if(ai(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!h.call(t,r)||!ai(e[r],t[r]))return!1}return!0}function ci(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ui(e,t){var n,i=ci(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ci(i)}}function hi(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hi(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function di(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function pi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function gi(e){var t=di(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&pi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=void 0===i.end?s:Math.min(i.end,r),!e.extend&&s>i&&(r=i,i=s,s=r),r=ui(n,s);var o=ui(n,i);r&&o&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fi=u&&"documentMode"in document&&11>=document.documentMode,mi=null,vi=null,yi=null,Ci=!1;function wi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;Ci||null==mi||mi!==K(i)||("selectionStart"in(i=mi)&&pi(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},yi&&li(yi,i)||(yi=i,0<(i=qi(vi,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=mi)))}function Si(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var bi={animationend:Si("Animation","AnimationEnd"),animationiteration:Si("Animation","AnimationIteration"),animationstart:Si("Animation","AnimationStart"),transitionend:Si("Transition","TransitionEnd")},xi={},_i={};function Mi(e){if(xi[e])return xi[e];if(!bi[e])return e;var t,n=bi[e];for(t in n)if(n.hasOwnProperty(t)&&t in _i)return xi[e]=n[t];return e}u&&(_i=document.createElement("div").style,"AnimationEvent"in window||(delete bi.animationend.animation,delete bi.animationiteration.animation,delete bi.animationstart.animation),"TransitionEvent"in window||delete bi.transitionend.transition);var Ei=Mi("animationend"),Ri=Mi("animationiteration"),Ti=Mi("animationstart"),Pi=Mi("transitionend"),Ai=new Map,Fi="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Di(e,t){Ai.set(e,t),l(t,[e])}for(var Li=0;Li<Fi.length;Li++){var Ii=Fi[Li];Di(Ii.toLowerCase(),"on"+(Ii[0].toUpperCase()+Ii.slice(1)))}Di(Ei,"onAnimationEnd"),Di(Ri,"onAnimationIteration"),Di(Ti,"onAnimationStart"),Di("dblclick","onDoubleClick"),Di("focusin","onFocus"),Di("focusout","onBlur"),Di(Pi,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ki="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Oi=new Set("cancel close invalid load scroll toggle".split(" ").concat(ki));function Ni(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,r,o,a,l,c){if(Ge.apply(this,arguments),Oe){if(!Oe)throw Error(s(198));var u=Ne;Oe=!1,Ne=null,Be||(Be=!0,ze=u)}}(i,t,void 0,e),e.currentTarget=null}function Bi(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;Ni(r,a,c),s=l}else for(o=0;o<i.length;o++){if(l=(a=i[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;Ni(r,a,c),s=l}}}if(Be)throw e=ze,Be=!1,ze=null,e}function zi(e,t){var n=t[fr];void 0===n&&(n=t[fr]=new Set);var i=e+"__bubble";n.has(i)||(Vi(t,e,2,!1),n.add(i))}function Hi(e,t,n){var i=0;t&&(i|=4),Vi(n,e,i,t)}var Gi="_reactListening"+Math.random().toString(36).slice(2);function Ui(e){if(!e[Gi]){e[Gi]=!0,o.forEach((function(t){"selectionchange"!==t&&(Oi.has(t)||Hi(t,!1,e),Hi(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Gi]||(t[Gi]=!0,Hi("selectionchange",!1,t))}}function Vi(e,t,n,i){switch(Zt(t)){case 1:var r=jt;break;case 4:r=qt;break;default:r=Xt}n=r.bind(null,t,n,e),r=void 0,!Le||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Wi(e,t,n,i,r){var s=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var o=i.tag;if(3===o||4===o){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===o)for(o=i.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;o=o.return}for(;null!==a;){if(null===(o=yr(a)))return;if(5===(l=o.tag)||6===l){i=s=o;continue e}a=a.parentNode}}i=i.return}Fe((function(){var i=s,r=Se(n),o=[];e:{var a=Ai.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Rn;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=gn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Pn;break;case Ei:case Ri:case Ti:l=vn;break;case Pi:l=An;break;case"scroll":l=dn;break;case"wheel":l=Dn;break;case"copy":case"cut":case"paste":l=Cn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Tn}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var p,g=i;null!==g;){var f=(p=g).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==d&&(null!=(f=De(g,d))&&u.push(ji(g,f,p)))),h)break;g=g.return}0<u.length&&(a=new l(a,c,null,n,r),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!yr(c)&&!c[gr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?yr(c):null)&&(c!==(h=Ue(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=gn,f="onMouseLeave",d="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(u=Tn,f="onPointerLeave",d="onPointerEnter",g="pointer"),h=null==l?a:wr(l),p=null==c?a:wr(c),(a=new u(f,g+"leave",l,n,r)).target=h,a.relatedTarget=p,f=null,yr(r)===i&&((u=new u(d,g+"enter",c,n,r)).target=p,u.relatedTarget=h,f=u),h=f,l&&c)e:{for(d=c,g=0,p=u=l;p;p=Xi(p))g++;for(p=0,f=d;f;f=Xi(f))p++;for(;0<g-p;)u=Xi(u),g--;for(;0<p-g;)d=Xi(d),p--;for(;g--;){if(u===d||null!==d&&u===d.alternate)break e;u=Xi(u),d=Xi(d)}u=null}else u=null;null!==l&&Ki(o,a,l,u,!1),null!==c&&null!==h&&Ki(o,h,c,u,!0)}if("select"===(l=(a=i?wr(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Zn;else if(Wn(a))if(Yn)m=oi;else{m=ri;var v=ii}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=si);switch(m&&(m=m(e,i))?jn(o,m,n,r):(v&&v(e,a,i),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=i?wr(i):window,e){case"focusin":(Wn(v)||"true"===v.contentEditable)&&(mi=v,vi=i,yi=null);break;case"focusout":yi=vi=mi=null;break;case"mousedown":Ci=!0;break;case"contextmenu":case"mouseup":case"dragend":Ci=!1,wi(o,n,r);break;case"selectionchange":if(fi)break;case"keydown":case"keyup":wi(o,n,r)}var y;if(In)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Un?Hn(e,n)&&(C="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(C="onCompositionStart");C&&(Nn&&"ko"!==n.locale&&(Un||"onCompositionStart"!==C?"onCompositionEnd"===C&&Un&&(y=en()):(Jt="value"in(Yt=r)?Yt.value:Yt.textContent,Un=!0)),0<(v=qi(i,C)).length&&(C=new wn(C,e,null,n,r),o.push({event:C,listeners:v}),y?C.data=y:null!==(y=Gn(n))&&(C.data=y))),(y=On?function(e,t){switch(e){case"compositionend":return Gn(t);case"keypress":return 32!==t.which?null:(zn=!0,Bn);case"textInput":return(e=t.data)===Bn&&zn?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!In&&Hn(e,t)?(e=en(),Qt=Jt=Yt=null,Un=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Nn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(i=qi(i,"onBeforeInput")).length&&(r=new wn("onBeforeInput","beforeinput",null,n,r),o.push({event:r,listeners:i}),r.data=y))}Bi(o,t)}))}function ji(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qi(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=De(e,n))&&i.unshift(ji(e,s,r)),null!=(s=De(e,t))&&i.push(ji(e,s,r))),e=e.return}return i}function Xi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Ki(e,t,n,i,r){for(var s=t._reactName,o=[];null!==n&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=De(n,s))&&o.unshift(ji(n,l,a)):r||null!=(l=De(n,s))&&o.push(ji(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var $i=/\r\n?/g,Zi=/\u0000|\uFFFD/g;function Yi(e){return("string"===typeof e?e:""+e).replace($i,"\n").replace(Zi,"")}function Ji(e,t,n){if(t=Yi(t),Yi(e)!==t&&n)throw Error(s(425))}function Qi(){}var er=null,tr=null;function nr(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ir="function"===typeof setTimeout?setTimeout:void 0,rr="function"===typeof clearTimeout?clearTimeout:void 0,sr="function"===typeof Promise?Promise:void 0,or="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sr?function(e){return sr.resolve(null).then(e).catch(ar)}:ir;function ar(e){setTimeout((function(){throw e}))}function lr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void Ut(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Ut(t)}function cr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ur(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hr=Math.random().toString(36).slice(2),dr="__reactFiber$"+hr,pr="__reactProps$"+hr,gr="__reactContainer$"+hr,fr="__reactEvents$"+hr,mr="__reactListeners$"+hr,vr="__reactHandles$"+hr;function yr(e){var t=e[dr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[gr]||n[dr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ur(e);null!==e;){if(n=e[dr])return n;e=ur(e)}return t}n=(e=n).parentNode}return null}function Cr(e){return!(e=e[dr]||e[gr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function Sr(e){return e[pr]||null}var br=[],xr=-1;function _r(e){return{current:e}}function Mr(e){0>xr||(e.current=br[xr],br[xr]=null,xr--)}function Er(e,t){xr++,br[xr]=e.current,e.current=t}var Rr={},Tr=_r(Rr),Pr=_r(!1),Ar=Rr;function Fr(e,t){var n=e.type.contextTypes;if(!n)return Rr;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Dr(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Lr(){Mr(Pr),Mr(Tr)}function Ir(e,t,n){if(Tr.current!==Rr)throw Error(s(168));Er(Tr,t),Er(Pr,n)}function kr(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(s(108,V(e)||"Unknown",r));return N({},n,i)}function Or(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Rr,Ar=Tr.current,Er(Tr,e),Er(Pr,Pr.current),!0}function Nr(e,t,n){var i=e.stateNode;if(!i)throw Error(s(169));n?(e=kr(e,t,Ar),i.__reactInternalMemoizedMergedChildContext=e,Mr(Pr),Mr(Tr),Er(Tr,e)):Mr(Pr),Er(Pr,n)}var Br=null,zr=!1,Hr=!1;function Gr(e){null===Br?Br=[e]:Br.push(e)}function Ur(){if(!Hr&&null!==Br){Hr=!0;var e=0,t=Ct;try{var n=Br;for(Ct=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Br=null,zr=!1}catch(r){throw null!==Br&&(Br=Br.slice(e+1)),Xe(Qe,Ur),r}finally{Ct=t,Hr=!1}}return null}var Vr=[],Wr=0,jr=null,qr=0,Xr=[],Kr=0,$r=null,Zr=1,Yr="";function Jr(e,t){Vr[Wr++]=qr,Vr[Wr++]=jr,jr=e,qr=t}function Qr(e,t,n){Xr[Kr++]=Zr,Xr[Kr++]=Yr,Xr[Kr++]=$r,$r=e;var i=Zr;e=Yr;var r=32-ot(i)-1;i&=~(1<<r),n+=1;var s=32-ot(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Zr=1<<32-ot(t)+r|n<<r|i,Yr=s+e}else Zr=1<<s|n<<r|i,Yr=e}function es(e){null!==e.return&&(Jr(e,1),Qr(e,1,0))}function ts(e){for(;e===jr;)jr=Vr[--Wr],Vr[Wr]=null,qr=Vr[--Wr],Vr[Wr]=null;for(;e===$r;)$r=Xr[--Kr],Xr[Kr]=null,Yr=Xr[--Kr],Xr[Kr]=null,Zr=Xr[--Kr],Xr[Kr]=null}var ns=null,is=null,rs=!1,ss=null;function os(e,t){var n=Dc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function as(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,is=cr(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,is=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==$r?{id:Zr,overflow:Yr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Dc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,is=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(rs){var t=is;if(t){var n=t;if(!as(e,t)){if(ls(e))throw Error(s(418));t=cr(n.nextSibling);var i=ns;t&&as(e,t)?os(i,n):(e.flags=-4097&e.flags|2,rs=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,rs=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function hs(e){if(e!==ns)return!1;if(!rs)return us(e),rs=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!nr(e.type,e.memoizedProps)),t&&(t=is)){if(ls(e))throw ds(),Error(s(418));for(;t;)os(e,t),t=cr(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){is=cr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}is=null}}else is=ns?cr(e.stateNode.nextSibling):null;return!0}function ds(){for(var e=is;e;)e=cr(e.nextSibling)}function ps(){is=ns=null,rs=!1}function gs(e){null===ss?ss=[e]:ss.push(e)}var fs=w.ReactCurrentBatchConfig;function ms(e,t){if(e&&e.defaultProps){for(var n in t=N({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var vs=_r(null),ys=null,Cs=null,ws=null;function Ss(){ws=Cs=ys=null}function bs(e){var t=vs.current;Mr(vs),e._currentValue=t}function xs(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function _s(e,t){ys=e,ws=Cs=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(wa=!0),e.firstContext=null)}function Ms(e){var t=e._currentValue;if(ws!==e)if(e={context:e,memoizedValue:t,next:null},null===Cs){if(null===ys)throw Error(s(308));Cs=e,ys.dependencies={lanes:0,firstContext:e}}else Cs=Cs.next=e;return t}var Es=null;function Rs(e){null===Es?Es=[e]:Es.push(e)}function Ts(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,Rs(t)):(n.next=r.next,r.next=n),t.interleaved=n,Ps(e,i)}function Ps(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var As=!1;function Fs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ds(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ls(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Is(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Pl)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Ps(e,n)}return null===(r=i.interleaved)?(t.next=t,Rs(i)):(t.next=r.next,r.next=t),i.interleaved=t,Ps(e,n)}function ks(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Os(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ns(e,t,n,i){var r=e.updateQueue;As=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=r.baseState;for(o=0,u=c=l=null,a=s;;){var d=a.lane,p=a.eventTime;if((i&d)===d){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=e,f=a;switch(d=t,p=n,f.tag){case 1:if("function"===typeof(g=f.payload)){h=g.call(p,h,d);break e}h=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null===(d="function"===typeof(g=f.payload)?g.call(p,h,d):g)||void 0===d)break e;h=N({},h,d);break e;case 2:As=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=r.effects)?r.effects=[a]:d.push(a))}else p={eventTime:p,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,o|=d;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(d=a).next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}if(null===u&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{o|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Nl|=o,e.lanes=o,e.memoizedState=h}}function Bs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(s(191,r));r.call(i)}}}var zs=(new i.Component).refs;function Hs(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:N({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Gs={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=tc(),r=nc(e),s=Ls(i,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Is(e,s,r))&&(ic(t,e,r,i),ks(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=tc(),r=nc(e),s=Ls(i,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Is(e,s,r))&&(ic(t,e,r,i),ks(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),i=nc(e),r=Ls(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Is(e,r,i))&&(ic(t,e,i,n),ks(t,e,i))}};function Us(e,t,n,i,r,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!li(n,i)||!li(r,s))}function Vs(e,t,n){var i=!1,r=Rr,s=t.contextType;return"object"===typeof s&&null!==s?s=Ms(s):(r=Dr(t)?Ar:Tr.current,s=(i=null!==(i=t.contextTypes)&&void 0!==i)?Fr(e,r):Rr),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Gs,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function Ws(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&Gs.enqueueReplaceState(t,t.state,null)}function js(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs=zs,Fs(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=Ms(s):(s=Dr(t)?Ar:Tr.current,r.context=Fr(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(Hs(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&Gs.enqueueReplaceState(r,r.state,null),Ns(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}function qs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var i=n.stateNode}if(!i)throw Error(s(147,e));var r=i,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=r.refs;t===zs&&(t=r.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function Xs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ks(e){return(0,e._init)(e._payload)}function $s(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Ic(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Bc(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,i){var s=n.type;return s===x?h(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===D&&Ks(s)===t.type)?((i=r(t,n.props)).ref=qs(e,t,n),i.return=e,i):((i=kc(n.type,n.key,n.props,null,e.mode,i)).ref=qs(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=zc(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function h(e,t,n,i,s){return null===t||7!==t.tag?((t=Oc(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Bc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case S:return(n=kc(t.type,t.key,t.props,null,e.mode,n)).ref=qs(e,null,t),n.return=e,n;case b:return(t=zc(t,e.mode,n)).return=e,t;case D:return d(e,(0,t._init)(t._payload),n)}if(te(t)||k(t))return(t=Oc(t,e.mode,n,null)).return=e,t;Xs(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:l(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case S:return n.key===r?c(e,t,n,i):null;case b:return n.key===r?u(e,t,n,i):null;case D:return p(e,t,(r=n._init)(n._payload),i)}if(te(n)||k(n))return null!==r?null:h(e,t,n,i,null);Xs(e,n)}return null}function g(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case S:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case b:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case D:return g(e,t,n,(0,i._init)(i._payload),r)}if(te(i)||k(i))return h(t,e=e.get(n)||null,i,r,null);Xs(t,i)}return null}function f(r,s,a,l){for(var c=null,u=null,h=s,f=s=0,m=null;null!==h&&f<a.length;f++){h.index>f?(m=h,h=null):m=h.sibling;var v=p(r,h,a[f],l);if(null===v){null===h&&(h=m);break}e&&h&&null===v.alternate&&t(r,h),s=o(v,s,f),null===u?c=v:u.sibling=v,u=v,h=m}if(f===a.length)return n(r,h),rs&&Jr(r,f),c;if(null===h){for(;f<a.length;f++)null!==(h=d(r,a[f],l))&&(s=o(h,s,f),null===u?c=h:u.sibling=h,u=h);return rs&&Jr(r,f),c}for(h=i(r,h);f<a.length;f++)null!==(m=g(h,r,f,a[f],l))&&(e&&null!==m.alternate&&h.delete(null===m.key?f:m.key),s=o(m,s,f),null===u?c=m:u.sibling=m,u=m);return e&&h.forEach((function(e){return t(r,e)})),rs&&Jr(r,f),c}function m(r,a,l,c){var u=k(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,f=a,m=a=0,v=null,y=l.next();null!==f&&!y.done;m++,y=l.next()){f.index>m?(v=f,f=null):v=f.sibling;var C=p(r,f,y.value,c);if(null===C){null===f&&(f=v);break}e&&f&&null===C.alternate&&t(r,f),a=o(C,a,m),null===h?u=C:h.sibling=C,h=C,f=v}if(y.done)return n(r,f),rs&&Jr(r,m),u;if(null===f){for(;!y.done;m++,y=l.next())null!==(y=d(r,y.value,c))&&(a=o(y,a,m),null===h?u=y:h.sibling=y,h=y);return rs&&Jr(r,m),u}for(f=i(r,f);!y.done;m++,y=l.next())null!==(y=g(f,r,m,y.value,c))&&(e&&null!==y.alternate&&f.delete(null===y.key?m:y.key),a=o(y,a,m),null===h?u=y:h.sibling=y,h=y);return e&&f.forEach((function(e){return t(r,e)})),rs&&Jr(r,m),u}return function e(i,s,o,l){if("object"===typeof o&&null!==o&&o.type===x&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case S:e:{for(var c=o.key,u=s;null!==u;){if(u.key===c){if((c=o.type)===x){if(7===u.tag){n(i,u.sibling),(s=r(u,o.props.children)).return=i,i=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&Ks(c)===u.type){n(i,u.sibling),(s=r(u,o.props)).ref=qs(i,u,o),s.return=i,i=s;break e}n(i,u);break}t(i,u),u=u.sibling}o.type===x?((s=Oc(o.props.children,i.mode,l,o.key)).return=i,i=s):((l=kc(o.type,o.key,o.props,null,i.mode,l)).ref=qs(i,s,o),l.return=i,i=l)}return a(i);case b:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(i,s.sibling),(s=r(s,o.children||[])).return=i,i=s;break e}n(i,s);break}t(i,s),s=s.sibling}(s=zc(o,i.mode,l)).return=i,i=s}return a(i);case D:return e(i,s,(u=o._init)(o._payload),l)}if(te(o))return f(i,s,o,l);if(k(o))return m(i,s,o,l);Xs(i,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,o)).return=i,i=s):(n(i,s),(s=Bc(o,i.mode,l)).return=i,i=s),a(i)):n(i,s)}}var Zs=$s(!0),Ys=$s(!1),Js={},Qs=_r(Js),eo=_r(Js),to=_r(Js);function no(e){if(e===Js)throw Error(s(174));return e}function io(e,t){switch(Er(to,t),Er(eo,e),Er(Qs,Js),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Mr(Qs),Er(Qs,t)}function ro(){Mr(Qs),Mr(eo),Mr(to)}function so(e){no(to.current);var t=no(Qs.current),n=le(t,e.type);t!==n&&(Er(eo,e),Er(Qs,n))}function oo(e){eo.current===e&&(Mr(Qs),Mr(eo))}var ao=_r(0);function lo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var co=[];function uo(){for(var e=0;e<co.length;e++)co[e]._workInProgressVersionPrimary=null;co.length=0}var ho=w.ReactCurrentDispatcher,po=w.ReactCurrentBatchConfig,go=0,fo=null,mo=null,vo=null,yo=!1,Co=!1,wo=0,So=0;function bo(){throw Error(s(321))}function xo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ai(e[n],t[n]))return!1;return!0}function _o(e,t,n,i,r,o){if(go=o,fo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ho.current=null===e||null===e.memoizedState?aa:la,e=n(i,r),Co){o=0;do{if(Co=!1,wo=0,25<=o)throw Error(s(301));o+=1,vo=mo=null,t.updateQueue=null,ho.current=ca,e=n(i,r)}while(Co)}if(ho.current=oa,t=null!==mo&&null!==mo.next,go=0,vo=mo=fo=null,yo=!1,t)throw Error(s(300));return e}function Mo(){var e=0!==wo;return wo=0,e}function Eo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===vo?fo.memoizedState=vo=e:vo=vo.next=e,vo}function Ro(){if(null===mo){var e=fo.alternate;e=null!==e?e.memoizedState:null}else e=mo.next;var t=null===vo?fo.memoizedState:vo.next;if(null!==t)vo=t,mo=e;else{if(null===e)throw Error(s(310));e={memoizedState:(mo=e).memoizedState,baseState:mo.baseState,baseQueue:mo.baseQueue,queue:mo.queue,next:null},null===vo?fo.memoizedState=vo=e:vo=vo.next=e}return vo}function To(e,t){return"function"===typeof t?t(e):t}function Po(e){var t=Ro(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=mo,r=i.baseQueue,o=n.pending;if(null!==o){if(null!==r){var a=r.next;r.next=o.next,o.next=a}i.baseQueue=r=o,n.pending=null}if(null!==r){o=r.next,i=i.baseState;var l=a=null,c=null,u=o;do{var h=u.lane;if((go&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=i):c=c.next=d,fo.lanes|=h,Nl|=h}u=u.next}while(null!==u&&u!==o);null===c?a=i:c.next=l,ai(i,t.memoizedState)||(wa=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{o=r.lane,fo.lanes|=o,Nl|=o,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ao(e){var t=Ro(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,o=t.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{o=e(o,a.action),a=a.next}while(a!==r);ai(o,t.memoizedState)||(wa=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function Fo(){}function Do(e,t){var n=fo,i=Ro(),r=t(),o=!ai(i.memoizedState,r);if(o&&(i.memoizedState=r,wa=!0),i=i.queue,Wo(ko.bind(null,n,i,e),[e]),i.getSnapshot!==t||o||null!==vo&&1&vo.memoizedState.tag){if(n.flags|=2048,zo(9,Io.bind(null,n,i,r,t),void 0,null),null===Al)throw Error(s(349));0!==(30&go)||Lo(n,t,r)}return r}function Lo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=fo.updateQueue)?(t={lastEffect:null,stores:null},fo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Io(e,t,n,i){t.value=n,t.getSnapshot=i,Oo(t)&&No(e)}function ko(e,t,n){return n((function(){Oo(t)&&No(e)}))}function Oo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ai(e,n)}catch(i){return!0}}function No(e){var t=Ps(e,1);null!==t&&ic(t,e,1,-1)}function Bo(e){var t=Eo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:To,lastRenderedState:e},t.queue=e,e=e.dispatch=na.bind(null,fo,e),[t.memoizedState,e]}function zo(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=fo.updateQueue)?(t={lastEffect:null,stores:null},fo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Ho(){return Ro().memoizedState}function Go(e,t,n,i){var r=Eo();fo.flags|=e,r.memoizedState=zo(1|t,n,void 0,void 0===i?null:i)}function Uo(e,t,n,i){var r=Ro();i=void 0===i?null:i;var s=void 0;if(null!==mo){var o=mo.memoizedState;if(s=o.destroy,null!==i&&xo(i,o.deps))return void(r.memoizedState=zo(t,n,s,i))}fo.flags|=e,r.memoizedState=zo(1|t,n,s,i)}function Vo(e,t){return Go(8390656,8,e,t)}function Wo(e,t){return Uo(2048,8,e,t)}function jo(e,t){return Uo(4,2,e,t)}function qo(e,t){return Uo(4,4,e,t)}function Xo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ko(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Uo(4,4,Xo.bind(null,t,e),n)}function $o(){}function Zo(e,t){var n=Ro();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&xo(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Yo(e,t){var n=Ro();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&xo(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Jo(e,t,n){return 0===(21&go)?(e.baseState&&(e.baseState=!1,wa=!0),e.memoizedState=n):(ai(n,t)||(n=ft(),fo.lanes|=n,Nl|=n,e.baseState=!0),t)}function Qo(e,t){var n=Ct;Ct=0!==n&&4>n?n:4,e(!0);var i=po.transition;po.transition={};try{e(!1),t()}finally{Ct=n,po.transition=i}}function ea(){return Ro().memoizedState}function ta(e,t,n){var i=nc(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},ia(e))ra(t,n);else if(null!==(n=Ts(e,t,n,i))){ic(n,e,i,tc()),sa(n,t,i)}}function na(e,t,n){var i=nc(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(ia(e))ra(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,ai(a,o)){var l=t.interleaved;return null===l?(r.next=r,Rs(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(c){}null!==(n=Ts(e,t,r,i))&&(ic(n,e,i,r=tc()),sa(n,t,i))}}function ia(e){var t=e.alternate;return e===fo||null!==t&&t===fo}function ra(e,t){Co=yo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function sa(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,yt(e,n)}}var oa={readContext:Ms,useCallback:bo,useContext:bo,useEffect:bo,useImperativeHandle:bo,useInsertionEffect:bo,useLayoutEffect:bo,useMemo:bo,useReducer:bo,useRef:bo,useState:bo,useDebugValue:bo,useDeferredValue:bo,useTransition:bo,useMutableSource:bo,useSyncExternalStore:bo,useId:bo,unstable_isNewReconciler:!1},aa={readContext:Ms,useCallback:function(e,t){return Eo().memoizedState=[e,void 0===t?null:t],e},useContext:Ms,useEffect:Vo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Go(4194308,4,Xo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Go(4194308,4,e,t)},useInsertionEffect:function(e,t){return Go(4,2,e,t)},useMemo:function(e,t){var n=Eo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=Eo();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=ta.bind(null,fo,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},Eo().memoizedState=e},useState:Bo,useDebugValue:$o,useDeferredValue:function(e){return Eo().memoizedState=e},useTransition:function(){var e=Bo(!1),t=e[0];return e=Qo.bind(null,e[1]),Eo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=fo,r=Eo();if(rs){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Al)throw Error(s(349));0!==(30&go)||Lo(i,t,n)}r.memoizedState=n;var o={value:n,getSnapshot:t};return r.queue=o,Vo(ko.bind(null,i,o,e),[e]),i.flags|=2048,zo(9,Io.bind(null,i,o,n,t),void 0,null),n},useId:function(){var e=Eo(),t=Al.identifierPrefix;if(rs){var n=Yr;t=":"+t+"R"+(n=(Zr&~(1<<32-ot(Zr)-1)).toString(32)+n),0<(n=wo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=So++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},la={readContext:Ms,useCallback:Zo,useContext:Ms,useEffect:Wo,useImperativeHandle:Ko,useInsertionEffect:jo,useLayoutEffect:qo,useMemo:Yo,useReducer:Po,useRef:Ho,useState:function(){return Po(To)},useDebugValue:$o,useDeferredValue:function(e){return Jo(Ro(),mo.memoizedState,e)},useTransition:function(){return[Po(To)[0],Ro().memoizedState]},useMutableSource:Fo,useSyncExternalStore:Do,useId:ea,unstable_isNewReconciler:!1},ca={readContext:Ms,useCallback:Zo,useContext:Ms,useEffect:Wo,useImperativeHandle:Ko,useInsertionEffect:jo,useLayoutEffect:qo,useMemo:Yo,useReducer:Ao,useRef:Ho,useState:function(){return Ao(To)},useDebugValue:$o,useDeferredValue:function(e){var t=Ro();return null===mo?t.memoizedState=e:Jo(t,mo.memoizedState,e)},useTransition:function(){return[Ao(To)[0],Ro().memoizedState]},useMutableSource:Fo,useSyncExternalStore:Do,useId:ea,unstable_isNewReconciler:!1};function ua(e,t){try{var n="",i=t;do{n+=G(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r,digest:null}}function ha(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function da(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var pa="function"===typeof WeakMap?WeakMap:Map;function ga(e,t,n){(n=Ls(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){jl||(jl=!0,ql=i),da(0,t)},n}function fa(e,t,n){(n=Ls(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){da(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){da(0,t),"function"!==typeof i&&(null===Xl?Xl=new Set([this]):Xl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new pa;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=Ec.bind(null,e,t,n),t.then(e,e))}function va(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ya(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ls(-1,1)).tag=2,Is(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}var Ca=w.ReactCurrentOwner,wa=!1;function Sa(e,t,n,i){t.child=null===e?Ys(t,null,n,i):Zs(t,e.child,n,i)}function ba(e,t,n,i,r){n=n.render;var s=t.ref;return _s(t,r),i=_o(e,t,n,i,s,r),n=Mo(),null===e||wa?(rs&&n&&es(t),t.flags|=1,Sa(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,ja(e,t,r))}function xa(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||Lc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=kc(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,_a(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:li)(o,i)&&e.ref===t.ref)return ja(e,t,r)}return t.flags|=1,(e=Ic(s,i)).ref=t.ref,e.return=t,t.child=e}function _a(e,t,n,i,r){if(null!==e){var s=e.memoizedProps;if(li(s,i)&&e.ref===t.ref){if(wa=!1,t.pendingProps=i=s,0===(e.lanes&r))return t.lanes=e.lanes,ja(e,t,r);0!==(131072&e.flags)&&(wa=!0)}}return Ra(e,t,n,i,r)}function Ma(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Er(Il,Ll),Ll|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Er(Il,Ll),Ll|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==s?s.baseLanes:n,Er(Il,Ll),Ll|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,Er(Il,Ll),Ll|=i;return Sa(e,t,r,n),t.child}function Ea(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ra(e,t,n,i,r){var s=Dr(n)?Ar:Tr.current;return s=Fr(t,s),_s(t,r),n=_o(e,t,n,i,s,r),i=Mo(),null===e||wa?(rs&&i&&es(t),t.flags|=1,Sa(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,ja(e,t,r))}function Ta(e,t,n,i,r){if(Dr(n)){var s=!0;Or(t)}else s=!1;if(_s(t,r),null===t.stateNode)Wa(e,t),Vs(t,n,i),js(t,n,i,r),i=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ms(c):c=Fr(t,c=Dr(n)?Ar:Tr.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==i||l!==c)&&Ws(t,o,i,c),As=!1;var d=t.memoizedState;o.state=d,Ns(t,i,o,r),l=t.memoizedState,a!==i||d!==l||Pr.current||As?("function"===typeof u&&(Hs(t,n,u,i),l=t.memoizedState),(a=As||Us(t,n,a,i,d,l,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,Ds(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:ms(t.type,a),o.props=c,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ms(l):l=Fr(t,l=Dr(n)?Ar:Tr.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==l)&&Ws(t,o,i,l),As=!1,d=t.memoizedState,o.state=d,Ns(t,i,o,r);var g=t.memoizedState;a!==h||d!==g||Pr.current||As?("function"===typeof p&&(Hs(t,n,p,i),g=t.memoizedState),(c=As||Us(t,n,c,i,d,g,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(i,g,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,g,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=g),o.props=i,o.state=g,o.context=l,i=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return Pa(e,t,n,i,s,r)}function Pa(e,t,n,i,r,s){Ea(e,t);var o=0!==(128&t.flags);if(!i&&!o)return r&&Nr(t,n,!1),ja(e,t,s);i=t.stateNode,Ca.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&o?(t.child=Zs(t,e.child,null,s),t.child=Zs(t,null,a,s)):Sa(e,t,a,s),t.memoizedState=i.state,r&&Nr(t,n,!0),t.child}function Aa(e){var t=e.stateNode;t.pendingContext?Ir(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ir(0,t.context,!1),io(e,t.containerInfo)}function Fa(e,t,n,i,r){return ps(),gs(r),t.flags|=256,Sa(e,t,n,i),t.child}var Da,La,Ia,ka,Oa={dehydrated:null,treeContext:null,retryLane:0};function Na(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ba(e,t,n){var i,r=t.pendingProps,o=ao.current,a=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&o)),i?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Er(ao,1&o),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=r.children,e=r.fallback,a?(r=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Nc(l,r,0,null),e=Oc(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Na(n),t.memoizedState=Oa,e):za(t,l));if(null!==(o=e.memoizedState)&&null!==(i=o.dehydrated))return function(e,t,n,i,r,o,a){if(n)return 256&t.flags?(t.flags&=-257,Ha(e,t,a,i=ha(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=i.fallback,r=t.mode,i=Nc({mode:"visible",children:i.children},r,0,null),(o=Oc(o,r,a,null)).flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,0!==(1&t.mode)&&Zs(t,e.child,null,a),t.child.memoizedState=Na(a),t.memoizedState=Oa,o);if(0===(1&t.mode))return Ha(e,t,a,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Ha(e,t,a,i=ha(o=Error(s(419)),i,void 0))}if(l=0!==(a&e.childLanes),wa||l){if(null!==(i=Al)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!==(r&(i.suspendedLanes|a))?0:r)&&r!==o.retryLane&&(o.retryLane=r,Ps(e,r),ic(i,e,r,-1))}return mc(),Ha(e,t,a,i=ha(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Tc.bind(null,e),r._reactRetry=t,null):(e=o.treeContext,is=cr(r.nextSibling),ns=t,rs=!0,ss=null,null!==e&&(Xr[Kr++]=Zr,Xr[Kr++]=Yr,Xr[Kr++]=$r,Zr=e.id,Yr=e.overflow,$r=t),t=za(t,i.children),t.flags|=4096,t)}(e,t,l,r,i,o,n);if(a){a=r.fallback,l=t.mode,i=(o=e.child).sibling;var c={mode:"hidden",children:r.children};return 0===(1&l)&&t.child!==o?((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null):(r=Ic(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==i?a=Ic(i,a):(a=Oc(a,l,n,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,l=null===(l=e.child.memoizedState)?Na(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Oa,r}return e=(a=e.child).sibling,r=Ic(a,{mode:"visible",children:r.children}),0===(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function za(e,t){return(t=Nc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ha(e,t,n,i){return null!==i&&gs(i),Zs(t,e.child,null,n),(e=za(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ga(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),xs(e.return,t,n)}function Ua(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function Va(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(Sa(e,t,i.children,n),0!==(2&(i=ao.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ga(e,n,t);else if(19===e.tag)Ga(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Er(ao,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===lo(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Ua(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===lo(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Ua(t,!0,n,null,s);break;case"together":Ua(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wa(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ja(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Nl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Ic(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ic(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function qa(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Xa(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Ka(e,t,n){var i=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xa(t),null;case 1:case 17:return Dr(t.type)&&Lr(),Xa(t),null;case 3:return i=t.stateNode,ro(),Mr(Pr),Mr(Tr),uo(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(ac(ss),ss=null))),La(e,t),Xa(t),null;case 5:oo(t);var r=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Ia(e,t,n,i,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(s(166));return Xa(t),null}if(e=no(Qs.current),hs(t)){i=t.stateNode,n=t.type;var o=t.memoizedProps;switch(i[dr]=t,i[pr]=o,e=0!==(1&t.mode),n){case"dialog":zi("cancel",i),zi("close",i);break;case"iframe":case"object":case"embed":zi("load",i);break;case"video":case"audio":for(r=0;r<ki.length;r++)zi(ki[r],i);break;case"source":zi("error",i);break;case"img":case"image":case"link":zi("error",i),zi("load",i);break;case"details":zi("toggle",i);break;case"input":Z(i,o),zi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},zi("invalid",i);break;case"textarea":re(i,o),zi("invalid",i)}for(var l in ye(n,o),r=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==o.suppressHydrationWarning&&Ji(i.textContent,c,e),r=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Ji(i.textContent,c,e),r=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&zi("scroll",i)}switch(n){case"input":q(i),Q(i,o,!0);break;case"textarea":q(i),oe(i);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(i.onclick=Qi)}i=r,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[dr]=t,e[pr]=i,Da(e,t,!1,!1),t.stateNode=e;e:{switch(l=Ce(n,i),n){case"dialog":zi("cancel",e),zi("close",e),r=i;break;case"iframe":case"object":case"embed":zi("load",e),r=i;break;case"video":case"audio":for(r=0;r<ki.length;r++)zi(ki[r],e);r=i;break;case"source":zi("error",e),r=i;break;case"img":case"image":case"link":zi("error",e),zi("load",e),r=i;break;case"details":zi("toggle",e),r=i;break;case"input":Z(e,i),r=$(e,i),zi("invalid",e);break;case"option":default:r=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},r=N({},i,{value:void 0}),zi("invalid",e);break;case"textarea":re(e,i),r=ie(e,i),zi("invalid",e)}for(o in ye(n,r),c=r)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?me(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&zi("scroll",e):null!=u&&C(e,o,u,l))}switch(n){case"input":q(e),Q(e,i,!1);break;case"textarea":q(e),oe(e);break;case"option":null!=i.value&&e.setAttribute("value",""+W(i.value));break;case"select":e.multiple=!!i.multiple,null!=(o=i.value)?ne(e,!!i.multiple,o,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof r.onClick&&(e.onclick=Qi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Xa(t),null;case 6:if(e&&null!=t.stateNode)ka(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(s(166));if(n=no(to.current),no(Qs.current),hs(t)){if(i=t.stateNode,n=t.memoizedProps,i[dr]=t,(o=i.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Ji(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ji(i.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[dr]=t,t.stateNode=i}return Xa(t),null;case 13:if(Mr(ao),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(rs&&null!==is&&0!==(1&t.mode)&&0===(128&t.flags))ds(),ps(),t.flags|=98560,o=!1;else if(o=hs(t),null!==i&&null!==i.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[dr]=t}else ps(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Xa(t),o=!1}else null!==ss&&(ac(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ao.current)?0===kl&&(kl=3):mc())),null!==t.updateQueue&&(t.flags|=4),Xa(t),null);case 4:return ro(),La(e,t),null===e&&Ui(t.stateNode.containerInfo),Xa(t),null;case 10:return bs(t.type._context),Xa(t),null;case 19:if(Mr(ao),null===(o=t.memoizedState))return Xa(t),null;if(i=0!==(128&t.flags),null===(l=o.rendering))if(i)qa(o,!1);else{if(0!==kl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=lo(e))){for(t.flags|=128,qa(o,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Er(ao,1&ao.current|2),t.child}e=e.sibling}null!==o.tail&&Ye()>Vl&&(t.flags|=128,i=!0,qa(o,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=lo(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),qa(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!rs)return Xa(t),null}else 2*Ye()-o.renderingStartTime>Vl&&1073741824!==n&&(t.flags|=128,i=!0,qa(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ye(),t.sibling=null,n=ao.current,Er(ao,i?1&n|2:1&n),t):(Xa(t),null);case 22:case 23:return dc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Ll)&&(Xa(t),6&t.subtreeFlags&&(t.flags|=8192)):Xa(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function $a(e,t){switch(ts(t),t.tag){case 1:return Dr(t.type)&&Lr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ro(),Mr(Pr),Mr(Tr),uo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Mr(ao),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ps()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Mr(ao),null;case 4:return ro(),null;case 10:return bs(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Da=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},La=function(){},Ia=function(e,t,n,i){var r=e.memoizedProps;if(r!==i){e=t.stateNode,no(Qs.current);var s,o=null;switch(n){case"input":r=$(e,r),i=$(e,i),o=[];break;case"select":r=N({},r,{value:void 0}),i=N({},i,{value:void 0}),o=[];break;case"textarea":r=ie(e,r),i=ie(e,i),o=[];break;default:"function"!==typeof r.onClick&&"function"===typeof i.onClick&&(e.onclick=Qi)}for(u in ye(n,i),n=null,r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=r?r[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&zi("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},ka=function(e,t,n,i){n!==i&&(t.flags|=4)};var Za=!1,Ya=!1,Ja="function"===typeof WeakSet?WeakSet:Set,Qa=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){Mc(e,t,i)}else n.current=null}function tl(e,t,n){try{n()}catch(i){Mc(e,t,i)}}var nl=!1;function il(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&tl(t,n,s)}r=r.next}while(r!==i)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[dr],delete t[pr],delete t[fr],delete t[mr],delete t[vr])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Qi));else if(4!==i&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function ul(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var hl=null,dl=!1;function pl(e,t,n){for(n=n.child;null!==n;)gl(e,t,n),n=n.sibling}function gl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,n)}catch(a){}switch(n.tag){case 5:Ya||el(n,t);case 6:var i=hl,r=dl;hl=null,pl(e,t,n),dl=r,null!==(hl=i)&&(dl?(e=hl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):hl.removeChild(n.stateNode));break;case 18:null!==hl&&(dl?(e=hl,n=n.stateNode,8===e.nodeType?lr(e.parentNode,n):1===e.nodeType&&lr(e,n),Ut(e)):lr(hl,n.stateNode));break;case 4:i=hl,r=dl,hl=n.stateNode.containerInfo,dl=!0,pl(e,t,n),hl=i,dl=r;break;case 0:case 11:case 14:case 15:if(!Ya&&(null!==(i=n.updateQueue)&&null!==(i=i.lastEffect))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&tl(n,t,o),r=r.next}while(r!==i)}pl(e,t,n);break;case 1:if(!Ya&&(el(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Mc(n,t,a)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?(Ya=(i=Ya)||null!==n.memoizedState,pl(e,t,n),Ya=i):pl(e,t,n);break;default:pl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ja),t.forEach((function(t){var i=Pc.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:hl=l.stateNode,dl=!1;break e;case 3:case 4:hl=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===hl)throw Error(s(160));gl(o,a,r),hl=null,dl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(u){Mc(r,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vl(t,e),t=t.sibling}function vl(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&i){try{il(3,e,e.return),rl(3,e)}catch(m){Mc(e,e.return,m)}try{il(5,e,e.return)}catch(m){Mc(e,e.return,m)}}break;case 1:ml(t,e),yl(e),512&i&&null!==n&&el(n,n.return);break;case 5:if(ml(t,e),yl(e),512&i&&null!==n&&el(n,n.return),32&e.flags){var r=e.stateNode;try{de(r,"")}catch(m){Mc(e,e.return,m)}}if(4&i&&null!=(r=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&Y(r,o),Ce(l,a);var u=Ce(l,o);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];"style"===h?me(r,d):"dangerouslySetInnerHTML"===h?he(r,d):"children"===h?de(r,d):C(r,h,d,u)}switch(l){case"input":J(r,o);break;case"textarea":se(r,o);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var g=o.value;null!=g?ne(r,!!o.multiple,g,!1):p!==!!o.multiple&&(null!=o.defaultValue?ne(r,!!o.multiple,o.defaultValue,!0):ne(r,!!o.multiple,o.multiple?[]:"",!1))}r[pr]=o}catch(m){Mc(e,e.return,m)}}break;case 6:if(ml(t,e),yl(e),4&i){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,o=e.memoizedProps;try{r.nodeValue=o}catch(m){Mc(e,e.return,m)}}break;case 3:if(ml(t,e),yl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(m){Mc(e,e.return,m)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(r=e.child).flags&&(o=null!==r.memoizedState,r.stateNode.isHidden=o,!o||null!==r.alternate&&null!==r.alternate.memoizedState||(Ul=Ye())),4&i&&fl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ya=(u=Ya)||h,ml(t,e),Ya=u):ml(t,e),yl(e),8192&i){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Qa=e,h=e.child;null!==h;){for(d=Qa=h;null!==Qa;){switch(g=(p=Qa).child,p.tag){case 0:case 11:case 14:case 15:il(4,p,p.return);break;case 1:el(p,p.return);var f=p.stateNode;if("function"===typeof f.componentWillUnmount){i=p,n=p.return;try{t=i,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(m){Mc(i,n,m)}}break;case 5:el(p,p.return);break;case 22:if(null!==p.memoizedState){bl(d);continue}}null!==g?(g.return=p,Qa=g):bl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{r=d.stateNode,u?"function"===typeof(o=r.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,a=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=fe("display",a))}catch(m){Mc(e,e.return,m)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){Mc(e,e.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(t,e),yl(e),4&i&&fl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var i=n;break e}n=n.return}throw Error(s(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(de(r,""),i.flags&=-33),ul(e,ll(e),r);break;case 3:case 4:var o=i.stateNode.containerInfo;cl(e,ll(e),o);break;default:throw Error(s(161))}}catch(a){Mc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Cl(e,t,n){Qa=e,wl(e,t,n)}function wl(e,t,n){for(var i=0!==(1&e.mode);null!==Qa;){var r=Qa,s=r.child;if(22===r.tag&&i){var o=null!==r.memoizedState||Za;if(!o){var a=r.alternate,l=null!==a&&null!==a.memoizedState||Ya;a=Za;var c=Ya;if(Za=o,(Ya=l)&&!c)for(Qa=r;null!==Qa;)l=(o=Qa).child,22===o.tag&&null!==o.memoizedState?xl(r):null!==l?(l.return=o,Qa=l):xl(r);for(;null!==s;)Qa=s,wl(s,t,n),s=s.sibling;Qa=r,Za=a,Ya=c}Sl(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,Qa=s):Sl(e)}}function Sl(e){for(;null!==Qa;){var t=Qa;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ya||rl(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Ya)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:ms(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Bs(t,o,i);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Bs(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Ut(d)}}}break;default:throw Error(s(163))}Ya||512&t.flags&&sl(t)}catch(p){Mc(t,t.return,p)}}if(t===e){Qa=null;break}if(null!==(n=t.sibling)){n.return=t.return,Qa=n;break}Qa=t.return}}function bl(e){for(;null!==Qa;){var t=Qa;if(t===e){Qa=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Qa=n;break}Qa=t.return}}function xl(e){for(;null!==Qa;){var t=Qa;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Mc(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){Mc(t,r,l)}}var s=t.return;try{sl(t)}catch(l){Mc(t,s,l)}break;case 5:var o=t.return;try{sl(t)}catch(l){Mc(t,o,l)}}}catch(l){Mc(t,t.return,l)}if(t===e){Qa=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Qa=a;break}Qa=t.return}}var _l,Ml=Math.ceil,El=w.ReactCurrentDispatcher,Rl=w.ReactCurrentOwner,Tl=w.ReactCurrentBatchConfig,Pl=0,Al=null,Fl=null,Dl=0,Ll=0,Il=_r(0),kl=0,Ol=null,Nl=0,Bl=0,zl=0,Hl=null,Gl=null,Ul=0,Vl=1/0,Wl=null,jl=!1,ql=null,Xl=null,Kl=!1,$l=null,Zl=0,Yl=0,Jl=null,Ql=-1,ec=0;function tc(){return 0!==(6&Pl)?Ye():-1!==Ql?Ql:Ql=Ye()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Pl)&&0!==Dl?Dl&-Dl:null!==fs.transition?(0===ec&&(ec=ft()),ec):0!==(e=Ct)?e:e=void 0===(e=window.event)?16:Zt(e.type)}function ic(e,t,n,i){if(50<Yl)throw Yl=0,Jl=null,Error(s(185));vt(e,n,i),0!==(2&Pl)&&e===Al||(e===Al&&(0===(2&Pl)&&(Bl|=n),4===kl&&lc(e,Dl)),rc(e,i),1===n&&0===Pl&&0===(1&t.mode)&&(Vl=Ye()+500,zr&&Ur()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=r[o];-1===l?0!==(a&n)&&0===(a&i)||(r[o]=pt(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var i=dt(e,e===Al?Dl:0);if(0===i)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){zr=!0,Gr(e)}(cc.bind(null,e)):Gr(cc.bind(null,e)),or((function(){0===(6&Pl)&&Ur()})),n=null;else{switch(wt(i)){case 1:n=Qe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=it}n=Ac(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if(Ql=-1,ec=0,0!==(6&Pl))throw Error(s(327));var n=e.callbackNode;if(xc()&&e.callbackNode!==n)return null;var i=dt(e,e===Al?Dl:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=vc(e,i);else{t=i;var r=Pl;Pl|=2;var o=fc();for(Al===e&&Dl===t||(Wl=null,Vl=Ye()+500,pc(e,t));;)try{Cc();break}catch(l){gc(e,l)}Ss(),El.current=o,Pl=r,null!==Fl?t=0:(Al=null,Dl=0,t=kl)}if(0!==t){if(2===t&&(0!==(r=gt(e))&&(i=r,t=oc(e,r))),1===t)throw n=Ol,pc(e,0),lc(e,i),rc(e,Ye()),n;if(6===t)lc(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!ai(s(),r))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=vc(e,i))&&(0!==(o=gt(e))&&(i=o,t=oc(e,o))),1===t))throw n=Ol,pc(e,0),lc(e,i),rc(e,Ye()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(s(345));case 2:case 5:bc(e,Gl,Wl);break;case 3:if(lc(e,i),(130023424&i)===i&&10<(t=Ul+500-Ye())){if(0!==dt(e,0))break;if(((r=e.suspendedLanes)&i)!==i){tc(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=ir(bc.bind(null,e,Gl,Wl),t);break}bc(e,Gl,Wl);break;case 4:if(lc(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var a=31-ot(i);o=1<<a,(a=t[a])>r&&(r=a),i&=~o}if(i=r,10<(i=(120>(i=Ye()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Ml(i/1960))-i)){e.timeoutHandle=ir(bc.bind(null,e,Gl,Wl),i);break}bc(e,Gl,Wl);break;default:throw Error(s(329))}}}return rc(e,Ye()),e.callbackNode===n?sc.bind(null,e):null}function oc(e,t){var n=Hl;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=Gl,Gl=n,null!==t&&ac(t)),e}function ac(e){null===Gl?Gl=e:Gl.push.apply(Gl,e)}function lc(e,t){for(t&=~zl,t&=~Bl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),i=1<<n;e[n]=-1,t&=~i}}function cc(e){if(0!==(6&Pl))throw Error(s(327));xc();var t=dt(e,0);if(0===(1&t))return rc(e,Ye()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var i=gt(e);0!==i&&(t=i,n=oc(e,i))}if(1===n)throw n=Ol,pc(e,0),lc(e,t),rc(e,Ye()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bc(e,Gl,Wl),rc(e,Ye()),null}function uc(e,t){var n=Pl;Pl|=1;try{return e(t)}finally{0===(Pl=n)&&(Vl=Ye()+500,zr&&Ur())}}function hc(e){null!==$l&&0===$l.tag&&0===(6&Pl)&&xc();var t=Pl;Pl|=1;var n=Tl.transition,i=Ct;try{if(Tl.transition=null,Ct=1,e)return e()}finally{Ct=i,Tl.transition=n,0===(6&(Pl=t))&&Ur()}}function dc(){Ll=Il.current,Mr(Il)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,rr(n)),null!==Fl)for(n=Fl.return;null!==n;){var i=n;switch(ts(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Lr();break;case 3:ro(),Mr(Pr),Mr(Tr),uo();break;case 5:oo(i);break;case 4:ro();break;case 13:case 19:Mr(ao);break;case 10:bs(i.type._context);break;case 22:case 23:dc()}n=n.return}if(Al=e,Fl=e=Ic(e.current,null),Dl=Ll=t,kl=0,Ol=null,zl=Bl=Nl=0,Gl=Hl=null,null!==Es){for(t=0;t<Es.length;t++)if(null!==(i=(n=Es[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var o=s.next;s.next=r,i.next=o}n.pending=i}Es=null}return e}function gc(e,t){for(;;){var n=Fl;try{if(Ss(),ho.current=oa,yo){for(var i=fo.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}yo=!1}if(go=0,vo=mo=fo=null,Co=!1,wo=0,Rl.current=null,null===n||null===n.return){kl=1,Ol=t,Fl=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Dl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=va(a);if(null!==g){g.flags&=-257,ya(g,a,l,0,t),1&g.mode&&ma(o,u,t),c=u;var f=(t=g).updateQueue;if(null===f){var m=new Set;m.add(c),t.updateQueue=m}else f.add(c);break e}if(0===(1&t)){ma(o,u,t),mc();break e}c=Error(s(426))}else if(rs&&1&l.mode){var v=va(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),ya(v,a,l,0,t),gs(ua(c,l));break e}}o=c=ua(c,l),4!==kl&&(kl=2),null===Hl?Hl=[o]:Hl.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Os(o,ga(0,c,t));break e;case 1:l=c;var y=o.type,C=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==C&&"function"===typeof C.componentDidCatch&&(null===Xl||!Xl.has(C)))){o.flags|=65536,t&=-t,o.lanes|=t,Os(o,fa(o,l,t));break e}}o=o.return}while(null!==o)}Sc(n)}catch(w){t=w,Fl===n&&null!==n&&(Fl=n=n.return);continue}break}}function fc(){var e=El.current;return El.current=oa,null===e?oa:e}function mc(){0!==kl&&3!==kl&&2!==kl||(kl=4),null===Al||0===(268435455&Nl)&&0===(268435455&Bl)||lc(Al,Dl)}function vc(e,t){var n=Pl;Pl|=2;var i=fc();for(Al===e&&Dl===t||(Wl=null,pc(e,t));;)try{yc();break}catch(r){gc(e,r)}if(Ss(),Pl=n,El.current=i,null!==Fl)throw Error(s(261));return Al=null,Dl=0,kl}function yc(){for(;null!==Fl;)wc(Fl)}function Cc(){for(;null!==Fl&&!$e();)wc(Fl)}function wc(e){var t=_l(e.alternate,e,Ll);e.memoizedProps=e.pendingProps,null===t?Sc(e):Fl=t,Rl.current=null}function Sc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ka(n,t,Ll)))return void(Fl=n)}else{if(null!==(n=$a(n,t)))return n.flags&=32767,void(Fl=n);if(null===e)return kl=6,void(Fl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Fl=t);Fl=t=e}while(null!==t);0===kl&&(kl=5)}function bc(e,t,n){var i=Ct,r=Tl.transition;try{Tl.transition=null,Ct=1,function(e,t,n,i){do{xc()}while(null!==$l);if(0!==(6&Pl))throw Error(s(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-ot(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,o),e===Al&&(Fl=Al=null,Dl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,Ac(tt,(function(){return xc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Tl.transition,Tl.transition=null;var a=Ct;Ct=1;var l=Pl;Pl|=4,Rl.current=null,function(e,t){if(er=Wt,pi(e=di())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(S){n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,p=null;t:for(;;){for(var g;d!==n||0!==r&&3!==d.nodeType||(l=a+r),d!==o||0!==i&&3!==d.nodeType||(c=a+i),3===d.nodeType&&(a+=d.nodeValue.length),null!==(g=d.firstChild);)p=d,d=g;for(;;){if(d===e)break t;if(p===n&&++u===r&&(l=a),p===o&&++h===i&&(c=a),null!==(g=d.nextSibling))break;p=(d=p).parentNode}d=g}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(tr={focusedElem:e,selectionRange:n},Wt=!1,Qa=t;null!==Qa;)if(e=(t=Qa).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qa=e;else for(;null!==Qa;){t=Qa;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var m=f.memoizedProps,v=f.memoizedState,y=t.stateNode,C=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:ms(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=C}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(s(163))}}catch(S){Mc(t,t.return,S)}if(null!==(e=t.sibling)){e.return=t.return,Qa=e;break}Qa=t.return}f=nl,nl=!1}(e,n),vl(n,e),gi(tr),Wt=!!er,tr=er=null,e.current=n,Cl(n,e,r),Ze(),Pl=l,Ct=a,Tl.transition=o}else e.current=n;if(Kl&&(Kl=!1,$l=e,Zl=r),o=e.pendingLanes,0===o&&(Xl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Ye()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(jl)throw jl=!1,e=ql,ql=null,e;0!==(1&Zl)&&0!==e.tag&&xc(),o=e.pendingLanes,0!==(1&o)?e===Jl?Yl++:(Yl=0,Jl=e):Yl=0,Ur()}(e,t,n,i)}finally{Tl.transition=r,Ct=i}return null}function xc(){if(null!==$l){var e=wt(Zl),t=Tl.transition,n=Ct;try{if(Tl.transition=null,Ct=16>e?16:e,null===$l)var i=!1;else{if(e=$l,$l=null,Zl=0,0!==(6&Pl))throw Error(s(331));var r=Pl;for(Pl|=4,Qa=e.current;null!==Qa;){var o=Qa,a=o.child;if(0!==(16&Qa.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Qa=u;null!==Qa;){var h=Qa;switch(h.tag){case 0:case 11:case 15:il(8,h,o)}var d=h.child;if(null!==d)d.return=h,Qa=d;else for(;null!==Qa;){var p=(h=Qa).sibling,g=h.return;if(ol(h),h===u){Qa=null;break}if(null!==p){p.return=g,Qa=p;break}Qa=g}}}var f=o.alternate;if(null!==f){var m=f.child;if(null!==m){f.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}Qa=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Qa=a;else e:for(;null!==Qa;){if(0!==(2048&(o=Qa).flags))switch(o.tag){case 0:case 11:case 15:il(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Qa=y;break e}Qa=o.return}}var C=e.current;for(Qa=C;null!==Qa;){var w=(a=Qa).child;if(0!==(2064&a.subtreeFlags)&&null!==w)w.return=a,Qa=w;else e:for(a=C;null!==Qa;){if(0!==(2048&(l=Qa).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(b){Mc(l,l.return,b)}if(l===a){Qa=null;break e}var S=l.sibling;if(null!==S){S.return=l.return,Qa=S;break e}Qa=l.return}}if(Pl=r,Ur(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch(b){}i=!0}return i}finally{Ct=n,Tl.transition=t}}return!1}function _c(e,t,n){e=Is(e,t=ga(0,t=ua(n,t),1),1),t=tc(),null!==e&&(vt(e,1,t),rc(e,t))}function Mc(e,t,n){if(3===e.tag)_c(e,e,n);else for(;null!==t;){if(3===t.tag){_c(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===Xl||!Xl.has(i))){t=Is(t,e=fa(t,e=ua(n,e),1),1),e=tc(),null!==t&&(vt(t,1,e),rc(t,e));break}}t=t.return}}function Ec(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Al===e&&(Dl&n)===n&&(4===kl||3===kl&&(130023424&Dl)===Dl&&500>Ye()-Ul?pc(e,0):zl|=n),rc(e,t)}function Rc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=tc();null!==(e=Ps(e,t))&&(vt(e,t,n),rc(e,n))}function Tc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Rc(e,n)}function Pc(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(s(314))}null!==i&&i.delete(t),Rc(e,n)}function Ac(e,t){return Xe(e,t)}function Fc(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dc(e,t,n,i){return new Fc(e,t,n,i)}function Lc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ic(e,t){var n=e.alternate;return null===n?((n=Dc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function kc(e,t,n,i,r,o){var a=2;if(i=e,"function"===typeof e)Lc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case x:return Oc(n.children,r,o,t);case _:a=8,r|=8;break;case M:return(e=Dc(12,n,t,2|r)).elementType=M,e.lanes=o,e;case P:return(e=Dc(13,n,t,r)).elementType=P,e.lanes=o,e;case A:return(e=Dc(19,n,t,r)).elementType=A,e.lanes=o,e;case L:return Nc(n,r,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case E:a=10;break e;case R:a=9;break e;case T:a=11;break e;case F:a=14;break e;case D:a=16,i=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Dc(a,n,t,r)).elementType=e,t.type=i,t.lanes=o,t}function Oc(e,t,n,i){return(e=Dc(7,e,i,t)).lanes=n,e}function Nc(e,t,n,i){return(e=Dc(22,e,i,t)).elementType=L,e.lanes=n,e.stateNode={isHidden:!1},e}function Bc(e,t,n){return(e=Dc(6,e,null,t)).lanes=n,e}function zc(e,t,n){return(t=Dc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Hc(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Gc(e,t,n,i,r,s,o,a,l){return e=new Hc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Dc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fs(s),e}function Uc(e){if(!e)return Rr;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Dr(n))return kr(e,n,t)}return t}function Vc(e,t,n,i,r,s,o,a,l){return(e=Gc(n,i,!0,e,0,s,0,a,l)).context=Uc(null),n=e.current,(s=Ls(i=tc(),r=nc(n))).callback=void 0!==t&&null!==t?t:null,Is(n,s,r),e.current.lanes=r,vt(e,r,i),rc(e,i),e}function Wc(e,t,n,i){var r=t.current,s=tc(),o=nc(r);return n=Uc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ls(s,o)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=Is(r,t,o))&&(ic(e,r,o,s),ks(e,r,o)),o}function jc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Xc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}_l=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Pr.current)wa=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return wa=!1,function(e,t,n){switch(t.tag){case 3:Aa(t),ps();break;case 5:so(t);break;case 1:Dr(t.type)&&Or(t);break;case 4:io(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Er(vs,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Er(ao,1&ao.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ba(e,t,n):(Er(ao,1&ao.current),null!==(e=ja(e,t,n))?e.sibling:null);Er(ao,1&ao.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return Va(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Er(ao,ao.current),i)break;return null;case 22:case 23:return t.lanes=0,Ma(e,t,n)}return ja(e,t,n)}(e,t,n);wa=0!==(131072&e.flags)}else wa=!1,rs&&0!==(1048576&t.flags)&&Qr(t,qr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Wa(e,t),e=t.pendingProps;var r=Fr(t,Tr.current);_s(t,n),r=_o(null,t,i,e,r,n);var o=Mo();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dr(i)?(o=!0,Or(t)):o=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Fs(t),r.updater=Gs,t.stateNode=r,r._reactInternals=t,js(t,i,e,n),t=Pa(null,t,i,!0,o,n)):(t.tag=0,rs&&o&&es(t),Sa(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Wa(e,t),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Lc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===F)return 14}return 2}(i),e=ms(i,e),r){case 0:t=Ra(null,t,i,e,n);break e;case 1:t=Ta(null,t,i,e,n);break e;case 11:t=ba(null,t,i,e,n);break e;case 14:t=xa(null,t,i,ms(i.type,e),n);break e}throw Error(s(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Ra(e,t,i,r=t.elementType===i?r:ms(i,r),n);case 1:return i=t.type,r=t.pendingProps,Ta(e,t,i,r=t.elementType===i?r:ms(i,r),n);case 3:e:{if(Aa(t),null===e)throw Error(s(387));i=t.pendingProps,r=(o=t.memoizedState).element,Ds(e,t),Ns(t,i,null,n);var a=t.memoizedState;if(i=a.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Fa(e,t,i,n,r=ua(Error(s(423)),t));break e}if(i!==r){t=Fa(e,t,i,n,r=ua(Error(s(424)),t));break e}for(is=cr(t.stateNode.containerInfo.firstChild),ns=t,rs=!0,ss=null,n=Ys(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ps(),i===r){t=ja(e,t,n);break e}Sa(e,t,i,n)}t=t.child}return t;case 5:return so(t),null===e&&cs(t),i=t.type,r=t.pendingProps,o=null!==e?e.memoizedProps:null,a=r.children,nr(i,r)?a=null:null!==o&&nr(i,o)&&(t.flags|=32),Ea(e,t),Sa(e,t,a,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Ba(e,t,n);case 4:return io(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=Zs(t,null,i,n):Sa(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,ba(e,t,i,r=t.elementType===i?r:ms(i,r),n);case 7:return Sa(e,t,t.pendingProps,n),t.child;case 8:case 12:return Sa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,o=t.memoizedProps,a=r.value,Er(vs,i._currentValue),i._currentValue=a,null!==o)if(ai(o.value,a)){if(o.children===r.children&&!Pr.current){t=ja(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===o.tag){(c=Ls(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),xs(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),xs(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}Sa(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,_s(t,n),i=i(r=Ms(r)),t.flags|=1,Sa(e,t,i,n),t.child;case 14:return r=ms(i=t.type,t.pendingProps),xa(e,t,i,r=ms(i.type,r),n);case 15:return _a(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:ms(i,r),Wa(e,t),t.tag=1,Dr(i)?(e=!0,Or(t)):e=!1,_s(t,n),Vs(t,i,r),js(t,i,r,n),Pa(null,t,i,!0,e,n);case 19:return Va(e,t,n);case 22:return Ma(e,t,n)}throw Error(s(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function $c(e){this._internalRoot=e}function Zc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function eu(e,t,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof r){var a=r;r=function(){var e=jc(o);a.call(e)}}Wc(t,o,e,r)}else o=function(e,t,n,i,r){if(r){if("function"===typeof i){var s=i;i=function(){var e=jc(o);s.call(e)}}var o=Vc(t,i,e,0,null,!1,0,"",Qc);return e._reactRootContainer=o,e[gr]=o.current,Ui(8===e.nodeType?e.parentNode:e),hc(),o}for(;r=e.lastChild;)e.removeChild(r);if("function"===typeof i){var a=i;i=function(){var e=jc(l);a.call(e)}}var l=Gc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[gr]=l.current,Ui(8===e.nodeType?e.parentNode:e),hc((function(){Wc(t,l,n,i)})),l}(n,t,e,r,i);return jc(o)}Zc.prototype.render=$c.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Wc(e,t,null,null)},Zc.prototype.unmount=$c.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hc((function(){Wc(null,e,null,null)})),t[gr]=null}},Zc.prototype.unstable_scheduleHydration=function(e){if(e){var t=_t();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Lt.length&&0!==t&&t<Lt[n].priority;n++);Lt.splice(n,0,e),0===n&&Nt(e)}},St=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),rc(t,Ye()),0===(6&Pl)&&(Vl=Ye()+500,Ur()))}break;case 13:hc((function(){var t=Ps(e,1);if(null!==t){var n=tc();ic(t,e,1,n)}})),Xc(e,1)}},bt=function(e){if(13===e.tag){var t=Ps(e,134217728);if(null!==t)ic(t,e,134217728,tc());Xc(e,134217728)}},xt=function(e){if(13===e.tag){var t=nc(e),n=Ps(e,t);if(null!==n)ic(n,e,t,tc());Xc(e,t)}},_t=function(){return Ct},Mt=function(e,t){var n=Ct;try{return Ct=e,t()}finally{Ct=n}},be=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=Sr(i);if(!r)throw Error(s(90));X(i),J(i,r)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=uc,Pe=hc;var tu={usingClientEntryPoint:!1,Events:[Cr,wr,Sr,Ee,Re,uc]},nu={findFiberByHostInstance:yr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},iu={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=je(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{rt=ru.inject(iu),st=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(s(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:b,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(s(299));var n=!1,i="",r=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Gc(e,1,!1,null,0,n,0,i,r),e[gr]=t.current,Ui(8===e.nodeType?e.parentNode:e),new $c(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=je(t))?null:e.stateNode},t.flushSync=function(e){return hc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(s(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(s(405));var i=null!=n&&n.hydratedSources||null,r=!1,o="",a=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Vc(t,null,e,1,null!=n?n:null,r,0,o,a),e[gr]=t.current,Ui(e),i)for(e=0;e<i.length;e++)r=(r=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Zc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(s(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(s(40));return!!e._reactRootContainer&&(hc((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[gr]=null}))})),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Jc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return eu(e,t,n,!1,i)},t.version="18.2.0-next-9e3b772b8-20220608"},784:(e,t,n)=>{"use strict";e.exports=n(813)},813:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<s(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,o=r>>>1;i<o;){var a=2*(i+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<r&&0>s(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<r&&0>s(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,p=3,g=!1,f=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,C="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=i(u)}}function S(e){if(m=!1,w(e),!f)if(null!==i(c))f=!0,L(b);else{var t=i(u);null!==t&&I(S,t.startTime-e)}}function b(e,n){f=!1,m&&(m=!1,y(E),E=-1),g=!0;var s=p;try{for(w(n),d=i(c);null!==d&&(!(d.expirationTime>n)||e&&!P());){var o=d.callback;if("function"===typeof o){d.callback=null,p=d.priorityLevel;var a=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===i(c)&&r(c),w(n)}else r(c);d=i(c)}if(null!==d)var l=!0;else{var h=i(u);null!==h&&I(S,h.startTime-n),l=!1}return l}finally{d=null,p=s,g=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x,_=!1,M=null,E=-1,R=5,T=-1;function P(){return!(t.unstable_now()-T<R)}function A(){if(null!==M){var e=t.unstable_now();T=e;var n=!0;try{n=M(!0,e)}finally{n?x():(_=!1,M=null)}}else _=!1}if("function"===typeof C)x=function(){C(A)};else if("undefined"!==typeof MessageChannel){var F=new MessageChannel,D=F.port2;F.port1.onmessage=A,x=function(){D.postMessage(null)}}else x=function(){v(A,0)};function L(e){M=e,_||(_=!0,x())}function I(e,n){E=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||g||(f=!0,L(b))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:r,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===i(c)&&e===i(u)&&(m?(y(E),E=-1):m=!0,I(S,s-o))):(e.sortIndex=a,n(c,e),f||g||(f=!0,L(b))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},853:(e,t,n)=>{"use strict";e.exports=n(234)},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},958:(e,t,n)=>{e.exports=function(e){var t={},i=n(43),r=n(513),s=Object.assign;function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),g=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),v=Symbol.for("react.suspense_list"),y=Symbol.for("react.memo"),C=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var w=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var S=Symbol.iterator;function b(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=S&&e[S]||e["@@iterator"])?e:null}function x(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case u:return"Fragment";case c:return"Portal";case d:return"Profiler";case h:return"StrictMode";case m:return"Suspense";case v:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case g:return(e.displayName||"Context")+".Consumer";case p:return(e._context.displayName||"Context")+".Provider";case f:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case y:return null!==(t=e.displayName||null)?t:x(e.type)||"Memo";case C:t=e._payload,e=e._init;try{return x(e(t))}catch(n){}}return null}function _(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return x(t);case 8:return t===h?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function M(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function E(e){if(M(e)!==e)throw Error(o(188))}function R(e){var t=e.alternate;if(!t){if(null===(t=M(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(i=r.return)){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return E(r),e;if(s===i)return E(r),t;s=s.sibling}throw Error(o(188))}if(n.return!==i.return)n=r,i=s;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,i=s;break}if(l===i){a=!0,i=r,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,i=r;break}if(l===i){a=!0,i=s,n=r;break}l=l.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==i)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}function T(e){return null!==(e=R(e))?P(e):null}function P(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=P(e);if(null!==t)return t;e=e.sibling}return null}function A(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){if(4!==e.tag){var t=A(e);if(null!==t)return t}e=e.sibling}return null}var F,D=Array.isArray,L=e.getPublicInstance,I=e.getRootHostContext,k=e.getChildHostContext,O=e.prepareForCommit,N=e.resetAfterCommit,B=e.createInstance,z=e.appendInitialChild,H=e.finalizeInitialChildren,G=e.prepareUpdate,U=e.shouldSetTextContent,V=e.createTextInstance,W=e.scheduleTimeout,j=e.cancelTimeout,q=e.noTimeout,X=e.isPrimaryRenderer,K=e.supportsMutation,$=e.supportsPersistence,Z=e.supportsHydration,Y=e.getInstanceFromNode,J=e.preparePortalMount,Q=e.getCurrentEventPriority,ee=e.detachDeletedInstance,te=e.supportsMicrotasks,ne=e.scheduleMicrotask,ie=e.supportsTestSelectors,re=e.findFiberRoot,se=e.getBoundingRect,oe=e.getTextContent,ae=e.isHiddenSubtree,le=e.matchAccessibilityRole,ce=e.setFocusIfFocusable,ue=e.setupIntersectionObserver,he=e.appendChild,de=e.appendChildToContainer,pe=e.commitTextUpdate,ge=e.commitMount,fe=e.commitUpdate,me=e.insertBefore,ve=e.insertInContainerBefore,ye=e.removeChild,Ce=e.removeChildFromContainer,we=e.resetTextContent,Se=e.hideInstance,be=e.hideTextInstance,xe=e.unhideInstance,_e=e.unhideTextInstance,Me=e.clearContainer,Ee=e.cloneInstance,Re=e.createContainerChildSet,Te=e.appendChildToContainerChildSet,Pe=e.finalizeContainerChildren,Ae=e.replaceContainerChildren,Fe=e.cloneHiddenInstance,De=e.cloneHiddenTextInstance,Le=e.canHydrateInstance,Ie=e.canHydrateTextInstance,ke=e.canHydrateSuspenseInstance,Oe=e.isSuspenseInstancePending,Ne=e.isSuspenseInstanceFallback,Be=e.registerSuspenseInstanceRetry,ze=e.getNextHydratableSibling,He=e.getFirstHydratableChild,Ge=e.getFirstHydratableChildWithinContainer,Ue=e.getFirstHydratableChildWithinSuspenseInstance,Ve=e.hydrateInstance,We=e.hydrateTextInstance,je=e.hydrateSuspenseInstance,qe=e.getNextHydratableInstanceAfterSuspenseInstance,Xe=e.commitHydratedContainer,Ke=e.commitHydratedSuspenseInstance,$e=e.clearSuspenseBoundary,Ze=e.clearSuspenseBoundaryFromContainer,Ye=e.shouldDeleteUnhydratedTailInstances,Je=e.didNotMatchHydratedContainerTextInstance,Qe=e.didNotMatchHydratedTextInstance;function et(e){if(void 0===F)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var tt=!1;function nt(e,t){if(!e||tt)return"";tt=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),s=i.stack.split("\n"),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||r[o]!==s[a]){var l="\n"+r[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{tt=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?et(e):""}var it=Object.prototype.hasOwnProperty,rt=[],st=-1;function ot(e){return{current:e}}function at(e){0>st||(e.current=rt[st],rt[st]=null,st--)}function lt(e,t){st++,rt[st]=e.current,e.current=t}var ct={},ut=ot(ct),ht=ot(!1),dt=ct;function pt(e,t){var n=e.type.contextTypes;if(!n)return ct;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function gt(e){return null!==(e=e.childContextTypes)&&void 0!==e}function ft(){at(ht),at(ut)}function mt(e,t,n){if(ut.current!==ct)throw Error(o(168));lt(ut,t),lt(ht,n)}function vt(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in t))throw Error(o(108,_(e)||"Unknown",r));return s({},n,i)}function yt(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ct,dt=ut.current,lt(ut,e),lt(ht,ht.current),!0}function Ct(e,t,n){var i=e.stateNode;if(!i)throw Error(o(169));n?(e=vt(e,t,dt),i.__reactInternalMemoizedMergedChildContext=e,at(ht),at(ut),lt(ut,e)):at(ht),lt(ht,n)}var wt=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(St(e)/bt|0)|0},St=Math.log,bt=Math.LN2;var xt=64,_t=4194304;function Mt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Et(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~r;0!==a?i=Mt(a):0!==(s&=o)&&(i=Mt(s))}else 0!==(o=n&~r)?i=Mt(o):0!==s&&(i=Mt(s));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(s=t&-t)||16===r&&0!==(4194240&s)))return t;if(0!==(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-wt(t)),i|=e[n],t&=~r;return i}function Rt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Tt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Pt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function At(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-wt(t)]=n}function Ft(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-wt(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var Dt=0;function Lt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var It=r.unstable_scheduleCallback,kt=r.unstable_cancelCallback,Ot=r.unstable_shouldYield,Nt=r.unstable_requestPaint,Bt=r.unstable_now,zt=r.unstable_ImmediatePriority,Ht=r.unstable_UserBlockingPriority,Gt=r.unstable_NormalPriority,Ut=r.unstable_IdlePriority,Vt=null,Wt=null;var jt="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},qt=null,Xt=!1,Kt=!1;function $t(e){null===qt?qt=[e]:qt.push(e)}function Zt(){if(!Kt&&null!==qt){Kt=!0;var e=0,t=Dt;try{var n=qt;for(Dt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}qt=null,Xt=!1}catch(r){throw null!==qt&&(qt=qt.slice(e+1)),It(zt,Zt),r}finally{Dt=t,Kt=!1}}return null}var Yt=a.ReactCurrentBatchConfig;function Jt(e,t){if(jt(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!it.call(t,r)||!jt(e[r],t[r]))return!1}return!0}function Qt(e){switch(e.tag){case 5:return et(e.type);case 16:return et("Lazy");case 13:return et("Suspense");case 19:return et("SuspenseList");case 0:case 2:case 15:return e=nt(e.type,!1);case 11:return e=nt(e.type.render,!1);case 1:return e=nt(e.type,!0);default:return""}}function en(e,t){if(e&&e.defaultProps){for(var n in t=s({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var tn=ot(null),nn=null,rn=null,sn=null;function on(){sn=rn=nn=null}function an(e,t,n){X?(lt(tn,t._currentValue),t._currentValue=n):(lt(tn,t._currentValue2),t._currentValue2=n)}function ln(e){var t=tn.current;at(tn),X?e._currentValue=t:e._currentValue2=t}function cn(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function un(e,t){nn=e,sn=rn=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Or=!0),e.firstContext=null)}function hn(e){var t=X?e._currentValue:e._currentValue2;if(sn!==e)if(e={context:e,memoizedValue:t,next:null},null===rn){if(null===nn)throw Error(o(308));rn=e,nn.dependencies={lanes:0,firstContext:e}}else rn=rn.next=e;return t}var dn=null,pn=!1;function gn(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fn(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function vn(e,t){var n=e.updateQueue;null!==n&&(n=n.shared,null!==Ks&&0!==(1&e.mode)&&0===(2&Xs)?(null===(e=n.interleaved)?(t.next=t,null===dn?dn=[n]:dn.push(n)):(t.next=e.next,e.next=t),n.interleaved=t):(null===(e=n.pending)?t.next=t:(t.next=e.next,e.next=t),n.pending=t))}function yn(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Ft(e,n)}}function Cn(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function wn(e,t,n,i){var r=e.updateQueue;pn=!1;var o=r.firstBaseUpdate,a=r.lastBaseUpdate,l=r.shared.pending;if(null!==l){r.shared.pending=null;var c=l,u=c.next;c.next=null,null===a?o=u:a.next=u,a=c;var h=e.alternate;null!==h&&((l=(h=h.updateQueue).lastBaseUpdate)!==a&&(null===l?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(null!==o){var d=r.baseState;for(a=0,h=u=c=null,l=o;;){var p=l.lane,g=l.eventTime;if((i&p)===p){null!==h&&(h=h.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var f=e,m=l;switch(p=t,g=n,m.tag){case 1:if("function"===typeof(f=m.payload)){d=f.call(g,d,p);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(p="function"===typeof(f=m.payload)?f.call(g,d,p):f)||void 0===p)break e;d=s({},d,p);break e;case 2:pn=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(p=r.effects)?r.effects=[l]:p.push(l))}else g={eventTime:g,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===h?(u=h=g,c=d):h=h.next=g,a|=p;if(null===(l=l.next)){if(null===(l=r.shared.pending))break;l=(p=l).next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}if(null===h&&(c=d),r.baseState=c,r.firstBaseUpdate=u,r.lastBaseUpdate=h,null!==(t=r.shared.interleaved)){r=t;do{a|=r.lane,r=r.next}while(r!==t)}else null===o&&(r.shared.lanes=0);to|=a,e.lanes=a,e.memoizedState=d}}function Sn(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!==typeof r)throw Error(o(191,r));r.call(i)}}}var bn=(new i.Component).refs;function xn(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:s({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var _n={isMounted:function(e){return!!(e=e._reactInternals)&&M(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=So(),r=bo(e),s=mn(i,r);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),vn(e,s),null!==(t=xo(e,r,i))&&yn(t,e,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=So(),r=bo(e),s=mn(i,r);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),vn(e,s),null!==(t=xo(e,r,i))&&yn(t,e,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=So(),i=bo(e),r=mn(n,i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),vn(e,r),null!==(t=xo(e,i,n))&&yn(t,e,i)}};function Mn(e,t,n,i,r,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!Jt(n,i)||!Jt(r,s))}function En(e,t,n){var i=!1,r=ct,s=t.contextType;return"object"===typeof s&&null!==s?s=hn(s):(r=gt(t)?dt:ut.current,s=(i=null!==(i=t.contextTypes)&&void 0!==i)?pt(e,r):ct),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=_n,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function Rn(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&_n.enqueueReplaceState(t,t.state,null)}function Tn(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs=bn,gn(e);var s=t.contextType;"object"===typeof s&&null!==s?r.context=hn(s):(s=gt(t)?dt:ut.current,r.context=pt(e,s)),r.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(xn(e,t,s,n),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&_n.enqueueReplaceState(r,r.state,null),wn(e,n,r,i),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4194308)}var Pn=[],An=0,Fn=null,Dn=0,Ln=[],In=0,kn=null,On=1,Nn="";function Bn(e,t){Pn[An++]=Dn,Pn[An++]=Fn,Fn=e,Dn=t}function zn(e,t,n){Ln[In++]=On,Ln[In++]=Nn,Ln[In++]=kn,kn=e;var i=On;e=Nn;var r=32-wt(i)-1;i&=~(1<<r),n+=1;var s=32-wt(t)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,On=1<<32-wt(t)+r|n<<r|i,Nn=s+e}else On=1<<s|n<<r|i,Nn=e}function Hn(e){null!==e.return&&(Bn(e,1),zn(e,1,0))}function Gn(e){for(;e===Fn;)Fn=Pn[--An],Pn[An]=null,Dn=Pn[--An],Pn[An]=null;for(;e===kn;)kn=Ln[--In],Ln[In]=null,Nn=Ln[--In],Ln[In]=null,On=Ln[--In],Ln[In]=null}var Un=null,Vn=null,Wn=!1,jn=!1,qn=null;function Xn(e,t){var n=Jo(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function Kn(e,t){switch(e.tag){case 5:return null!==(t=Le(t,e.type,e.pendingProps))&&(e.stateNode=t,Un=e,Vn=He(t),!0);case 6:return null!==(t=Ie(t,e.pendingProps))&&(e.stateNode=t,Un=e,Vn=null,!0);case 13:if(null!==(t=ke(t))){var n=null!==kn?{id:On,overflow:Nn}:null;return e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Jo(18,null,null,0)).stateNode=t,n.return=e,e.child=n,Un=e,Vn=null,!0}return!1;default:return!1}}function $n(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function Zn(e){if(Wn){var t=Vn;if(t){var n=t;if(!Kn(e,t)){if($n(e))throw Error(o(418));t=ze(n);var i=Un;t&&Kn(e,t)?Xn(i,n):(e.flags=-4097&e.flags|2,Wn=!1,Un=e)}}else{if($n(e))throw Error(o(418));e.flags=-4097&e.flags|2,Wn=!1,Un=e}}}function Yn(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Un=e}function Jn(e){if(!Z||e!==Un)return!1;if(!Wn)return Yn(e),Wn=!0,!1;if(3!==e.tag&&(5!==e.tag||Ye(e.type)&&!U(e.type,e.memoizedProps))){var t=Vn;if(t){if($n(e)){for(e=Vn;e;)e=ze(e);throw Error(o(418))}for(;t;)Xn(e,t),t=ze(t)}}if(Yn(e),13===e.tag){if(!Z)throw Error(o(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));Vn=qe(e)}else Vn=Un?ze(e.stateNode):null;return!0}function Qn(){Z&&(Vn=Un=null,jn=Wn=!1)}function ei(e){null===qn?qn=[e]:qn.push(e)}function ti(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var i=n.stateNode}if(!i)throw Error(o(147,e));var r=i,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=r.refs;t===bn&&(t=r.refs={}),null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function ni(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ii(e){return(0,e._init)(e._payload)}function ri(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=ea(e,t)).index=0,e.sibling=null,e}function s(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function h(e,t,n,i){return null===t||6!==t.tag?((t=ra(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function d(e,t,n,i){var s=n.type;return s===u?g(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===C&&ii(s)===t.type)?((i=r(t,n.props)).ref=ti(e,t,n),i.return=e,i):((i=ta(n.type,n.key,n.props,null,e.mode,i)).ref=ti(e,t,n),i.return=e,i)}function p(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=sa(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function g(e,t,n,i,s){return null===t||7!==t.tag?((t=na(n,e.mode,i,s)).return=e,t):((t=r(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=ra(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case l:return(n=ta(t.type,t.key,t.props,null,e.mode,n)).ref=ti(e,null,t),n.return=e,n;case c:return(t=sa(t,e.mode,n)).return=e,t;case C:return f(e,(0,t._init)(t._payload),n)}if(D(t)||b(t))return(t=na(t,e.mode,n,null)).return=e,t;ni(e,t)}return null}function m(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==r?null:h(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case l:return n.key===r?d(e,t,n,i):null;case c:return n.key===r?p(e,t,n,i):null;case C:return m(e,t,(r=n._init)(n._payload),i)}if(D(n)||b(n))return null!==r?null:g(e,t,n,i,null);ni(e,n)}return null}function v(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i)return h(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case l:return d(t,e=e.get(null===i.key?n:i.key)||null,i,r);case c:return p(t,e=e.get(null===i.key?n:i.key)||null,i,r);case C:return v(e,t,n,(0,i._init)(i._payload),r)}if(D(i)||b(i))return g(t,e=e.get(n)||null,i,r,null);ni(t,i)}return null}function y(r,o,a,l){for(var c=null,u=null,h=o,d=o=0,p=null;null!==h&&d<a.length;d++){h.index>d?(p=h,h=null):p=h.sibling;var g=m(r,h,a[d],l);if(null===g){null===h&&(h=p);break}e&&h&&null===g.alternate&&t(r,h),o=s(g,o,d),null===u?c=g:u.sibling=g,u=g,h=p}if(d===a.length)return n(r,h),Wn&&Bn(r,d),c;if(null===h){for(;d<a.length;d++)null!==(h=f(r,a[d],l))&&(o=s(h,o,d),null===u?c=h:u.sibling=h,u=h);return Wn&&Bn(r,d),c}for(h=i(r,h);d<a.length;d++)null!==(p=v(h,r,d,a[d],l))&&(e&&null!==p.alternate&&h.delete(null===p.key?d:p.key),o=s(p,o,d),null===u?c=p:u.sibling=p,u=p);return e&&h.forEach((function(e){return t(r,e)})),Wn&&Bn(r,d),c}function w(r,a,l,c){var u=b(l);if("function"!==typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var h=u=null,d=a,p=a=0,g=null,y=l.next();null!==d&&!y.done;p++,y=l.next()){d.index>p?(g=d,d=null):g=d.sibling;var C=m(r,d,y.value,c);if(null===C){null===d&&(d=g);break}e&&d&&null===C.alternate&&t(r,d),a=s(C,a,p),null===h?u=C:h.sibling=C,h=C,d=g}if(y.done)return n(r,d),Wn&&Bn(r,p),u;if(null===d){for(;!y.done;p++,y=l.next())null!==(y=f(r,y.value,c))&&(a=s(y,a,p),null===h?u=y:h.sibling=y,h=y);return Wn&&Bn(r,p),u}for(d=i(r,d);!y.done;p++,y=l.next())null!==(y=v(d,r,p,y.value,c))&&(e&&null!==y.alternate&&d.delete(null===y.key?p:y.key),a=s(y,a,p),null===h?u=y:h.sibling=y,h=y);return e&&d.forEach((function(e){return t(r,e)})),Wn&&Bn(r,p),u}return function e(i,s,o,h){if("object"===typeof o&&null!==o&&o.type===u&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case l:e:{for(var d=o.key,p=s;null!==p;){if(p.key===d){if((d=o.type)===u){if(7===p.tag){n(i,p.sibling),(s=r(p,o.props.children)).return=i,i=s;break e}}else if(p.elementType===d||"object"===typeof d&&null!==d&&d.$$typeof===C&&ii(d)===p.type){n(i,p.sibling),(s=r(p,o.props)).ref=ti(i,p,o),s.return=i,i=s;break e}n(i,p);break}t(i,p),p=p.sibling}o.type===u?((s=na(o.props.children,i.mode,h,o.key)).return=i,i=s):((h=ta(o.type,o.key,o.props,null,i.mode,h)).ref=ti(i,s,o),h.return=i,i=h)}return a(i);case c:e:{for(p=o.key;null!==s;){if(s.key===p){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(i,s.sibling),(s=r(s,o.children||[])).return=i,i=s;break e}n(i,s);break}t(i,s),s=s.sibling}(s=sa(o,i.mode,h)).return=i,i=s}return a(i);case C:return e(i,s,(p=o._init)(o._payload),h)}if(D(o))return y(i,s,o,h);if(b(o))return w(i,s,o,h);ni(i,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(i,s.sibling),(s=r(s,o)).return=i,i=s):(n(i,s),(s=ra(o,i.mode,h)).return=i,i=s),a(i)):n(i,s)}}var si=ri(!0),oi=ri(!1),ai={},li=ot(ai),ci=ot(ai),ui=ot(ai);function hi(e){if(e===ai)throw Error(o(174));return e}function di(e,t){lt(ui,t),lt(ci,e),lt(li,ai),e=I(t),at(li),lt(li,e)}function pi(){at(li),at(ci),at(ui)}function gi(e){var t=hi(ui.current),n=hi(li.current);n!==(t=k(n,e.type,t))&&(lt(ci,e),lt(li,t))}function fi(e){ci.current===e&&(at(li),at(ci))}var mi=ot(0);function vi(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Oe(n)||Ne(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var yi=[];function Ci(){for(var e=0;e<yi.length;e++){var t=yi[e];X?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}yi.length=0}var wi=a.ReactCurrentDispatcher,Si=a.ReactCurrentBatchConfig,bi=0,xi=null,_i=null,Mi=null,Ei=!1,Ri=!1,Ti=0,Pi=0;function Ai(){throw Error(o(321))}function Fi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!jt(e[n],t[n]))return!1;return!0}function Di(e,t,n,i,r,s){if(bi=s,xi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,wi.current=null===e||null===e.memoizedState?gr:fr,e=n(i,r),Ri){s=0;do{if(Ri=!1,Ti=0,25<=s)throw Error(o(301));s+=1,Mi=_i=null,t.updateQueue=null,wi.current=mr,e=n(i,r)}while(Ri)}if(wi.current=pr,t=null!==_i&&null!==_i.next,bi=0,Mi=_i=xi=null,Ei=!1,t)throw Error(o(300));return e}function Li(){var e=0!==Ti;return Ti=0,e}function Ii(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Mi?xi.memoizedState=Mi=e:Mi=Mi.next=e,Mi}function ki(){if(null===_i){var e=xi.alternate;e=null!==e?e.memoizedState:null}else e=_i.next;var t=null===Mi?xi.memoizedState:Mi.next;if(null!==t)Mi=t,_i=e;else{if(null===e)throw Error(o(310));e={memoizedState:(_i=e).memoizedState,baseState:_i.baseState,baseQueue:_i.baseQueue,queue:_i.queue,next:null},null===Mi?xi.memoizedState=Mi=e:Mi=Mi.next=e}return Mi}function Oi(e,t){return"function"===typeof t?t(e):t}function Ni(e){var t=ki(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var i=_i,r=i.baseQueue,s=n.pending;if(null!==s){if(null!==r){var a=r.next;r.next=s.next,s.next=a}i.baseQueue=r=s,n.pending=null}if(null!==r){s=r.next,i=i.baseState;var l=a=null,c=null,u=s;do{var h=u.lane;if((bi&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:e(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=i):c=c.next=d,xi.lanes|=h,to|=h}u=u.next}while(null!==u&&u!==s);null===c?a=i:c.next=l,jt(i,t.memoizedState)||(Or=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){r=e;do{s=r.lane,xi.lanes|=s,to|=s,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Bi(e){var t=ki(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,s=t.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{s=e(s,a.action),a=a.next}while(a!==r);jt(s,t.memoizedState)||(Or=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,i]}function zi(){}function Hi(e,t){var n=xi,i=ki(),r=t(),s=!jt(i.memoizedState,r);if(s&&(i.memoizedState=r,Or=!0),i=i.queue,Yi(Vi.bind(null,n,i,e),[e]),i.getSnapshot!==t||s||null!==Mi&&1&Mi.memoizedState.tag){if(n.flags|=2048,qi(9,Ui.bind(null,n,i,r,t),void 0,null),null===Ks)throw Error(o(349));0!==(30&bi)||Gi(n,t,r)}return r}function Gi(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=xi.updateQueue)?(t={lastEffect:null,stores:null},xi.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ui(e,t,n,i){t.value=n,t.getSnapshot=i,Wi(t)&&xo(e,1,-1)}function Vi(e,t,n){return n((function(){Wi(t)&&xo(e,1,-1)}))}function Wi(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!jt(e,n)}catch(i){return!0}}function ji(e){var t=Ii();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oi,lastRenderedState:e},t.queue=e,e=e.dispatch=lr.bind(null,xi,e),[t.memoizedState,e]}function qi(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=xi.updateQueue)?(t={lastEffect:null,stores:null},xi.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Xi(){return ki().memoizedState}function Ki(e,t,n,i){var r=Ii();xi.flags|=e,r.memoizedState=qi(1|t,n,void 0,void 0===i?null:i)}function $i(e,t,n,i){var r=ki();i=void 0===i?null:i;var s=void 0;if(null!==_i){var o=_i.memoizedState;if(s=o.destroy,null!==i&&Fi(i,o.deps))return void(r.memoizedState=qi(t,n,s,i))}xi.flags|=e,r.memoizedState=qi(1|t,n,s,i)}function Zi(e,t){return Ki(8390656,8,e,t)}function Yi(e,t){return $i(2048,8,e,t)}function Ji(e,t){return $i(4,2,e,t)}function Qi(e,t){return $i(4,4,e,t)}function er(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function tr(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,$i(4,4,er.bind(null,t,e),n)}function nr(){}function ir(e,t){var n=ki();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&Fi(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function rr(e,t){var n=ki();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&Fi(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function sr(e,t){var n=Dt;Dt=0!==n&&4>n?n:4,e(!0);var i=Si.transition;Si.transition={};try{e(!1),t()}finally{Dt=n,Si.transition=i}}function or(){return ki().memoizedState}function ar(e,t,n){var i=bo(e);n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},cr(e)?ur(t,n):(hr(e,t,n),null!==(e=xo(e,i,n=So()))&&dr(e,t,i))}function lr(e,t,n){var i=bo(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(cr(e))ur(t,r);else{hr(e,t,r);var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,jt(a,o))return}catch(l){}null!==(e=xo(e,i,n=So()))&&dr(e,t,i)}}function cr(e){var t=e.alternate;return e===xi||null!==t&&t===xi}function ur(e,t){Ri=Ei=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function hr(e,t,n){null!==Ks&&0!==(1&e.mode)&&0===(2&Xs)?(null===(e=t.interleaved)?(n.next=n,null===dn?dn=[t]:dn.push(t)):(n.next=e.next,e.next=n),t.interleaved=n):(null===(e=t.pending)?n.next=n:(n.next=e.next,e.next=n),t.pending=n)}function dr(e,t,n){if(0!==(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Ft(e,n)}}var pr={readContext:hn,useCallback:Ai,useContext:Ai,useEffect:Ai,useImperativeHandle:Ai,useInsertionEffect:Ai,useLayoutEffect:Ai,useMemo:Ai,useReducer:Ai,useRef:Ai,useState:Ai,useDebugValue:Ai,useDeferredValue:Ai,useTransition:Ai,useMutableSource:Ai,useSyncExternalStore:Ai,useId:Ai,unstable_isNewReconciler:!1},gr={readContext:hn,useCallback:function(e,t){return Ii().memoizedState=[e,void 0===t?null:t],e},useContext:hn,useEffect:Zi,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ki(4194308,4,er.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ki(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ki(4,2,e,t)},useMemo:function(e,t){var n=Ii();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=Ii();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=ar.bind(null,xi,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},Ii().memoizedState=e},useState:ji,useDebugValue:nr,useDeferredValue:function(e){var t=ji(e),n=t[0],i=t[1];return Zi((function(){var t=Si.transition;Si.transition={};try{i(e)}finally{Si.transition=t}}),[e]),n},useTransition:function(){var e=ji(!1),t=e[0];return e=sr.bind(null,e[1]),Ii().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=xi,r=Ii();if(Wn){if(void 0===n)throw Error(o(407));n=n()}else{if(n=t(),null===Ks)throw Error(o(349));0!==(30&bi)||Gi(i,t,n)}r.memoizedState=n;var s={value:n,getSnapshot:t};return r.queue=s,Zi(Vi.bind(null,i,s,e),[e]),i.flags|=2048,qi(9,Ui.bind(null,i,s,n,t),void 0,null),n},useId:function(){var e=Ii(),t=Ks.identifierPrefix;if(Wn){var n=Nn;t=":"+t+"R"+(n=(On&~(1<<32-wt(On)-1)).toString(32)+n),0<(n=Ti++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Pi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},fr={readContext:hn,useCallback:ir,useContext:hn,useEffect:Yi,useImperativeHandle:tr,useInsertionEffect:Ji,useLayoutEffect:Qi,useMemo:rr,useReducer:Ni,useRef:Xi,useState:function(){return Ni(Oi)},useDebugValue:nr,useDeferredValue:function(e){var t=Ni(Oi),n=t[0],i=t[1];return Yi((function(){var t=Si.transition;Si.transition={};try{i(e)}finally{Si.transition=t}}),[e]),n},useTransition:function(){return[Ni(Oi)[0],ki().memoizedState]},useMutableSource:zi,useSyncExternalStore:Hi,useId:or,unstable_isNewReconciler:!1},mr={readContext:hn,useCallback:ir,useContext:hn,useEffect:Yi,useImperativeHandle:tr,useInsertionEffect:Ji,useLayoutEffect:Qi,useMemo:rr,useReducer:Bi,useRef:Xi,useState:function(){return Bi(Oi)},useDebugValue:nr,useDeferredValue:function(e){var t=Bi(Oi),n=t[0],i=t[1];return Yi((function(){var t=Si.transition;Si.transition={};try{i(e)}finally{Si.transition=t}}),[e]),n},useTransition:function(){return[Bi(Oi)[0],ki().memoizedState]},useMutableSource:zi,useSyncExternalStore:Hi,useId:or,unstable_isNewReconciler:!1};function vr(e,t){try{var n="",i=t;do{n+=Qt(i),i=i.return}while(i);var r=n}catch(s){r="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:r}}function yr(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var Cr,wr,Sr,br,xr="function"===typeof WeakMap?WeakMap:Map;function _r(e,t,n){(n=mn(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){uo||(uo=!0,ho=i),yr(0,t)},n}function Mr(e,t,n){(n=mn(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){yr(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){yr(0,t),"function"!==typeof i&&(null===po?po=new Set([this]):po.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function Er(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new xr;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=qo.bind(null,e,t,n),t.then(e,e))}function Rr(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function Tr(e,t,n,i,r){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=mn(-1,1)).tag=2,vn(n,t))),n.lanes|=1),e):(e.flags|=65536,e.lanes=r,e)}function Pr(e){e.flags|=4}function Ar(e,t){if(null!==e&&e.child===t.child)return!0;if(0!==(16&t.flags))return!1;for(e=t.child;null!==e;){if(0!==(12854&e.flags)||0!==(12854&e.subtreeFlags))return!1;e=e.sibling}return!0}if(K)Cr=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)z(e,n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},wr=function(){},Sr=function(e,t,n,i,r){if((e=e.memoizedProps)!==i){var s=t.stateNode,o=hi(li.current);n=G(s,n,e,i,r,o),(t.updateQueue=n)&&Pr(t)}},br=function(e,t,n,i){n!==i&&Pr(t)};else if($){Cr=function(e,t,n,i){for(var r=t.child;null!==r;){if(5===r.tag){var s=r.stateNode;n&&i&&(s=Fe(s,r.type,r.memoizedProps,r)),z(e,s)}else if(6===r.tag)s=r.stateNode,n&&i&&(s=De(s,r.memoizedProps,r)),z(e,s);else if(4!==r.tag)if(22===r.tag&&null!==r.memoizedState)null!==(s=r.child)&&(s.return=r),Cr(e,r,!0,!0);else if(null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};var Fr=function(e,t,n,i){for(var r=t.child;null!==r;){if(5===r.tag){var s=r.stateNode;n&&i&&(s=Fe(s,r.type,r.memoizedProps,r)),Te(e,s)}else if(6===r.tag)s=r.stateNode,n&&i&&(s=De(s,r.memoizedProps,r)),Te(e,s);else if(4!==r.tag)if(22===r.tag&&null!==r.memoizedState)null!==(s=r.child)&&(s.return=r),Fr(e,r,!0,!0);else if(null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};wr=function(e,t){var n=t.stateNode;if(!Ar(e,t)){e=n.containerInfo;var i=Re(e);Fr(i,t,!1,!1),n.pendingChildren=i,Pr(t),Pe(e,i)}},Sr=function(e,t,n,i,r){var s=e.stateNode,o=e.memoizedProps;if((e=Ar(e,t))&&o===i)t.stateNode=s;else{var a=t.stateNode,l=hi(li.current),c=null;o!==i&&(c=G(a,n,o,i,r,l)),e&&null===c?t.stateNode=s:(s=Ee(s,c,n,o,i,t,e,a),H(s,n,i,r,l)&&Pr(t),t.stateNode=s,e?Pr(t):Cr(s,t,!1,!1))}},br=function(e,t,n,i){n!==i?(e=hi(ui.current),n=hi(li.current),t.stateNode=V(i,e,n,t),Pr(t)):t.stateNode=e.stateNode}}else wr=function(){},Sr=function(){},br=function(){};function Dr(e,t){if(!Wn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Lr(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Ir(e,t,n){var i=t.pendingProps;switch(Gn(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Lr(t),null;case 1:case 17:return gt(t.type)&&ft(),Lr(t),null;case 3:return i=t.stateNode,pi(),at(ht),at(ut),Ci(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(Jn(t)?Pr(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==qn&&(To(qn),qn=null))),wr(e,t),Lr(t),null;case 5:fi(t),n=hi(ui.current);var r=t.type;if(null!==e&&null!=t.stateNode)Sr(e,t,r,i,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(o(166));return Lr(t),null}if(e=hi(li.current),Jn(t)){if(!Z)throw Error(o(175));e=Ve(t.stateNode,t.type,t.memoizedProps,n,e,t,!jn),t.updateQueue=e,null!==e&&Pr(t)}else{var s=B(r,i,n,e,t);Cr(s,t,!1,!1),t.stateNode=s,H(s,r,i,n,e)&&Pr(t)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Lr(t),null;case 6:if(e&&null!=t.stateNode)br(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(o(166));if(e=hi(ui.current),n=hi(li.current),Jn(t)){if(!Z)throw Error(o(176));if(e=t.stateNode,i=t.memoizedProps,(n=We(e,i,t,!jn))&&null!==(r=Un))switch(s=0!==(1&r.mode),r.tag){case 3:Je(r.stateNode.containerInfo,e,i,s);break;case 5:Qe(r.type,r.memoizedProps,r.stateNode,e,i,s)}n&&Pr(t)}else t.stateNode=V(i,e,n,t)}return Lr(t),null;case 13:if(at(mi),i=t.memoizedState,Wn&&null!==Vn&&0!==(1&t.mode)&&0===(128&t.flags)){for(e=Vn;e;)e=ze(e);return Qn(),t.flags|=98560,t}if(null!==i&&null!==i.dehydrated){if(i=Jn(t),null===e){if(!i)throw Error(o(318));if(!Z)throw Error(o(344));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(o(317));je(e,t)}else Qn(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;return Lr(t),null}return null!==qn&&(To(qn),qn=null),0!==(128&t.flags)?(t.lanes=n,t):(i=null!==i,n=!1,null===e?Jn(t):n=null!==e.memoizedState,i&&!n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&mi.current)?0===Qs&&(Qs=3):Oo())),null!==t.updateQueue&&(t.flags|=4),Lr(t),null);case 4:return pi(),wr(e,t),null===e&&J(t.stateNode.containerInfo),Lr(t),null;case 10:return ln(t.type._context),Lr(t),null;case 19:if(at(mi),null===(r=t.memoizedState))return Lr(t),null;if(i=0!==(128&t.flags),null===(s=r.rendering))if(i)Dr(r,!1);else{if(0!==Qs||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=vi(e))){for(t.flags|=128,Dr(r,!1),null!==(e=s.updateQueue)&&(t.updateQueue=e,t.flags|=4),t.subtreeFlags=0,e=n,i=t.child;null!==i;)r=e,(n=i).flags&=14680066,null===(s=n.alternate)?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=s.childLanes,n.lanes=s.lanes,n.child=s.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=s.memoizedProps,n.memoizedState=s.memoizedState,n.updateQueue=s.updateQueue,n.type=s.type,r=s.dependencies,n.dependencies=null===r?null:{lanes:r.lanes,firstContext:r.firstContext}),i=i.sibling;return lt(mi,1&mi.current|2),t.child}e=e.sibling}null!==r.tail&&Bt()>ao&&(t.flags|=128,i=!0,Dr(r,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=vi(s))){if(t.flags|=128,i=!0,null!==(e=e.updateQueue)&&(t.updateQueue=e,t.flags|=4),Dr(r,!0),null===r.tail&&"hidden"===r.tailMode&&!s.alternate&&!Wn)return Lr(t),null}else 2*Bt()-r.renderingStartTime>ao&&1073741824!==n&&(t.flags|=128,i=!0,Dr(r,!1),t.lanes=4194304);r.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=r.last)?e.sibling=s:t.child=s,r.last=s)}return null!==r.tail?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=Bt(),t.sibling=null,e=mi.current,lt(mi,i?1&e|2:1&e),t):(Lr(t),null);case 22:case 23:return Do(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Ys)&&(Lr(t),K&&6&t.subtreeFlags&&(t.flags|=8192)):Lr(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}var kr=a.ReactCurrentOwner,Or=!1;function Nr(e,t,n,i){t.child=null===e?oi(t,null,n,i):si(t,e.child,n,i)}function Br(e,t,n,i,r){n=n.render;var s=t.ref;return un(t,r),i=Di(e,t,n,i,s,r),n=Li(),null===e||Or?(Wn&&n&&Hn(t),t.flags|=1,Nr(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,rs(e,t,r))}function zr(e,t,n,i,r){if(null===e){var s=n.type;return"function"!==typeof s||Qo(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=ta(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Hr(e,t,s,i,r))}if(s=e.child,0===(e.lanes&r)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:Jt)(o,i)&&e.ref===t.ref)return rs(e,t,r)}return t.flags|=1,(e=ea(s,i)).ref=t.ref,e.return=t,t.child=e}function Hr(e,t,n,i,r){if(null!==e&&Jt(e.memoizedProps,i)&&e.ref===t.ref){if(Or=!1,0===(e.lanes&r))return t.lanes=e.lanes,rs(e,t,r);0!==(131072&e.flags)&&(Or=!0)}return Vr(e,t,n,i,r)}function Gr(e,t,n){var i=t.pendingProps,r=i.children,s=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null},lt(Js,Ys),Ys|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null},t.updateQueue=null,lt(Js,Ys),Ys|=e,null;t.memoizedState={baseLanes:0,cachePool:null},i=null!==s?s.baseLanes:n,lt(Js,Ys),Ys|=i}else null!==s?(i=s.baseLanes|n,t.memoizedState=null):i=n,lt(Js,Ys),Ys|=i;return Nr(e,t,r,n),t.child}function Ur(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Vr(e,t,n,i,r){var s=gt(n)?dt:ut.current;return s=pt(t,s),un(t,r),n=Di(e,t,n,i,s,r),i=Li(),null===e||Or?(Wn&&i&&Hn(t),t.flags|=1,Nr(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,rs(e,t,r))}function Wr(e,t,n,i,r){if(gt(n)){var s=!0;yt(t)}else s=!1;if(un(t,r),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),En(t,n,i),Tn(t,n,i,r),i=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=hn(c):c=pt(t,c=gt(n)?dt:ut.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==i||l!==c)&&Rn(t,o,i,c),pn=!1;var d=t.memoizedState;o.state=d,wn(t,i,o,r),l=t.memoizedState,a!==i||d!==l||ht.current||pn?("function"===typeof u&&(xn(t,n,u,i),l=t.memoizedState),(a=pn||Mn(t,n,a,i,d,l,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,fn(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:en(t.type,a),o.props=c,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=hn(l):l=pt(t,l=gt(n)?dt:ut.current);var p=n.getDerivedStateFromProps;(u="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==l)&&Rn(t,o,i,l),pn=!1,d=t.memoizedState,o.state=d,wn(t,i,o,r);var g=t.memoizedState;a!==h||d!==g||ht.current||pn?("function"===typeof p&&(xn(t,n,p,i),g=t.memoizedState),(c=pn||Mn(t,n,c,i,d,g,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(i,g,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,g,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=g),o.props=i,o.state=g,o.context=l,i=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return jr(e,t,n,i,s,r)}function jr(e,t,n,i,r,s){Ur(e,t);var o=0!==(128&t.flags);if(!i&&!o)return r&&Ct(t,n,!1),rs(e,t,s);i=t.stateNode,kr.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&o?(t.child=si(t,e.child,null,s),t.child=si(t,null,a,s)):Nr(e,t,a,s),t.memoizedState=i.state,r&&Ct(t,n,!0),t.child}function qr(e){var t=e.stateNode;t.pendingContext?mt(0,t.pendingContext,t.pendingContext!==t.context):t.context&&mt(0,t.context,!1),di(e,t.containerInfo)}function Xr(e,t,n,i,r){return Qn(),ei(r),t.flags|=256,Nr(e,t,n,i),t.child}var Kr={dehydrated:null,treeContext:null,retryLane:0};function $r(e){return{baseLanes:e,cachePool:null}}function Zr(e,t,n){var i,r=t.pendingProps,s=mi.current,a=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&s)),i?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),lt(mi,1&s),null===e)return Zn(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:Ne(e)?t.lanes=8:t.lanes=1073741824,null):(s=r.children,e=r.fallback,a?(r=t.mode,a=t.child,s={mode:"hidden",children:s},0===(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=s):a=ia(s,r,0,null),e=na(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=$r(n),t.memoizedState=Kr,e):Yr(t,s));if(null!==(s=e.memoizedState)){if(null!==(i=s.dehydrated)){if(l)return 256&t.flags?(t.flags&=-257,es(e,t,n,Error(o(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,s=t.mode,r=ia({mode:"visible",children:r.children},s,0,null),(a=na(a,s,n,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&si(t,e.child,null,n),t.child.memoizedState=$r(n),t.memoizedState=Kr,a);if(0===(1&t.mode))t=es(e,t,n,null);else if(Ne(i))t=es(e,t,n,Error(o(419)));else if(r=0!==(n&e.childLanes),Or||r){if(null!==(r=Ks)){switch(n&-n){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(r=0!==(a&(r.suspendedLanes|n))?0:a)&&r!==s.retryLane&&(s.retryLane=r,xo(e,r,-1))}Oo(),t=es(e,t,n,Error(o(421)))}else Oe(i)?(t.flags|=128,t.child=e.child,t=Ko.bind(null,e),Be(i,t),t=null):(n=s.treeContext,Z&&(Vn=Ue(i),Un=t,Wn=!0,qn=null,jn=!1,null!==n&&(Ln[In++]=On,Ln[In++]=Nn,Ln[In++]=kn,On=n.id,Nn=n.overflow,kn=t)),(t=Yr(t,t.pendingProps.children)).flags|=4096);return t}return a?(r=Qr(e,t,r.children,r.fallback,n),a=t.child,s=e.child.memoizedState,a.memoizedState=null===s?$r(n):{baseLanes:s.baseLanes|n,cachePool:null},a.childLanes=e.childLanes&~n,t.memoizedState=Kr,r):(n=Jr(e,t,r.children,n),t.memoizedState=null,n)}return a?(r=Qr(e,t,r.children,r.fallback,n),a=t.child,s=e.child.memoizedState,a.memoizedState=null===s?$r(n):{baseLanes:s.baseLanes|n,cachePool:null},a.childLanes=e.childLanes&~n,t.memoizedState=Kr,r):(n=Jr(e,t,r.children,n),t.memoizedState=null,n)}function Yr(e,t){return(t=ia({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Jr(e,t,n,i){var r=e.child;return e=r.sibling,n=ea(r,{mode:"visible",children:n}),0===(1&t.mode)&&(n.lanes=i),n.return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n}function Qr(e,t,n,i,r){var s=t.mode,o=(e=e.child).sibling,a={mode:"hidden",children:n};return 0===(1&s)&&t.child!==e?((n=t.child).childLanes=0,n.pendingProps=a,t.deletions=null):(n=ea(e,a)).subtreeFlags=14680064&e.subtreeFlags,null!==o?i=ea(o,i):(i=na(i,s,r,null)).flags|=2,i.return=t,n.return=t,n.sibling=i,t.child=n,i}function es(e,t,n,i){return null!==i&&ei(i),si(t,e.child,null,n),(e=Yr(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ts(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),cn(e.return,t,n)}function ns(e,t,n,i,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function is(e,t,n){var i=t.pendingProps,r=i.revealOrder,s=i.tail;if(Nr(e,t,i.children,n),0!==(2&(i=mi.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ts(e,n,t);else if(19===e.tag)ts(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(lt(mi,i),0===(1&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===vi(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),ns(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===vi(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}ns(t,!0,n,null,s);break;case"together":ns(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function rs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),to|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=ea(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=ea(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function ss(e,t){switch(Gn(t),t.tag){case 1:return gt(t.type)&&ft(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return pi(),at(ht),at(ut),Ci(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return fi(t),null;case 13:if(at(mi),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));Qn()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return at(mi),null;case 4:return pi(),null;case 10:return ln(t.type._context),null;case 22:case 23:return Do(),null;default:return null}}var os=!1,as=!1,ls="function"===typeof WeakSet?WeakSet:Set,cs=null;function us(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(i){jo(e,t,i)}else n.current=null}function hs(e,t,n){try{n()}catch(i){jo(e,t,i)}}var ds=!1;function ps(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&hs(t,n,s)}r=r.next}while(r!==i)}}function gs(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function fs(e){var t=e.ref;if(null!==t){var n=e.stateNode;if(5===e.tag)e=L(n);else e=n;"function"===typeof t?t(e):t.current=e}}function ms(e,t,n){if(Wt&&"function"===typeof Wt.onCommitFiberUnmount)try{Wt.onCommitFiberUnmount(Vt,t)}catch(o){}switch(t.tag){case 0:case 11:case 14:case 15:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var i=e=e.next;do{var r=i,s=r.destroy;r=r.tag,void 0!==s&&(0!==(2&r)||0!==(4&r))&&hs(t,n,s),i=i.next}while(i!==e)}break;case 1:if(us(t,n),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(o){jo(t,n,o)}break;case 5:us(t,n);break;case 4:K?_s(e,t,n):$&&$&&(t=t.stateNode.containerInfo,n=Re(t),Ae(t,n))}}function vs(e,t,n){for(var i=t;;)if(ms(e,i,n),null===i.child||K&&4===i.tag){if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}else i.child.return=i,i=i.child}function ys(e){var t=e.alternate;null!==t&&(e.alternate=null,ys(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&ee(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Cs(e){return 5===e.tag||3===e.tag||4===e.tag}function ws(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Cs(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Ss(e){if(K){e:{for(var t=e.return;null!==t;){if(Cs(t))break e;t=t.return}throw Error(o(160))}var n=t;switch(n.tag){case 5:t=n.stateNode,32&n.flags&&(we(t),n.flags&=-33),xs(e,n=ws(e),t);break;case 3:case 4:t=n.stateNode.containerInfo,bs(e,n=ws(e),t);break;default:throw Error(o(161))}}}function bs(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?ve(n,e,t):de(n,e);else if(4!==i&&null!==(e=e.child))for(bs(e,t,n),e=e.sibling;null!==e;)bs(e,t,n),e=e.sibling}function xs(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?me(n,e,t):he(n,e);else if(4!==i&&null!==(e=e.child))for(xs(e,t,n),e=e.sibling;null!==e;)xs(e,t,n),e=e.sibling}function _s(e,t,n){for(var i,r,s=t,a=!1;;){if(!a){a=s.return;e:for(;;){if(null===a)throw Error(o(160));switch(i=a.stateNode,a.tag){case 5:r=!1;break e;case 3:case 4:i=i.containerInfo,r=!0;break e}a=a.return}a=!0}if(5===s.tag||6===s.tag)vs(e,s,n),r?Ce(i,s.stateNode):ye(i,s.stateNode);else if(18===s.tag)r?Ze(i,s.stateNode):$e(i,s.stateNode);else if(4===s.tag){if(null!==s.child){i=s.stateNode.containerInfo,r=!0,s.child.return=s,s=s.child;continue}}else if(ms(e,s,n),null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)return;4===(s=s.return).tag&&(a=!1)}s.sibling.return=s.return,s=s.sibling}}function Ms(e,t){if(K){switch(t.tag){case 0:case 11:case 14:case 15:return ps(3,t,t.return),gs(3,t),void ps(5,t,t.return);case 1:case 12:case 17:return;case 5:var n=t.stateNode;if(null!=n){var i=t.memoizedProps;e=null!==e?e.memoizedProps:i;var r=t.type,s=t.updateQueue;t.updateQueue=null,null!==s&&fe(n,s,r,e,i,t)}return;case 6:if(null===t.stateNode)throw Error(o(162));return n=t.memoizedProps,void pe(t.stateNode,null!==e?e.memoizedProps:n,n);case 3:return void(Z&&null!==e&&e.memoizedState.isDehydrated&&Xe(t.stateNode.containerInfo));case 13:case 19:return void Es(t)}throw Error(o(163))}switch(t.tag){case 0:case 11:case 14:case 15:return ps(3,t,t.return),gs(3,t),void ps(5,t,t.return);case 12:case 22:case 23:return;case 13:case 19:return void Es(t);case 3:Z&&null!==e&&e.memoizedState.isDehydrated&&Xe(t.stateNode.containerInfo)}e:if($){switch(t.tag){case 1:case 5:case 6:break e;case 3:case 4:t=t.stateNode,Ae(t.containerInfo,t.pendingChildren);break e}throw Error(o(163))}}function Es(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new ls),t.forEach((function(t){var i=$o.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function Rs(e,t,n){cs=e,Ts(e,t,n)}function Ts(e,t,n){for(var i=0!==(1&e.mode);null!==cs;){var r=cs,s=r.child;if(22===r.tag&&i){var o=null!==r.memoizedState||os;if(!o){var a=r.alternate,l=null!==a&&null!==a.memoizedState||as;a=os;var c=as;if(os=o,(as=l)&&!c)for(cs=r;null!==cs;)l=(o=cs).child,22===o.tag&&null!==o.memoizedState?Fs(r):null!==l?(l.return=o,cs=l):Fs(r);for(;null!==s;)cs=s,Ts(s,t,n),s=s.sibling;cs=r,os=a,as=c}Ps(e)}else 0!==(8772&r.subtreeFlags)&&null!==s?(s.return=r,cs=s):Ps(e)}}function Ps(e){for(;null!==cs;){var t=cs;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:as||gs(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!as)if(null===n)i.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:en(t.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Sn(t,s,i);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:n=L(t.child.stateNode);break;case 1:n=t.child.stateNode}Sn(t,a,n)}break;case 5:var l=t.stateNode;null===n&&4&t.flags&&ge(l,t.type,t.memoizedProps,t);break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(Z&&null===t.memoizedState){var c=t.alternate;if(null!==c){var u=c.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Ke(h)}}}break;default:throw Error(o(163))}as||512&t.flags&&fs(t)}catch(d){jo(t,t.return,d)}}if(t===e){cs=null;break}if(null!==(n=t.sibling)){n.return=t.return,cs=n;break}cs=t.return}}function As(e){for(;null!==cs;){var t=cs;if(t===e){cs=null;break}var n=t.sibling;if(null!==n){n.return=t.return,cs=n;break}cs=t.return}}function Fs(e){for(;null!==cs;){var t=cs;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{gs(4,t)}catch(l){jo(t,n,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){jo(t,r,l)}}var s=t.return;try{fs(t)}catch(l){jo(t,s,l)}break;case 5:var o=t.return;try{fs(t)}catch(l){jo(t,o,l)}}}catch(l){jo(t,t.return,l)}if(t===e){cs=null;break}var a=t.sibling;if(null!==a){a.return=t.return,cs=a;break}cs=t.return}}var Ds=0,Ls=1,Is=2,ks=3,Os=4;if("function"===typeof Symbol&&Symbol.for){var Ns=Symbol.for;Ds=Ns("selector.component"),Ls=Ns("selector.has_pseudo_class"),Is=Ns("selector.role"),ks=Ns("selector.test_id"),Os=Ns("selector.text")}function Bs(e){var t=Y(e);if(null!=t){if("string"!==typeof t.memoizedProps["data-testname"])throw Error(o(364));return t}if(null===(e=re(e)))throw Error(o(362));return e.stateNode.current}function zs(e,t){switch(t.$$typeof){case Ds:if(e.type===t.value)return!0;break;case Ls:e:{t=t.value,e=[e,0];for(var n=0;n<e.length;){var i=e[n++],r=e[n++],s=t[r];if(5!==i.tag||!ae(i)){for(;null!=s&&zs(i,s);)s=t[++r];if(r===t.length){t=!0;break e}for(i=i.child;null!==i;)e.push(i,r),i=i.sibling}}t=!1}return t;case Is:if(5===e.tag&&le(e.stateNode,t.value))return!0;break;case Os:if((5===e.tag||6===e.tag)&&(null!==(e=oe(e))&&0<=e.indexOf(t.value)))return!0;break;case ks:if(5===e.tag&&("string"===typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function Hs(e){switch(e.$$typeof){case Ds:return"<"+(x(e.value)||"Unknown")+">";case Ls:return":has("+(Hs(e)||"")+")";case Is:return'[role="'+e.value+'"]';case Os:return'"'+e.value+'"';case ks:return'[data-testname="'+e.value+'"]';default:throw Error(o(365))}}function Gs(e,t){var n=[];e=[e,0];for(var i=0;i<e.length;){var r=e[i++],s=e[i++],o=t[s];if(5!==r.tag||!ae(r)){for(;null!=o&&zs(r,o);)o=t[++s];if(s===t.length)n.push(r);else for(r=r.child;null!==r;)e.push(r,s),r=r.sibling}}return n}function Us(e,t){if(!ie)throw Error(o(363));e=Gs(e=Bs(e),t),t=[],e=Array.from(e);for(var n=0;n<e.length;){var i=e[n++];if(5===i.tag)ae(i)||t.push(i.stateNode);else for(i=i.child;null!==i;)e.push(i),i=i.sibling}return t}var Vs=Math.ceil,Ws=a.ReactCurrentDispatcher,js=a.ReactCurrentOwner,qs=a.ReactCurrentBatchConfig,Xs=0,Ks=null,$s=null,Zs=0,Ys=0,Js=ot(0),Qs=0,eo=null,to=0,no=0,io=0,ro=null,so=null,oo=0,ao=1/0;function lo(){ao=Bt()+500}var co,uo=!1,ho=null,po=null,go=!1,fo=null,mo=0,vo=0,yo=null,Co=-1,wo=0;function So(){return 0!==(6&Xs)?Bt():-1!==Co?Co:Co=Bt()}function bo(e){return 0===(1&e.mode)?1:0!==(2&Xs)&&0!==Zs?Zs&-Zs:null!==Yt.transition?(0===wo&&(e=xt,0===(4194240&(xt<<=1))&&(xt=64),wo=e),wo):0!==(e=Dt)?e:Q()}function xo(e,t,n){if(50<vo)throw vo=0,yo=null,Error(o(185));var i=_o(e,t);return null===i?null:(At(i,t,n),0!==(2&Xs)&&i===Ks||(i===Ks&&(0===(2&Xs)&&(no|=t),4===Qs&&Po(i,Zs)),Mo(i,n),1===t&&0===Xs&&0===(1&e.mode)&&(lo(),Xt&&Zt())),i)}function _o(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function Mo(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-wt(s),a=1<<o,l=r[o];-1===l?0!==(a&n)&&0===(a&i)||(r[o]=Rt(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var i=Et(e,e===Ks?Zs:0);if(0===i)null!==n&&kt(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&kt(n),1===t)0===e.tag?function(e){Xt=!0,$t(e)}(Ao.bind(null,e)):$t(Ao.bind(null,e)),te?ne((function(){0===Xs&&Zt()})):It(zt,Zt),n=null;else{switch(Lt(i)){case 1:n=zt;break;case 4:n=Ht;break;case 16:default:n=Gt;break;case 536870912:n=Ut}n=Zo(n,Eo.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Eo(e,t){if(Co=-1,wo=0,0!==(6&Xs))throw Error(o(327));var n=e.callbackNode;if(Vo()&&e.callbackNode!==n)return null;var i=Et(e,e===Ks?Zs:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=No(e,i);else{t=i;var r=Xs;Xs|=2;var s=ko();for(Ks===e&&Zs===t||(lo(),Lo(e,t));;)try{zo();break}catch(l){Io(e,l)}on(),Ws.current=s,Xs=r,null!==$s?t=0:(Ks=null,Zs=0,t=Qs)}if(0!==t){if(2===t&&(0!==(r=Tt(e))&&(i=r,t=Ro(e,r))),1===t)throw n=eo,Lo(e,0),Po(e,i),Mo(e,Bt()),n;if(6===t)Po(e,i);else{if(r=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!jt(s(),r))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)&&(2===(t=No(e,i))&&(0!==(s=Tt(e))&&(i=s,t=Ro(e,s))),1===t))throw n=eo,Lo(e,0),Po(e,i),Mo(e,Bt()),n;switch(e.finishedWork=r,e.finishedLanes=i,t){case 0:case 1:throw Error(o(345));case 2:case 5:Uo(e,so);break;case 3:if(Po(e,i),(130023424&i)===i&&10<(t=oo+500-Bt())){if(0!==Et(e,0))break;if(((r=e.suspendedLanes)&i)!==i){So(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=W(Uo.bind(null,e,so),t);break}Uo(e,so);break;case 4:if(Po(e,i),(4194240&i)===i)break;for(t=e.eventTimes,r=-1;0<i;){var a=31-wt(i);s=1<<a,(a=t[a])>r&&(r=a),i&=~s}if(i=r,10<(i=(120>(i=Bt()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Vs(i/1960))-i)){e.timeoutHandle=W(Uo.bind(null,e,so),i);break}Uo(e,so);break;default:throw Error(o(329))}}}return Mo(e,Bt()),e.callbackNode===n?Eo.bind(null,e):null}function Ro(e,t){var n=ro;return e.current.memoizedState.isDehydrated&&(Lo(e,t).flags|=256),2!==(e=No(e,t))&&(t=so,so=n,null!==t&&To(t)),e}function To(e){null===so?so=e:so.push.apply(so,e)}function Po(e,t){for(t&=~io,t&=~no,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-wt(t),i=1<<n;e[n]=-1,t&=~i}}function Ao(e){if(0!==(6&Xs))throw Error(o(327));Vo();var t=Et(e,0);if(0===(1&t))return Mo(e,Bt()),null;var n=No(e,t);if(0!==e.tag&&2===n){var i=Tt(e);0!==i&&(t=i,n=Ro(e,i))}if(1===n)throw n=eo,Lo(e,0),Po(e,t),Mo(e,Bt()),n;if(6===n)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Uo(e,so),Mo(e,Bt()),null}function Fo(e){null!==fo&&0===fo.tag&&0===(6&Xs)&&Vo();var t=Xs;Xs|=1;var n=qs.transition,i=Dt;try{if(qs.transition=null,Dt=1,e)return e()}finally{Dt=i,qs.transition=n,0===(6&(Xs=t))&&Zt()}}function Do(){Ys=Js.current,at(Js)}function Lo(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==q&&(e.timeoutHandle=q,j(n)),null!==$s)for(n=$s.return;null!==n;){var i=n;switch(Gn(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&ft();break;case 3:pi(),at(ht),at(ut),Ci();break;case 5:fi(i);break;case 4:pi();break;case 13:case 19:at(mi);break;case 10:ln(i.type._context);break;case 22:case 23:Do()}n=n.return}if(Ks=e,$s=e=ea(e.current,null),Zs=Ys=t,Qs=0,eo=null,io=no=to=0,so=ro=null,null!==dn){for(t=0;t<dn.length;t++)if(null!==(i=(n=dn[t]).interleaved)){n.interleaved=null;var r=i.next,s=n.pending;if(null!==s){var o=s.next;s.next=r,i.next=o}n.pending=i}dn=null}return e}function Io(e,t){for(;;){var n=$s;try{if(on(),wi.current=pr,Ei){for(var i=xi.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}Ei=!1}if(bi=0,Mi=_i=xi=null,Ri=!1,Ti=0,js.current=null,null===n||null===n.return){Qs=1,eo=t,$s=null;break}e:{var s=e,a=n.return,l=n,c=t;if(t=Zs,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=Rr(a);if(null!==g){g.flags&=-257,Tr(g,a,l,0,t),1&g.mode&&Er(s,u,t),c=u;var f=(t=g).updateQueue;if(null===f){var m=new Set;m.add(c),t.updateQueue=m}else f.add(c);break e}if(0===(1&t)){Er(s,u,t),Oo();break e}c=Error(o(426))}else if(Wn&&1&l.mode){var v=Rr(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),Tr(v,a,l,0,t),ei(c);break e}}s=c,4!==Qs&&(Qs=2),null===ro?ro=[s]:ro.push(s),c=vr(c,l),l=a;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t,Cn(l,_r(0,c,t));break e;case 1:s=c;var y=l.type,C=l.stateNode;if(0===(128&l.flags)&&("function"===typeof y.getDerivedStateFromError||null!==C&&"function"===typeof C.componentDidCatch&&(null===po||!po.has(C)))){l.flags|=65536,t&=-t,l.lanes|=t,Cn(l,Mr(l,s,t));break e}}l=l.return}while(null!==l)}Go(n)}catch(w){t=w,$s===n&&null!==n&&($s=n=n.return);continue}break}}function ko(){var e=Ws.current;return Ws.current=pr,null===e?pr:e}function Oo(){0!==Qs&&3!==Qs&&2!==Qs||(Qs=4),null===Ks||0===(268435455&to)&&0===(268435455&no)||Po(Ks,Zs)}function No(e,t){var n=Xs;Xs|=2;var i=ko();for(Ks===e&&Zs===t||Lo(e,t);;)try{Bo();break}catch(r){Io(e,r)}if(on(),Xs=n,Ws.current=i,null!==$s)throw Error(o(261));return Ks=null,Zs=0,Qs}function Bo(){for(;null!==$s;)Ho($s)}function zo(){for(;null!==$s&&!Ot();)Ho($s)}function Ho(e){var t=co(e.alternate,e,Ys);e.memoizedProps=e.pendingProps,null===t?Go(e):$s=t,js.current=null}function Go(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ir(n,t,Ys)))return void($s=n)}else{if(null!==(n=ss(n,t)))return n.flags&=32767,void($s=n);if(null===e)return Qs=6,void($s=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void($s=t);$s=t=e}while(null!==t);0===Qs&&(Qs=5)}function Uo(e,t){var n=Dt,i=qs.transition;try{qs.transition=null,Dt=1,function(e,t,n){do{Vo()}while(null!==fo);if(0!==(6&Xs))throw Error(o(327));var i=e.finishedWork,r=e.finishedLanes;if(null===i)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var s=i.lanes|i.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-wt(n),s=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~s}}(e,s),e===Ks&&($s=Ks=null,Zs=0),0===(2064&i.subtreeFlags)&&0===(2064&i.flags)||go||(go=!0,Zo(Gt,(function(){return Vo(),null}))),s=0!==(15990&i.flags),0!==(15990&i.subtreeFlags)||s){s=qs.transition,qs.transition=null;var a=Dt;Dt=1;var l=Xs;Xs|=4,js.current=null,function(e,t){for(O(e.containerInfo),cs=t;null!==cs;)if(t=(e=cs).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,cs=t;else for(;null!==cs;){e=cs;try{var n=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==n){var i=n.memoizedProps,r=n.memoizedState,s=e.stateNode,a=s.getSnapshotBeforeUpdate(e.elementType===e.type?i:en(e.type,i),r);s.__reactInternalSnapshotBeforeUpdate=a}break;case 3:K&&Me(e.stateNode.containerInfo);break;default:throw Error(o(163))}}catch(l){jo(e,e.return,l)}if(null!==(t=e.sibling)){t.return=e.return,cs=t;break}cs=e.return}n=ds,ds=!1}(e,i),function(e,t){for(cs=t;null!==cs;){var n=(t=cs).deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var s=e;K?_s(s,r,t):vs(s,r,t);var o=r.alternate;null!==o&&(o.return=null),r.return=null}catch(S){jo(r,t,S)}}if(n=t.child,0!==(12854&t.subtreeFlags)&&null!==n)n.return=t,cs=n;else for(;null!==cs;){t=cs;try{var a=t.flags;if(32&a&&K&&we(t.stateNode),512&a){var l=t.alternate;if(null!==l){var c=l.ref;null!==c&&("function"===typeof c?c(null):c.current=null)}}if(8192&a)switch(t.tag){case 13:if(null!==t.memoizedState){var u=t.alternate;null!==u&&null!==u.memoizedState||(oo=Bt())}break;case 22:var h=null!==t.memoizedState,d=t.alternate,p=null!==d&&null!==d.memoizedState;if(n=t,K)e:if(i=n,r=h,s=null,K)for(var g=i;;){if(5===g.tag){if(null===s){s=g;var f=g.stateNode;r?Se(f):xe(g.stateNode,g.memoizedProps)}}else if(6===g.tag){if(null===s){var m=g.stateNode;r?be(m):_e(m,g.memoizedProps)}}else if((22!==g.tag&&23!==g.tag||null===g.memoizedState||g===i)&&null!==g.child){g.child.return=g,g=g.child;continue}if(g===i)break;for(;null===g.sibling;){if(null===g.return||g.return===i)break e;s===g&&(s=null),g=g.return}s===g&&(s=null),g.sibling.return=g.return,g=g.sibling}if(h&&!p&&0!==(1&n.mode)){cs=n;for(var v=n.child;null!==v;){for(n=cs=v;null!==cs;){var y=(i=cs).child;switch(i.tag){case 0:case 11:case 14:case 15:ps(4,i,i.return);break;case 1:us(i,i.return);var C=i.stateNode;if("function"===typeof C.componentWillUnmount){var w=i.return;try{C.props=i.memoizedProps,C.state=i.memoizedState,C.componentWillUnmount()}catch(S){jo(i,w,S)}}break;case 5:us(i,i.return);break;case 22:if(null!==i.memoizedState){As(n);continue}}null!==y?(y.return=i,cs=y):As(n)}v=v.sibling}}}switch(4102&a){case 2:Ss(t),t.flags&=-3;break;case 6:Ss(t),t.flags&=-3,Ms(t.alternate,t);break;case 4096:t.flags&=-4097;break;case 4100:t.flags&=-4097,Ms(t.alternate,t);break;case 4:Ms(t.alternate,t)}}catch(S){jo(t,t.return,S)}if(null!==(n=t.sibling)){n.return=t.return,cs=n;break}cs=t.return}}}(e,i),N(e.containerInfo),e.current=i,Rs(i,e,r),Nt(),Xs=l,Dt=a,qs.transition=s}else e.current=i;if(go&&(go=!1,fo=e,mo=r),s=e.pendingLanes,0===s&&(po=null),function(e){if(Wt&&"function"===typeof Wt.onCommitFiberRoot)try{Wt.onCommitFiberRoot(Vt,e,void 0,128===(128&e.current.flags))}catch(t){}}(i.stateNode),Mo(e,Bt()),null!==t)for(n=e.onRecoverableError,i=0;i<t.length;i++)n(t[i]);if(uo)throw uo=!1,e=ho,ho=null,e;0!==(1&mo)&&0!==e.tag&&Vo(),s=e.pendingLanes,0!==(1&s)?e===yo?vo++:(vo=0,yo=e):vo=0,Zt()}(e,t,n)}finally{qs.transition=i,Dt=n}return null}function Vo(){if(null!==fo){var e=Lt(mo),t=qs.transition,n=Dt;try{if(qs.transition=null,Dt=16>e?16:e,null===fo)var i=!1;else{if(e=fo,fo=null,mo=0,0!==(6&Xs))throw Error(o(331));var r=Xs;for(Xs|=4,cs=e.current;null!==cs;){var s=cs,a=s.child;if(0!==(16&cs.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(cs=u;null!==cs;){var h=cs;switch(h.tag){case 0:case 11:case 15:ps(8,h,s)}var d=h.child;if(null!==d)d.return=h,cs=d;else for(;null!==cs;){var p=(h=cs).sibling,g=h.return;if(ys(h),h===u){cs=null;break}if(null!==p){p.return=g,cs=p;break}cs=g}}}var f=s.alternate;if(null!==f){var m=f.child;if(null!==m){f.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}cs=s}}if(0!==(2064&s.subtreeFlags)&&null!==a)a.return=s,cs=a;else e:for(;null!==cs;){if(0!==(2048&(s=cs).flags))switch(s.tag){case 0:case 11:case 15:ps(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,cs=y;break e}cs=s.return}}var C=e.current;for(cs=C;null!==cs;){var w=(a=cs).child;if(0!==(2064&a.subtreeFlags)&&null!==w)w.return=a,cs=w;else e:for(a=C;null!==cs;){if(0!==(2048&(l=cs).flags))try{switch(l.tag){case 0:case 11:case 15:gs(9,l)}}catch(b){jo(l,l.return,b)}if(l===a){cs=null;break e}var S=l.sibling;if(null!==S){S.return=l.return,cs=S;break e}cs=l.return}}if(Xs=r,Zt(),Wt&&"function"===typeof Wt.onPostCommitFiberRoot)try{Wt.onPostCommitFiberRoot(Vt,e)}catch(b){}i=!0}return i}finally{Dt=n,qs.transition=t}}return!1}function Wo(e,t,n){vn(e,t=_r(0,t=vr(n,t),1)),t=So(),null!==(e=_o(e,1))&&(At(e,1,t),Mo(e,t))}function jo(e,t,n){if(3===e.tag)Wo(e,e,n);else for(;null!==t;){if(3===t.tag){Wo(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===po||!po.has(i))){vn(t,e=Mr(t,e=vr(n,e),1)),e=So(),null!==(t=_o(t,1))&&(At(t,1,e),Mo(t,e));break}}t=t.return}}function qo(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=So(),e.pingedLanes|=e.suspendedLanes&n,Ks===e&&(Zs&n)===n&&(4===Qs||3===Qs&&(130023424&Zs)===Zs&&500>Bt()-oo?Lo(e,0):io|=n),Mo(e,t)}function Xo(e,t){0===t&&(0===(1&e.mode)?t=1:(t=_t,0===(130023424&(_t<<=1))&&(_t=4194304)));var n=So();null!==(e=_o(e,t))&&(At(e,t,n),Mo(e,n))}function Ko(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Xo(e,n)}function $o(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(o(314))}null!==i&&i.delete(t),Xo(e,n)}function Zo(e,t){return It(e,t)}function Yo(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jo(e,t,n,i){return new Yo(e,t,n,i)}function Qo(e){return!(!(e=e.prototype)||!e.isReactComponent)}function ea(e,t){var n=e.alternate;return null===n?((n=Jo(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ta(e,t,n,i,r,s){var a=2;if(i=e,"function"===typeof e)Qo(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case u:return na(n.children,r,s,t);case h:a=8,r|=8;break;case d:return(e=Jo(12,n,t,2|r)).elementType=d,e.lanes=s,e;case m:return(e=Jo(13,n,t,r)).elementType=m,e.lanes=s,e;case v:return(e=Jo(19,n,t,r)).elementType=v,e.lanes=s,e;case w:return ia(n,r,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case p:a=10;break e;case g:a=9;break e;case f:a=11;break e;case y:a=14;break e;case C:a=16,i=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Jo(a,n,t,r)).elementType=e,t.type=i,t.lanes=s,t}function na(e,t,n,i){return(e=Jo(7,e,i,t)).lanes=n,e}function ia(e,t,n,i){return(e=Jo(22,e,i,t)).elementType=w,e.lanes=n,e.stateNode={},e}function ra(e,t,n){return(e=Jo(6,e,null,t)).lanes=n,e}function sa(e,t,n){return(t=Jo(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function oa(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=q,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Pt(0),this.expirationTimes=Pt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pt(0),this.identifierPrefix=i,this.onRecoverableError=r,Z&&(this.mutableSourceEagerHydrationData=null)}function aa(e,t,n,i,r,s,o,a,l){return e=new oa(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Jo(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null},gn(s),e}function la(e){if(!e)return ct;e:{if(M(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(gt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var n=e.type;if(gt(n))return vt(e,n,t)}return t}function ca(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return null===(e=T(t))?null:e.stateNode}function ua(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function ha(e,t){ua(e,t),(e=e.alternate)&&ua(e,t)}function da(e){return null===(e=T(e))?null:e.stateNode}function pa(){return null}return co=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||ht.current)Or=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return Or=!1,function(e,t,n){switch(t.tag){case 3:qr(t),Qn();break;case 5:gi(t);break;case 1:gt(t.type)&&yt(t);break;case 4:di(t,t.stateNode.containerInfo);break;case 10:an(0,t.type._context,t.memoizedProps.value);break;case 13:var i=t.memoizedState;if(null!==i)return null!==i.dehydrated?(lt(mi,1&mi.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Zr(e,t,n):(lt(mi,1&mi.current),null!==(e=rs(e,t,n))?e.sibling:null);lt(mi,1&mi.current);break;case 19:if(i=0!==(n&t.childLanes),0!==(128&e.flags)){if(i)return is(e,t,n);t.flags|=128}var r=t.memoizedState;if(null!==r&&(r.rendering=null,r.tail=null,r.lastEffect=null),lt(mi,mi.current),i)break;return null;case 22:case 23:return t.lanes=0,Gr(e,t,n)}return rs(e,t,n)}(e,t,n);Or=0!==(131072&e.flags)}else Or=!1,Wn&&0!==(1048576&t.flags)&&zn(t,Dn,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var r=pt(t,ut.current);un(t,n),r=Di(null,t,i,e,r,n);var s=Li();return t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,gt(i)?(s=!0,yt(t)):s=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,gn(t),r.updater=_n,t.stateNode=r,r._reactInternals=t,Tn(t,i,e,n),t=jr(null,t,i,!0,s,n)):(t.tag=0,Wn&&s&&Hn(t),Nr(null,t,r,n),t=t.child),t;case 16:i=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=(r=i._init)(i._payload),t.type=i,r=t.tag=function(e){if("function"===typeof e)return Qo(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===f)return 11;if(e===y)return 14}return 2}(i),e=en(i,e),r){case 0:t=Vr(null,t,i,e,n);break e;case 1:t=Wr(null,t,i,e,n);break e;case 11:t=Br(null,t,i,e,n);break e;case 14:t=zr(null,t,i,en(i.type,e),n);break e}throw Error(o(306,i,""))}return t;case 0:return i=t.type,r=t.pendingProps,Vr(e,t,i,r=t.elementType===i?r:en(i,r),n);case 1:return i=t.type,r=t.pendingProps,Wr(e,t,i,r=t.elementType===i?r:en(i,r),n);case 3:e:{if(qr(t),null===e)throw Error(o(387));i=t.pendingProps,r=(s=t.memoizedState).element,fn(e,t),wn(t,i,null,n);var a=t.memoizedState;if(i=a.element,Z&&s.isDehydrated){if(s={element:i,isDehydrated:!1,cache:a.cache,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Xr(e,t,i,n,r=Error(o(423)));break e}if(i!==r){t=Xr(e,t,i,n,r=Error(o(424)));break e}for(Z&&(Vn=Ge(t.stateNode.containerInfo),Un=t,Wn=!0,qn=null,jn=!1),n=oi(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(Qn(),i===r){t=rs(e,t,n);break e}Nr(e,t,i,n)}t=t.child}return t;case 5:return gi(t),null===e&&Zn(t),i=t.type,r=t.pendingProps,s=null!==e?e.memoizedProps:null,a=r.children,U(i,r)?a=null:null!==s&&U(i,s)&&(t.flags|=32),Ur(e,t),Nr(e,t,a,n),t.child;case 6:return null===e&&Zn(t),null;case 13:return Zr(e,t,n);case 4:return di(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=si(t,null,i,n):Nr(e,t,i,n),t.child;case 11:return i=t.type,r=t.pendingProps,Br(e,t,i,r=t.elementType===i?r:en(i,r),n);case 7:return Nr(e,t,t.pendingProps,n),t.child;case 8:case 12:return Nr(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,r=t.pendingProps,s=t.memoizedProps,an(0,i,a=r.value),null!==s)if(jt(s.value,a)){if(s.children===r.children&&!ht.current){t=rs(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){a=s.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===s.tag){(c=mn(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),cn(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(o(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),cn(a,n,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}Nr(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,i=t.pendingProps.children,un(t,n),i=i(r=hn(r)),t.flags|=1,Nr(e,t,i,n),t.child;case 14:return r=en(i=t.type,t.pendingProps),zr(e,t,i,r=en(i.type,r),n);case 15:return Hr(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,r=t.pendingProps,r=t.elementType===i?r:en(i,r),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,gt(i)?(e=!0,yt(t)):e=!1,un(t,n),En(t,i,r),Tn(t,i,r,n),jr(null,t,i,!0,e,n);case 19:return is(e,t,n);case 22:return Gr(e,t,n)}throw Error(o(156,t.tag))},t.attemptContinuousHydration=function(e){13===e.tag&&(xo(e,134217728,So()),ha(e,134217728))},t.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=So(),n=bo(e);xo(e,n,t),ha(e,n)}},t.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Mt(t.pendingLanes);0!==n&&(Ft(t,1|n),Mo(t,Bt()),0===(6&Xs)&&(lo(),Zt()))}break;case 13:var i=So();Fo((function(){return xo(e,1,i)})),ha(e,1)}},t.batchedUpdates=function(e,t){var n=Xs;Xs|=1;try{return e(t)}finally{0===(Xs=n)&&(lo(),Xt&&Zt())}},t.createComponentSelector=function(e){return{$$typeof:Ds,value:e}},t.createContainer=function(e,t,n,i,r,s,o){return aa(e,t,!1,null,0,i,0,s,o)},t.createHasPseudoClassSelector=function(e){return{$$typeof:Ls,value:e}},t.createHydrationContainer=function(e,t,n,i,r,s,o,a,l){return(e=aa(n,i,!0,e,0,s,0,a,l)).context=la(null),n=e.current,(s=mn(i=So(),r=bo(n))).callback=void 0!==t&&null!==t?t:null,vn(n,s),e.current.lanes=r,At(e,r,i),Mo(e,i),e},t.createPortal=function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:c,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}},t.createRoleSelector=function(e){return{$$typeof:Is,value:e}},t.createTestNameSelector=function(e){return{$$typeof:ks,value:e}},t.createTextSelector=function(e){return{$$typeof:Os,value:e}},t.deferredUpdates=function(e){var t=Dt,n=qs.transition;try{return qs.transition=null,Dt=16,e()}finally{Dt=t,qs.transition=n}},t.discreteUpdates=function(e,t,n,i,r){var s=Dt,o=qs.transition;try{return qs.transition=null,Dt=1,e(t,n,i,r)}finally{Dt=s,qs.transition=o,0===Xs&&lo()}},t.findAllNodes=Us,t.findBoundingRects=function(e,t){if(!ie)throw Error(o(363));t=Us(e,t),e=[];for(var n=0;n<t.length;n++)e.push(se(t[n]));for(t=e.length-1;0<t;t--)for(var i=(n=e[t]).x,r=i+n.width,s=n.y,a=s+n.height,l=t-1;0<=l;l--)if(t!==l){var c=e[l],u=c.x,h=u+c.width,d=c.y,p=d+c.height;if(i>=u&&s>=d&&r<=h&&a<=p){e.splice(t,1);break}if(!(i!==u||n.width!==c.width||p<s||d>a)){d>s&&(c.height+=d-s,c.y=s),p<a&&(c.height=a-d),e.splice(t,1);break}if(!(s!==d||n.height!==c.height||h<i||u>r)){u>i&&(c.width+=u-i,c.x=i),h<r&&(c.width=r-u),e.splice(t,1);break}}return e},t.findHostInstance=ca,t.findHostInstanceWithNoPortals=function(e){return null===(e=null!==(e=R(e))?A(e):null)?null:e.stateNode},t.findHostInstanceWithWarning=function(e){return ca(e)},t.flushControlled=function(e){var t=Xs;Xs|=1;var n=qs.transition,i=Dt;try{qs.transition=null,Dt=1,e()}finally{Dt=i,qs.transition=n,0===(Xs=t)&&(lo(),Zt())}},t.flushPassiveEffects=Vo,t.flushSync=Fo,t.focusWithin=function(e,t){if(!ie)throw Error(o(363));for(t=Gs(e=Bs(e),t),t=Array.from(t),e=0;e<t.length;){var n=t[e++];if(!ae(n)){if(5===n.tag&&ce(n.stateNode))return!0;for(n=n.child;null!==n;)t.push(n),n=n.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Dt},t.getFindAllNodesFailureDescription=function(e,t){if(!ie)throw Error(o(363));var n=0,i=[];e=[Bs(e),0];for(var r=0;r<e.length;){var s=e[r++],a=e[r++],l=t[a];if((5!==s.tag||!ae(s))&&(zs(s,l)&&(i.push(Hs(l)),++a>n&&(n=a)),a<t.length))for(s=s.child;null!==s;)e.push(s,a),s=s.sibling}if(n<t.length){for(e=[];n<t.length;n++)e.push(Hs(t[n]));return"findAllNodes was able to match part of the selector:\n  "+i.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},t.getPublicRootInstance=function(e){return(e=e.current).child?5===e.child.tag?L(e.child.stateNode):e.child.stateNode:null},t.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:da,findFiberByHostInstance:e.findFiberByHostInstance||pa,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},"undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)e=!0;else{try{Vt=t.inject(e),Wt=t}catch(n){}e=!!t.checkDCE}}return e},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(e,t,n,i){if(!ie)throw Error(o(363));e=Us(e,t);var r=ue(e,n,i).disconnect;return{disconnect:function(){r()}}},t.registerMutableSourceForHydration=function(e,t){var n=t._getVersion;n=n(t._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n)},t.runWithPriority=function(e,t){var n=Dt;try{return Dt=e,t()}finally{Dt=n}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(e,t,n,i){var r=t.current,s=So(),o=bo(r);return n=la(n),null===t.context?t.context=n:t.pendingContext=n,(t=mn(s,o)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),vn(r,t),null!==(e=xo(r,o,s))&&yn(e,r,o),o},t}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,n),s.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,i)=>(n.f[i](e,t),t)),[])),n.u=e=>"static/js/"+e+".bd6bd765.chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="inbound:";n.l=(i,r,s,o)=>{if(e[i])e[i].push(r);else{var a,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==t+s){a=h;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+s),a.src=i),e[i]=[r];var d=(t,n)=>{a.onerror=a.onload=null,clearTimeout(p);var r=e[i];if(delete e[i],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(n))),t)return t(n)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/wms_project_frontend/manager/inbound/",(()=>{var e={792:0};n.f.j=(t,i)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var s=new Promise(((n,i)=>r=e[t]=[n,i]));i.push(r[2]=s);var o=n.p+n.u(t),a=new Error;n.l(o,(i=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=i&&("load"===i.type?"missing":i.type),o=i&&i.target&&i.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,r[1](a)}}),"chunk-"+t,t)}};var t=(t,i)=>{var r,s,o=i[0],a=i[1],l=i[2],c=0;if(o.some((t=>0!==e[t]))){for(r in a)n.o(a,r)&&(n.m[r]=a[r]);if(l)l(n)}for(t&&t(i);c<o.length;c++)s=o[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},i=self.webpackChunkinbound=self.webpackChunkinbound||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{ACESFilmicToneMapping:()=>Rg,AddEquation:()=>qp,AddOperation:()=>bg,AdditiveAnimationBlendMode:()=>um,AdditiveBlending:()=>Up,AgXToneMapping:()=>Pg,AlphaFormat:()=>hf,AlwaysCompare:()=>Km,AlwaysDepth:()=>pg,AlwaysStencilFunc:()=>Hm,AmbientLight:()=>cM,AnimationAction:()=>QM,AnimationClip:()=>D_,AnimationLoader:()=>G_,AnimationMixer:()=>tE,AnimationObjectGroup:()=>JM,AnimationUtils:()=>C_,ArcCurve:()=>Vb,ArrayCamera:()=>PM,ArrowHelper:()=>ZE,AttachedBindMode:()=>Fg,Audio:()=>NM,AudioAnalyser:()=>VM,AudioContext:()=>xM,AudioListener:()=>OM,AudioLoader:()=>_M,AxesHelper:()=>YE,BackSide:()=>Bp,BasicDepthPacking:()=>gm,BasicShadowMap:()=>Lp,BatchedMesh:()=>QS,Bone:()=>hS,BooleanKeyframeTrack:()=>M_,Box2:()=>vE,Box3:()=>iy,Box3Helper:()=>jE,BoxGeometry:()=>dw,BoxHelper:()=>WE,BufferAttribute:()=>kC,BufferGeometry:()=>JC,BufferGeometryLoader:()=>mM,ByteType:()=>Qg,Cache:()=>I_,Camera:()=>yw,CameraHelper:()=>GE,CanvasTexture:()=>Rb,CapsuleGeometry:()=>Ab,CatmullRomCurve3:()=>$b,CineonToneMapping:()=>Eg,CircleGeometry:()=>Fb,ClampToEdgeWrapping:()=>Hg,Clock:()=>AM,Color:()=>bC,ColorKeyframeTrack:()=>E_,ColorManagement:()=>Ov,CompressedArrayTexture:()=>Mb,CompressedCubeTexture:()=>Eb,CompressedTexture:()=>_b,CompressedTextureLoader:()=>U_,ConeGeometry:()=>Lb,ConstantAlphaFactor:()=>ug,ConstantColorFactor:()=>lg,Controls:()=>QE,CubeCamera:()=>_w,CubeReflectionMapping:()=>Ig,CubeRefractionMapping:()=>kg,CubeTexture:()=>Mw,CubeTextureLoader:()=>W_,CubeUVReflectionMapping:()=>Bg,CubicBezierCurve:()=>Qb,CubicBezierCurve3:()=>ex,CubicInterpolant:()=>S_,CullFaceBack:()=>Ap,CullFaceFront:()=>Fp,CullFaceFrontBack:()=>Dp,CullFaceNone:()=>Pp,Curve:()=>Gb,CurvePath:()=>ax,CustomBlending:()=>jp,CustomToneMapping:()=>Tg,CylinderGeometry:()=>Db,Cylindrical:()=>gE,Data3DTexture:()=>Yv,DataArrayTexture:()=>$v,DataTexture:()=>dS,DataTextureLoader:()=>j_,DataUtils:()=>FC,DecrementStencilOp:()=>Pm,DecrementWrapStencilOp:()=>Fm,DefaultLoadingManager:()=>O_,DepthArrayTexture:()=>Pb,DepthFormat:()=>gf,DepthStencilFormat:()=>ff,DepthTexture:()=>Tb,DetachedBindMode:()=>Dg,DirectionalLight:()=>lM,DirectionalLightHelper:()=>BE,DiscreteInterpolant:()=>x_,DodecahedronGeometry:()=>kb,DoubleSide:()=>zp,DstAlphaFactor:()=>ig,DstColorFactor:()=>sg,DynamicCopyUsage:()=>nv,DynamicDrawUsage:()=>Zm,DynamicReadUsage:()=>Qm,EdgesGeometry:()=>Hb,EllipseCurve:()=>Ub,EqualCompare:()=>Vm,EqualDepth:()=>mg,EqualStencilFunc:()=>km,EquirectangularReflectionMapping:()=>Og,EquirectangularRefractionMapping:()=>Ng,Euler:()=>Hy,EventDispatcher:()=>hv,ExtrudeGeometry:()=>Hx,FileLoader:()=>H_,Float16BufferAttribute:()=>VC,Float32BufferAttribute:()=>WC,FloatType:()=>sf,Fog:()=>Fw,FogExp2:()=>Aw,FramebufferTexture:()=>xb,FrontSide:()=>Np,Frustum:()=>FS,FrustumArray:()=>IS,GLBufferAttribute:()=>lE,GLSL1:()=>rv,GLSL3:()=>sv,GreaterCompare:()=>jm,GreaterDepth:()=>yg,GreaterEqualCompare:()=>Xm,GreaterEqualDepth:()=>vg,GreaterEqualStencilFunc:()=>zm,GreaterStencilFunc:()=>Nm,GridHelper:()=>LE,Group:()=>Rw,HalfFloatType:()=>of,HemisphereLight:()=>K_,HemisphereLightHelper:()=>DE,IcosahedronGeometry:()=>Ux,ImageBitmapLoader:()=>SM,ImageLoader:()=>V_,ImageUtils:()=>Hv,IncrementStencilOp:()=>Tm,IncrementWrapStencilOp:()=>Am,InstancedBufferAttribute:()=>mS,InstancedBufferGeometry:()=>fM,InstancedInterleavedBuffer:()=>aE,InstancedMesh:()=>_S,Int16BufferAttribute:()=>zC,Int32BufferAttribute:()=>GC,Int8BufferAttribute:()=>OC,IntType:()=>nf,InterleavedBuffer:()=>Lw,InterleavedBufferAttribute:()=>kw,Interpolant:()=>w_,InterpolateDiscrete:()=>im,InterpolateLinear:()=>rm,InterpolateSmooth:()=>sm,InterpolationSamplingMode:()=>uv,InterpolationSamplingType:()=>cv,InvertStencilOp:()=>Dm,KeepStencilOp:()=>Em,KeyframeTrack:()=>__,LOD:()=>eS,LatheGeometry:()=>Vx,Layers:()=>Gy,LessCompare:()=>Um,LessDepth:()=>gg,LessEqualCompare:()=>Wm,LessEqualDepth:()=>fg,LessEqualStencilFunc:()=>Om,LessStencilFunc:()=>Im,Light:()=>X_,LightProbe:()=>dM,Line:()=>lb,Line3:()=>wE,LineBasicMaterial:()=>eb,LineCurve:()=>tx,LineCurve3:()=>nx,LineDashedMaterial:()=>p_,LineLoop:()=>pb,LineSegments:()=>db,LinearFilter:()=>Xg,LinearInterpolant:()=>b_,LinearMipMapLinearFilter:()=>Yg,LinearMipMapNearestFilter:()=>$g,LinearMipmapLinearFilter:()=>Zg,LinearMipmapNearestFilter:()=>Kg,LinearSRGBColorSpace:()=>bm,LinearToneMapping:()=>_g,LinearTransfer:()=>xm,Loader:()=>N_,LoaderUtils:()=>gM,LoadingManager:()=>k_,LoopOnce:()=>em,LoopPingPong:()=>nm,LoopRepeat:()=>tm,MOUSE:()=>Rp,Material:()=>MC,MaterialLoader:()=>pM,MathUtils:()=>bv,Matrix2:()=>fE,Matrix3:()=>_v,Matrix4:()=>Ay,MaxEquation:()=>Zp,Mesh:()=>uw,MeshBasicMaterial:()=>EC,MeshDepthMaterial:()=>u_,MeshDistanceMaterial:()=>h_,MeshLambertMaterial:()=>c_,MeshMatcapMaterial:()=>d_,MeshNormalMaterial:()=>l_,MeshPhongMaterial:()=>o_,MeshPhysicalMaterial:()=>s_,MeshStandardMaterial:()=>r_,MeshToonMaterial:()=>a_,MinEquation:()=>$p,MirroredRepeatWrapping:()=>Gg,MixOperation:()=>Sg,MultiplyBlending:()=>Wp,MultiplyOperation:()=>wg,NearestFilter:()=>Ug,NearestMipMapLinearFilter:()=>qg,NearestMipMapNearestFilter:()=>Wg,NearestMipmapLinearFilter:()=>jg,NearestMipmapNearestFilter:()=>Vg,NeutralToneMapping:()=>Ag,NeverCompare:()=>Gm,NeverDepth:()=>dg,NeverStencilFunc:()=>Lm,NoBlending:()=>Hp,NoColorSpace:()=>wm,NoToneMapping:()=>xg,NormalAnimationBlendMode:()=>cm,NormalBlending:()=>Gp,NotEqualCompare:()=>qm,NotEqualDepth:()=>Cg,NotEqualStencilFunc:()=>Bm,NumberKeyframeTrack:()=>R_,Object3D:()=>iC,ObjectLoader:()=>vM,ObjectSpaceNormalMap:()=>Cm,OctahedronGeometry:()=>Wx,OneFactor:()=>Jp,OneMinusConstantAlphaFactor:()=>hg,OneMinusConstantColorFactor:()=>cg,OneMinusDstAlphaFactor:()=>rg,OneMinusDstColorFactor:()=>og,OneMinusSrcAlphaFactor:()=>ng,OneMinusSrcColorFactor:()=>eg,OrthographicCamera:()=>oM,PCFShadowMap:()=>Ip,PCFSoftShadowMap:()=>kp,PMREMGenerator:()=>TR,Path:()=>lx,PerspectiveCamera:()=>bw,Plane:()=>TS,PlaneGeometry:()=>jx,PlaneHelper:()=>qE,PointLight:()=>sM,PointLightHelper:()=>TE,Points:()=>Cb,PointsMaterial:()=>gb,PolarGridHelper:()=>IE,PolyhedronGeometry:()=>Ib,PositionalAudio:()=>UM,PropertyBinding:()=>YM,PropertyMixer:()=>WM,QuadraticBezierCurve:()=>ix,QuadraticBezierCurve3:()=>rx,Quaternion:()=>Qv,QuaternionKeyframeTrack:()=>P_,QuaternionLinearInterpolant:()=>T_,RED_GREEN_RGTC2_Format:()=>Jf,RED_RGTC1_Format:()=>Zf,REVISION:()=>Ep,RGBADepthPacking:()=>fm,RGBAFormat:()=>pf,RGBAIntegerFormat:()=>Sf,RGBA_ASTC_10x10_Format:()=>Wf,RGBA_ASTC_10x5_Format:()=>Gf,RGBA_ASTC_10x6_Format:()=>Uf,RGBA_ASTC_10x8_Format:()=>Vf,RGBA_ASTC_12x10_Format:()=>jf,RGBA_ASTC_12x12_Format:()=>qf,RGBA_ASTC_4x4_Format:()=>Lf,RGBA_ASTC_5x4_Format:()=>If,RGBA_ASTC_5x5_Format:()=>kf,RGBA_ASTC_6x5_Format:()=>Of,RGBA_ASTC_6x6_Format:()=>Nf,RGBA_ASTC_8x5_Format:()=>Bf,RGBA_ASTC_8x6_Format:()=>zf,RGBA_ASTC_8x8_Format:()=>Hf,RGBA_BPTC_Format:()=>Xf,RGBA_ETC2_EAC_Format:()=>Df,RGBA_PVRTC_2BPPV1_Format:()=>Pf,RGBA_PVRTC_4BPPV1_Format:()=>Tf,RGBA_S3TC_DXT1_Format:()=>xf,RGBA_S3TC_DXT3_Format:()=>_f,RGBA_S3TC_DXT5_Format:()=>Mf,RGBDepthPacking:()=>mm,RGBFormat:()=>df,RGBIntegerFormat:()=>wf,RGB_BPTC_SIGNED_Format:()=>Kf,RGB_BPTC_UNSIGNED_Format:()=>$f,RGB_ETC1_Format:()=>Af,RGB_ETC2_Format:()=>Ff,RGB_PVRTC_2BPPV1_Format:()=>Rf,RGB_PVRTC_4BPPV1_Format:()=>Ef,RGB_S3TC_DXT1_Format:()=>bf,RGDepthPacking:()=>vm,RGFormat:()=>yf,RGIntegerFormat:()=>Cf,RawShaderMaterial:()=>i_,Ray:()=>Py,Raycaster:()=>uE,RectAreaLight:()=>uM,RedFormat:()=>mf,RedIntegerFormat:()=>vf,ReinhardToneMapping:()=>Mg,RenderTarget:()=>Xv,RenderTarget3D:()=>nE,RenderTargetArray:()=>iE,RepeatWrapping:()=>zg,ReplaceStencilOp:()=>Rm,ReverseSubtractEquation:()=>Kp,RingGeometry:()=>qx,SIGNED_RED_GREEN_RGTC2_Format:()=>Qf,SIGNED_RED_RGTC1_Format:()=>Yf,SRGBColorSpace:()=>Sm,SRGBTransfer:()=>_m,Scene:()=>Dw,ShaderChunk:()=>rR,ShaderLib:()=>oR,ShaderMaterial:()=>vw,ShadowMaterial:()=>n_,Shape:()=>cx,ShapeGeometry:()=>Xx,ShapePath:()=>JE,ShapeUtils:()=>Nx,ShortType:()=>ef,Skeleton:()=>fS,SkeletonHelper:()=>EE,SkinnedMesh:()=>uS,Source:()=>Uv,Sphere:()=>Sy,SphereGeometry:()=>Kx,Spherical:()=>pE,SphericalHarmonics3:()=>hM,SplineCurve:()=>sx,SpotLight:()=>eM,SpotLightHelper:()=>bE,Sprite:()=>Zw,SpriteMaterial:()=>Ow,SrcAlphaFactor:()=>tg,SrcAlphaSaturateFactor:()=>ag,SrcColorFactor:()=>Qp,StaticCopyUsage:()=>tv,StaticDrawUsage:()=>$m,StaticReadUsage:()=>Jm,StereoCamera:()=>TM,StreamCopyUsage:()=>iv,StreamDrawUsage:()=>Ym,StreamReadUsage:()=>ev,StringKeyframeTrack:()=>A_,SubtractEquation:()=>Xp,SubtractiveBlending:()=>Vp,TOUCH:()=>Tp,TangentSpaceNormalMap:()=>ym,TetrahedronGeometry:()=>$x,Texture:()=>jv,TextureLoader:()=>q_,TextureUtils:()=>tR,TimestampQuery:()=>lv,TorusGeometry:()=>Zx,TorusKnotGeometry:()=>Yx,Triangle:()=>vC,TriangleFanDrawMode:()=>pm,TriangleStripDrawMode:()=>dm,TrianglesDrawMode:()=>hm,TubeGeometry:()=>Jx,UVMapping:()=>Lg,Uint16BufferAttribute:()=>HC,Uint32BufferAttribute:()=>UC,Uint8BufferAttribute:()=>NC,Uint8ClampedBufferAttribute:()=>BC,Uniform:()=>rE,UniformsGroup:()=>oE,UniformsLib:()=>sR,UniformsUtils:()=>mw,UnsignedByteType:()=>Jg,UnsignedInt248Type:()=>cf,UnsignedInt5999Type:()=>uf,UnsignedIntType:()=>rf,UnsignedShort4444Type:()=>af,UnsignedShort5551Type:()=>lf,UnsignedShortType:()=>tf,VSMShadowMap:()=>Op,Vector2:()=>xv,Vector3:()=>ey,Vector4:()=>qv,VectorKeyframeTrack:()=>F_,VideoFrameTexture:()=>bb,VideoTexture:()=>Sb,WebGL3DRenderTarget:()=>Jv,WebGLArrayRenderTarget:()=>Zv,WebGLCoordinateSystem:()=>ov,WebGLCubeRenderTarget:()=>Ew,WebGLRenderTarget:()=>Kv,WebGLRenderer:()=>BP,WebGLUtils:()=>FP,WebGPUCoordinateSystem:()=>av,WebXRController:()=>Pw,WireframeGeometry:()=>Qx,WrapAroundEnding:()=>lm,ZeroCurvatureEnding:()=>om,ZeroFactor:()=>Yp,ZeroSlopeEnding:()=>am,ZeroStencilOp:()=>Mm,createCanvasElement:()=>Av});var t=n(43),i=n(391),r=(n(358),"popstate");function s(){return d((function(e,t){let{pathname:n="/",search:i="",hash:r=""}=h(e.location.hash.substring(1));return n.startsWith("/")||n.startsWith(".")||(n="/"+n),c("",{pathname:n,search:i,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){let n=e.document.querySelector("base"),i="";if(n&&n.getAttribute("href")){let t=e.location.href,n=t.indexOf("#");i=-1===n?t:t.slice(0,n)}return i+"#"+("string"===typeof t?t:u(t))}),(function(e,t){a("/"===e.pathname.charAt(0),`relative pathnames are not supported in hash history.push(${JSON.stringify(t)})`)}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function o(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function a(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function l(e,t){return{usr:e.state,key:e.key,idx:t}}function c(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return{pathname:"string"===typeof e?e:e.pathname,search:"",hash:"",..."string"===typeof t?h(t):t,state:n,key:t&&t.key||i||Math.random().toString(36).substring(2,10)}}function u(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(t+="#"===i.charAt(0)?i:"#"+i),t}function h(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substring(i),e=e.substring(0,i)),e&&(t.pathname=e)}return t}function d(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:s=document.defaultView,v5Compat:a=!1}=i,h=s.history,d="POP",p=null,g=f();function f(){return(h.state||{idx:null}).idx}function m(){d="POP";let e=f(),t=null==e?null:e-g;g=e,p&&p({action:d,location:y.location,delta:t})}function v(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,n="string"===typeof e?e:u(e);return n=n.replace(/ $/,"%20"),o(t,`No window.location.(origin|href) available to create URL for href: ${n}`),new URL(n,t)}null==g&&(g=0,h.replaceState({...h.state,idx:g},""));let y={get action(){return d},get location(){return e(s,h)},listen(e){if(p)throw new Error("A history only accepts one active listener");return s.addEventListener(r,m),p=e,()=>{s.removeEventListener(r,m),p=null}},createHref:e=>t(s,e),createURL:v,encodeLocation(e){let t=v(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){d="PUSH";let i=c(y.location,e,t);n&&n(i,e),g=f()+1;let r=l(i,g),o=y.createHref(i);try{h.pushState(r,"",o)}catch(CF){if(CF instanceof DOMException&&"DataCloneError"===CF.name)throw CF;s.location.assign(o)}a&&p&&p({action:d,location:y.location,delta:1})},replace:function(e,t){d="REPLACE";let i=c(y.location,e,t);n&&n(i,e),g=f();let r=l(i,g),s=y.createHref(i);h.replaceState(r,"",s),a&&p&&p({action:d,location:y.location,delta:0})},go:e=>h.go(e)};return y}new WeakMap;function p(e,t){return g(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function g(e,t,n,i){let r=T(("string"===typeof t?h(t):t).pathname||"/",n);if(null==r)return null;let s=f(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(s);let o=null;for(let a=0;null==o&&a<s.length;++a){let e=R(r);o=M(s[a],e,i)}return o}function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=(e,r,s)=>{let a={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:r,route:e};a.relativePath.startsWith("/")&&(o(a.relativePath.startsWith(i),`Absolute route path "${a.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),a.relativePath=a.relativePath.slice(i.length));let l=L([i,a.relativePath]),c=n.concat(a);e.children&&e.children.length>0&&(o(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),f(e.children,t,c,l)),(null!=e.path||e.index)&&t.push({path:l,score:_(l,e.index),routesMeta:c})};return e.forEach(((e,t)=>{if(""!==e.path&&e.path?.includes("?"))for(let n of m(e.path))r(e,t,n);else r(e,t)})),t}function m(e){let t=e.split("/");if(0===t.length)return[];let[n,...i]=t,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===i.length)return r?[s,""]:[s];let o=m(i.join("/")),a=[];return a.push(...o.map((e=>""===e?s:[s,e].join("/")))),r&&a.push(...o),a.map((t=>e.startsWith("/")&&""===t?"/":t))}var v=/^:[\w-]+$/,y=3,C=2,w=1,S=10,b=-2,x=e=>"*"===e;function _(e,t){let n=e.split("/"),i=n.length;return n.some(x)&&(i+=b),t&&(i+=C),n.filter((e=>!x(e))).reduce(((e,t)=>e+(v.test(t)?y:""===t?w:S)),i)}function M(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:i}=e,r={},s="/",o=[];for(let a=0;a<i.length;++a){let e=i[a],l=a===i.length-1,c="/"===s?t:t.slice(s.length)||"/",u=E({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),h=e.route;if(!u&&l&&n&&!i[i.length-1].route.index&&(u=E({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(r,u.params),o.push({params:r,pathname:L([s,u.pathname]),pathnameBase:I(L([s,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(s=L([s,u.pathnameBase]))}return o}function E(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];a("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let i=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(i.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(i.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))");let s=new RegExp(r,t?void 0:"i");return[s,i]}(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),l=r.slice(1);return{params:i.reduce(((e,t,n)=>{let{paramName:i,isOptional:r}=t;if("*"===i){let e=l[n]||"";o=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const a=l[n];return e[i]=r&&!a?void 0:(a||"").replace(/%2F/g,"/"),e}),{}),pathname:s,pathnameBase:o,pattern:e}}function R(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(CF){return a(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${CF}).`),e}}function T(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&"/"!==i?null:e.slice(n)||"/"}function P(e,t,n,i){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function A(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function F(e){let t=A(e);return t.map(((e,n)=>n===t.length-1?e.pathname:e.pathnameBase))}function D(e,t,n){let i,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?i=h(e):(i={...e},o(!i.pathname||!i.pathname.includes("?"),P("?","pathname","search",i)),o(!i.pathname||!i.pathname.includes("#"),P("#","pathname","hash",i)),o(!i.search||!i.search.includes("#"),P("#","search","hash",i)));let s,a=""===e||""===i.pathname,l=a?"/":i.pathname;if(null==l)s=n;else{let e=t.length-1;if(!r&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}s=e>=0?t[e]:"/"}let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:i="",hash:r=""}="string"===typeof e?h(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:k(i),hash:O(r)}}(i,s),u=l&&"/"!==l&&l.endsWith("/"),d=(a||"."===l)&&n.endsWith("/");return c.pathname.endsWith("/")||!u&&!d||(c.pathname+="/"),c}var L=e=>e.join("/").replace(/\/\/+/g,"/"),I=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),k=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",O=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function N(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var B=["POST","PUT","PATCH","DELETE"],z=(new Set(B),["GET",...B]);new Set(z),Symbol("ResetLoaderData");var H=t.createContext(null);H.displayName="DataRouter";var G=t.createContext(null);G.displayName="DataRouterState";var U=t.createContext({isTransitioning:!1});U.displayName="ViewTransition";var V=t.createContext(new Map);V.displayName="Fetchers";var W=t.createContext(null);W.displayName="Await";var j=t.createContext(null);j.displayName="Navigation";var q=t.createContext(null);q.displayName="Location";var X=t.createContext({outlet:null,matches:[],isDataRoute:!1});X.displayName="Route";var K=t.createContext(null);K.displayName="RouteError";function $(){return null!=t.useContext(q)}function Z(){return o($(),"useLocation() may be used only in the context of a <Router> component."),t.useContext(q).location}var Y="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function J(e){t.useContext(j).static||t.useLayoutEffect(e)}function Q(){let{isDataRoute:e}=t.useContext(X);return e?function(){let{router:e}=le("useNavigate"),n=ue("useNavigate"),i=t.useRef(!1);J((()=>{i.current=!0}));let r=t.useCallback((async function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(i.current,Y),i.current&&("number"===typeof t?e.navigate(t):await e.navigate(t,{fromRouteId:n,...r}))}),[e,n]);return r}():function(){o($(),"useNavigate() may be used only in the context of a <Router> component.");let e=t.useContext(H),{basename:n,navigator:i}=t.useContext(j),{matches:r}=t.useContext(X),{pathname:s}=Z(),l=JSON.stringify(F(r)),c=t.useRef(!1);J((()=>{c.current=!0}));let u=t.useCallback((function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a(c.current,Y),!c.current)return;if("number"===typeof t)return void i.go(t);let o=D(t,JSON.parse(l),s,"path"===r.relative);null==e&&"/"!==n&&(o.pathname="/"===o.pathname?n:L([n,o.pathname])),(r.replace?i.replace:i.push)(o,r.state,r)}),[n,i,l,s,e]);return u}()}t.createContext(null);function ee(e){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:i}=t.useContext(X),{pathname:r}=Z(),s=JSON.stringify(F(i));return t.useMemo((()=>D(e,JSON.parse(s),r,"path"===n)),[e,s,r,n])}function te(e,n,i,r){o($(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s,static:l}=t.useContext(j),{matches:c}=t.useContext(X),u=c[c.length-1],d=u?u.params:{},g=u?u.pathname:"/",f=u?u.pathnameBase:"/",m=u&&u.route;{let e=m&&m.path||"";pe(g,!m||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}let v,y=Z();if(n){let e="string"===typeof n?h(n):n;o("/"===f||e.pathname?.startsWith(f),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${e.pathname}" was given in the \`location\` prop.`),v=e}else v=y;let C=v.pathname||"/",w=C;if("/"!==f){let e=f.replace(/^\//,"").split("/");w="/"+C.replace(/^\//,"").split("/").slice(e.length).join("/")}let S=!l&&i&&i.matches&&i.matches.length>0?i.matches:p(e,{pathname:w});a(m||null!=S,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),a(null==S||void 0!==S[S.length-1].route.element||void 0!==S[S.length-1].route.Component||void 0!==S[S.length-1].route.lazy,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=oe(S&&S.map((e=>Object.assign({},e,{params:Object.assign({},d,e.params),pathname:L([f,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?f:L([f,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),c,i,r);return n&&b?t.createElement(q.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},b):b}function ne(){let e=he(),n=N(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),i=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},a=null;return console.error("Error handled by React Router default ErrorBoundary:",e),a=t.createElement(t.Fragment,null,t.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),t.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",t.createElement("code",{style:o},"ErrorBoundary")," or"," ",t.createElement("code",{style:o},"errorElement")," prop on your route.")),t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},n),i?t.createElement("pre",{style:s},i):null,a)}var ie=t.createElement(ne,null),re=class extends t.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?t.createElement(X.Provider,{value:this.props.routeContext},t.createElement(K.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function se(e){let{routeContext:n,match:i,children:r}=e,s=t.useContext(H);return s&&s.static&&s.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=i.route.id),t.createElement(X.Provider,{value:n},r)}function oe(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null==e){if(!i)return null;if(i.errors)e=i.matches;else{if(0!==n.length||i.initialized||!(i.matches.length>0))return null;e=i.matches}}let r=e,s=i?.errors;if(null!=s){let e=r.findIndex((e=>e.route.id&&void 0!==s?.[e.route.id]));o(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),r=r.slice(0,Math.min(r.length,e+1))}let a=!1,l=-1;if(i)for(let t=0;t<r.length;t++){let e=r[t];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(l=t),e.route.id){let{loaderData:t,errors:n}=i,s=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!n||void 0===n[e.route.id]);if(e.route.lazy||s){a=!0,r=l>=0?r.slice(0,l+1):[r[0]];break}}}return r.reduceRight(((e,o,c)=>{let u,h=!1,d=null,p=null;i&&(u=s&&o.route.id?s[o.route.id]:void 0,d=o.route.errorElement||ie,a&&(l<0&&0===c?(pe("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,p=null):l===c&&(h=!0,p=o.route.hydrateFallbackElement||null)));let g=n.concat(r.slice(0,c+1)),f=()=>{let n;return n=u?d:h?p:o.route.Component?t.createElement(o.route.Component,null):o.route.element?o.route.element:e,t.createElement(se,{match:o,routeContext:{outlet:e,matches:g,isDataRoute:null!=i},children:n})};return i&&(o.route.ErrorBoundary||o.route.errorElement||0===c)?t.createElement(re,{location:i.location,revalidation:i.revalidation,component:d,error:u,children:f(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):f()}),null)}function ae(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function le(e){let n=t.useContext(H);return o(n,ae(e)),n}function ce(e){let n=t.useContext(G);return o(n,ae(e)),n}function ue(e){let n=function(e){let n=t.useContext(X);return o(n,ae(e)),n}(e),i=n.matches[n.matches.length-1];return o(i.route.id,`${e} can only be used on routes that contain a unique "id"`),i.route.id}function he(){let e=t.useContext(K),n=ce("useRouteError"),i=ue("useRouteError");return void 0!==e?e:n.errors?.[i]}var de={};function pe(e,t,n){t||de[e]||(de[e]=!0,a(!1,n))}t.memo((function(e){let{routes:t,future:n,state:i}=e;return te(t,void 0,i,n)}));function ge(e){o(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function fe(e){let{basename:n="/",children:i=null,location:r,navigationType:s="POP",navigator:l,static:c=!1}=e;o(!$(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=n.replace(/^\/*/,"/"),d=t.useMemo((()=>({basename:u,navigator:l,static:c,future:{}})),[u,l,c]);"string"===typeof r&&(r=h(r));let{pathname:p="/",search:g="",hash:f="",state:m=null,key:v="default"}=r,y=t.useMemo((()=>{let e=T(p,u);return null==e?null:{location:{pathname:e,search:g,hash:f,state:m,key:v},navigationType:s}}),[u,p,g,f,m,v,s]);return a(null!=y,`<Router basename="${u}"> is not able to match the URL "${p}${g}${f}" because it does not start with the basename, so the <Router> won't render anything.`),null==y?null:t.createElement(j.Provider,{value:d},t.createElement(q.Provider,{children:i,value:y}))}function me(e){let{children:t,location:n}=e;return te(ve(t),n)}t.Component;function ve(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];return t.Children.forEach(e,((e,r)=>{if(!t.isValidElement(e))return;let s=[...n,r];if(e.type===t.Fragment)return void i.push.apply(i,ve(e.props.children,s));o(e.type===ge,`[${"string"===typeof e.type?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),o(!e.props.index||!e.props.children,"An index route cannot have child routes.");let a={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=ve(e.props.children,s)),i.push(a)})),i}var ye="get",Ce="application/x-www-form-urlencoded";function we(e){return null!=e&&"string"===typeof e.tagName}var Se=null;var be=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function xe(e){return null==e||be.has(e)?e:(a(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ce}"`),null)}function _e(e,t){let n,i,r,s,o;if(we(a=e)&&"form"===a.tagName.toLowerCase()){let o=e.getAttribute("action");i=o?T(o,t):null,n=e.getAttribute("method")||ye,r=xe(e.getAttribute("enctype"))||Ce,s=new FormData(e)}else if(function(e){return we(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return we(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let o=e.form;if(null==o)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let a=e.getAttribute("formaction")||o.getAttribute("action");if(i=a?T(a,t):null,n=e.getAttribute("formmethod")||o.getAttribute("method")||ye,r=xe(e.getAttribute("formenctype"))||xe(o.getAttribute("enctype"))||Ce,s=new FormData(o,e),!function(){if(null===Se)try{new FormData(document.createElement("form"),0),Se=!1}catch(e){Se=!0}return Se}()){let{name:t,type:n,value:i}=e;if("image"===n){let e=t?`${t}.`:"";s.append(`${e}x`,"0"),s.append(`${e}y`,"0")}else t&&s.append(t,i)}}else{if(we(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=ye,i=null,r=Ce,o=e}var a;return s&&"text/plain"===r&&(o=s,s=void 0),{action:i,method:n.toLowerCase(),encType:r,formData:s,body:o}}function Me(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}async function Ee(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(CF){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(CF),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise((()=>{}))}}function Re(e){return null!=e&&"string"===typeof e.page}function Te(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Pe(e,t,n,i,r,s){let o=(e,t)=>!n[t]||e.route.id!==n[t].route.id,a=(e,t)=>n[t].pathname!==e.pathname||n[t].route.path?.endsWith("*")&&n[t].params["*"]!==e.params["*"];return"assets"===s?t.filter(((e,t)=>o(e,t)||a(e,t))):"data"===s?t.filter(((t,s)=>{let l=i.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(o(t,s)||a(t,s))return!0;if(t.route.shouldRevalidate){let i=t.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof i)return i}return!0})):[]}function Ae(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i=e.map((e=>{let i=t.routes[e.route.id];if(!i)return[];let r=[i.module];return i.clientActionModule&&(r=r.concat(i.clientActionModule)),i.clientLoaderModule&&(r=r.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(r=r.concat(i.hydrateFallbackModule)),i.imports&&(r=r.concat(i.imports)),r})).flat(1),[...new Set(i)];var i}function Fe(e,t){let n=new Set,i=new Set(t);return e.reduce(((e,r)=>{if(t&&!Re(r)&&"script"===r.as&&r.href&&i.has(r.href))return e;let s=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let i of n)t[i]=e[i];return t}(r));return n.has(s)||(n.add(s),e.push({key:s,link:r})),e}),[])}function De(e){return{__html:e}}Symbol("SingleFetchRedirect");function Le(e,t){let n="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===n.pathname?n.pathname="_root.data":t&&"/"===T(n.pathname,t)?n.pathname=`${t.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}t.Component;function Ie(e){let{error:n,isOutsideRemixApp:i}=e;console.error(n);let r,s=t.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://remix.run/guides/errors for more information."\n        );\n      '}});if(N(n))return t.createElement(ke,{title:"Unhandled Thrown Response!"},t.createElement("h1",{style:{fontSize:"24px"}},n.status," ",n.statusText),s);if(n instanceof Error)0;else{let e=null==n?"Unknown Error":"object"===typeof n&&"toString"in n?n.toString():JSON.stringify(n);new Error(e)}return t.createElement(ke,{title:"Application Error!",isOutsideRemixApp:i},t.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),t.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},r.stack),s)}function ke(e){let{title:n,renderScripts:i,isOutsideRemixApp:r,children:s}=e,{routeModules:o}=He();return o.root?.Layout&&!r?s:t.createElement("html",{lang:"en"},t.createElement("head",null,t.createElement("meta",{charSet:"utf-8"}),t.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),t.createElement("title",null,n)),t.createElement("body",null,t.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},s,i?t.createElement(Xe,null):null)))}function Oe(e){return!0===e}function Ne(){let e=t.useContext(H);return Me(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Be(){let e=t.useContext(G);return Me(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var ze=t.createContext(void 0);function He(){let e=t.useContext(ze);return Me(e,"You must render this element inside a <HydratedRouter> element"),e}function Ge(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function Ue(e,t,n){if(n&&!qe)return[e[0]];if(t){let n=e.findIndex((e=>void 0!==t[e.route.id]));return e.slice(0,n+1)}return e}function Ve(e){let{page:n,...i}=e,{router:r}=Ne(),s=t.useMemo((()=>p(r.routes,n,r.basename)),[r.routes,n,r.basename]);return s?t.createElement(je,{page:n,matches:s,...i}):null}function We(e){let{manifest:n,routeModules:i}=He(),[r,s]=t.useState([]);return t.useEffect((()=>{let t=!1;return async function(e,t,n){let i=await Promise.all(e.map((async e=>{let i=t.routes[e.route.id];if(i){let e=await Ee(i,n);return e.links?e.links():[]}return[]})));return Fe(i.flat(1).filter(Te).filter((e=>"stylesheet"===e.rel||"preload"===e.rel)).map((e=>"stylesheet"===e.rel?{...e,rel:"prefetch",as:"style"}:{...e,rel:"prefetch"})))}(e,n,i).then((e=>{t||s(e)})),()=>{t=!0}}),[e,n,i]),r}function je(e){let{page:n,matches:i,...r}=e,s=Z(),{manifest:o,routeModules:a}=He(),{basename:l}=Ne(),{loaderData:c,matches:u}=Be(),h=t.useMemo((()=>Pe(n,i,u,o,s,"data")),[n,i,u,o,s]),d=t.useMemo((()=>Pe(n,i,u,o,s,"assets")),[n,i,u,o,s]),p=t.useMemo((()=>{if(n===s.pathname+s.search+s.hash)return[];let e=new Set,t=!1;if(i.forEach((n=>{let i=o.routes[n.route.id];i&&i.hasLoader&&(!h.some((e=>e.route.id===n.route.id))&&n.route.id in c&&a[n.route.id]?.shouldRevalidate||i.hasClientLoader?t=!0:e.add(n.route.id))})),0===e.size)return[];let r=Le(n,l);return t&&e.size>0&&r.searchParams.set("_routes",i.filter((t=>e.has(t.route.id))).map((e=>e.route.id)).join(",")),[r.pathname+r.search]}),[l,c,s,o,h,i,n,a]),g=t.useMemo((()=>Ae(d,o)),[d,o]),f=We(d);return t.createElement(t.Fragment,null,p.map((e=>t.createElement("link",{key:e,rel:"prefetch",as:"fetch",href:e,...r}))),g.map((e=>t.createElement("link",{key:e,rel:"modulepreload",href:e,...r}))),f.map((e=>{let{key:n,link:i}=e;return t.createElement("link",{key:n,...i})})))}ze.displayName="FrameworkContext";var qe=!1;function Xe(e){let{manifest:n,serverHandoffString:i,isSpaMode:r,ssr:s,renderMeta:o}=He(),{router:a,static:l,staticContext:c}=Ne(),{matches:u}=Be(),h=Oe(s);o&&(o.didRenderScripts=!0);let d=Ue(u,null,r);t.useEffect((()=>{0}),[]);let g=t.useMemo((()=>{let r=c?`window.__reactRouterContext = ${i};window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());`:" ",s=l?`${n.hmr?.runtime?`import ${JSON.stringify(n.hmr.runtime)};`:""}${h?"":`import ${JSON.stringify(n.url)}`};\n${d.map(((e,t)=>{let i=`route${t}`,r=n.routes[e.route.id];Me(r,`Route ${e.route.id} not found in manifest`);let{clientActionModule:s,clientLoaderModule:o,clientMiddlewareModule:a,hydrateFallbackModule:l,module:c}=r,u=[...s?[{module:s,varName:`${i}_clientAction`}]:[],...o?[{module:o,varName:`${i}_clientLoader`}]:[],...a?[{module:a,varName:`${i}_clientMiddleware`}]:[],...l?[{module:l,varName:`${i}_HydrateFallback`}]:[],{module:c,varName:`${i}_main`}];return 1===u.length?`import * as ${i} from ${JSON.stringify(c)};`:[u.map((e=>`import * as ${e.varName} from "${e.module}";`)).join("\n"),`const ${i} = {${u.map((e=>`...${e.varName}`)).join(",")}};`].join("\n")})).join("\n")}\n  ${h?`window.__reactRouterManifest = ${JSON.stringify(function(e,t){let n=new Set(t.state.matches.map((e=>e.route.id))),i=t.state.location.pathname.split("/").filter(Boolean),r=["/"];for(i.pop();i.length>0;)r.push(`/${i.join("/")}`),i.pop();r.forEach((e=>{let i=p(t.routes,e,t.basename);i&&i.forEach((e=>n.add(e.route.id)))}));let s=[...n].reduce(((t,n)=>Object.assign(t,{[n]:e.routes[n]})),{});return{...e,routes:s}}(n,a),null,2)};`:""}\n  window.__reactRouterRouteModules = {${d.map(((e,t)=>`${JSON.stringify(e.route.id)}:route${t}`)).join(",")}};\n\nimport(${JSON.stringify(n.entry.module)});`:" ";return t.createElement(t.Fragment,null,t.createElement("script",{...e,suppressHydrationWarning:!0,dangerouslySetInnerHTML:De(r),type:void 0}),t.createElement("script",{...e,suppressHydrationWarning:!0,dangerouslySetInnerHTML:De(s),type:"module",async:!0}))}),[]),f=qe?[]:n.entry.imports.concat(Ae(d,n,{includeHydrateFallback:!0}));return qe?null:t.createElement(t.Fragment,null,h?null:t.createElement("link",{rel:"modulepreload",href:n.url,crossOrigin:e.crossOrigin}),t.createElement("link",{rel:"modulepreload",href:n.entry.module,crossOrigin:e.crossOrigin}),[...new Set(m)].map((n=>t.createElement("link",{key:n,rel:"modulepreload",href:n,crossOrigin:e.crossOrigin}))),g);var m}function Ke(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach((t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)}))}}var $e="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{$e&&(window.__reactRouterVersion="7.4.1")}catch(zD){}function Ze(e){let{basename:n,children:i,window:r}=e,o=t.useRef();null==o.current&&(o.current=s({window:r,v5Compat:!0}));let a=o.current,[l,c]=t.useState({action:a.action,location:a.location}),u=t.useCallback((e=>{t.startTransition((()=>c(e)))}),[c]);return t.useLayoutEffect((()=>a.listen(u)),[a,u]),t.createElement(fe,{basename:n,children:i,location:l.location,navigationType:l.action,navigator:a})}var Ye=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Je=t.forwardRef((function(e,n){let i,{onClick:r,discover:s="render",prefetch:l="none",relative:c,reloadDocument:h,replace:d,state:p,target:g,to:f,preventScrollReset:m,viewTransition:v,...y}=e,{basename:C}=t.useContext(j),w="string"===typeof f&&Ye.test(f),S=!1;if("string"===typeof f&&w&&(i=f,$e))try{let e=new URL(window.location.href),t=f.startsWith("//")?new URL(e.protocol+f):new URL(f),n=T(t.pathname,C);t.origin===e.origin&&null!=n?f=n+t.search+t.hash:S=!0}catch(zD){a(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=function(e){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o($(),"useHref() may be used only in the context of a <Router> component.");let{basename:i,navigator:r}=t.useContext(j),{hash:s,pathname:a,search:l}=ee(e,{relative:n}),c=a;return"/"!==i&&(c="/"===a?i:L([i,a])),r.createHref({pathname:c,search:l,hash:s})}(f,{relative:c}),[x,_,M]=function(e,n){let i=t.useContext(ze),[r,s]=t.useState(!1),[o,a]=t.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:h,onTouchStart:d}=n,p=t.useRef(null);t.useEffect((()=>{if("render"===e&&a(!0),"viewport"===e){let e=new IntersectionObserver((e=>{e.forEach((e=>{a(e.isIntersecting)}))}),{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}}),[e]),t.useEffect((()=>{if(r){let e=setTimeout((()=>{a(!0)}),100);return()=>{clearTimeout(e)}}}),[r]);let g=()=>{s(!0)},f=()=>{s(!1),a(!1)};return i?"intent"!==e?[o,p,{}]:[o,p,{onFocus:Ge(l,g),onBlur:Ge(c,f),onMouseEnter:Ge(u,g),onMouseLeave:Ge(h,f),onTouchStart:Ge(d,g)}]:[!1,p,{}]}(l,y),E=function(e){let{target:n,replace:i,state:r,preventScrollReset:s,relative:o,viewTransition:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=Q(),c=Z(),h=ee(e,{relative:o});return t.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==i?i:u(c)===u(h);l(e,{replace:n,state:r,preventScrollReset:s,relative:o,viewTransition:a})}}),[c,l,h,i,r,n,e,s,o,a])}(f,{replace:d,state:p,target:g,preventScrollReset:m,relative:c,viewTransition:v});let R=t.createElement("a",{...y,...M,href:i||b,onClick:S||h?r:function(e){r&&r(e),e.defaultPrevented||E(e)},ref:Ke(n,_),target:g,"data-discover":w||"render"!==s?void 0:"true"});return x&&!w?t.createElement(t.Fragment,null,R,t.createElement(Ve,{page:b})):R}));Je.displayName="Link",t.forwardRef((function(e,n){let{"aria-current":i="page",caseSensitive:r=!1,className:s="",end:a=!1,style:l,to:c,viewTransition:u,children:h,...d}=e,p=ee(c,{relative:d.relative}),g=Z(),f=t.useContext(G),{navigator:m,basename:v}=t.useContext(j),y=null!=f&&function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.useContext(U);o(null!=i,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=tt("useViewTransitionState"),s=ee(e,{relative:n.relative});if(!i.isTransitioning)return!1;let a=T(i.currentLocation.pathname,r)||i.currentLocation.pathname,l=T(i.nextLocation.pathname,r)||i.nextLocation.pathname;return null!=E(s.pathname,l)||null!=E(s.pathname,a)}(p)&&!0===u,C=m.encodeLocation?m.encodeLocation(p).pathname:p.pathname,w=g.pathname,S=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;r||(w=w.toLowerCase(),S=S?S.toLowerCase():null,C=C.toLowerCase()),S&&v&&(S=T(S,v)||S);const b="/"!==C&&C.endsWith("/")?C.length-1:C.length;let x,_=w===C||!a&&w.startsWith(C)&&"/"===w.charAt(b),M=null!=S&&(S===C||!a&&S.startsWith(C)&&"/"===S.charAt(C.length)),R={isActive:_,isPending:M,isTransitioning:y},P=_?i:void 0;x="function"===typeof s?s(R):[s,_?"active":null,M?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let A="function"===typeof l?l(R):l;return t.createElement(Je,{...d,"aria-current":P,className:x,ref:n,style:A,to:c,viewTransition:u},"function"===typeof h?h(R):h)})).displayName="NavLink";var Qe=t.forwardRef(((e,n)=>{let{discover:i="render",fetcherKey:r,navigate:s,reloadDocument:a,replace:l,state:c,method:h=ye,action:d,onSubmit:p,relative:g,preventScrollReset:f,viewTransition:m,...v}=e,y=rt(),C=function(e){let{relative:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:i}=t.useContext(j),r=t.useContext(X);o(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),a={...ee(e||".",{relative:n})},l=Z();if(null==e){a.search=l.search;let e=new URLSearchParams(a.search),t=e.getAll("index");if(t.some((e=>""===e))){e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let n=e.toString();a.search=n?`?${n}`:""}}e&&"."!==e||!s.route.index||(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index");"/"!==i&&(a.pathname="/"===a.pathname?i:L([i,a.pathname]));return u(a)}(d,{relative:g}),w="get"===h.toLowerCase()?"get":"post",S="string"===typeof d&&Ye.test(d);return t.createElement("form",{ref:n,method:w,action:C,onSubmit:a?p:e=>{if(p&&p(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=t?.getAttribute("formmethod")||h;y(t||e.currentTarget,{fetcherKey:r,method:n,navigate:s,replace:l,state:c,relative:g,preventScrollReset:f,viewTransition:m})},...v,"data-discover":S||"render"!==i?void 0:"true"})}));function et(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function tt(e){let n=t.useContext(H);return o(n,et(e)),n}Qe.displayName="Form";var nt=0,it=()=>`__${String(++nt)}__`;function rt(){let{router:e}=tt("useSubmit"),{basename:n}=t.useContext(j),i=ue("useRouteId");return t.useCallback((async function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:s,method:o,encType:a,formData:l,body:c}=_e(t,n);if(!1===r.navigate){let t=r.fetcherKey||it();await e.fetch(t,i,r.action||s,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||o,formEncType:r.encType||a,flushSync:r.flushSync})}else await e.navigate(r.action||s,{preventScrollReset:r.preventScrollReset,formData:l,body:c,formMethod:r.method||o,formEncType:r.encType||a,replace:r.replace,state:r.state,fromRouteId:i,flushSync:r.flushSync,viewTransition:r.viewTransition})}),[e,n,i])}new TextEncoder;var st=n(579);const ot={header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"2px 10px",backgroundColor:"#FFFFFF",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",height:"45px"},searchBarContainer:{flex:1,display:"flex",alignItems:"center",margin:"0 30px"},searchBar:{width:"40%",padding:"5px 12px",borderRadius:"10px",border:"1px solid #ccc",fontSize:"13px"},rightSection:{display:"flex",justifyContent:"flex-end"},profileContainer:{width:"300px",display:"flex",justifyContent:"flex-end",alignItems:"center",cursor:"pointer",margin:"0 20px",backgroundColor:"#FFFFFF",padding:"5px 10px",gap:"10px"},userImage:{width:"35px",height:"35px",borderRadius:"10px",objectFit:"cover"},companyName:{marginRight:"30px",fontSize:"13px",fontWeight:"bold",color:"gray",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},at=()=>{const[e,n]=(0,t.useState)(!0),[i,r]=(0,t.useState)("\uc608\uc81c \ud68c\uc0ac"),[s,o]=(0,t.useState)("https://via.placeholder.com/40"),a=Q(),[l,c]=(0,t.useState)(!1);(0,t.useEffect)((()=>{document.body.style.margin="0",document.body.style.padding="0",document.documentElement.style.margin="0",document.documentElement.style.padding="0",window.scrollTo(0,0)}),[]),(0,t.useEffect)((()=>{const e=sessionStorage.getItem("userEmail");o({"admin@test.com":"/wms_project_frontend/manager/inbound/images/admin.png","test@test.com":"/wms_project_frontend/manager/inbound/images/user1.png","user@test.com":"/wms_project_frontend/manager/inbound/images/user2.png"}[e]||"/wms_project_frontend/manager/inbound/images/default.png")}),[]);return(0,st.jsxs)("header",{style:ot.header,children:[(0,st.jsx)("div",{style:ot.searchBarContainer,children:(0,st.jsx)("input",{type:"text",placeholder:"\uac80\uc0c9...",style:ot.searchBar})}),(0,st.jsx)("div",{style:ot.rightSection,children:e&&(0,st.jsxs)("div",{style:ot.profileContainer,onClick:()=>{a("/my-info")},children:[(0,st.jsx)("span",{style:{fontSize:"13px",fontWeight:"bold",color:l?"black":"gray",transition:"color 0.3s ease"},onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),children:i}),s&&(0,st.jsx)("img",{src:s,alt:"\uc0ac\uc6a9\uc790",style:ot.userImage})]})})]})};const lt=n.p+"static/media/logo.da96bc02422412d4dff37c1dfcace96c.svg";const ct=n.p+"static/media/icon1.b0cb2751b022cf640b3dcc709db5ee56.svg";const ut=n.p+"static/media/icon2.4f69b8d536c06ba765232b744b8171a6.svg";const ht=n.p+"static/media/icon3.34bbbab865981643798fc62e4a0a05b6.svg";const dt=n.p+"static/media/icon4.257d6db1ef8ee4484e721ad5ca7e03b2.svg",pt=[{label:"HOME",children:[{label:"\uba54\uc778\ud398\uc774\uc9c0",icon:ct,url:"https://kjh011012.github.io/wms_project_frontend/manager/dashboard/#/admin/Mainpage",external:!0}]},{label:"\uc785\uace0 \ubc0f \uacc4\uc57d",children:[{label:"\uacc4\uc57d \ud604\ud669",icon:ct,url:"https://kjh011012.github.io/wms_project_frontend/manager/inbound/#/admin/contract-status",external:!0},{label:"\uc785\uace0 \ud604\ud669",icon:ct,url:"https://kjh011012.github.io/wms_project_frontend/manager/inbound/#/admin/inbound-status-detail",external:!0}]},{label:"\ucd9c\uace0",children:[{label:"\ucd9c\uace0 \ud604\ud669",icon:ut,url:"https://kjh011012.github.io/wms_project_frontend/manager/outbound/#/admin/OutboundStatus",external:!0}]},{label:"\uc7ac\uace0",children:[{label:"\uc7ac\uace0 \ud604\ud669",icon:ut,url:"https://kjh011012.github.io/wms_project_frontend/manager/inventory/#/admin/InventoryStatus",external:!0}]},{label:"\ucc3d\uace0\uad00\ub9ac",children:[{label:"\uae30\uc790\uc7ac \uad00\ub9ac",icon:ut,url:"https://kjh011012.github.io/wms_project_frontend/manager/equipments/#/admin/EquipmentList",external:!0}]},{label:"\uc2dc\uc2a4\ud15c",children:[{label:"\uacf5\uc9c0\uc0ac\ud56d",icon:ht,url:"https://kjh011012.github.io/wms_project_frontend/manager/inquiry/#/admin/Notices",external:!0},{label:"\ubb38\uc758\uc0ac\ud56d",icon:dt,url:"https://kjh011012.github.io/wms_project_frontend/manager/inquiry/#/admin/Inquiries",external:!0},{label:"\uc0ac\uc6d0\uad00\ub9ac",icon:dt,url:"https://kjh011012.github.io/wms_project_frontend/manager/inquiry/#/admin/Employees",external:!0}]}],gt=()=>(0,st.jsxs)("div",{className:"sidebar",children:[(0,st.jsxs)("div",{className:"sidebar-header",children:[(0,st.jsx)("img",{src:lt,alt:"Logo",className:"sidebar-logo"}),"Smart WMS"]}),pt.map(((e,t)=>(0,st.jsxs)("div",{className:"menu-group",children:[(0,st.jsx)("div",{className:"menu-label",children:e.label}),(0,st.jsx)("div",{className:"menu-children",children:e.children.map(((e,t)=>(0,st.jsxs)("a",{href:e.url,className:"sidebar-item",target:"_self",rel:"noopener noreferrer",children:[e.icon&&(0,st.jsx)("img",{className:"sidebar-icon",src:e.icon,alt:e.label}),(0,st.jsx)("span",{children:e.label})]},t)))})]},t)))]}),ft={container:{display:"flex",height:"100vh",marginLeft:"160px"},main:{flex:1,display:"flex",flexDirection:"column"},content:{flex:1,padding:"0px",backgroundColor:"#f9f9f9"}},mt=e=>{let{children:t}=e;return(0,st.jsxs)("div",{style:ft.container,children:[(0,st.jsx)(gt,{}),(0,st.jsxs)("div",{style:ft.main,children:[(0,st.jsx)(at,{}),(0,st.jsx)("div",{style:ft.content,children:t})]})]})};var vt=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,n){const i=t?this.allAsyncListeners:this.allSyncListeners;let r=i.get(e);return!r&&n&&(r=new Set,i.set(e,r)),r}noRegisteredListenersExist(){return 0===this.allSyncListeners.size&&0===this.allAsyncListeners.size&&0===this.globalSyncListeners.size&&0===this.globalAsyncListeners.size}addEventListener(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.getListeners(e,n,!0).add(t)}removeEventListener(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.getListeners(e,n,!1);if(i&&(i.delete(t),0===i.size)){(n?this.allAsyncListeners:this.allSyncListeners).delete(e)}}addGlobalListener(e){(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.globalAsyncListeners:this.globalSyncListeners).add(e)}removeGlobalListener(e){(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.globalAsyncListeners:this.globalSyncListeners).delete(e)}dispatchEvent(e){const t=e;this.dispatchToListeners(t,!0),this.dispatchToListeners(t,!1),this.firedEvents[t.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){const n=e.type;if(t&&"event"in e){const t=e.event;t instanceof Event&&(e.eventPath=t.composedPath())}const i=(n,i)=>n.forEach((n=>{if(!i.has(n))return;const r=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming((()=>n(e))):()=>n(e);t?this.dispatchAsync(r):r()})),r=this.getListeners(n,t,!1)??new Set,s=new Set(r);s.size>0&&i(s,r);new Set(t?this.globalAsyncListeners:this.globalSyncListeners).forEach((i=>{const r=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming((()=>i(n,e))):()=>i(n,e);t?this.dispatchAsync(r):r()}))}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){const e=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(e):e(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],e.forEach((e=>e()))}},yt=(e=>(e.CommunityCoreModule="@ag-grid-community/core",e.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",e.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",e.CsvExportModule="@ag-grid-community/csv-export",e.EnterpriseCoreModule="@ag-grid-enterprise/core",e.RowGroupingModule="@ag-grid-enterprise/row-grouping",e.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",e.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",e.MenuModule="@ag-grid-enterprise/menu",e.SetFilterModule="@ag-grid-enterprise/set-filter",e.MultiFilterModule="@ag-grid-enterprise/multi-filter",e.StatusBarModule="@ag-grid-enterprise/status-bar",e.SideBarModule="@ag-grid-enterprise/side-bar",e.RangeSelectionModule="@ag-grid-enterprise/range-selection",e.MasterDetailModule="@ag-grid-enterprise/master-detail",e.RichSelectModule="@ag-grid-enterprise/rich-select",e.GridChartsModule="@ag-grid-enterprise/charts",e.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",e.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",e.ExcelExportModule="@ag-grid-enterprise/excel-export",e.ClipboardModule="@ag-grid-enterprise/clipboard",e.SparklinesModule="@ag-grid-enterprise/sparklines",e.AdvancedFilterModule="@ag-grid-enterprise/advanced-filter",e.AngularModule="@ag-grid-community/angular",e.ReactModule="@ag-grid-community/react",e.VueModule="@ag-grid-community/vue",e))(yt||{}),Ct={};function wt(e,t){Ct[t]||(e(),Ct[t]=!0)}function St(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];console.log("AG Grid: "+e,...n)}function bt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];wt((()=>console.warn("AG Grid: "+e,...n)),e+n?.join(""))}function xt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];wt((()=>console.error("AG Grid: "+e,...n)),e+n?.join(""))}function _t(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Mt(e){!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.length>0&&window.setTimeout((()=>e.forEach((e=>e()))),t)}(e,400)}var Et=[],Rt=!1;function Tt(e){Et.push(e),Rt||(Rt=!0,window.setTimeout((()=>{const e=Et.slice();Et.length=0,Rt=!1,e.forEach((e=>e()))}),0))}function Pt(e,t){let n;return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];const o=this;window.clearTimeout(n),n=window.setTimeout((function(){e.apply(o,r)}),t)}}function At(e,t){let n=0;return function(){const i=(new Date).getTime();if(!(i-n<t)){n=i;for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];e.apply(this,s)}}}function Ft(e){return null==e||""===e?null:e}function Dt(e){return null!=e&&(""!==e||arguments.length>1&&void 0!==arguments[1]&&arguments[1])}function Lt(e){return!Dt(e)}function It(e){return null==e||0===e.length}function kt(e){return null!=e&&"function"===typeof e.toString?e.toString():null}function Ot(e){if(void 0===e)return;if(null===e||""===e)return null;if("number"===typeof e)return isNaN(e)?void 0:e;const t=parseInt(e,10);return isNaN(t)?void 0:t}function Nt(e){if(void 0!==e)return null!==e&&""!==e&&Bt(e)}function Bt(e){return"boolean"===typeof e?e:"string"===typeof e&&("TRUE"===e.toUpperCase()||""==e)}function zt(e,t){return(e?JSON.stringify(e):null)===(t?JSON.stringify(t):null)}function Ht(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=null==e,r=null==t;if(e&&e.toNumber&&(e=e.toNumber()),t&&t.toNumber&&(t=t.toNumber()),i&&r)return 0;if(i)return-1;if(r)return 1;function s(e,t){return e>t?1:e<t?-1:0}if("string"!==typeof e)return s(e,t);if(!n)return s(e,t);try{return e.localeCompare(t)}catch(zD){return s(e,t)}}function Gt(e){if(e instanceof Set||e instanceof Map){const t=[];return e.forEach((e=>t.push(e))),t}return Object.values(e)}function Ut(e,t){return e.get("rowModelType")===t}function Vt(e){return Ut(e,"clientSide")}function Wt(e){return Ut(e,"serverSide")}function jt(e,t){return e.get("domLayout")===t}function qt(e){return void 0!==bn(e)}function Xt(e){return!e.get("suppressAsyncEvents")}function Kt(e){return"function"===typeof e.get("getRowHeight")}function $t(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0;if(null==i&&(i=e.environment.getDefaultRowHeight()),Kt(e)){if(n)return{height:i,estimated:!0};const r={node:t,data:t.data},s=e.getCallback("getRowHeight")(r);if(Yt(s))return 0===s&&bt("The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead."),{height:Math.max(1,s),estimated:!1}}if(t.detail&&e.get("masterDetail"))return function(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};const t=e.get("detailRowHeight");if(Yt(t))return{height:t,estimated:!1};return{height:300,estimated:!1}}(e);const r=e.get("rowHeight");return{height:r&&Yt(r)?r:i,estimated:!1}}function Zt(e){const{environment:t}=e,n=e.get("rowHeight");if(!n||Lt(n))return t.getDefaultRowHeight();const i=t.refreshRowHeightVariable();return-1!==i?i:(bt("row height must be a number if not using standard row model"),t.getDefaultRowHeight())}function Yt(e){return!isNaN(e)&&"number"===typeof e&&isFinite(e)}function Jt(e,t,n){const i=t[e.getDomDataKey()];return i?i[n]:void 0}function Qt(e,t,n,i){const r=e.getDomDataKey();let s=t[r];Lt(s)&&(s={},t[r]=s),s[n]=i}function en(e){let t=null;const n=e.get("getDocument");return n&&Dt(n)?t=n():e.eGridDiv&&(t=e.eGridDiv.ownerDocument),t&&Dt(t)?t:document}function tn(e){return en(e).defaultView||window}function nn(e){return e.eGridDiv.getRootNode()}function rn(e){return nn(e).activeElement}function sn(e){const t=en(e),n=rn(e);return null===n||n===t.body}function on(e){return!e.get("ensureDomOrder")&&e.get("animateRows")}function an(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||jt(e,"print"))}function ln(e){const t=e.get("autoGroupColumnDef");return!t?.comparator&&!e.get("treeData")}function cn(e){const t=e.get("groupAggFiltering");return"function"===typeof t?e.getCallback("groupAggFiltering"):!0===t?()=>!0:void 0}function un(e){const t=e.get("grandTotalRow");if(t)return t;return e.get("groupIncludeTotalFooter")?"bottom":void 0}function hn(e){const t=e.get("groupTotalRow");if("function"===typeof t)return e.getCallback("groupTotalRow");if(t)return()=>t;const n=e.get("groupIncludeFooter");if("function"===typeof n){const t=e.getCallback("groupIncludeFooter");return e=>t(e)?"bottom":void 0}return()=>n?"bottom":void 0}function dn(e){return e.exists("groupDisplayType")?"multipleColumns"===e.get("groupDisplayType"):e.get("groupHideOpenParents")}function pn(e,t){return!t&&"groupRows"===e.get("groupDisplayType")}function gn(e){const t=e.getCallback("getRowId");return void 0===t?t:e=>{let n=t(e);return"string"!==typeof n&&(bt("The getRowId callback must return a string. The ID ",n," is being cast to a string."),n=String(n)),n}}function fn(e){return e?.checkboxes??!0}function mn(e){return"multiRow"===e?.mode&&(e.headerCheckbox??!0)}function vn(e){const t=e.get("cellSelection");return void 0!==t?!!t:e.get("enableRangeSelection")}function yn(e){const t=e.get("cellSelection");return void 0!==t?"boolean"!==typeof t&&"fill"===t.handle?.mode:e.get("enableFillHandle")}function Cn(e){const t=e.get("rowSelection")??"single";if("string"===typeof t){const t=e.get("suppressRowClickSelection"),n=e.get("suppressRowDeselection");return(!t||!n)&&(t?"enableDeselection":!n||"enableSelection")}return("singleRow"===t.mode||"multiRow"===t.mode)&&(t.enableClickSelection??!1)}function wn(e){const t=Cn(e);return!0===t||"enableDeselection"===t}function Sn(e){const t=e.get("rowSelection");return"string"===typeof t?e.get("isRowSelectable"):t?.isRowSelectable}function bn(e){const t=e.get("rowSelection");if("string"===typeof t)switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}return t?.mode}function xn(e){return"multiRow"===bn(e)}function _n(e){const t=e.get("rowSelection");if("string"===typeof t){const t=e.get("groupSelectsChildren"),n=e.get("groupSelectsFiltered");return t&&n?"filteredDescendants":t?"descendants":"self"}return"multiRow"===t?.mode?t.groupSelects:void 0}function Mn(e){const t=_n(e);return"descendants"===t||"filteredDescendants"===t}function En(e){return e.isModuleRegistered("@ag-grid-enterprise/set-filter")&&!e.get("suppressSetFilterByDefault")}function Rn(e){if(e&&e.length)return e[e.length-1]}function Tn(e,t,n){return null==e&&null==t||null!=e&&null!=t&&e.length===t.length&&e.every(((e,i)=>n?n(e,t[i]):t[i]===e))}function Pn(e,t){const n=e.indexOf(t);n>=0&&(e[n]=e[e.length-1],e.pop())}function An(e,t){const n=e.indexOf(t);n>=0&&e.splice(n,1)}function Fn(e,t,n){e.splice(n,0,t)}function Dn(e,t,n){!function(e,t){for(let n=0;n<t.length;n++)An(e,t[n])}(e,t),t.slice().reverse().forEach((t=>Fn(e,t,n)))}function Ln(e,t){return e.indexOf(t)>-1}function In(e,t){null!=t&&null!=e&&t.forEach((t=>e.push(t)))}var kn="__ag_Grid_Stop_Propagation",On=["touchstart","touchend","touchmove","touchcancel","scroll"],Nn={};function Bn(e){e[kn]=!0}function zn(e){return!0===e[kn]}var Hn=(()=>{const e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return t=>{if("boolean"===typeof Nn[t])return Nn[t];const n=document.createElement(e[t]||"div");return Nn[t="on"+t]=t in n}})();function Gn(e,t,n){let i=t;for(;i;){const t=Jt(e,i,n);if(t)return t;i=i.parentElement}return null}function Un(e,t){return!(!t||!e)&&function(e){const t=e;if(t.path)return t.path;if(t.composedPath)return t.composedPath();return function(e){const t=[];let n=e.target;for(;n;)t.push(n),n=n.parentElement;return t}(t)}(t).indexOf(e)>=0}var Vn=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.frameworkOverrides=e.frameworkOverrides,this.stubContext=e.context,this.eventService=e.eventService,this.gos=e.gos,this.localeService=e.localeService}getFrameworkOverrides(){return this.frameworkOverrides}destroy(){for(let e=0;e<this.destroyFunctions.length;e++)this.destroyFunctions[e]();this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,n){this.localEventService||(this.localEventService=new vt),this.localEventService.addEventListener(e,t,n)}removeEventListener(e,t,n){this.localEventService&&this.localEventService.removeEventListener(e,t,n)}dispatchLocalEvent(e){this.localEventService&&this.localEventService.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventService,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){const n=[];for(const i in t){const r=t[i];r&&n.push(this._setupListener(e,i,r))}return n}_setupListener(e,t,n){if(this.destroyed)return()=>null;e instanceof HTMLElement?function(e,t,n,i){const r=Ln(On,n)?{passive:!0}:void 0;e&&e.addEventListener&&e.addEventListener(t,n,i,r)}(this.getFrameworkOverrides(),e,t,n):e.addEventListener(t,n);const i=()=>(e.removeEventListener(t,n),null);return this.destroyFunctions.push(i),()=>(i(),this.destroyFunctions=this.destroyFunctions.filter((e=>e!==i)),null)}setupGridOptionListener(e,t){this.gos.addPropertyEventListener(e,t);const n=()=>(this.gos.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter((e=>e!==n)),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupGridOptionListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;const n=e.join("-")+this.propertyListenerId++,i=e=>{if(e.changeSet){if(e.changeSet&&e.changeSet.id===this.lastChangeSetIdLookup[n])return;this.lastChangeSetIdLookup[n]=e.changeSet.id}const i={type:"gridPropertyChanged",changeSet:e.changeSet,source:e.source};t(i)};e.forEach((e=>this.setupGridOptionListener(e,i)))}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createManagedBean(e,t){const n=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),n}createBean(e,t,n){return(t||this.stubContext).createBean(e,n)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};function Wn(e){return e instanceof jn}var jn=class extends Vn{constructor(e,t,n,i){super(),this.isColumn=!1,this.expandable=!1,this.instanceId=di(),this.expandableListenerRemoveCallback=null,this.colGroupDef=e,this.groupId=t,this.expanded=!!e&&!!e.openByDefault,this.padding=n,this.level=i}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}setOriginalParent(e){this.originalParent=e}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return!!this.children&&this.children.some((e=>e.isVisible()))}isPadding(){return this.padding}setExpanded(e){this.expanded=void 0!==e&&e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}addLeafColumns(e){this.children&&this.children.forEach((t=>{pi(t)?e.push(t):Wn(t)&&t.addLeafColumns(e)}))}getColumnGroupShow(){const e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const e=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach((t=>t.addEventListener("visibleChanged",e))),this.expandableListenerRemoveCallback=()=>{this.getLeafColumns().forEach((t=>t.removeEventListener("visibleChanged",e))),this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,n=!1;const i=this.findChildrenRemovingPadding();for(let s=0,o=i.length;s<o;s++){const r=i[s];if(!r.isVisible())continue;const o=r.getColumnGroupShow();"open"===o?(e=!0,n=!0):"closed"===o?(t=!0,n=!0):(e=!0,t=!0)}const r=e&&t&&n;this.expandable!==r&&(this.expandable=r,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){const e=[],t=n=>{n.forEach((n=>{Wn(n)&&n.isPadding()?t(n.children):e.push(n)}))};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},qn="ag-Grid-ControlsColumn",Xn=class extends Vn{constructor(){super(...arguments),this.beanName="controlsColService"}createControlsCols(){const{gos:e}=this,t=e.get("rowSelection");if(!t||"object"!==typeof t)return[];const n=fn(t),i=mn(t);if(n||i){const t=e.get("selectionColumnDef"),n={maxWidth:50,resizable:!1,suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPosition:e.get("enableRtl")?"right":"left",comparator(e,t,n,i){const r=n.isSelected(),s=i.isSelected();return r&&s?0:r?1:-1},editable:!1,suppressFillHandle:!0,...t,colId:`${qn}`},i=new gi(n,null,n.colId,!1);return this.createBean(i),[i]}return[]}},Kn="ag-Grid-AutoColumn";function $n(e){const t=[],n=e=>{for(let i=0;i<e.length;i++){const r=e[i];pi(r)?t.push(r):Wn(r)&&n(r.getChildren())}};return n(e),t}function Zn(e){return e.reduce(((e,t)=>e+t.getActualWidth()),0)}function Yn(e,t,n){const i={};if(!t)return;yi(null,t,(e=>{i[e.getInstanceId()]=e})),n&&yi(null,n,(e=>{i[e.getInstanceId()]=null}));const r=Object.values(i).filter((e=>null!=e));e.destroyBeans(r)}function Jn(e){return e.getId().startsWith(Kn)}function Qn(e){return e.getColId().startsWith(qn)}function ei(e){let t=[];if(e instanceof Array){e.some((e=>"string"!==typeof e))?bt("if colDef.type is supplied an array it should be of type 'string[]'"):t=e}else"string"===typeof e?t=e.split(","):bt("colDef.type should be of type 'string' | 'string[]'");return t}var ti=class{constructor(e){this.frameworkOverrides=e,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(e){let t=e;return this.frameworkOverrides.shouldWrapOutgoing&&(t=t=>{this.frameworkOverrides.wrapOutgoing((()=>e(t)))},this.wrappedListeners.set(e,t)),t}wrapGlobal(e){let t=e;return this.frameworkOverrides.shouldWrapOutgoing&&(t=(t,n)=>{this.frameworkOverrides.wrapOutgoing((()=>e(t,n)))},this.wrappedGlobalListeners.set(e,t)),t}unwrap(e){return this.wrappedListeners.get(e)??e}unwrapGlobal(e){return this.wrappedGlobalListeners.get(e)??e}},ni=new Set(["__proto__","constructor","prototype"]);function ii(e,t){if(null!=e)if(Array.isArray(e))for(let n=0;n<e.length;n++)t(n.toString(),e[n]);else for(const[n,i]of Object.entries(e))t(n,i)}function ri(e){const t={},n=Object.keys(e);for(let i=0;i<n.length;i++){if(ni.has(n[i]))continue;const r=n[i],s=e[r];t[r]=s}return t}function si(e,t){if(!e)return;const n=e,i={};return Object.keys(n).forEach((e=>{if(t&&t.indexOf(e)>=0||ni.has(e))return;const r=n[e],s=ci(r)&&r.constructor===Object;i[e]=s?si(r):r})),i}function oi(e){if(!e)return[];const t=Object;if("function"===typeof t.values)return t.values(e);const n=[];for(const i in e)e.hasOwnProperty(i)&&e.propertyIsEnumerable(i)&&n.push(e[i]);return n}function ai(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Dt(t)&&ii(t,((t,r)=>{if(ni.has(t))return;let s=e[t];if(s!==r){if(i){if(null==s&&null!=r){"object"===typeof r&&r.constructor===Object&&(s={},e[t]=s)}}ci(r)&&ci(s)&&!Array.isArray(s)?ai(s,r,n,i):(n||void 0!==r)&&(e[t]=r)}}))}function li(e,t,n){if(!t||!e)return;if(!n)return e[t];const i=t.split(".");let r=e;for(let s=0;s<i.length;s++){if(null==r)return;r=r[i[s]]}return r}function ci(e){return"object"===typeof e&&null!==e}var ui={resizable:!0,sortable:!0},hi=0;function di(){return hi++}function pi(e){return e instanceof gi}var gi=class extends Vn{constructor(e,t,n,i){super(),this.isColumn=!0,this.instanceId=di(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.columnEventService=new vt,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=e,this.userProvidedColDef=t,this.colId=n,this.primary=i,this.setState(e)}wireBeans(e){this.columnHoverService=e.columnHoverService}getInstanceId(){return this.instanceId}setState(e){void 0!==e.sort?"asc"!==e.sort&&"desc"!==e.sort||(this.sort=e.sort):"asc"!==e.initialSort&&"desc"!==e.initialSort||(this.sort=e.initialSort);const t=e.sortIndex,n=e.initialSortIndex;void 0!==t?null!==t&&(this.sortIndex=t):null!==n&&(this.sortIndex=n);const i=e.hide,r=e.initialHide;this.visible=void 0!==i?!i:!r,void 0!==e.pinned?this.setPinned(e.pinned):this.setPinned(e.initialPinned);const s=e.flex,o=e.initialFlex;void 0!==s?this.flex=s:void 0!==o&&(this.flex=o)}setColDef(e,t,n){this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),this.columnEventService.dispatchEvent(this.createColumnEvent("colDefChanged",n))}getUserProvidedColDef(){return this.userProvidedColDef}setParent(e){this.parent=e}getParent(){return this.parent}setOriginalParent(e){this.originalParent=e}getOriginalParent(){return this.originalParent}postConstruct(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip()}initDotNotation(){const e=this.gos.get("suppressFieldDotNotation");this.fieldContainsDots=Dt(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!e,this.tooltipFieldContainsDots=Dt(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!e}initMinAndMaxWidths(){const e=this.colDef;this.minWidth=e.minWidth??this.gos.environment.getDefaultColumnMinWidth(),this.maxWidth=e.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){this.tooltipEnabled=Dt(this.colDef.tooltipField)||Dt(this.colDef.tooltipValueGetter)||Dt(this.colDef.tooltipComponent)}resetActualWidth(e){const t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t;const n=Ot(e.width),i=Ot(e.initialWidth);return t=null!=n?n:null!=i?i:200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){if(Lt(this.colDef)||Lt(this.colDef.showRowGroup))return!1;const t=!0===this.colDef.showRowGroup,n=this.colDef.showRowGroup===e;return t||n}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}addEventListener(e,t){this.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.columnEventService.setFrameworkOverrides(this.frameworkOverrides),this.frameworkEventListenerService=new ti(this.frameworkOverrides));const n=this.frameworkEventListenerService?.wrap(t)??t;this.columnEventService.addEventListener(e,n)}removeEventListener(e,t){const n=this.frameworkEventListenerService?.unwrap(t)??t;this.columnEventService.removeEventListener(e,n)}createColumnFunctionCallbackParams(e){return this.gos.addGridCommonParams({node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){if("boolean"===typeof this.colDef.suppressNavigable)return this.colDef.suppressNavigable;if("function"===typeof this.colDef.suppressNavigable){const t=this.createColumnFunctionCallbackParams(e);return(0,this.colDef.suppressNavigable)(t)}return!1}isCellEditable(e){if(e.group)if(this.gos.get("treeData")){if(!e.data&&!this.gos.get("enableGroupEdit"))return!1}else if(!this.gos.get("enableGroupEdit"))return!1;return this.isColumnFunc(e,this.colDef.editable)}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){const t=this.gos.get("rowSelection");if(t&&"string"!==typeof t){const n=Qn(this)&&fn(t);return this.isColumnFunc(e,n)}return this.isColumnFunc(e,this.colDef.checkboxSelection)}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?this.colDef.suppressPaste:null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){return this.colDef[e]??ui[e]}isColumnFunc(e,t){if("boolean"===typeof t)return t;if("function"===typeof t){return t(this.createColumnFunctionCallbackParams(e))}return!1}setHighlighted(e){this.highlighted!==e&&(this.highlighted=e,this.columnEventService.dispatchEvent(this.createColumnEvent("headerHighlightChanged","uiColumnMoved")))}setMoving(e,t){this.moving=e,this.columnEventService.dispatchEvent(this.createColumnEvent("movingChanged",t))}createColumnEvent(e,t){return this.gos.addGridCommonParams({type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sort}setSort(e,t){this.sort!==e&&(this.sort=e,this.columnEventService.dispatchEvent(this.createColumnEvent("sortChanged",t))),this.dispatchStateUpdatedEvent("sort")}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return"asc"===this.sort}isSortDescending(){return"desc"===this.sort}isSortNone(){return Lt(this.sort)}isSorting(){return Dt(this.sort)}getSortIndex(){return this.sortIndex}setSortIndex(e){this.sortIndex=e,this.dispatchStateUpdatedEvent("sortIndex")}setMenuVisible(e,t){this.menuVisible!==e&&(this.menuVisible=e,this.columnEventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",t)))}isMenuVisible(){return this.menuVisible}setAggFunc(e){this.aggFunc=e,this.dispatchStateUpdatedEvent("aggFunc")}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.columnEventService.dispatchEvent(this.createColumnEvent("leftChanged",t)))}isFilterActive(){return this.filterActive}setFilterActive(e,t,n){this.filterActive!==e&&(this.filterActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",t)));const i=this.createColumnEvent("filterChanged",t);n&&ai(i,n),this.columnEventService.dispatchEvent(i)}isHovered(){return this.columnHoverService.isHovered(this)}setPinned(e){this.pinned=!0===e||"left"===e?"left":"right"===e?"right":null,this.dispatchStateUpdatedEvent("pinned")}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.columnEventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",t)))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.columnEventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",t)))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return"left"===this.pinned||"right"===this.pinned}isPinnedLeft(){return"left"===this.pinned}isPinnedRight(){return"right"===this.pinned}getPinned(){return this.pinned}setVisible(e,t){const n=!0===e;this.visible!==n&&(this.visible=n,this.columnEventService.dispatchEvent(this.createColumnEvent("visibleChanged",t))),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getColumnGroupPaddingInfo(){let e=this.getParent();if(!e||!e.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const t=e.getPaddingLevel()+1;let n=!0;for(;e;){if(!e.isPadding()){n=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:n}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return this.gos.addGridCommonParams({node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(Lt(this.colDef.colSpan))return 1;const t=this.createBaseColDefParams(e),n=this.colDef.colSpan(t);return Math.max(n,1)}getRowSpan(e){if(Lt(this.colDef.rowSpan))return 1;const t=this.createBaseColDefParams(e),n=this.colDef.rowSpan(t);return Math.max(n,1)}setActualWidth(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex&&"flex"!==t&&"gridInitializing"!==t&&(this.flex=null),n||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.columnEventService.dispatchEvent(this.createColumnEvent("widthChanged",e))}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex||0}setFlex(e){this.flex!==e&&(this.flex=e),this.dispatchStateUpdatedEvent("flex")}setMinimum(e){this.setActualWidth(this.minWidth,e)}setRowGroupActive(e,t){this.rowGroupActive!==e&&(this.rowGroupActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",t))),this.dispatchStateUpdatedEvent("rowGroup")}isRowGroupActive(){return this.rowGroupActive}setPivotActive(e,t){this.pivotActive!==e&&(this.pivotActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",t))),this.dispatchStateUpdatedEvent("pivot")}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}setValueActive(e,t){this.aggregationActive!==e&&(this.aggregationActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("columnValueChanged",t)))}isValueActive(){return this.aggregationActive}isAllowPivot(){return!0===this.colDef.enablePivot}isAllowValue(){return!0===this.colDef.enableValue}isAllowRowGroup(){return!0===this.colDef.enableRowGroup}dispatchStateUpdatedEvent(e){this.columnEventService.dispatchEvent({type:"columnStateUpdated",key:e})}},fi={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}},mi=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=kt(e);let n=0;for(;;){let i;if(e?(i=e,0!==n&&(i+="_"+n)):t?(i=t,0!==n&&(i+="_"+n)):i=n,!this.existingKeys[i])return this.existingKeys[i]=!0,String(i);n++}}},vi=class extends Vn{constructor(){super(...arguments),this.beanName="columnFactory"}wireBeans(e){this.dataTypeService=e.dataTypeService}createColumnTree(e,t,n,i){const r=new mi,{existingCols:s,existingGroups:o,existingColKeys:a}=this.extractExistingTreeData(n);r.addExistingKeys(a);const l=this.recursivelyCreateColumns(e,0,t,s,r,o,i),c=this.findMaxDept(l,0),u=this.balanceColumnTree(l,0,c,r);return yi(null,u,((e,t)=>{Wn(e)&&e.setupExpandable(),e.setOriginalParent(t)})),{columnTree:u,treeDept:c}}extractExistingTreeData(e){const t=[],n=[],i=[];return e&&yi(null,e,(e=>{if(Wn(e)){const t=e;n.push(t)}else{const n=e;i.push(n.getId()),t.push(n)}})),{existingCols:t,existingGroups:n,existingColKeys:i}}balanceTreeForAutoCols(e,t){const n=[],i=this.findDepth(t);return e.forEach((e=>{let t=e;for(let n=i-1;n>=0;n--){const i=new jn(null,`FAKE_PATH_${e.getId()}}_${n}`,!0,n);this.createBean(i),i.setChildren([t]),t.setOriginalParent(i),t=i}0===i&&e.setOriginalParent(null),n.push(t)})),[n,i]}findDepth(e){let t=0,n=e;for(;n&&n[0]&&Wn(n[0]);)t++,n=n[0].getChildren();return t}balanceColumnTree(e,t,n,i){const r=[];for(let s=0;s<e.length;s++){const o=e[s];if(Wn(o)){const e=o,s=this.balanceColumnTree(e.getChildren(),t+1,n,i);e.setChildren(s),r.push(e)}else{let s,a;for(let e=n-1;e>=t;e--){const e=i.getUniqueKey(null,null),n=this.createMergedColGroupDef(null),r=new jn(n,e,!0,t);this.createBean(r),a&&a.setChildren([r]),a=r,s||(s=a)}if(s&&a){r.push(s);if(e.some((e=>Wn(e)))){a.setChildren([o]);continue}a.setChildren(e);break}r.push(o)}}return r}findMaxDept(e,t){let n=t;for(let i=0;i<e.length;i++){const r=e[i];if(Wn(r)){const e=r,i=this.findMaxDept(e.getChildren(),t+1);n<i&&(n=i)}}return n}recursivelyCreateColumns(e,t,n,i,r,s,o){if(!e)return[];const a=new Array(e.length);for(let l=0;l<a.length;l++){const c=e[l];this.isColumnGroup(c)?a[l]=this.createColumnGroup(n,c,t,i,r,s,o):a[l]=this.createColumn(n,c,i,r,o)}return a}createColumnGroup(e,t,n,i,r,s,o){const a=this.createMergedColGroupDef(t),l=r.getUniqueKey(a.groupId||null,null),c=new jn(a,l,!1,n);this.createBean(c);const u=this.findExistingGroup(t,s);u&&s.splice(u.idx,1);const h=u?.group;h&&c.setExpanded(h.isExpanded());const d=this.recursivelyCreateColumns(a.children,n+1,e,i,r,s,o);return c.setChildren(d),c}createMergedColGroupDef(e){const t={};return Object.assign(t,this.gos.get("defaultColGroupDef")),Object.assign(t,e),t}createColumn(e,t,n,i,r){const s=this.findExistingColumn(t,n);s&&n?.splice(s.idx,1);let o=s?.column;if(o){const e=this.addColumnDefaultAndTypes(t,o.getColId());o.setColDef(e,t,r),this.applyColumnState(o,e,r)}else{const n=i.getUniqueKey(t.colId,t.field),r=this.addColumnDefaultAndTypes(t,n);o=new gi(r,t,n,e),this.createBean(o)}return this.dataTypeService?.addColumnListeners(o),o}applyColumnState(e,t,n){const i=Ot(t.flex);void 0!==i&&e.setFlex(i);if(e.getFlex()<=0){const i=Ot(t.width);if(null!=i)e.setActualWidth(i,n);else{const t=e.getActualWidth();e.setActualWidth(t,n)}}void 0!==t.sort&&("asc"==t.sort||"desc"==t.sort?e.setSort(t.sort,n):e.setSort(void 0,n));const r=Ot(t.sortIndex);void 0!==r&&e.setSortIndex(r);const s=Nt(t.hide);void 0!==s&&e.setVisible(!s,n),void 0!==t.pinned&&e.setPinned(t.pinned)}findExistingColumn(e,t){if(t)for(let n=0;n<t.length;n++){const i=t[n].getUserProvidedColDef();if(!i)continue;if(null!=e.colId){if(t[n].getId()===e.colId)return{idx:n,column:t[n]};continue}if(null!=e.field){if(i.field===e.field)return{idx:n,column:t[n]}}else if(i===e)return{idx:n,column:t[n]}}}findExistingGroup(e,t){if(null!=e.groupId)for(let n=0;n<t.length;n++){const i=t[n];if(i.getColGroupDef()&&i.getId()===e.groupId)return{idx:n,group:i}}}addColumnDefaultAndTypes(e,t){const n={};ai(n,this.gos.get("defaultColDef"),!1,!0);const i=this.updateColDefAndGetColumnType(n,e,t);i&&this.assignColumnTypes(i,n),ai(n,e,!1,!0);const r=this.gos.get("autoGroupColumnDef"),s=ln(this.gos);return e.rowGroup&&r&&s&&ai(n,{sort:r.sort,initialSort:r.initialSort},!1,!0),this.dataTypeService?.validateColDef(n),n}updateColDefAndGetColumnType(e,t,n){const i=this.dataTypeService?.updateColDefAndGetColumnType(e,t,n),r=t.type??i??e.type;return e.type=r,r?ei(r):void 0}assignColumnTypes(e,t){if(!e.length)return;const n=Object.assign({},fi);ii(this.gos.get("columnTypes")||{},((e,t)=>{if(e in n)bt(`the column type '${e}' is a default column type and cannot be overridden.`);else{t.type&&bt("Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type."),n[e]=t}})),e.forEach((e=>{const i=n[e.trim()];i?ai(t,i,!1,!0):bt("colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes")}))}isColumnGroup(e){return void 0!==e.children}};function yi(e,t,n){if(t)for(let i=0;i<t.length;i++){const r=t[i];Wn(r)&&yi(r,r.getChildren(),n),n(r,e)}}var Ci=class extends Vn{constructor(){super(...arguments),this.beanName="columnModel",this.pivotMode=!1,this.autoHeightActiveAtLeastOnce=!1,this.ready=!1,this.changeEventsDispatching=!1,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}wireBeans(e){this.context=e.context,this.ctrlsService=e.ctrlsService,this.columnFactory=e.columnFactory,this.columnSizeService=e.columnSizeService,this.visibleColsService=e.visibleColsService,this.columnViewportService=e.columnViewportService,this.pivotResultColsService=e.pivotResultColsService,this.columnAnimationService=e.columnAnimationService,this.autoColService=e.autoColService,this.controlsColService=e.controlsColService,this.valueCache=e.valueCache,this.columnDefFactory=e.columnDefFactory,this.columnApplyStateService=e.columnApplyStateService,this.columnGroupStateService=e.columnGroupStateService,this.eventDispatcher=e.columnEventDispatcher,this.columnMoveService=e.columnMoveService,this.columnAutosizeService=e.columnAutosizeService,this.funcColsService=e.funcColsService,this.quickFilterService=e.quickFilterService,this.showRowGroupColsService=e.showRowGroupColsService,this.environment=e.environment}postConstruct(){const e=this.gos.get("pivotMode");this.isPivotSettingAllowed(e)&&(this.pivotMode=e),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents"],(e=>this.refreshAll(wi(e.source)))),this.addManagedPropertyListener("rowSelection",(e=>{this.onSelectionOptionsChanged(e.currentValue,e.previousValue,wi(e.source))})),this.addManagedPropertyListener("autoGroupColumnDef",(e=>this.onAutoGroupColumnDefChanged(wi(e.source)))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],(e=>this.recreateColumnDefs(wi(e.source)))),this.addManagedPropertyListener("pivotMode",(e=>this.setPivotMode(this.gos.get("pivotMode"),wi(e.source)))),this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered()})}createColsFromColDefs(e){const t=this.colDefs?this.columnApplyStateService.compareColumnStatesAndDispatchEvents(e):void 0;this.valueCache.expire();const n=this.colDefCols?.list,i=this.colDefCols?.tree,r=this.columnFactory.createColumnTree(this.colDefs,!0,i,e);Yn(this.context,this.colDefCols?.tree,r.columnTree);const s=r.columnTree,o=r.treeDept,a=$n(s),l={};a.forEach((e=>l[e.getId()]=e)),this.colDefCols={tree:s,treeDepth:o,list:a,map:l},this.funcColsService.extractCols(e,n),this.ready=!0,this.refreshCols(!0),this.visibleColsService.refresh(e),this.columnViewportService.checkViewportColumns(),this.eventDispatcher.everythingChanged(e),t&&(this.changeEventsDispatching=!0,t(),this.changeEventsDispatching=!1),this.eventDispatcher.newColumnsLoaded(e),"gridInitializing"===e&&this.columnSizeService.applyAutosizeStrategy()}refreshCols(e){if(!this.colDefCols)return;const t=this.cols?.tree;this.saveColOrder(),this.selectCols(),this.createAutoCols(),this.addAutoCols(),this.createControlsCols(),this.addControlsCols();const n=(i=this.gos,this.showingPivotResult?!i.get("enableStrictPivotColumnOrder"):i.get("maintainColumnOrder"));var i;e&&!n||this.restoreColOrder(),this.positionLockedCols(),this.showRowGroupColsService?.refresh(),this.quickFilterService?.refreshQuickFilterCols(),this.setColSpanActive(),this.setAutoHeightActive(),this.visibleColsService.clear(),this.columnViewportService.clear();!Tn(t,this.cols.tree)&&this.eventDispatcher.gridColumns()}selectCols(){const e=this.pivotResultColsService.getPivotResultCols();if(this.showingPivotResult=null!=e,e){const{map:t,list:n,tree:i,treeDepth:r}=e;this.cols={list:n.slice(),map:{...t},tree:i.slice(),treeDepth:r};e.list.some((e=>void 0!==this.cols?.map[e.getColId()]))||(this.lastPivotOrder=null)}else{const{map:e,list:t,tree:n,treeDepth:i}=this.colDefCols;this.cols={list:t.slice(),map:{...e},tree:n.slice(),treeDepth:i}}}getColsToShow(){const e=this.isPivotMode()&&!this.isShowingPivotResult(),t=this.funcColsService.getValueColumns();return this.cols.list.filter((n=>{const i=Jn(n);if(e){const e=t&&Ln(t,n);return i||e}return i||n.isVisible()}))}addAutoCols(){null!=this.autoCols&&(this.cols.list=this.autoCols.list.concat(this.cols.list),this.cols.tree=this.autoCols.tree.concat(this.cols.tree),Si(this.cols))}createAutoCols(){const e=pn(this.gos,this.pivotMode),t=this.pivotMode?this.gos.get("pivotSuppressAutoColumn"):this.isSuppressAutoCol(),n=this.funcColsService.getRowGroupColumns(),i=()=>{this.autoCols&&(Yn(this.context,this.autoCols.tree),this.autoCols=null)};if(!(n.length>0||this.gos.get("treeData"))||t||e||!this.autoColService)return void i();const r=this.autoColService.createAutoCols(n)??[],s=xi(r,this.autoCols?.list||null),o=this.cols.treeDepth,a=this.autoCols?this.autoCols.treeDepth:-1;if(s&&a==o)return;i();const[l,c]=this.columnFactory.balanceTreeForAutoCols(r,this.cols.tree);this.autoCols={list:r,tree:l,treeDepth:c,map:{}};const u=e=>{if(!e)return null;const t=e.filter((e=>!Jn(e)));return[...r,...t]};this.lastOrder=u(this.lastOrder),this.lastPivotOrder=u(this.lastPivotOrder)}createControlsCols(){const e=()=>{Yn(this.context,this.controlsCols?.tree),this.controlsCols=null};this.controlsColService||e();const t=this.cols.treeDepth,n=(this.controlsCols?.treeDepth??-1)==t,i=this.controlsColService?.createControlsCols()??[];if(xi(i,this.controlsCols?.list??[])&&n)return;e();const[r,s]=this.columnFactory.balanceTreeForAutoCols(i,this.cols.tree);this.controlsCols={list:i,tree:r,treeDepth:s,map:{}};const o=e=>{if(!e)return null;const t=e.filter((e=>!Qn(e)));return[...i,...t]};this.lastOrder=o(this.lastOrder),this.lastPivotOrder=o(this.lastPivotOrder)}addControlsCols(){null!=this.controlsCols&&(this.cols.list=this.controlsCols.list.concat(this.cols.list),this.cols.tree=this.controlsCols.tree.concat(this.cols.tree),Si(this.cols))}refreshAll(e){this.isReady()&&(this.refreshCols(!1),this.visibleColsService.refresh(e))}setColsVisible(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;this.columnApplyStateService.applyColumnState({state:e.map((e=>({colId:"string"===typeof e?e:e.getColId(),hide:!t})))},n)}setColsPinned(e,t,n){if(!this.cols)return;if(It(e))return;if(jt(this.gos,"print"))return void bt("Changing the column pinning status is not allowed with domLayout='print'");let i;this.columnAnimationService.start(),i=!0===t||"left"===t?"left":"right"===t?"right":null;const r=[];e.forEach((e=>{if(!e)return;const t=this.getCol(e);t&&t.getPinned()!==i&&(t.setPinned(i),r.push(t))})),r.length&&(this.visibleColsService.refresh(n),this.eventDispatcher.columnPinned(r,n)),this.columnAnimationService.finish()}setColumnGroupOpened(e,t,n){let i;i=Wn(e)?e.getId():e||"",this.columnGroupStateService.setColumnGroupState([{groupId:i,open:t}],n)}getProvidedColGroup(e){let t=null;return yi(null,this.cols?.tree,(n=>{Wn(n)&&n.getId()===e&&(t=n)})),t}isColGroupLocked(e){const t=this.gos.get("groupLockGroupColumns");if(!e.isRowGroupActive()||0===t)return!1;if(-1===t)return!0;return t>this.funcColsService.getRowGroupColumns().findIndex((t=>t.getColId()===e.getColId()))}isSuppressAutoCol(){if("custom"===this.gos.get("groupDisplayType"))return!0;return"custom"===this.gos.get("treeDataDisplayType")}setAutoHeightActive(){if(this.autoHeightActive=this.cols.list.some((e=>e.isVisible()&&e.isAutoHeight())),this.autoHeightActive){this.autoHeightActiveAtLeastOnce=!0;Vt(this.gos)||Wt(this.gos)||bt("autoHeight columns only work with Client Side Row Model and Server Side Row Model.")}}restoreColOrder(){const e=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!e)return;const t=new Map(e.map(((e,t)=>[e,t])));if(!this.cols.list.some((e=>t.has(e))))return;const n=new Map(this.cols.list.map((e=>[e,!0]))),i=e.filter((e=>n.has(e))),r=new Map(i.map((e=>[e,!0]))),s=this.cols.list.filter((e=>!r.has(e))),o=i.slice();s.forEach((e=>{let t=e.getOriginalParent();if(!t)return void o.push(e);const n=[];for(;!n.length&&t;){t.getLeafColumns().forEach((e=>{const t=o.indexOf(e)>=0,i=n.indexOf(e)<0;t&&i&&n.push(e)})),t=t.getOriginalParent()}if(!n.length)return void o.push(e);const i=n.map((e=>o.indexOf(e))),r=Math.max(...i);Fn(o,e,r+1)})),this.cols.list=o}sortColsLikeKeys(e){if(null==this.cols)return;let t=[];const n={};e.forEach((e=>{if(n[e])return;const i=this.cols.map[e];i&&(t.push(i),n[e]=!0)}));let i=0;this.cols.list.forEach((e=>{const r=e.getColId();if(null!=n[r])return;r.startsWith(Kn)?Fn(t,e,i++):t.push(e)})),t=this.columnMoveService.placeLockedColumns(t),this.columnMoveService.doesMovePassMarryChildren(t)?this.cols.list=t:bt("Applying column order broke a group where columns should be married together. Applying new order has been discarded.")}sortColsLikeCols(e){if(!e||e.length<=1)return;e.filter((e=>this.cols.list.indexOf(e)<0)).length>0||e.sort(((e,t)=>this.cols.list.indexOf(e)-this.cols.list.indexOf(t)))}resetColDefIntoCol(e,t){const n=e.getUserProvidedColDef();if(!n)return!1;const i=this.columnFactory.addColumnDefaultAndTypes(n,e.getColId());return e.setColDef(i,n,t),!0}queueResizeOperations(){this.shouldQueueResizeOperations=!0}isShouldQueueResizeOperations(){return this.shouldQueueResizeOperations}processResizeOperations(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach((e=>e())),this.resizeOperationQueue=[]}pushResizeOperation(e){this.resizeOperationQueue.push(e)}moveInCols(e,t,n){Dn(this.cols?.list,e,t),this.visibleColsService.refresh(n)}positionLockedCols(){this.cols.list=this.columnMoveService.placeLockedColumns(this.cols.list)}saveColOrder(){this.showingPivotResult?this.lastPivotOrder=this.cols?.list:this.lastOrder=this.cols?.list}getColumnDefs(){if(!this.colDefCols)return;const e=this.colDefCols.list.slice();this.showingPivotResult?e.sort(((e,t)=>this.lastOrder.indexOf(e)-this.lastOrder.indexOf(t))):this.lastOrder&&e.sort(((e,t)=>this.cols.list.indexOf(e)-this.cols.list.indexOf(t)));const t=this.funcColsService.getRowGroupColumns(),n=this.funcColsService.getPivotColumns();return this.columnDefFactory.buildColumnDefs(e,t,n)}isShowingPivotResult(){return this.showingPivotResult}isChangeEventsDispatching(){return this.changeEventsDispatching}isColSpanActive(){return this.colSpanActive}isProvidedColGroupsPresent(){return this.colDefCols?.treeDepth>0}setColSpanActive(){this.colSpanActive=this.cols.list.some((e=>null!=e.getColDef().colSpan))}isAutoRowHeightActive(){return this.autoHeightActive}wasAutoRowHeightEverActive(){return this.autoHeightActiveAtLeastOnce}getHeaderRowCount(){return this.cols?this.cols.treeDepth+1:-1}isReady(){return this.ready}isPivotMode(){return this.pivotMode}setPivotMode(e,t){e!==this.pivotMode&&this.isPivotSettingAllowed(this.pivotMode)&&(this.pivotMode=e,this.ready&&(this.refreshCols(!1),this.visibleColsService.refresh(t),this.eventDispatcher.pivotModeChanged()))}isPivotSettingAllowed(e){return!e||!this.gos.get("treeData")||(bt("Pivot mode not available with treeData."),!1)}isPivotActive(){const e=this.funcColsService.getPivotColumns();return this.pivotMode&&!It(e)}recreateColumnDefs(e){this.cols&&(this.autoCols&&this.autoColService.updateAutoCols(this.autoCols.list,e),this.createColsFromColDefs(e))}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){Yn(this.context,this.colDefCols?.tree),Yn(this.context,this.autoCols?.tree),Yn(this.context,this.controlsCols?.tree),super.destroy()}getColTree(){return this.cols.tree}getColDefColTree(){return this.colDefCols.tree}getColDefCols(){return this.colDefCols?.list?this.colDefCols.list:null}getCols(){return this.cols?.list??[]}getAllCols(){const e=this.pivotResultColsService.getPivotResultCols(),t=e?.list;return[this.colDefCols?.list??[],this.autoCols?.list??[],this.controlsCols?.list??[],t??[]].flat()}getColsForKeys(e){return e?e.map((e=>this.getCol(e))).filter((e=>null!=e)):[]}getColDefCol(e){return this.colDefCols?.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return null==e?null:this.getColFromCollection(e,this.cols)}getColFromCollection(e,t){if(null==t)return null;const{map:n,list:i}=t;if("string"==typeof e&&n[e])return n[e];for(let r=0;r<i.length;r++)if(bi(i[r],e))return i[r];return this.getAutoCol(e)}getAutoCol(e){return this.autoCols?.list.find((t=>bi(t,e)))??null}getAutoCols(){return this.autoCols?.list??null}setColHeaderHeight(e,t){e.setAutoHeaderHeight(t)&&(e.isColumn?this.eventDispatcher.headerHeight(e):this.eventDispatcher.groupHeaderHeight(e))}getGroupRowsHeight(){const e=[],t=this.ctrlsService.getHeaderRowContainerCtrls();for(const n of t){if(!n)continue;const t=n.getGroupRowCount()||0;for(let i=0;i<t;i++){const t=n.getGroupRowCtrlAtIndex(i),r=e[i];if(t){const n=this.getColumnGroupHeaderRowHeight(t);(null==r||n>r)&&(e[i]=n)}}}return e}getColumnGroupHeaderRowHeight(e){const t=this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight();let n=0;const i=e.getHeaderCtrls();for(const r of i){const e=r.getColumn();if(e.isAutoHeaderHeight()){const t=e.getAutoHeaderHeight();null!=t&&t>n&&(n=t)}}return Math.max(t,n)}getColumnHeaderRowHeight(){const e=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),t=this.visibleColsService.getAllCols().filter((e=>e.isAutoHeaderHeight())).map((e=>e.getAutoHeaderHeight()||0));return Math.max(e,...t)}getHeaderHeight(){return this.gos.get("headerHeight")??this.environment.getDefaultHeaderHeight()}getFloatingFiltersHeight(){return this.gos.get("floatingFiltersHeight")??this.getHeaderHeight()}getGroupHeaderHeight(){return this.gos.get("groupHeaderHeight")??this.getHeaderHeight()}getPivotHeaderHeight(){return this.gos.get("pivotHeaderHeight")??this.getHeaderHeight()}getPivotGroupHeaderHeight(){return this.gos.get("pivotGroupHeaderHeight")??this.getGroupHeaderHeight()}onFirstDataRendered(){const e=this.gos.get("autoSizeStrategy");if("fitCellContents"!==e?.type)return;const{colIds:t,skipHeader:n}=e;setTimeout((()=>{t?this.columnAutosizeService.autoSizeCols({colKeys:t,skipHeader:n,source:"autosizeColumns"}):this.columnAutosizeService.autoSizeAllColumns("autosizeColumns",n)}))}onAutoGroupColumnDefChanged(e){this.autoCols&&this.autoColService.updateAutoCols(this.autoCols.list,e)}onSelectionOptionsChanged(e,t,n){const i=(t&&"string"!==typeof t?fn(t):void 0)!==(e&&"string"!==typeof e?fn(e):void 0),r=t&&"string"!==typeof t?mn(t):void 0,s=e&&"string"!==typeof e?mn(e):void 0;(i||r!==s)&&this.refreshAll(n)}};function wi(e){return"gridOptionsUpdated"===e?"gridOptionsChanged":e}function Si(e){e.map={},e.list.forEach((t=>e.map[t.getId()]=t))}function bi(e,t){const n=e===t,i=e.getColDef()===t,r=e.getColId()==t;return n||i||r}function xi(e,t){return Tn(e,t,((e,t)=>e.getColId()===t.getColId()))}var _i=class extends Vn{constructor(){super(...arguments),this.beanName="columnAutosizeService",this.timesDelayed=0}wireBeans(e){this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.animationFrameService=e.animationFrameService,this.autoWidthCalculator=e.autoWidthCalculator,this.eventDispatcher=e.columnEventDispatcher,this.ctrlsService=e.ctrlsService,this.renderStatusService=e.renderStatusService}autoSizeCols(e){if(this.columnModel.isShouldQueueResizeOperations())return void this.columnModel.pushResizeOperation((()=>this.autoSizeCols(e)));const{colKeys:t,skipHeader:n,skipHeaderGroups:i,stopAtGroup:r,source:s="api"}=e;if(this.animationFrameService.flushAllFrames(),this.timesDelayed<5&&this.renderStatusService&&!this.renderStatusService.areHeaderCellsRendered())return this.timesDelayed++,void setTimeout((()=>this.autoSizeCols(e)));this.timesDelayed=0;const o=[];let a=-1;const l=null!=n?n:this.gos.get("skipHeaderOnAutoSize"),c=null!=i?i:l;for(;0!==a;){a=0;const e=[];t.forEach((t=>{if(!t)return;const n=this.columnModel.getCol(t);if(!n)return;if(o.indexOf(n)>=0)return;const i=this.autoWidthCalculator.getPreferredWidthForColumn(n,l);if(i>0){const e=this.normaliseColumnWidth(n,i);n.setActualWidth(e,s),o.push(n),a++}e.push(n)})),e.length&&this.visibleColsService.refresh(s)}c||this.autoSizeColumnGroupsByColumns(t,s,r),this.eventDispatcher.columnResized(o,!0,"autosizeColumns")}autoSizeColumn(e,t,n){e&&this.autoSizeCols({colKeys:[e],skipHeader:n,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,n){const i=new Set;let r;this.columnModel.getColsForKeys(e).forEach((e=>{let t=e.getParent();for(;t&&t!=n;)t.isPadding()||i.add(t),t=t.getParent()}));for(const s of i){for(const e of this.ctrlsService.getHeaderRowContainerCtrls())if(r=e.getHeaderCtrlForColumn(s),r)break;r&&r.resizeLeafColumnsToFit(t)}return[]}autoSizeAllColumns(e,t){if(this.columnModel.isShouldQueueResizeOperations())return void this.columnModel.pushResizeOperation((()=>this.autoSizeAllColumns(e,t)));const n=this.visibleColsService.getAllCols();this.autoSizeCols({colKeys:n,skipHeader:t,source:e})}normaliseColumnWidth(e,t){const n=e.getMinWidth();t<n&&(t=n);const i=e.getMaxWidth();return e.isGreaterThanMax(t)&&(t=i),t}},Mi=class extends Vn{constructor(){super(...arguments),this.beanName="funcColsService",this.rowGroupCols=[],this.valueCols=[],this.pivotCols=[]}wireBeans(e){this.columnModel=e.columnModel,this.eventDispatcher=e.columnEventDispatcher,this.aggFuncService=e.aggFuncService,this.visibleColsService=e.visibleColsService}getModifyColumnsNoEventsCallbacks(){return{addGroupCol:e=>this.rowGroupCols.push(e),removeGroupCol:e=>An(this.rowGroupCols,e),addPivotCol:e=>this.pivotCols.push(e),removePivotCol:e=>An(this.pivotCols,e),addValueCol:e=>this.valueCols.push(e),removeValueCol:e=>An(this.valueCols,e)}}getSourceColumnsForGroupColumn(e){const t=e.getColDef().showRowGroup;if(!t)return null;if(!0===t)return this.rowGroupCols.slice(0);const n=this.columnModel.getColDefCol(t);return n?[n]:null}sortRowGroupColumns(e){this.rowGroupCols.sort(e)}sortPivotColumns(e){this.pivotCols.sort(e)}getValueColumns(){return this.valueCols?this.valueCols:[]}getPivotColumns(){return this.pivotCols?this.pivotCols:[]}getRowGroupColumns(){return this.rowGroupCols?this.rowGroupCols:[]}isRowGroupEmpty(){return It(this.rowGroupCols)}setColumnAggFunc(e,t,n){if(!e)return;const i=this.columnModel.getColDefCol(e);i&&(i.setAggFunc(t),this.eventDispatcher.columnChanged("columnValueChanged",[i],n))}setRowGroupColumns(e,t){this.setColList(e,this.rowGroupCols,"columnRowGroupChanged",!0,!0,((e,n)=>this.setRowGroupActive(e,n,t)),t)}setRowGroupActive(e,t,n){e!==t.isRowGroupActive()&&(t.setRowGroupActive(e,n),e&&!this.gos.get("suppressRowGroupHidesColumns")&&this.columnModel.setColsVisible([t],!1,n),e||this.gos.get("suppressMakeColumnVisibleAfterUnGroup")||this.columnModel.setColsVisible([t],!0,n))}addRowGroupColumns(e,t){this.updateColList(e,this.rowGroupCols,!0,!0,(e=>this.setRowGroupActive(!0,e,t)),"columnRowGroupChanged",t)}removeRowGroupColumns(e,t){this.updateColList(e,this.rowGroupCols,!1,!0,(e=>this.setRowGroupActive(!1,e,t)),"columnRowGroupChanged",t)}addPivotColumns(e,t){this.updateColList(e,this.pivotCols,!0,!1,(e=>e.setPivotActive(!0,t)),"columnPivotChanged",t)}setPivotColumns(e,t){this.setColList(e,this.pivotCols,"columnPivotChanged",!0,!1,((e,n)=>{n.setPivotActive(e,t)}),t)}removePivotColumns(e,t){this.updateColList(e,this.pivotCols,!1,!1,(e=>e.setPivotActive(!1,t)),"columnPivotChanged",t)}setValueColumns(e,t){this.setColList(e,this.valueCols,"columnValueChanged",!1,!1,((e,n)=>this.setValueActive(e,n,t)),t)}setValueActive(e,t,n){if(e!==t.isValueActive()&&(t.setValueActive(e,n),e&&!t.getAggFunc()&&this.aggFuncService)){const e=this.aggFuncService.getDefaultAggFunc(t);t.setAggFunc(e)}}addValueColumns(e,t){this.updateColList(e,this.valueCols,!0,!1,(e=>this.setValueActive(!0,e,t)),"columnValueChanged",t)}removeValueColumns(e,t){this.updateColList(e,this.valueCols,!1,!1,(e=>this.setValueActive(!1,e,t)),"columnValueChanged",t)}moveRowGroupColumn(e,t,n){if(this.isRowGroupEmpty())return;const i=this.rowGroupCols[e],r=this.rowGroupCols.slice(e,t);this.rowGroupCols.splice(e,1),this.rowGroupCols.splice(t,0,i),this.eventDispatcher.rowGroupChanged(r,n)}setColList(e,t,n,i,r,s,o){if(!this.columnModel.getCols())return;const a=new Map;t.forEach(((e,t)=>a.set(e,t))),t.length=0,Dt(e)&&e.forEach((e=>{const n=this.columnModel.getColDefCol(e);n&&t.push(n)})),t.forEach(((e,t)=>{const n=a.get(e);void 0!==n?i&&n!==t||a.delete(e):a.set(e,0)}));(this.columnModel.getColDefCols()||[]).forEach((e=>{const n=t.indexOf(e)>=0;s(n,e)})),r&&this.columnModel.refreshCols(!1),this.visibleColsService.refresh(o),this.eventDispatcher.columnChanged(n,[...a.keys()],o)}updateColList(e,t,n,i,r,s,o){if(!e||It(e))return;let a=!1;const l=new Set;e.forEach((e=>{if(!e)return;const i=this.columnModel.getColDefCol(e);if(i){if(l.add(i),n){if(t.indexOf(i)>=0)return;t.push(i)}else{const e=t.indexOf(i);if(e<0)return;for(let n=e+1;n<t.length;n++)l.add(t[n]);An(t,i)}r(i),a=!0}})),a&&(i&&this.columnModel.refreshCols(!1),this.visibleColsService.refresh(o),this.eventDispatcher.genericColumnEvent(s,Array.from(l),o))}extractCols(e,t){this.extractRowGroupCols(e,t),this.extractPivotCols(e,t),this.extractValueCols(e,t)}extractValueCols(e,t){this.valueCols=this.extractColsCommon(t,this.valueCols,((t,n)=>t.setValueActive(n,e)),(()=>{}),(()=>{}),(e=>{const t=e.aggFunc;return null===t||""===t?null:void 0!==t?!!t:void 0}),(e=>null!=e.initialAggFunc&&""!=e.initialAggFunc)),this.valueCols.forEach((e=>{const t=e.getColDef();null!=t.aggFunc&&""!=t.aggFunc?e.setAggFunc(t.aggFunc):e.getAggFunc()||e.setAggFunc(t.initialAggFunc)}))}extractRowGroupCols(e,t){this.rowGroupCols=this.extractColsCommon(t,this.rowGroupCols,((t,n)=>t.setRowGroupActive(n,e)),(e=>e.rowGroupIndex),(e=>e.initialRowGroupIndex),(e=>e.rowGroup),(e=>e.initialRowGroup))}extractPivotCols(e,t){this.pivotCols=this.extractColsCommon(t,this.pivotCols,((t,n)=>t.setPivotActive(n,e)),(e=>e.pivotIndex),(e=>e.initialPivotIndex),(e=>e.pivot),(e=>e.initialPivot))}extractColsCommon(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;const a=[],l=[];(this.columnModel.getColDefCols()||[]).forEach((n=>{const c=e.indexOf(n)<0,u=n.getColDef(),h=Nt(s(u)),d=Nt(o(u)),p=Ot(i(u)),g=Ot(r(u));let f;if(f=void 0!==h?h:void 0!==p?null!==p&&p>=0:c?void 0!==d?d:!!(void 0!==g)&&(null!=g&&g>=0):t.indexOf(n)>=0,f){(c?null!=p||null!=g:null!=p)?a.push(n):l.push(n)}}));const c=e=>{const t=i(e.getColDef()),n=r(e.getColDef());return null!=t?t:n};a.sort(((e,t)=>{const n=c(e),i=c(t);return n===i?0:n<i?-1:1}));const u=[].concat(a);return t.forEach((e=>{l.indexOf(e)>=0&&u.push(e)})),l.forEach((e=>{u.indexOf(e)<0&&u.push(e)})),t.forEach((e=>{u.indexOf(e)<0&&n(e,!1)})),u.forEach((e=>{t.indexOf(e)<0&&n(e,!0)})),u}generateColumnStateForRowGroupAndPivotIndexes(e,t){const n={},i=(e,t,i,r,s,o)=>{const a=this.columnModel.getColDefCols();if(!t.length||!a)return[];const l=Object.keys(e),c=new Set(l),u=new Set(l),h=new Set(t.map((e=>{const t=e.getColId();return u.delete(t),t})).concat(l)),d=[],p={};let g=0;for(let n=0;n<a.length;n++){const e=a[n].getColId();h.has(e)&&(d.push(e),p[e]=g++)}let f=1e3,m=!1,v=0;const y=t=>{const n=p[t];for(let i=v;i<n;i++){const t=d[i];u.has(t)&&(e[t][s]=f++,u.delete(t))}v=n};t.forEach((t=>{const a=t.getColId();if(c.has(a))y(a),e[a][s]=f++;else{const l=t.getColDef();if(null===l[s]||void 0===l[s]&&null==l[o]){if(!m){l[i]||void 0===l[i]&&l[r]?y(a):(u.forEach((t=>{e[t][s]=f+p[t]})),f+=d.length,m=!0)}n[a]||(n[a]={colId:a}),n[a][s]=f++}}}))};return i(e,this.rowGroupCols,"rowGroup","initialRowGroup","rowGroupIndex","initialRowGroupIndex"),i(t,this.pivotCols,"pivot","initialPivot","pivotIndex","initialPivotIndex"),Object.values(n)}},Ei=class extends Vn{constructor(){super(...arguments),this.beanName="columnApplyStateService"}wireBeans(e){this.columnModel=e.columnModel,this.eventDispatcher=e.columnEventDispatcher,this.sortController=e.sortController,this.columnGetStateService=e.columnGetStateService,this.funcColsService=e.funcColsService,this.visibleColsService=e.visibleColsService,this.columnAnimationService=e.columnAnimationService,this.pivotResultColsService=e.pivotResultColsService}applyColumnState(e,t){const n=this.columnModel.getColDefCols()||[];if(It(n))return!1;if(e&&e.state&&!e.state.forEach)return bt("applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;const i=this.funcColsService.getModifyColumnsNoEventsCallbacks(),r=(n,r,s)=>{const o=this.compareColumnStatesAndDispatchEvents(t),a=r.slice(),l={},c={},u=[],h=[];let d=0;const p=this.funcColsService.getRowGroupColumns().slice(),g=this.funcColsService.getPivotColumns().slice();n.forEach((n=>{const r=n.colId||"";if(r.startsWith(Kn))return u.push(n),void h.push(n);const o=s(r);o?(this.syncColumnWithStateItem(o,n,e.defaultState,l,c,!1,t,i),An(a,o)):(h.push(n),d+=1)}));const f=n=>this.syncColumnWithStateItem(n,null,e.defaultState,l,c,!1,t,i);a.forEach(f),this.funcColsService.sortRowGroupColumns(Ri.bind(this,l,p)),this.funcColsService.sortPivotColumns(Ri.bind(this,c,g)),this.columnModel.refreshCols(!1);const m=(this.columnModel.getAutoCols()||[]).slice();return u.forEach((n=>{const r=this.columnModel.getAutoCol(n.colId);An(m,r),this.syncColumnWithStateItem(r,n,e.defaultState,null,null,!0,t,i)})),m.forEach(f),this.orderLiveColsLikeState(e),this.visibleColsService.refresh(t),this.eventDispatcher.everythingChanged(t),o(),{unmatchedAndAutoStates:h,unmatchedCount:d}};this.columnAnimationService.start();let{unmatchedAndAutoStates:s,unmatchedCount:o}=r(e.state||[],n,(e=>this.columnModel.getColDefCol(e)));if(s.length>0||Dt(e.defaultState)){const e=this.pivotResultColsService.getPivotResultCols(),t=e?.list;o=r(s,t||[],(e=>this.pivotResultColsService.getPivotResultCol(e))).unmatchedCount}return this.columnAnimationService.finish(),0===o}resetColumnState(e){if(It(this.columnModel.getColDefCols()))return;const t=$n(this.columnModel.getColDefColTree()),n=[];let i=1e3,r=1e3,s=[];const o=this.columnModel.getAutoCols();o&&(s=s.concat(o)),t&&(s=s.concat(t)),s.forEach((e=>{const t=this.getColumnStateFromColDef(e);Lt(t.rowGroupIndex)&&t.rowGroup&&(t.rowGroupIndex=i++),Lt(t.pivotIndex)&&t.pivot&&(t.pivotIndex=r++),n.push(t)})),this.applyColumnState({state:n,applyOrder:!0},e)}getColumnStateFromColDef(e){const t=(e,t)=>null!=e?e:null!=t?t:null,n=e.getColDef(),i=t(n.sort,n.initialSort),r=t(n.sortIndex,n.initialSortIndex),s=t(n.hide,n.initialHide),o=t(n.pinned,n.initialPinned),a=t(n.width,n.initialWidth),l=t(n.flex,n.initialFlex);let c=t(n.rowGroupIndex,n.initialRowGroupIndex),u=t(n.rowGroup,n.initialRowGroup);null!=c||null!=u&&0!=u||(c=null,u=null);let h=t(n.pivotIndex,n.initialPivotIndex),d=t(n.pivot,n.initialPivot);null!=h||null!=d&&0!=d||(h=null,d=null);const p=t(n.aggFunc,n.initialAggFunc);return{colId:e.getColId(),sort:i,sortIndex:r,hide:s,pinned:o,width:a,flex:l,rowGroup:u,rowGroupIndex:c,pivot:d,pivotIndex:h,aggFunc:p}}syncColumnWithStateItem(e,t,n,i,r,s,o,a){if(!e)return;const l=(e,i)=>{const r={value1:void 0,value2:void 0};let s=!1;return t&&(void 0!==t[e]&&(r.value1=t[e],s=!0),Dt(i)&&void 0!==t[i]&&(r.value2=t[i],s=!0)),!s&&n&&(void 0!==n[e]&&(r.value1=n[e]),Dt(i)&&void 0!==n[i]&&(r.value2=n[i])),r},c=l("hide").value1;void 0!==c&&e.setVisible(!c,o);const u=l("pinned").value1;void 0!==u&&e.setPinned(u);const h=e.getColDef().minWidth??this.gos.environment.getDefaultColumnMinWidth(),d=l("flex").value1;if(void 0!==d&&e.setFlex(d),null==d){const t=l("width").value1;null!=t&&null!=h&&t>=h&&e.setActualWidth(t,o)}const p=l("sort").value1;void 0!==p&&("desc"===p||"asc"===p?e.setSort(p,o):e.setSort(void 0,o));const g=l("sortIndex").value1;if(void 0!==g&&e.setSortIndex(g),s||!e.isPrimary())return;const f=l("aggFunc").value1;void 0!==f&&("string"===typeof f?(e.setAggFunc(f),e.isValueActive()||(e.setValueActive(!0,o),a.addValueCol(e))):(Dt(f)&&bt("stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),e.isValueActive()&&(e.setValueActive(!1,o),a.removeValueCol(e))));const{value1:m,value2:v}=l("rowGroup","rowGroupIndex");void 0===m&&void 0===v||("number"===typeof v||m?(e.isRowGroupActive()||(e.setRowGroupActive(!0,o),a.addGroupCol(e)),i&&"number"===typeof v&&(i[e.getId()]=v)):e.isRowGroupActive()&&(e.setRowGroupActive(!1,o),a.removeGroupCol(e)));const{value1:y,value2:C}=l("pivot","pivotIndex");void 0===y&&void 0===C||("number"===typeof C||y?(e.isPivotActive()||(e.setPivotActive(!0,o),a.addPivotCol(e)),r&&"number"===typeof C&&(r[e.getId()]=C)):e.isPivotActive()&&(e.setPivotActive(!1,o),a.removePivotCol(e)))}orderLiveColsLikeState(e){if(!e.applyOrder||!e.state)return;const t=[];e.state.forEach((e=>{null!=e.colId&&t.push(e.colId)})),this.columnModel.sortColsLikeKeys(t)}compareColumnStatesAndDispatchEvents(e){const t={rowGroupColumns:this.funcColsService.getRowGroupColumns().slice(),pivotColumns:this.funcColsService.getPivotColumns().slice(),valueColumns:this.funcColsService.getValueColumns().slice()},n=this.columnGetStateService.getColumnState(),i={};return n.forEach((e=>{i[e.colId]=e})),()=>{const r=this.columnModel.getAllCols(),s=(t,n,i,r)=>{if(Tn(n.map(r),i.map(r)))return;const s=new Set(n);i.forEach((e=>{s.delete(e)||s.add(e)}));const o=[...s];this.eventService.dispatchEvent({type:t,columns:o,column:1===o.length?o[0]:null,source:e})},o=e=>{const t=[];return r.forEach((n=>{const r=i[n.getColId()];r&&e(r,n)&&t.push(n)})),t},a=e=>e.getColId();s("columnRowGroupChanged",t.rowGroupColumns,this.funcColsService.getRowGroupColumns(),a),s("columnPivotChanged",t.pivotColumns,this.funcColsService.getPivotColumns(),a);const l=o(((e,t)=>{const n=null!=e.aggFunc,i=n!=t.isValueActive(),r=n&&e.aggFunc!=t.getAggFunc();return i||r}));l.length>0&&this.eventDispatcher.columnChanged("columnValueChanged",l,e);this.eventDispatcher.columnResized(o(((e,t)=>e.width!=t.getActualWidth())),!0,e);this.eventDispatcher.columnPinned(o(((e,t)=>e.pinned!=t.getPinned())),e);this.eventDispatcher.columnVisible(o(((e,t)=>e.hide==t.isVisible())),e);const c=o(((e,t)=>e.sort!=t.getSort()||e.sortIndex!=t.getSortIndex()));c.length>0&&this.sortController.dispatchSortChangedEvents(e,c),this.normaliseColumnMovedEventForColumnState(n,e)}}normaliseColumnMovedEventForColumnState(e,t){const n=this.columnGetStateService.getColumnState(),i={};n.forEach((e=>i[e.colId]=e));const r={};e.forEach((e=>{i[e.colId]&&(r[e.colId]=!0)}));const s=e.filter((e=>r[e.colId])),o=n.filter((e=>r[e.colId])),a=[];o.forEach(((e,t)=>{const n=s&&s[t];if(n&&n.colId!==e.colId){const e=this.columnModel.getCol(n.colId);e&&a.push(e)}})),a.length&&this.eventDispatcher.columnMoved({movedColumns:a,source:t,finished:!0})}},Ri=(e,t,n,i)=>{const r=e[n.getId()],s=e[i.getId()],o=null!=r,a=null!=s;if(o&&a)return r-s;if(o)return-1;if(a)return 1;const l=t.indexOf(n),c=t.indexOf(i),u=l>=0;return u&&c>=0?l-c:u?-1:1},Ti=class extends Vn{constructor(){super(...arguments),this.beanName="columnMoveService"}wireBeans(e){this.columnModel=e.columnModel,this.columnAnimationService=e.columnAnimationService,this.eventDispatcher=e.columnEventDispatcher}moveColumnByIndex(e,t,n){const i=this.columnModel.getCols();if(!i)return;const r=i[e];this.moveColumns([r],t,n)}moveColumns(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=this.columnModel.getCols();if(!r)return;if(t>r.length-e.length)return bt("tried to insert columns in invalid location, toIndex = ",t),void bt("remember that you should not count the moving columns when calculating the new index");this.columnAnimationService.start();const s=this.columnModel.getColsForKeys(e);this.doesMovePassRules(s,t)&&(this.columnModel.moveInCols(s,t,n),this.eventDispatcher.columnMoved({movedColumns:s,source:n,toIndex:t,finished:i})),this.columnAnimationService.finish()}doesMovePassRules(e,t){const n=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(n)}doesOrderPassRules(e){return!!this.doesMovePassMarryChildren(e)&&!!this.doesMovePassLockedPositions(e)}getProposedColumnOrder(e,t){const n=this.columnModel.getCols().slice();return Dn(n,e,t),n}doesMovePassLockedPositions(e){const t=this.gos.get("enableRtl");let n=t?1:-1,i=!0;return e.forEach((e=>{const r=(s=e.getColDef().lockPosition)?"left"===s||!0===s?-1:1:0;var s;t?r>n&&(i=!1):r<n&&(i=!1),n=r})),i}doesMovePassMarryChildren(e){let t=!0;return yi(null,this.columnModel.getColTree(),(n=>{if(!Wn(n))return;const i=n,r=i.getColGroupDef();if(!(r&&r.marryChildren))return;const s=[];i.getLeafColumns().forEach((t=>{const n=e.indexOf(t);s.push(n)}));Math.max.apply(Math,s)-Math.min.apply(Math,s)>i.getLeafColumns().length-1&&(t=!1)})),t}placeLockedColumns(e){const t=[],n=[],i=[];e.forEach((e=>{const r=e.getColDef().lockPosition;"right"===r?i.push(e):"left"===r||!0===r?t.push(e):n.push(e)}));return this.gos.get("enableRtl")?[...i,...n,...t]:[...t,...n,...i]}},Pi=/[&<>"']/g,Ai={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Fi(e){const t=String.fromCharCode;function n(e,n){return t(e>>n&63|128)}function i(e){if(0==(4294967168&e))return t(e);let i="";return 0==(4294965248&e)?i=t(e>>6&31|192):0==(4294901760&e)?(!function(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}(e),i=t(e>>12&15|224),i+=n(e,6)):0==(4292870144&e)&&(i=t(e>>18&7|240),i+=n(e,12),i+=n(e,6)),i+=t(63&e|128),i}const r=function(e){const t=[];if(!e)return[];const n=e.length;let i,r,s=0;for(;s<n;)i=e.charCodeAt(s++),i>=55296&&i<=56319&&s<n?(r=e.charCodeAt(s++),56320==(64512&r)?t.push(((1023&i)<<10)+(1023&r)+65536):(t.push(i),s--)):t.push(i);return t}(e),s=r.length;let o,a=-1,l="";for(;++a<s;)o=r[a],l+=i(o);return l}function Di(e,t){if(null==e)return null;const n=e.toString().toString();return t?n:n.replace(Pi,(e=>Ai[e]))}var Li=class extends Vn{constructor(){super(...arguments),this.beanName="columnNameService"}wireBeans(e){this.expressionService=e.expressionService,this.funcColsService=e.funcColsService,this.columnModel=e.columnModel}getDisplayNameForColumn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;const i=this.getHeaderName(e.getColDef(),e,null,null,t);return n?this.wrapHeaderNameWithAggFunc(e,i):i}getDisplayNameForProvidedColumnGroup(e,t,n){const i=t?t.getColGroupDef():null;return i?this.getHeaderName(i,null,e,t,n):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,n,i,r){const s=e.headerValueGetter;if(s){const o=this.gos.addGridCommonParams({colDef:e,column:t,columnGroup:n,providedColumnGroup:i,location:r});return"function"===typeof s?s(o):"string"===typeof s?this.expressionService.evaluate(s,o):(bt("headerValueGetter must be a function or a string"),"")}return null!=e.headerName?e.headerName:e.field?(o=e.field)&&null!=o?o.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z])([a-z])/g,"$1 $2$3").replace(/\./g," ").split(" ").map((e=>e.substring(0,1).toUpperCase()+(e.length>1?e.substring(1,e.length):""))).join(" "):null:"";var o}wrapHeaderNameWithAggFunc(e,t){if(this.gos.get("suppressAggFuncInHeader"))return t;const n=e.getColDef().pivotValueColumn;let i,r=null;if(Dt(n)){const s=this.funcColsService.getValueColumns(),o=this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&1===s.length,a=void 0!==e.getColDef().pivotTotalColumnIds;if(o&&!a)return t;r=n?n.getAggFunc():null,i=!0}else{const t=e.isValueActive(),n=this.columnModel.isPivotMode()||!this.funcColsService.isRowGroupEmpty();t&&n?(r=e.getAggFunc(),i=!0):i=!1}if(i){const e="string"===typeof r?r:"func";return`${this.localeService.getLocaleTextFunc()(e,e)}(${t})`}return t}},Ii=class extends Vn{constructor(){super(...arguments),this.beanName="pivotResultColsService"}wireBeans(e){this.context=e.context,this.columnModel=e.columnModel,this.columnFactory=e.columnFactory,this.visibleColsService=e.visibleColsService}destroy(){Yn(this.context,this.pivotResultCols?.tree),super.destroy()}isPivotResultColsPresent(){return null!=this.pivotResultCols}lookupPivotResultCol(e,t){if(null==this.pivotResultCols)return null;const n=this.columnModel.getColDefCol(t);let i=null;return this.pivotResultCols.list.forEach((t=>{const r=t.getColDef().pivotKeys,s=t.getColDef().pivotValueColumn;Tn(r,e)&&s===n&&(i=t)})),i}getPivotResultCols(){return this.pivotResultCols}getPivotResultCol(e){return this.pivotResultCols?this.columnModel.getColFromCollection(e,this.pivotResultCols):null}setPivotResultCols(e,t){if(this.columnModel.isReady()&&(null!=e||null!=this.pivotResultCols)){if(e){this.processPivotResultColDef(e);const n=this.columnFactory.createColumnTree(e,!1,this.pivotResultCols?.tree||this.previousPivotResultCols||void 0,t);Yn(this.context,this.pivotResultCols?.tree,n.columnTree);const i=n.columnTree,r=n.treeDept,s=$n(i),o={};this.pivotResultCols={tree:i,treeDepth:r,list:s,map:o},this.pivotResultCols.list.forEach((e=>this.pivotResultCols.map[e.getId()]=e));const a=!!this.previousPivotResultCols;this.previousPivotResultCols=null,this.columnModel.refreshCols(!a)}else this.previousPivotResultCols=this.pivotResultCols?this.pivotResultCols.tree:null,this.pivotResultCols=null,this.columnModel.refreshCols(!1);this.visibleColsService.refresh(t)}}processPivotResultColDef(e){const t=this.gos.get("processPivotResultColDef"),n=this.gos.get("processPivotResultColGroupDef");if(!t&&!n)return;const i=e=>{e.forEach((e=>{if(Dt(e.children)){const t=e;n&&n(t),i(t.children)}else{t&&t(e)}}))};e&&i(e)}},ki=class extends Vn{constructor(){super(...arguments),this.beanName="columnSizeService"}wireBeans(e){this.columnModel=e.columnModel,this.columnViewportService=e.columnViewportService,this.eventDispatcher=e.columnEventDispatcher,this.visibleColsService=e.visibleColsService,this.ctrlsService=e.ctrlsService}setColumnWidths(e,t,n,i){const r=[];e.forEach((e=>{const n=this.columnModel.getColDefCol(e.key)||this.columnModel.getCol(e.key);if(!n)return;r.push({width:e.newWidth,ratios:[1],columns:[n]});if("shift"===this.gos.get("colResizeDefault")&&(t=!t),t){const t=this.visibleColsService.getColAfter(n);if(!t)return;const i=n.getActualWidth()-e.newWidth,s=t.getActualWidth()+i;r.push({width:s,ratios:[1],columns:[t]})}})),0!==r.length&&this.resizeColumnSets({resizeSets:r,finished:n,source:i})}resizeColumnSets(e){const{resizeSets:t,finished:n,source:i}=e;if(!(!t||t.every((e=>this.checkMinAndMaxWidthsForSet(e))))){if(n){const e=t&&t.length>0?t[0].columns:null;this.eventDispatcher.columnResized(e,n,i)}return}const r=[],s=[];t.forEach((e=>{const{width:t,columns:n,ratios:o}=e,a={},l={};n.forEach((e=>s.push(e)));let c=!0,u=0;for(;c;){if(u++,u>1e3){xt("infinite loop in resizeColumnSets");break}c=!1;const e=[];let i=0,r=t;n.forEach(((t,n)=>{if(l[t.getId()])r-=a[t.getId()];else{e.push(t);const r=o[n];i+=r}}));const s=1/i;e.forEach(((n,i)=>{let u;i===e.length-1?u=r:(u=Math.round(o[i]*t*s),r-=u);const h=n.getMinWidth(),d=n.getMaxWidth();u<h?(u=h,l[n.getId()]=!0,c=!0):d>0&&u>d&&(u=d,l[n.getId()]=!0,c=!0),a[n.getId()]=u}))}n.forEach((e=>{const t=a[e.getId()];e.getActualWidth()!==t&&(e.setActualWidth(t,i),r.push(e))}))}));const o=r.length>0;let a=[];o&&(a=this.refreshFlexedColumns({resizingCols:s,skipSetLeft:!0}),this.visibleColsService.setLeftValues(i),this.visibleColsService.updateBodyWidths(),this.columnViewportService.checkViewportColumns());const l=s.concat(a);(o||n)&&this.eventDispatcher.columnResized(l,n,i,a)}checkMinAndMaxWidthsForSet(e){const{columns:t,width:n}=e;let i=0,r=0,s=!0;t.forEach((e=>{const t=e.getMinWidth();i+=t||0;const n=e.getMaxWidth();n>0?r+=n:s=!1}));return n>=i&&(!s||n<=r)}refreshFlexedColumns(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.source?e.source:"flex";if(null!=e.viewportWidth&&(this.flexViewportWidth=e.viewportWidth),!this.flexViewportWidth)return[];const n=this.visibleColsService.getCenterCols();let i=-1;if(e.resizingCols){const t=new Set(e.resizingCols);for(let e=n.length-1;e>=0;e--)if(t.has(n[e])){i=e;break}}let r=0,s=[],o=0,a=0;for(let d=0;d<n.length;d++){n[d].getFlex()&&d>i?(s.push(n[d]),a+=n[d].getFlex(),o+=n[d].getMinWidth()):r+=n[d].getActualWidth()}if(!s.length)return[];let l=[];r+o>this.flexViewportWidth&&(s.forEach((e=>e.setActualWidth(e.getMinWidth(),t))),l=s,s=[]);const c=[];let u;e:for(;;){u=this.flexViewportWidth-r;const e=u/a;for(let n=0;n<s.length;n++){const i=s[n],o=e*i.getFlex();let u=0;const h=i.getMinWidth(),d=i.getMaxWidth();if(o<h?u=h:o>d&&(u=d),u){i.setActualWidth(u,t),Pn(s,i),a-=i.getFlex(),l.push(i),r+=i.getActualWidth();continue e}c[n]=Math.floor(o)}break}let h=u;return s.forEach(((e,n)=>{const i=n<s.length-1?Math.min(c[n],h):Math.max(c[n],h);e.setActualWidth(i,t),l.push(e),h-=c[n]})),e.skipSetLeft||this.visibleColsService.setLeftValues(t),e.updateBodyWidths&&this.visibleColsService.updateBodyWidths(),e.fireResizedEvent&&this.eventDispatcher.columnResized(l,!0,t,s),s}sizeColumnsToFit(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sizeColumnsToFit",n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(this.columnModel.isShouldQueueResizeOperations())return void this.columnModel.pushResizeOperation((()=>this.sizeColumnsToFit(e,t,n,i)));const r={};i&&i?.columnLimits?.forEach((e=>{let{key:t,...n}=e;r["string"===typeof t?t:t.getColId()]=n}));const s=this.visibleColsService.getAllCols(),o=e===Zn(s);if(e<=0||!s.length||o)return;const a=[],l=[];s.forEach((e=>{!0===e.getColDef().suppressSizeToFit?l.push(e):a.push(e)}));const c=a.slice(0);let u=!1;const h=e=>{An(a,e),l.push(e)};for(a.forEach((e=>{e.resetActualWidth(t);const n=r?.[e.getId()],s=n?.minWidth??i?.defaultMinWidth,o=n?.maxWidth??i?.defaultMaxWidth,a=e.getActualWidth();"number"===typeof s&&a<s?e.setActualWidth(s,t,!0):"number"===typeof o&&a>o&&e.setActualWidth(o,t,!0)}));!u;){u=!0;const n=e-Zn(l);if(n<=0)a.forEach((e=>{const n=r?.[e.getId()]?.minWidth??i?.defaultMinWidth;"number"!==typeof n?e.setMinimum(t):e.setActualWidth(n,t,!0)}));else{const e=n/Zn(a);let s=n;for(let n=a.length-1;n>=0;n--){const o=a[n],l=r?.[o.getId()],c=l?.minWidth??i?.defaultMinWidth,d=l?.maxWidth??i?.defaultMaxWidth,p=o.getMinWidth(),g=o.getMaxWidth(),f="number"===typeof c&&c>p?c:p,m="number"===typeof d&&d<g?d:g;let v=Math.round(o.getActualWidth()*e);v<f?(v=f,h(o),u=!1):v>m?(v=m,h(o),u=!1):0===n&&(v=s),o.setActualWidth(v,t,!0),s-=v}}}c.forEach((e=>{e.fireColumnWidthChangedEvent(t)})),this.visibleColsService.setLeftValues(t),this.visibleColsService.updateBodyWidths(),n||this.eventDispatcher.columnResized(c,!0,t)}applyAutosizeStrategy(){const e=this.gos.get("autoSizeStrategy");if(!e)return;const{type:t}=e;setTimeout((()=>{if("fitGridWidth"===t){const{columnLimits:t,defaultMinWidth:n,defaultMaxWidth:i}=e,r=t?.map((e=>{let{colId:t,minWidth:n,maxWidth:i}=e;return{key:t,minWidth:n,maxWidth:i}}));this.ctrlsService.getGridBodyCtrl().sizeColumnsToFit({defaultMinWidth:n,defaultMaxWidth:i,columnLimits:r})}else"fitProvidedWidth"===t&&this.sizeColumnsToFit(e.width,"sizeColumnsToFit")}))}};function Oi(e,t){return e+"_"+t}function Ni(e){return e instanceof Bi}var Bi=class extends Vn{constructor(e,t,n,i){super(),this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null,this.groupId=t,this.partId=n,this.providedColumnGroup=e,this.pinned=i}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}setParent(e){this.parent=e}getUniqueId(){return Oi(this.groupId,this.partId)}isEmptyGroup(){return 0===this.displayedChildren.length}isMoving(){const e=this.getProvidedColumnGroup().getLeafColumns();return!(!e||0===e.length)&&e.every((e=>e.isMoving()))}checkLeft(){if(this.displayedChildren.forEach((e=>{Ni(e)&&e.checkLeft()})),this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const e=Rn(this.displayedChildren).getLeft();this.setLeft(e)}else{const e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;return this.displayedChildren&&this.displayedChildren.forEach((t=>{e+=t.getActualWidth()})),e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;return this.displayedChildren.forEach((t=>{t.isResizable()&&(e=!0)})),e}getMinWidth(){let e=0;return this.displayedChildren.forEach((t=>{e+=t.getMinWidth()})),e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){const e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){return!!this.getColGroupDef()?.autoHeaderHeight}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){this.displayedChildren.forEach((t=>{pi(t)?e.push(t):Ni(t)&&t.addDisplayedLeafColumns(e)}))}addLeafColumns(e){this.children.forEach((t=>{pi(t)?e.push(t):Ni(t)&&t.addLeafColumns(e)}))}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const e=this.getParent();return this.isPadding()&&e&&e.isPadding()?1+e.getPaddingLevel():0}calculateDisplayedColumns(){this.displayedChildren=[];let e=this;for(;null!=e&&e.isPadding();)e=e.getParent();if(!(!!e&&e.getProvidedColumnGroup().isExpandable()))return this.displayedChildren=this.children,void this.dispatchLocalEvent({type:"displayedChildrenChanged"});this.children.forEach((t=>{if(Ni(t)&&(!t.displayedChildren||!t.displayedChildren.length))return;switch(t.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(t);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(t);break;default:this.displayedChildren.push(t)}})),this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},zi=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let n;return n="number"!==typeof t?0:t+1,this.existingIds[e]=n,n}},Hi=class extends Vn{constructor(){super(...arguments),this.beanName="visibleColsService",this.colsAndGroupsMap={},this.columnsLeft=[],this.columnsRight=[],this.columnsCenter=[],this.columns=[],this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.bodyWidthDirty=!0}wireBeans(e){this.columnModel=e.columnModel,this.columnSizeService=e.columnSizeService,this.columnViewportService=e.columnViewportService,this.eventDispatcher=e.columnEventDispatcher}refresh(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this.buildTrees(),this.updateOpenClosedVisibilityInColumnGroups(),this.columnsLeft=Ui(this.treeLeft),this.columnsCenter=Ui(this.treeCenter),this.columnsRight=Ui(this.treeRight),this.joinColsAriaOrder(),this.joinCols(),this.setLeftValues(e),this.autoHeightCols=this.columns.filter((e=>e.isAutoHeight())),this.columnSizeService.refreshFlexedColumns(),this.updateBodyWidths(),this.columnViewportService.checkViewportColumns(!1),this.setFirstRightAndLastLeftPinned(e),this.eventDispatcher.visibleCols(e)}updateBodyWidths(){const e=Zn(this.columnsCenter),t=Zn(this.columnsLeft),n=Zn(this.columnsRight);this.bodyWidthDirty=this.bodyWidth!==e;(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==n)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=n,this.eventService.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventService.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e){let t,n;this.gos.get("enableRtl")?(t=this.columnsLeft?this.columnsLeft[0]:null,n=this.columnsRight?Rn(this.columnsRight):null):(t=this.columnsLeft?Rn(this.columnsLeft):null,n=this.columnsRight?this.columnsRight[0]:null),this.columnModel.getCols().forEach((i=>{i.setLastLeftPinned(i===t,e),i.setFirstRightPinned(i===n,e)}))}buildTrees(){const e=this.columnModel.getColsToShow(),t=e.filter((e=>"left"==e.getPinned())),n=e.filter((e=>"right"==e.getPinned())),i=e.filter((e=>"left"!=e.getPinned()&&"right"!=e.getPinned())),r=new zi;this.treeLeft=this.createGroups({columns:t,idCreator:r,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=this.createGroups({columns:n,idCreator:r,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=this.createGroups({columns:i,idCreator:r,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.columnsLeft=[],this.columnsRight=[],this.columnsCenter=[],this.columns=[],this.ariaOrderColumns=[]}joinColsAriaOrder(){const e=this.columnModel.getCols(),t=[],n=[],i=[];for(const r of e){const e=r.getPinned();e?!0===e||"left"===e?t.push(r):i.push(r):n.push(r)}this.ariaOrderColumns=t.concat(n).concat(i)}getAriaColIndex(e){let t;return t=Ni(e)?e.getLeafColumns()[0]:e,this.ariaOrderColumns.indexOf(t)+1}getAllAutoHeightCols(){return this.autoHeightCols}setLeftValuesOfGroups(){[this.treeLeft,this.treeRight,this.treeCenter].forEach((e=>{e.forEach((e=>{if(Ni(e)){e.checkLeft()}}))}))}setLeftValuesOfCols(e){if(!this.columnModel.getColDefCols())return;const t=this.columnModel.getCols().slice(0),n=this.gos.get("enableRtl");[this.columnsLeft,this.columnsRight,this.columnsCenter].forEach((i=>{if(n){let t=Zn(i);i.forEach((n=>{t-=n.getActualWidth(),n.setLeft(t,e)}))}else{let t=0;i.forEach((n=>{n.setLeft(t,e),t+=n.getActualWidth()}))}!function(e,t){for(let n=0;n<t.length;n++)Pn(e,t[n])}(t,i)})),t.forEach((t=>{t.setLeft(null,e)}))}joinCols(){this.gos.get("enableRtl")?this.columns=this.columnsRight.concat(this.columnsCenter).concat(this.columnsLeft):this.columns=this.columnsLeft.concat(this.columnsCenter).concat(this.columnsRight)}getColsCenter(){return this.columnsCenter}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}getTreeLeft(){return this.treeLeft}getTreeRight(){return this.treeRight}getTreeCenter(){return this.treeCenter}getAllCols(){return this.columns}isColDisplayed(e){return this.getAllCols().indexOf(e)>=0}getLeftColsForRow(e){return this.columnModel.isColSpanActive()?this.getColsForRow(e,this.columnsLeft):this.columnsLeft}getRightColsForRow(e){return this.columnModel.isColSpanActive()?this.getColsForRow(e,this.columnsRight):this.columnsRight}getColsForRow(e,t,n,i){const r=[];let s=null;for(let o=0;o<t.length;o++){const a=t[o],l=t.length-o,c=Math.min(a.getColSpan(e),l),u=[a];if(c>1){const e=c-1;for(let n=1;n<=e;n++)u.push(t[o+n]);o+=e}let h;if(n?(h=!1,u.forEach((e=>{n(e)&&(h=!0)}))):h=!0,h){if(0===r.length&&s){!!i&&i(a)&&r.push(s)}r.push(a)}s=a}return r}getBodyContainerWidth(){return this.bodyWidth}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getCenterCols(){return this.columnsCenter}getLeftCols(){return this.columnsLeft}getRightCols(){return this.columnsRight}getColBefore(e){const t=this.getAllCols(),n=t.indexOf(e);return n>0?t[n-1]:null}getGroupAtDirection(e,t){const n=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),i=e.getDisplayedLeafColumns(),r="After"===t?Rn(i):i[0],s=`getCol${t}`;for(;;){const t=this[s](r);if(!t)return null;const i=this.getColGroupAtLevel(t,n);if(i!==e)return i}}getColGroupAtLevel(e,t){let n,i,r=e.getParent();for(;;){if(n=r.getProvidedColumnGroup().getLevel(),i=r.getPaddingLevel(),n+i<=t)break;r=r.getParent()}return r}isPinningLeft(){return this.columnsLeft.length>0}isPinningRight(){return this.columnsRight.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};const e=e=>{this.colsAndGroupsMap[e.getUniqueId()]=e};Gi(this.treeCenter,!1,e),Gi(this.treeLeft,!1,e),Gi(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}updateOpenClosedVisibilityInColumnGroups(){Gi(this.getAllTrees(),!1,(e=>{Ni(e)&&e.calculateDisplayedColumns()}))}getFirstColumn(){const e=this.gos.get("enableRtl"),t=["getLeftCols","getCenterCols","getRightCols"];e&&t.reverse();for(let n=0;n<t.length;n++){const i=this[t[n]]();if(i.length)return e?Rn(i):i[0]}return null}getColumnGroup(e,t){if(!e)return null;if(Ni(e))return e;const n=this.getAllTrees(),i="number"===typeof t;let r=null;return Gi(n,!1,(n=>{if(Ni(n)){const s=n;let o;o=i?e===s.getGroupId()&&t===s.getPartId():e===s.getGroupId(),o&&(r=s)}})),r}getColAfter(e){const t=this.getAllCols(),n=t.indexOf(e);return n<t.length-1?t[n+1]:null}isBodyWidthDirty(){return this.bodyWidthDirty}setBodyWidthDirty(){this.bodyWidthDirty=!0}getColsLeftWidth(){return Zn(this.columnsLeft)}getDisplayedColumnsRightWidth(){return Zn(this.columnsRight)}isColAtEdge(e,t){const n=this.getAllCols();if(!n.length)return!1;const i="first"===t;let r;if(Ni(e)){const t=e.getDisplayedLeafColumns();if(!t.length)return!1;r=i?t[0]:Rn(t)}else r=e;return(i?n[0]:Rn(n))===r}createGroups(e){const{columns:t,idCreator:n,pinned:i,oldDisplayedGroups:r,isStandaloneStructure:s}=e,o=this.mapOldGroupsById(r),a=[];let l=t;for(;l.length;){const e=l;l=[];let t=0;const r=r=>{const c=t;t=r;const u=e[c],h=(Ni(u)?u.getProvidedColumnGroup():u).getOriginalParent();if(null==h){for(let t=c;t<r;t++)a.push(e[t]);return}const d=this.createColGroup(h,n,o,i,s);for(let t=c;t<r;t++)d.addChild(e[t]);l.push(d)};for(let n=1;n<e.length;n++){const i=e[n],s=(Ni(i)?i.getProvidedColumnGroup():i).getOriginalParent(),o=e[t];s!==(Ni(o)?o.getProvidedColumnGroup():o).getOriginalParent()&&r(n)}t<e.length&&r(e.length)}return s||this.setupParentsIntoCols(a,null),a}createColGroup(e,t,n,i,r){const s=e.getGroupId(),o=t.getInstanceIdForKey(s);let a=n[Oi(s,o)];return a&&a.getProvidedColumnGroup()!==e&&(a=null),Dt(a)?a.reset():(a=new Bi(e,s,o,i),r||this.createBean(a)),a}mapOldGroupsById(e){const t={},n=e=>{e.forEach((e=>{if(Ni(e)){const i=e;t[e.getUniqueId()]=i,n(i.getChildren())}}))};return e&&n(e),t}setupParentsIntoCols(e,t){e.forEach((e=>{if(e.setParent(t),Ni(e)){const t=e;this.setupParentsIntoCols(t.getChildren(),t)}}))}};function Gi(e,t,n){if(e)for(let i=0;i<e.length;i++){const r=e[i];if(Ni(r)){Gi(t?r.getDisplayedChildren():r.getChildren(),t,n)}n(r)}}function Ui(e){const t=[];return Gi(e,!0,(e=>{pi(e)&&t.push(e)})),t}var Vi=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterOpened","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel"],Wi=[...Vi,"scrollbarWidthChanged","keyShortcutChangedCellStart","keyShortcutChangedCellEnd","pinnedHeightChanged","cellFocusCleared","fullWidthRowFocused","checkboxChanged","heightScaleChanged","suppressMovableColumns","suppressMenuHide","suppressFieldDotNotation","columnPanelItemDragStart","columnPanelItemDragEnd","bodyHeightChanged","columnContainerWidthChanged","displayedColumnsWidthChanged","scrollVisibilityChanged","scrollGapChanged","columnHoverChanged","flashCells","paginationPixelOffsetChanged","displayedRowsChanged","leftPinnedWidthChanged","rightPinnedWidthChanged","rowContainerHeightChanged","headerHeightChanged","columnGroupHeaderHeightChanged","columnHeaderHeightChanged","gridStylesChanged","storeUpdated","filterDestroyed","rowDataUpdateStarted","rowCountReady","advancedFilterEnabledChanged","dataTypesInferred","fieldValueChanged","fieldPickerValueSelected","richSelectListRowSelected","sideBarUpdated","alignedGridScroll","alignedGridColumn","gridOptionsChanged","chartTitleEdit","recalculateRowBounds","stickyTopOffsetChanged","overlayExclusiveChanged"],ji={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,advancedFilterModel:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressAsyncEvents:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,suppressAggFuncInHeader:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,suppressGroupMaintainValueType:!0,groupLockGroupColumns:!0,rowGroupPanelSuppressSort:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,suppressServerSideInfiniteScroll:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,columnMenu:!0,suppressSetFilterByDefault:!0},qi=class{};qi.STRING_PROPERTIES=["overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","grandTotalRow"],qi.OBJECT_PROPERTIES=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","theme","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterModel","advancedFilterParent","advancedFilterBuilderParams","initialState","autoSizeStrategy","cellSelection","selectionColumnDef"],qi.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"],qi.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns"],qi.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","suppressGroupMaintainValueType","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault"],qi.OTHER_PROPERTIES=["suppressStickyTotalRow","loadThemeGoogleFonts","rowSelection"],qi.FUNCTION_PROPERTIES=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","groupIncludeFooter","loadingCellRendererSelector","getRowId","groupAggFiltering","chartMenuItems","groupTotalRow"],qi.ALL_PROPERTIES=[...qi.ARRAY_PROPERTIES,...qi.OBJECT_PROPERTIES,...qi.STRING_PROPERTIES,...qi.NUMBER_PROPERTIES,...qi.FUNCTION_PROPERTIES,...qi.BOOLEAN_PROPERTIES,...qi.OTHER_PROPERTIES];var Xi=qi,Ki=class{static getCallbackForEvent(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}};Ki.VUE_OMITTED_PROPERTY="AG-VUE-OMITTED-PROPERTY",Ki.PUBLIC_EVENTS=Vi,Ki.EVENT_CALLBACKS=Wi.map((e=>Ki.getCallbackForEvent(e))),Ki.BOOLEAN_PROPERTIES=Xi.BOOLEAN_PROPERTIES,Ki.ALL_PROPERTIES=Xi.ALL_PROPERTIES,Ki.ALL_PROPERTIES_AND_CALLBACKS=[...Ki.ALL_PROPERTIES,...Ki.EVENT_CALLBACKS],Ki.ALL_PROPERTIES_AND_CALLBACKS_SET=new Set(Ki.ALL_PROPERTIES_AND_CALLBACKS);var $i=Ki;var Zi=class extends Vn{};function Yi(e,t,n){return n&&e.addDestroyFunc((()=>t.destroyBean(n))),n??e}var Ji,Qi,er,tr,nr,ir,rr,sr,or,ar,lr=class{constructor(e){this.cssClassStates={},this.getGui=e}addCssClass(e){const t=(e||"").split(" ");if(t.length>1)return void t.forEach((e=>this.addCssClass(e)));if(!0!==this.cssClassStates[e]&&e.length){const t=this.getGui();t&&t.classList.add(e),this.cssClassStates[e]=!0}}removeCssClass(e){const t=(e||"").split(" ");if(t.length>1)return void t.forEach((e=>this.removeCssClass(e)));if(!1!==this.cssClassStates[e]&&e.length){const t=this.getGui();t&&t.classList.remove(e),this.cssClassStates[e]=!1}}containsCssClass(e){const t=this.getGui();return!!t&&t.classList.contains(e)}addOrRemoveCssClass(e,t){if(!e)return;if(e.indexOf(" ")>=0){const n=(e||"").split(" ");if(n.length>1)return void n.forEach((e=>this.addOrRemoveCssClass(e,t)))}if(this.cssClassStates[e]!==t&&e.length){const n=this.getGui();n&&n.classList.toggle(e,t),this.cssClassStates[e]=t}}};function cr(e,t,n){null==n||"string"===typeof n&&""==n?hr(e,t):ur(e,t,n)}function ur(e,t,n){e.setAttribute(dr(t),n.toString())}function hr(e,t){e.removeAttribute(dr(t))}function dr(e){return`aria-${e}`}function pr(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function gr(e,t){cr(e,"label",t)}function fr(e,t){cr(e,"labelledby",t)}function mr(e,t){cr(e,"live",t)}function vr(e,t){cr(e,"hidden",t)}function yr(e,t){ur(e,"expanded",t)}function Cr(e,t){ur(e,"rowcount",t)}function wr(e,t){ur(e,"rowindex",t)}function Sr(e,t){ur(e,"colcount",t)}function br(e,t){ur(e,"colindex",t)}function xr(e,t){ur(e,"sort",t)}function _r(e){hr(e,"sort")}function Mr(e,t){cr(e,"selected",t)}function Er(e,t){return void 0===t?e("ariaIndeterminate","indeterminate"):!0===t?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}function Rr(){return void 0===Ji&&(Ji=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),Ji}function Tr(){if(void 0===Qi)if(Rr()){const e=navigator.userAgent.match(/version\/(\d+)/i);e&&(Qi=null!=e[1]?parseFloat(e[1]):0)}else Qi=0;return Qi}function Pr(){if(void 0===er){const e=window;er=!!e.chrome&&(!!e.chrome.webstore||!!e.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return er}function Ar(){return void 0===tr&&(tr=/(firefox)/i.test(navigator.userAgent)),tr}function Fr(){return void 0===nr&&(nr=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),nr}function Dr(){return void 0===ir&&(ir=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),ir}function Lr(){return!Rr()||Tr()>=15}function Ir(e){if(!e)return null;const t=e.tabIndex,n=e.getAttribute("tabIndex");return-1!==t||null!==n&&(""!==n||Ar())?t.toString():null}function kr(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let n=t.offsetWidth-t.clientWidth;0===n&&0===t.clientWidth&&(n=null),t.parentNode&&t.parentNode.removeChild(t),null!=n&&(sr=n,rr=0===n)}function Or(){return null==rr&&kr(),rr}var Nr="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function Br(e){const t=Element.prototype.matches||Element.prototype.msMatchesSelector,n=t.call(e,"input, select, button, textarea"),i=t.call(e,Nr),r=es(e);return n&&!i&&r}function zr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{skipAriaHidden:i}=n;e.classList.toggle("ag-hidden",!t),i||vr(e,!t)}function Hr(e,t){const n="disabled",i=t?e=>e.setAttribute(n,""):e=>e.removeAttribute(n);i(e),ls(e.querySelectorAll("input"),(e=>i(e)))}function Gr(e,t,n){let i=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,"number"==typeof n){if(++i>n)break}else if(e===n)break}return!1}function Ur(e){const{height:t,width:n,borderTopWidth:i,borderRightWidth:r,borderBottomWidth:s,borderLeftWidth:o,paddingTop:a,paddingRight:l,paddingBottom:c,paddingLeft:u,marginTop:h,marginRight:d,marginBottom:p,marginLeft:g,boxSizing:f}=window.getComputedStyle(e);return{height:parseFloat(t||"0"),width:parseFloat(n||"0"),borderTopWidth:parseFloat(i||"0"),borderRightWidth:parseFloat(r||"0"),borderBottomWidth:parseFloat(s||"0"),borderLeftWidth:parseFloat(o||"0"),paddingTop:parseFloat(a||"0"),paddingRight:parseFloat(l||"0"),paddingBottom:parseFloat(c||"0"),paddingLeft:parseFloat(u||"0"),marginTop:parseFloat(h||"0"),marginRight:parseFloat(d||"0"),marginBottom:parseFloat(p||"0"),marginLeft:parseFloat(g||"0"),boxSizing:f}}function Vr(e){const t=Ur(e);return"border-box"===t.boxSizing?t.height-t.paddingTop-t.paddingBottom:t.height}function Wr(e){const t=Ur(e);return"border-box"===t.boxSizing?t.width-t.paddingLeft-t.paddingRight:t.width}function jr(e){const{height:t,marginBottom:n,marginTop:i}=Ur(e);return Math.floor(t+n+i)}function qr(e){const{width:t,marginLeft:n,marginRight:i}=Ur(e);return Math.floor(t+n+i)}function Xr(e){const t=e.getBoundingClientRect(),{borderTopWidth:n,borderLeftWidth:i,borderRightWidth:r,borderBottomWidth:s}=Ur(e);return{top:t.top+(n||0),left:t.left+(i||0),right:t.right+(r||0),bottom:t.bottom+(s||0)}}function Kr(){if("boolean"===typeof ar)return ar;const e=document.createElement("div");return e.style.direction="rtl",e.style.width="1px",e.style.height="1px",e.style.position="fixed",e.style.top="0px",e.style.overflow="hidden",e.dir="rtl",e.innerHTML='<div style="width: 2px">\n            <span style="display: inline-block; width: 1px"></span>\n            <span style="display: inline-block; width: 1px"></span>\n        </div>',document.body.appendChild(e),e.scrollLeft=1,ar=0===Math.floor(e.scrollLeft),document.body.removeChild(e),ar}function $r(e,t){let n=e.scrollLeft;return t&&(n=Math.abs(n),Pr()&&!Kr()&&(n=e.scrollWidth-e.getBoundingClientRect().width-n)),n}function Zr(e,t,n){n&&(Kr()?t*=-1:(Rr()||Pr())&&(t=e.scrollWidth-e.getBoundingClientRect().width-t)),e.scrollLeft=t}function Yr(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}function Jr(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Qr(e){return!!e.offsetParent}function es(e){const t=e;if(t.checkVisibility)return t.checkVisibility({checkVisibilityCSS:!0});return!(!Qr(e)||"visible"!==window.getComputedStyle(e).visibility)}function ts(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function ns(e,t){"flex"===t?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):is(e,t)}function is(e,t){t=ss(t),e.style.width=t.toString(),e.style.maxWidth=t.toString(),e.style.minWidth=t.toString()}function rs(e,t){t=ss(t),e.style.height=t.toString(),e.style.maxHeight=t.toString(),e.style.minHeight=t.toString()}function ss(e){return"number"===typeof e?`${e}px`:e}function os(e){return e instanceof Node||e instanceof HTMLElement}function as(e,t,n){null==n||""===n?e.removeAttribute(t):e.setAttribute(t,n.toString())}function ls(e,t){if(null!=e)for(let n=0;n<e.length;n++)t(e[n])}var cs=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.nextValue=e,this.step=t}next(){const e=this.nextValue;return this.nextValue+=this.step,e}peek(){return this.nextValue}skip(e){this.nextValue+=e}},us=class e extends Vn{constructor(e,t,n,i){super(),this.parentComp=e,this.tooltipShowDelayOverride=t,this.tooltipHideDelayOverride=n,this.shouldDisplayTooltip=i,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(e){this.popupService=e.popupService,this.userComponentFactory=e.userComponentFactory}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");const e=this.parentComp.getGui();0===this.tooltipTrigger&&this.addManagedListeners(e,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),1===this.tooltipTrigger&&this.addManagedListeners(e,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(e,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(e,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(e){const t=this.gos.get(e);return t<0&&bt(`${e} should not be lower than 0`),Math.max(200,t)}getTooltipDelay(e){return"show"===e?this.tooltipShowDelayOverride??this.getGridOptionsTooltipDelay("tooltipShowDelay"):this.tooltipHideDelayOverride??this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){const e=this.gos.get("tooltipTrigger");return e&&"hover"!==e?1:0}onMouseEnter(t){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),Dr()||(e.isLocked?this.showTooltipTimeoutId=window.setTimeout((()=>{this.prepareToShowTooltip(t)}),100):this.prepareToShowTooltip(t))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&2===this.state&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){const t=e.relatedTarget,n=this.parentComp.getGui(),i=this.tooltipComp?.getGui();this.isInteractingWithTooltip||n.contains(t)||this.interactionEnabled&&i?.contains(t)||this.setToDoNothing()}onKeyDown(){this.isInteractingWithTooltip&&(this.isInteractingWithTooltip=!1),this.setToDoNothing()}prepareToShowTooltip(t){if(0!=this.state||e.isLocked)return;let n=0;t&&(n=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=t||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),n),this.state=1}isLastTooltipHiddenRecently(){return(new Date).getTime()-e.lastTooltipHideTime<1e3}setToDoNothing(e){e||2!==this.state||this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.onColumnMovedEventCallback&&(this.onColumnMovedEventCallback(),this.onColumnMovedEventCallback=void 0),this.onDocumentKeyDownCallback&&(this.onDocumentKeyDownCallback(),this.onDocumentKeyDownCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){const e={...this.parentComp.getTooltipParams()};if(!Dt(e.value)||this.shouldDisplayTooltip&&!this.shouldDisplayTooltip())return void this.setToDoNothing();this.state=2,this.tooltipInstanceCount++;const t=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(e).newAgStackInstance().then(t)}hideTooltip(t){!t&&this.isInteractingWithTooltip||(this.tooltipComp&&(this.destroyTooltipComp(),e.lastTooltipHideTime=(new Date).getTime()),this.eventService.dispatchEvent({type:"tooltipHide",parentGui:this.parentComp.getGui()}),t&&(this.isInteractingWithTooltip=!1),this.setToDoNothing(!0))}newTooltipComponentCallback(e,t){if(2!==this.state||this.tooltipInstanceCount!==e)return void this.destroyBean(t);const n=t.getGui();this.tooltipComp=t,n.classList.contains("ag-tooltip")||n.classList.add("ag-tooltip-custom"),0===this.tooltipTrigger&&n.classList.add("ag-tooltip-animate"),this.interactionEnabled&&n.classList.add("ag-tooltip-interactive");const i=this.localeService.getLocaleTextFunc(),r=this.popupService.addPopup({eChild:n,ariaLabel:i("ariaLabelTooltip","Tooltip")});if(r&&(this.tooltipPopupDestroyFunc=r.hideFunc),this.positionTooltip(),1===this.tooltipTrigger){const e=()=>this.setToDoNothing();[this.onBodyScrollEventCallback,this.onColumnMovedEventCallback]=this.addManagedEventListeners({bodyScroll:e,columnMoved:e})}this.interactionEnabled&&([this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(n,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}),[this.onDocumentKeyDownCallback]=this.addManagedElementListeners(en(this.gos),{keydown:e=>{n.contains(e?.target)||this.onKeyDown()}}),1===this.tooltipTrigger&&([this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(n,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}))),this.eventService.dispatchEvent({type:"tooltipShow",tooltipGui:n,parentGui:this.parentComp.getGui()}),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,this.lockService())}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}isTooltipFocused(){const e=this.tooltipComp?.getGui(),t=rn(this.gos);return!!e&&e.contains(t)}onTooltipFocusOut(e){const t=this.parentComp.getGui();this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,t.contains(e.relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){const e={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupService.positionPopupUnderMouseEvent({...e,mouseEvent:this.lastMouseEvent}):this.popupService.positionPopupByComponent({...e,eventSource:this.parentComp.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5})}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const e=this.tooltipPopupDestroyFunc,t=this.tooltipComp,n=0===this.tooltipTrigger?1e3:0;window.setTimeout((()=>{e(),this.destroyBean(t)}),n),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener].forEach((e=>{e&&e()})),this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){e.isLocked=!0,this.interactiveTooltipTimeoutId=window.setTimeout((()=>{this.unlockService(),this.setToDoNothing()}),100)}unlockService(){e.isLocked=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}};us.isLocked=!1;var hs=us,ds=class extends Vn{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}wireBeans(e){this.beans=e}postConstruct(){this.refreshToolTip()}setBrowserTooltip(e){const t="title",n=this.ctrl.getGui();n&&(null!=e&&""!=e?n.setAttribute(t,e):n.removeAttribute(t))}updateTooltipText(){this.tooltip=this.ctrl.getTooltipValue()}createTooltipFeatureIfNeeded(){if(null!=this.tooltipManager)return;const e={getTooltipParams:()=>this.getTooltipParams(),getGui:()=>this.ctrl.getGui()};this.tooltipManager=this.createBean(new hs(e,this.ctrl.getTooltipShowDelayOverride?.(),this.ctrl.getTooltipHideDelayOverride?.(),this.ctrl.shouldDisplayTooltip),this.beans.context)}refreshToolTip(){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context))):(this.setBrowserTooltip(null),this.createTooltipFeatureIfNeeded())}getTooltipParams(){const e=this.ctrl,t=e.getColumn?.(),n=e.getColDef?.(),i=e.getRowNode?.();return{location:e.getLocation(),colDef:n,column:t,rowIndex:e.getRowIndex?.(),node:i,data:i?.data,value:this.getTooltipText(),valueFormatted:e.getValueFormatted?.(),hideTooltipCallback:()=>this.tooltipManager?.hideTooltip(!0)}}getTooltipText(){return this.tooltip}destroy(){this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)),super.destroy()}},ps=new cs,gs=null,fs=class e extends Vn{constructor(e,t){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=ps.next(),this.cssClassManager=new lr((()=>this.eGui)),this.componentSelectors=new Map((t??[]).map((e=>[e.selector,e]))),e&&this.setTemplate(e)}preWireBeans(e){super.preWireBeans(e)}preConstruct(){this.usingBrowserTooltips=this.gos.get("enableBrowserTooltips"),this.wireTemplate(this.getGui())}wireTemplate(e,t){e&&this.gos&&(this.applyElementsToComponent(e),this.createChildComponentsFromTags(e,t))}getCompId(){return this.compId}getTooltipParams(){return{value:this.tooltipText,location:"UNKNOWN"}}setTooltip(e){const{newTooltipText:t,showDelayOverride:n,hideDelayOverride:i,location:r,shouldDisplayTooltip:s}=e||{};this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.tooltipText!==t&&(this.tooltipText=t);const o=()=>this.tooltipText;null!=t&&(this.tooltipFeature=this.createBean(new ds({getTooltipValue:o,getGui:()=>this.getGui(),getLocation:()=>r??"UNKNOWN",getColDef:e?.getColDef,getColumn:e?.getColumn,getTooltipShowDelayOverride:null!=n?()=>n:void 0,getTooltipHideDelayOverride:null!=i?()=>i:void 0,shouldDisplayTooltip:s})))}getDataRefAttribute(e){return e.getAttribute?e.getAttribute("data-ref"):null}applyElementsToComponent(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(void 0===t&&(t=this.getDataRefAttribute(e)),t){const r=this[t];if(r===gs)this[t]=i??e;else{const e=n&&n[t];this.suppressDataRefValidation||e||bt(`Issue with data-ref: ${t} on ${this.constructor.name} with ${r}`)}}}createChildComponentsFromTags(e,t){(function(e){if(null==e)return[];const t=[];return ls(e,(e=>t.push(e))),t})(e.childNodes).forEach((n=>{if(!(n instanceof HTMLElement))return;const i=this.createComponentFromElement(n,(e=>{e.getGui()&&this.copyAttributesFromNode(n,e.getGui())}),t);if(i){if(i.addItems&&n.children.length){this.createChildComponentsFromTags(n,t);const e=Array.prototype.slice.call(n.children);i.addItems(e)}this.swapComponentForNode(i,e,n)}else n.childNodes&&this.createChildComponentsFromTags(n,t)}))}createComponentFromElement(t,n,i){const r=t.nodeName,s=this.getDataRefAttribute(t),o=0===r.indexOf("AG-"),a=o?this.componentSelectors.get(r):null;let l=null;if(a){e.elementGettingCreated=t;const r=i&&s?i[s]:void 0;l=new a.component(r),l.setParentComponent(this),this.createBean(l,null,n)}else o&&bt(`Missing selector: ${r}`);return this.applyElementsToComponent(t,s,i,l),l}copyAttributesFromNode(e,t){!function(e,t){if(e)for(let n=0;n<e.length;n++){const i=e[n];t(i.name,i.value)}}(e.attributes,((e,n)=>t.setAttribute(e,n)))}swapComponentForNode(e,t,n){const i=e.getGui();t.replaceChild(i,n),t.insertBefore(document.createComment(n.nodeName),i),this.addDestroyFunc(this.destroyBean.bind(this,e))}activateTabIndex(e){const t=this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui()),e.forEach((e=>e.setAttribute("tabindex",t.toString())))}setTemplate(e,t,n){const i=ts(e);this.setTemplateFromElement(i,t,n)}setTemplateFromElement(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.eGui=e,this.suppressDataRefValidation=i,t)for(let r=0;r<t.length;r++){const e=t[r];this.componentSelectors.set(e.selector,e)}this.wireTemplate(e,n)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}getContainerAndElement(e,t){let n=t;return null==e?null:(n||(n=this.eGui),os(e)?{element:e,parent:n}:{element:e.getGui(),parent:n})}prependChild(e,t){const{element:n,parent:i}=this.getContainerAndElement(e,t)||{};n&&i&&i.insertAdjacentElement("afterbegin",n)}appendChild(e,t){const{element:n,parent:i}=this.getContainerAndElement(e,t)||{};n&&i&&i.appendChild(n)}isDisplayed(){return this.displayed}setVisible(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e!==this.visible){this.visible=e;const{skipAriaHidden:n}=t;!function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{skipAriaHidden:i}=n;e.classList.toggle("ag-invisible",!t),i||vr(e,!t)}(this.eGui,e,{skipAriaHidden:n})}}setDisplayed(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e!==this.displayed){this.displayed=e;const{skipAriaHidden:n}=t;zr(this.eGui,e,{skipAriaHidden:n});const i={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(i)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),super.destroy()}addGuiEventListener(e,t,n){this.eGui.addEventListener(e,t,n),this.addDestroyFunc((()=>this.eGui.removeEventListener(e,t)))}addCssClass(e){this.cssClassManager.addCssClass(e)}removeCssClass(e){this.cssClassManager.removeCssClass(e)}containsCssClass(e){return this.cssClassManager.containsCssClass(e)}addOrRemoveCssClass(e,t){this.cssClassManager.addOrRemoveCssClass(e,t)}},ms={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",menuAlt:"menu-alt",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none",advancedFilterBuilder:"group",advancedFilterBuilderDrag:"grip",advancedFilterBuilderInvalid:"not-allowed",advancedFilterBuilderMoveUp:"up",advancedFilterBuilderMoveDown:"down",advancedFilterBuilderAdd:"plus",advancedFilterBuilderRemove:"minus",chartsMenuEdit:"chart",chartsMenuAdvancedSettings:"settings",chartsMenuAdd:"plus",checkboxChecked:"checkbox-checked",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off"},vs=(()=>{const e=new Set(Object.values(ms));return e.add("eye"),e})();function ys(e,t,n,i){let r=null;const s=n&&n.getColDef().icons;if(s&&(r=s[e]),t&&!r){const n=t.get("icons");n&&(r=n[e])}if(!r){const t=document.createElement("span");let n=ms[e]??(vs.has(e)?e:void 0);return n||(i?n=e:(bt(`Did not find icon ${e}`),n="")),t.setAttribute("class",`ag-icon ag-icon-${n}`),t.setAttribute("unselectable","on"),pr(t,"presentation"),t}{let e;if("function"===typeof r)e=r();else{if("string"!==typeof r)throw new Error("icon from grid options needs to be a string or a function");e=r}if("string"===typeof e)return ts(e);if(os(e))return e;bt("iconRenderer should return back a string or a dom object")}}var Cs=class extends fs{constructor(){super(...arguments),this.dragSource=null,this.eIcon=gs,this.eLabel=gs}postConstruct(){const e=e=>function(e,t,n){const i=ys(e,t,n);if(i){const{className:e}=i;if("string"===typeof e&&e.indexOf("ag-icon")>-1||"object"===typeof e&&e["ag-icon"])return i}const r=document.createElement("span");return r.appendChild(i),r}(e,this.gos,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate('<div class="ag-dnd-ghost ag-unselectable">\n                <span data-ref="eIcon" class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>\n                <div data-ref="eLabel" class="ag-dnd-ghost-label"></div>\n            </div>')}destroy(){this.dragSource=null,super.destroy()}setIcon(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Yr(this.eIcon);let n=null;e||(e=this.dragSource?.getDefaultIconName?this.dragSource?.getDefaultIconName():"notAllowed"),n=this.dropIconMap[e],this.eIcon.classList.toggle("ag-shake-left-to-right",t),n===this.dropIconMap.hide&&this.gos.get("suppressDragLeaveHidesColumns")||n&&this.eIcon.appendChild(n)}setLabel(e){this.eLabel.textContent=Di(e)}};function ws(e,t,n){if(0===n)return!1;const i=Math.abs(e.clientX-t.clientX),r=Math.abs(e.clientY-t.clientY);return Math.max(i,r)<=n}var Ss=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.DOUBLE_TAP_MILLIS=500,this.destroyFuncs=[],this.touching=!1,this.localEventService=new vt,this.eElement=e,this.preventMouseClick=t;const n=this.onTouchStart.bind(this),i=this.onTouchMove.bind(this),r=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",n,{passive:!0}),this.eElement.addEventListener("touchmove",i,{passive:!0}),this.eElement.addEventListener("touchend",r,{passive:!1}),this.destroyFuncs.push((()=>{this.eElement.removeEventListener("touchstart",n,{passive:!0}),this.eElement.removeEventListener("touchmove",i,{passive:!0}),this.eElement.removeEventListener("touchend",r,{passive:!1})}))}getActiveTouch(e){for(let t=0;t<e.length;t++){if(e[t].identifier===this.touchStart.identifier)return e[t]}return null}addEventListener(e,t){this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService.removeEventListener(e,t)}onTouchStart(e){if(this.touching)return;this.touchStart=e.touches[0],this.touching=!0,this.moved=!1;const t=this.touchStart;window.setTimeout((()=>{const n=this.touchStart===t;if(this.touching&&n&&!this.moved){this.moved=!0;const t={type:"longTap",touchStart:this.touchStart,touchEvent:e};this.localEventService.dispatchEvent(t)}}),500)}onTouchMove(e){if(!this.touching)return;const t=this.getActiveTouch(e.touches);if(!t)return;!ws(t,this.touchStart,4)&&(this.moved=!0)}onTouchEnd(e){if(this.touching){if(!this.moved){const e={type:"tap",touchStart:this.touchStart};this.localEventService.dispatchEvent(e),this.checkForDoubleTap()}this.preventMouseClick&&e.cancelable&&e.preventDefault(),this.touching=!1}}checkForDoubleTap(){const e=(new Date).getTime();if(this.lastTapTime&&this.lastTapTime>0){if(e-this.lastTapTime>this.DOUBLE_TAP_MILLIS){const e={type:"doubleTap",touchStart:this.touchStart};this.localEventService.dispatchEvent(e),this.lastTapTime=null}else this.lastTapTime=e}else this.lastTapTime=e}destroy(){this.destroyFuncs.forEach((e=>e()))}};function bs(e,t){return`<span data-ref="eSort${e}" class="ag-sort-indicator-icon ag-sort-${t} ag-hidden" aria-hidden="true"></span>`}var xs=`<span class="ag-sort-indicator-container">\n        ${bs("Order","order")}\n        ${bs("Asc","ascending-icon")}\n        ${bs("Desc","descending-icon")}\n        ${bs("Mixed","mixed-icon")}\n        ${bs("None","none-icon")}\n    </span>`,_s=class extends fs{constructor(e){super(),this.eSortOrder=gs,this.eSortAsc=gs,this.eSortDesc=gs,this.eSortMixed=gs,this.eSortNone=gs,e||this.setTemplate(xs)}wireBeans(e){this.sortController=e.sortController}attachCustomElements(e,t,n,i,r){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=n,this.eSortMixed=i,this.eSortNone=r}setupSort(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!this.column.isSortable()&&!this.column.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e);const n=this.updateIcons.bind(this),i=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",n),this.addManagedEventListeners({newColumnsLoaded:n,sortChanged:i,columnRowGroupChanged:i}),this.onSortChanged()}addInIcon(e,t,n){if(null==t)return;const i=ys(e,this.gos,n);i&&t.appendChild(i)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const e=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc){const t="asc"===e;zr(this.eSortAsc,t,{skipAriaHidden:!0})}if(this.eSortDesc){const t="desc"===e;zr(this.eSortDesc,t,{skipAriaHidden:!0})}if(this.eSortNone){const t=!this.column.getColDef().unSortIcon&&!this.gos.get("unSortIcon"),n=null===e||void 0===e;zr(this.eSortNone,!t&&n,{skipAriaHidden:!0})}}setupMultiSortIndicator(){this.addInIcon("sortUnSort",this.eSortMixed,this.column);const e=this.column.getColDef().showRowGroup;ln(this.gos)&&e&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){if(this.eSortMixed){const e="mixed"===this.sortController.getDisplaySortForColumn(this.column);zr(this.eSortMixed,e,{skipAriaHidden:!0})}}updateSortOrder(){if(!this.eSortOrder)return;const e=this.sortController.getColumnsWithSortingOrdered(),t=this.sortController.getDisplaySortIndexForColumn(this.column)??-1,n=e.some((e=>this.sortController.getDisplaySortIndexForColumn(e)??!1)),i=t>=0&&n;zr(this.eSortOrder,i,{skipAriaHidden:!0}),t>=0?this.eSortOrder.textContent=(t+1).toString():Yr(this.eSortOrder)}},Ms={selector:"AG-SORT-INDICATOR",component:_s},Es=class extends fs{constructor(){super(...arguments),this.eFilter=gs,this.eFilterButton=gs,this.eSortIndicator=gs,this.eMenu=gs,this.eLabel=gs,this.eText=gs,this.eSortOrder=gs,this.eSortAsc=gs,this.eSortDesc=gs,this.eSortMixed=gs,this.eSortNone=gs,this.lastMovingChanged=0}wireBeans(e){this.sortController=e.sortController,this.menuService=e.menuService,this.funcColsService=e.funcColsService}destroy(){super.destroy()}refresh(e){const t=this.params;return this.params=e,this.workOutTemplate()==this.currentTemplate&&this.workOutShowMenu()==this.currentShowMenu&&this.workOutSort()==this.currentSort&&this.shouldSuppressMenuHide()==this.currentSuppressMenuHide&&t.enableFilterButton==e.enableFilterButton&&t.enableFilterIcon==e.enableFilterIcon&&(this.setDisplayName(e),!0)}workOutTemplate(){let e=this.params.template??'<div class="ag-cell-label-container" role="presentation">\n        <span data-ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>\n        <span data-ref="eFilterButton" class="ag-header-icon ag-header-cell-filter-button" aria-hidden="true"></span>\n        <div data-ref="eLabel" class="ag-header-cell-label" role="presentation">\n            <span data-ref="eText" class="ag-header-cell-text"></span>\n            <span data-ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>\n            <ag-sort-indicator data-ref="eSortIndicator"></ag-sort-indicator>\n        </div>\n    </div>';return e=e&&e.trim?e.trim():e,e}init(e){this.params=e,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate,[Ms]),this.setupTap(),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setupFilterButton(),this.setDisplayName(e)}setDisplayName(e){if(this.currentDisplayName!=e.displayName){this.currentDisplayName=e.displayName;const t=Di(this.currentDisplayName,!0);this.eText&&(this.eText.textContent=t)}}addInIcon(e,t,n){if(null==t)return;const i=ys(e,this.gos,n);i&&t.appendChild(i)}setupTap(){const{gos:e}=this;if(e.get("suppressTouch"))return;const t=new Ss(this.getGui(),!0),n=this.shouldSuppressMenuHide(),i=n&&Dt(this.eMenu),r=i?new Ss(this.eMenu,!0):t;if(this.params.enableMenu){const e=i?"tap":"longTap",t=e=>this.params.showColumnMenuAfterMouseClick(e.touchStart);this.addManagedListeners(r,{[e]:t})}if(this.params.enableSorting){const e=e=>{const t=e.touchStart.target;n&&(this.eMenu?.contains(t)||this.eFilterButton?.contains(t))||this.sortController.progressSort(this.params.column,!1,"uiColumnSorted")};this.addManagedListeners(t,{tap:e})}if(this.params.enableFilterButton){const e=new Ss(this.eFilterButton,!0);this.addManagedListeners(e,{tap:()=>this.params.showFilter(this.eFilterButton)}),this.addDestroyFunc((()=>e.destroy()))}this.addDestroyFunc((()=>t.destroy())),i&&this.addDestroyFunc((()=>r.destroy()))}workOutShowMenu(){return this.params.enableMenu&&this.menuService.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return this.menuService.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu)return Jr(this.eMenu),void(this.eMenu=void 0);const e=this.menuService.isLegacyMenuEnabled();this.addInIcon(e?"menu":"menuAlt",this.eMenu,this.params.column),this.eMenu.classList.toggle("ag-header-menu-icon",!e),this.currentSuppressMenuHide=this.shouldSuppressMenuHide(),this.addManagedElementListeners(this.eMenu,{click:()=>this.params.showColumnMenu(this.eMenu)}),this.eMenu.classList.toggle("ag-header-menu-always-show",this.currentSuppressMenuHide)}onMenuKeyboardShortcut(e){const t=this.params.column,n=this.menuService.isLegacyMenuEnabled();if(e&&!n){if(this.menuService.isFilterMenuInHeaderEnabled(t))return this.params.showFilter(this.eFilterButton??this.eMenu??this.getGui()),!0}else if(this.params.enableMenu)return this.params.showColumnMenu(this.eMenu??this.eFilterButton??this.getGui()),!0;return!1}workOutSort(){return this.params.enableSorting}setupSort(){if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.createBean(new _s(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),!this.currentSort)return;this.addManagedListeners(this.params.column,{movingChanged:()=>{this.lastMovingChanged=(new Date).getTime()}}),this.eLabel&&this.addManagedElementListeners(this.eLabel,{click:e=>{const t=this.params.column.isMoving(),n=(new Date).getTime()-this.lastMovingChanged<50;if(!(t||n)){const t="ctrl"===this.gos.get("multiSortKey")?e.ctrlKey||e.metaKey:e.shiftKey;this.params.progressSort(t)}}});const e=()=>{const e=this.params.column.getSort();if(this.addOrRemoveCssClass("ag-header-cell-sorted-asc","asc"===e),this.addOrRemoveCssClass("ag-header-cell-sorted-desc","desc"===e),this.addOrRemoveCssClass("ag-header-cell-sorted-none",!e),this.params.column.getColDef().showRowGroup){const e=this.funcColsService.getSourceColumnsForGroupColumn(this.params.column),t=e?.every((e=>this.params.column.getSort()==e.getSort())),n=!t;this.addOrRemoveCssClass("ag-header-cell-sorted-mixed",n)}};this.addManagedEventListeners({sortChanged:e,columnRowGroupChanged:e})}setupFilterIcon(){this.eFilter&&this.configureFilter(this.params.enableFilterIcon,this.eFilter,this.onFilterChangedIcon.bind(this))}setupFilterButton(){if(!this.eFilterButton)return;this.configureFilter(this.params.enableFilterButton,this.eFilterButton,this.onFilterChangedButton.bind(this))?this.addManagedElementListeners(this.eFilterButton,{click:()=>this.params.showFilter(this.eFilterButton)}):this.eFilterButton=void 0}configureFilter(e,t,n){if(!e)return Jr(t),!1;const i=this.params.column;return this.addInIcon("filter",t,i),this.addManagedListeners(i,{filterChanged:n}),n(),!0}onFilterChangedIcon(){const e=this.params.column.isFilterActive();zr(this.eFilter,e,{skipAriaHidden:!0})}onFilterChangedButton(){const e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){return e?this.eFilterButton??this.eMenu??this.getGui():this.eMenu??this.eFilterButton??this.getGui()}},Rs=class extends fs{constructor(){super('<div class="ag-header-group-cell-label" role="presentation">\n            <span data-ref="agLabel" class="ag-header-group-text" role="presentation"></span>\n            <span data-ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>\n            <span data-ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>\n        </div>'),this.agOpened=gs,this.agClosed=gs,this.agLabel=gs}wireBeans(e){this.columnModel=e.columnModel}destroy(){super.destroy()}init(e){this.params=e,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()}checkWarnings(){this.params.template&&bt("A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)")}setupExpandIcons(){this.addInIcon("columnGroupOpened",this.agOpened),this.addInIcon("columnGroupClosed",this.agClosed);const e=e=>{if(zn(e))return;const t=!this.params.columnGroup.isExpanded();this.columnModel.setColumnGroupOpened(this.params.columnGroup.getProvidedColumnGroup(),t,"uiColumnExpanded")};this.addTouchAndClickListeners(this.agClosed,e),this.addTouchAndClickListeners(this.agOpened,e);const t=e=>{Bn(e)};this.addManagedElementListeners(this.agClosed,{dblclick:t}),this.addManagedElementListeners(this.agOpened,{dblclick:t}),this.addManagedElementListeners(this.getGui(),{dblclick:e}),this.updateIconVisibility();const n=this.params.columnGroup.getProvidedColumnGroup(),i=this.updateIconVisibility.bind(this);this.addManagedListeners(n,{expandedChanged:i,expandableChanged:i})}addTouchAndClickListeners(e,t){const n=new Ss(e,!0);this.addManagedListeners(n,{tap:t}),this.addDestroyFunc((()=>n.destroy())),this.addManagedElementListeners(e,{click:t})}updateIconVisibility(){if(this.params.columnGroup.isExpandable()){const e=this.params.columnGroup.isExpanded();zr(this.agOpened,e),zr(this.agClosed,!e)}else zr(this.agOpened,!1),zr(this.agClosed,!1)}addInIcon(e,t){const n=ys(e,this.gos,null);n&&t.appendChild(n)}addGroupExpandIcon(){if(!this.params.columnGroup.isExpandable())return zr(this.agOpened,!1),void zr(this.agClosed,!1)}setupLabel(){const{displayName:e,columnGroup:t}=this.params;if(Dt(e)){const t=Di(e,!0);this.agLabel.textContent=t}this.addOrRemoveCssClass("ag-sticky-label",!t.getColGroupDef()?.suppressStickyLabel)}},Ts=class extends fs{constructor(){super(),this.refreshCount=0;const e=document.createElement("span"),t=document.createElement("span");t.setAttribute("class","ag-value-change-delta");const n=document.createElement("span");n.setAttribute("class","ag-value-change-value"),e.appendChild(t),e.appendChild(n),this.setTemplateFromElement(e)}wireBeans(e){this.filterManager=e.filterManager}init(e){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(e,!0)}showDelta(e,t){const n=Math.abs(t),i=e.formatValue(n),r=Dt(i)?i:n,s=t>=0;this.eDelta.textContent=s?"\u2191"+r:"\u2193"+r,this.eDelta.classList.toggle("ag-value-change-delta-up",s),this.eDelta.classList.toggle("ag-value-change-delta-down",!s)}setTimerToRemoveDelta(){this.refreshCount++;const e=this.refreshCount;this.getFrameworkOverrides().wrapIncoming((()=>{window.setTimeout((()=>{e===this.refreshCount&&this.hideDeltaValue()}),2e3)}))}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),Yr(this.eDelta)}refresh(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.value;if(n===this.lastValue)return!1;if(Dt(e.valueFormatted)?this.eValue.textContent=e.valueFormatted:Dt(e.value)?this.eValue.textContent=n:Yr(this.eValue),this.filterManager?.isSuppressFlashingCellsBecauseFiltering())return!1;if("number"===typeof n&&"number"===typeof this.lastValue){const t=n-this.lastValue;this.showDelta(e,t)}return this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=n,!0}},Ps=class extends fs{constructor(){super(),this.refreshCount=0;const e=document.createElement("span"),t=document.createElement("span");t.setAttribute("class","ag-value-slide-current"),e.appendChild(t),this.setTemplateFromElement(e),this.eCurrent=this.queryForHtmlElement(".ag-value-slide-current")}wireBeans(e){this.filterManager=e.filterManager}init(e){this.refresh(e,!0)}addSlideAnimation(){this.refreshCount++;const e=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious);const t=document.createElement("span");t.setAttribute("class","ag-value-slide-previous ag-value-slide-out"),this.ePrevious=t,this.ePrevious.textContent=this.eCurrent.textContent,this.getGui().insertBefore(this.ePrevious,this.eCurrent),this.getFrameworkOverrides().wrapIncoming((()=>{window.setTimeout((()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")}),50),window.setTimeout((()=>{e===this.refreshCount&&(this.getGui().removeChild(this.ePrevious),this.ePrevious=null)}),3e3)}))}refresh(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.value;return Lt(n)&&(n=""),n!==this.lastValue&&(!this.filterManager?.isSuppressFlashingCellsBecauseFiltering()&&(t||this.addSlideAnimation(),this.lastValue=n,Dt(e.valueFormatted)?this.eCurrent.textContent=e.valueFormatted:Dt(e.value)?this.eCurrent.textContent=n:Yr(this.eCurrent),!0))}},As=class{};As.BACKSPACE="Backspace",As.TAB="Tab",As.ENTER="Enter",As.ESCAPE="Escape",As.SPACE=" ",As.LEFT="ArrowLeft",As.UP="ArrowUp",As.RIGHT="ArrowRight",As.DOWN="ArrowDown",As.DELETE="Delete",As.F2="F2",As.PAGE_UP="PageUp",As.PAGE_DOWN="PageDown",As.PAGE_HOME="Home",As.PAGE_END="End",As.A="KeyA",As.C="KeyC",As.D="KeyD",As.V="KeyV",As.X="KeyX",As.Y="KeyY",As.Z="KeyZ";var Fs=class extends fs{constructor(e,t,n){super(t,n),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{}}postConstruct(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:n,labelAlignment:i,disabled:r}=this.config;null!=r&&this.setDisabled(r),null!=e&&this.setLabelSeparator(e),null!=t&&this.setLabel(t),null!=n&&this.setLabelWidth(n),this.setLabelAlignment(i||this.labelAlignment),this.refreshLabel()}refreshLabel(){Yr(this.eLabel),"string"===typeof this.label?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),""===this.label?(zr(this.eLabel,!1),pr(this.eLabel,"presentation")):(zr(this.eLabel,!0),pr(this.eLabel,null))}setLabelSeparator(e){return this.labelSeparator===e||(this.labelSeparator=e,null!=this.label&&this.refreshLabel()),this}getLabelId(){return this.eLabel.id=this.eLabel.id||`ag-${this.getCompId()}-label`,this.eLabel.id}getLabel(){return this.label}setLabel(e){return this.label===e||(this.label=e,this.refreshLabel()),this}setLabelAlignment(e){const t=this.getGui().classList;return t.toggle("ag-label-align-left","left"===e),t.toggle("ag-label-align-right","right"===e),t.toggle("ag-label-align-top","top"===e),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return null==this.label||ns(this.eLabel,e),this}setDisabled(e){e=!!e;const t=this.getGui();return Hr(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},Ds=class extends Fs{constructor(e,t,n,i){super(e,t,n),this.className=i}postConstruct(){super.postConstruct();const{width:e,value:t,onValueChange:n}=this.config;null!=e&&this.setWidth(e),null!=t&&this.setValue(t),null!=n&&this.onValueChange(n),this.className&&this.addCssClass(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){const e=this.getAriaElement(),t=this.getLabelId(),n=this.getLabel();null==n||""==n||null!==e.getAttribute("aria-label")?fr(e,""):fr(e,t??"")}setAriaLabel(e){return gr(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return is(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e||(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"})),this}},Ls=class extends Ds{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"input";super(e,e?.template??`\n            <div role="presentation">\n                <div data-ref="eLabel" class="ag-input-field-label"></div>\n                <div data-ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">\n                    <${i} data-ref="eInput" class="ag-input-field-input"></${i}>\n                </div>\n            </div>`,[],t),this.inputType=n,this.displayFieldTag=i,this.eLabel=gs,this.eWrapper=gs,this.eInput=gs}postConstruct(){super.postConstruct(),this.setInputType(),this.eLabel.classList.add(`${this.className}-label`),this.eWrapper.classList.add(`${this.className}-input-wrapper`),this.eInput.classList.add(`${this.className}-input`),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||`ag-${this.getCompId()}-input`;const{inputName:e,inputWidth:t}=this.config;null!=e&&this.setInputName(e),null!=t&&this.setInputWidth(t),this.addInputListeners(),this.activateTabIndex([this.eInput])}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(){"input"===this.displayFieldTag&&this.eInput.setAttribute("type",this.inputType)}getInputElement(){return this.eInput}setInputWidth(e){return ns(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){return this.eInput.maxLength=e,this}setInputPlaceholder(e){return as(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return gr(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return Hr(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(!0===e)as(this.eInput,"autocomplete",null);else{const t="string"===typeof e?e:"off";as(this.eInput,"autocomplete",t)}return this}},Is=class extends Ls{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ag-checkbox",arguments.length>2&&void 0!==arguments[2]?arguments[2]:"checkbox"),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly:e,passive:t}=this.config;"boolean"===typeof e&&this.setReadOnly(e),"boolean"===typeof t&&this.setPassive(t)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return void 0===this.selected||!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){return this.getInputElement().name=e,this}isSelected(){return this.selected}setSelected(e,t){this.isSelected()!==e&&(this.previousValue=this.isSelected(),e=this.selected="boolean"===typeof e?e:void 0,this.eInput.checked=e,this.eInput.indeterminate=void 0===e,t||this.dispatchChange(this.selected,this.previousValue))}dispatchChange(e,t,n){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:n});const i=this.getInputElement();this.eventService.dispatchEvent({type:"checkboxChanged",id:i.id,name:i.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),n=this.selected=e.target.checked;this.refreshSelectedClass(n),this.dispatchChange(n,t,e)}refreshSelectedClass(e){this.eWrapper.classList.toggle("ag-checked",!0===e),this.eWrapper.classList.toggle("ag-indeterminate",null==e)}},ks={selector:"AG-CHECKBOX",component:Is},Os=class extends fs{constructor(){super('\n            <div class="ag-cell-wrapper ag-checkbox-cell" role="presentation">\n                <ag-checkbox role="presentation" data-ref="eCheckbox"></ag-checkbox>\n            </div>',[ks]),this.eCheckbox=gs}init(e){this.refresh(e);const t=this.eCheckbox.getInputElement();t.setAttribute("tabindex","-1"),mr(t,"polite"),this.addManagedListeners(t,{click:e=>{if(Bn(e),this.eCheckbox.isDisabled())return;const t=this.eCheckbox.getValue();this.onCheckboxChanged(t)},dblclick:e=>{Bn(e)}}),this.addManagedElementListeners(this.params.eGridCell,{keydown:e=>{if(e.key===As.SPACE&&!this.eCheckbox.isDisabled()){this.params.eGridCell===rn(this.gos)&&this.eCheckbox.toggle();const t=this.eCheckbox.getValue();this.onCheckboxChanged(t),e.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){let t,n=!0;if(e.node.group&&e.column)if("boolean"===typeof e.value)t=e.value;else{const i=e.column.getColId();i.startsWith(Kn)?t=null==e.value||""===e.value?void 0:"true"===e.value:e.node.aggData&&void 0!==e.node.aggData[i]?t=e.value??void 0:n=!1}else t=e.value??void 0;if(!n)return void this.eCheckbox.setDisplayed(!1);this.eCheckbox.setValue(t);const i=null!=e.disabled?e.disabled:!e.column?.isCellEditable(e.node);this.eCheckbox.setDisabled(i);const r=this.localeService.getLocaleTextFunc(),s=Er(r,t),o=i?s:`${r("ariaToggleCellValue","Press SPACE to toggle cell value")} (${s})`;this.eCheckbox.setInputAriaLabel(o)}onCheckboxChanged(e){const{column:t,node:n,value:i}=this.params;this.eventService.dispatchEvent({type:"cellEditingStarted",column:t,colDef:t?.getColDef(),data:n.data,node:n,rowIndex:n.rowIndex,rowPinned:n.rowPinned,value:i});const r=this.params.node.setDataValue(this.params.column,e,"edit");this.eventService.dispatchEvent({type:"cellEditingStopped",column:t,colDef:t?.getColDef(),data:n.data,node:n,rowIndex:n.rowIndex,rowPinned:n.rowPinned,value:i,oldValue:i,newValue:e,valueChanged:r}),r||this.updateCheckbox(this.params)}},Ns=class extends fs{constructor(){super('<div class="ag-loading">\n            <span class="ag-loading-icon" data-ref="eLoadingIcon"></span>\n            <span class="ag-loading-text" data-ref="eLoadingText"></span>\n        </div>'),this.eLoadingIcon=gs,this.eLoadingText=gs}init(e){e.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){const e=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=e("loadingError","ERR")}setupLoading(){const e=ys("groupLoading",this.gos,null);e&&this.eLoadingIcon.appendChild(e);const t=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=t("loadingOoo","Loading")}refresh(e){return!1}destroy(){super.destroy()}},Bs=class extends fs{constructor(){super('<div class="ag-skeleton-container"></div>')}init(e){const t=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",t),this.addDestroyFunc((()=>fr(e.eParentOfValue))),fr(e.eParentOfValue,t),e.node.failedLoad?this.setupFailed():this.setupLoading(e)}setupFailed(){const e=this.localeService.getLocaleTextFunc();this.getGui().innerText=e("loadingError","ERR");const t=e("ariaSkeletonCellLoadingFailed","Row failed to load");gr(this.getGui(),t)}setupLoading(e){const t=en(this.gos).createElement("div");t.classList.add("ag-skeleton-effect");const n=e.node.rowIndex;if(null!=n){const e=75+25*(n%2===0?Math.sin(n):Math.cos(n));t.style.width=`${e}%`}this.getGui().appendChild(t);const i=this.localeService.getLocaleTextFunc()("ariaSkeletonCellLoading","Row data is loading");gr(this.getGui(),i)}refresh(e){return!1}destroy(){super.destroy()}},zs=class extends fs{constructor(){super()}destroy(){super.destroy()}},Hs=class extends zs{init(){const e=Ft(this.gos.get("overlayLoadingTemplate")?.trim());if(this.setTemplate(e??'<span aria-live="polite" aria-atomic="true" class="ag-overlay-loading-center"></span>'),!e){const e=this.localeService.getLocaleTextFunc();setTimeout((()=>{this.getGui().textContent=e("loadingOoo","Loading...")}))}}},Gs=class extends zs{init(){const e=Ft(this.gos.get("overlayNoRowsTemplate")?.trim());if(this.setTemplate(e??'<span class="ag-overlay-no-rows-center"></span>'),!e){const e=this.localeService.getLocaleTextFunc();setTimeout((()=>{this.getGui().textContent=e("noRowsToShow","No Rows To Show")}))}}},Us=class extends fs{isPopup(){return!0}setParentComponent(e){e.addCssClass("ag-has-popup"),super.setParentComponent(e)}destroy(){const e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},Vs=class extends Us{constructor(){super('<div class="ag-tooltip"></div>')}init(e){const{value:t}=e;this.getGui().textContent=Di(t,!0)}};function Ws(e){const{inputValue:t,allSuggestions:n,hideIrrelevant:i,filterByPercentageOfBestMatch:r,addSequentialWeight:s}=e;let o=n.map(((e,n)=>({value:e,relevance:js(t.toLowerCase(),e.toLocaleLowerCase(),s),idx:n})));if(o.sort(((e,t)=>t.relevance-e.relevance)),i&&(o=o.filter((e=>0!==e.relevance))),o.length>0&&r&&r>0){const e=o[0].relevance*r;o=o.filter((t=>e-t.relevance<0))}const a=[],l=[];for(const c of o)a.push(c.value),l.push(c.idx);return{values:a,indices:l}}function js(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=e.replace(/\s/g,""),r=t.replace(/\s/g,""),s=i.length,o=r.length,a=new Array(s+1).fill(null).map((()=>new Array(o+1).fill(0)));for(let u=0;u<=s;u+=1)a[u][0]=u;for(let u=0;u<=o;u+=1)a[0][u]=u;for(let u=1;u<=s;u++)for(let e=1;e<=o;e++)i[u-1]===r[e-1]?a[u][e]=a[u-1][e-1]:a[u][e]=1+Math.min(a[u][e-1],Math.min(a[u-1][e],a[u-1][e-1]));const l=a[s][o];let c=Math.max(s,o)-l;if(n){const e=function(e){const t=[],n=e.length;for(let i=1;i<=n;i++)for(let r=0;r<=n-i;r++){const n=r+i-1;t.push(e.slice(r,n+1))}return t}(i);for(let t=0;t<e.length;t++){const n=e[t];-1!==r.indexOf(n)&&(c+=1,c*=n.length)}}return c}var qs=class extends Vn{constructor(){super(...arguments),this.beanName="userComponentRegistry",this.agGridDefaults={agDragAndDropImage:Cs,agColumnHeader:Es,agColumnGroupHeader:Rs,agSortIndicator:_s,agAnimateShowChangeCellRenderer:Ts,agAnimateSlideCellRenderer:Ps,agLoadingCellRenderer:Ns,agSkeletonCellRenderer:Bs,agCheckboxCellRenderer:Os,agLoadingOverlay:Hs,agNoRowsOverlay:Gs,agTooltipComponent:Vs},this.agGridDefaultParams={},this.enterpriseAgDefaultCompsModule={agSetColumnFilter:"@ag-grid-enterprise/set-filter",agSetColumnFloatingFilter:"@ag-grid-enterprise/set-filter",agMultiColumnFilter:"@ag-grid-enterprise/multi-filter",agMultiColumnFloatingFilter:"@ag-grid-enterprise/multi-filter",agGroupColumnFilter:"@ag-grid-enterprise/row-grouping",agGroupColumnFloatingFilter:"@ag-grid-enterprise/row-grouping",agGroupCellRenderer:"@ag-grid-enterprise/row-grouping",agGroupRowRenderer:"@ag-grid-enterprise/row-grouping",agRichSelect:"@ag-grid-enterprise/rich-select",agRichSelectCellEditor:"@ag-grid-enterprise/rich-select",agDetailCellRenderer:"@ag-grid-enterprise/master-detail",agSparklineCellRenderer:"@ag-grid-enterprise/sparklines"},this.jsComps={}}postConstruct(){const e=this.gos.get("components");null!=e&&ii(e,((e,t)=>this.registerJsComponent(e,t)))}registerDefaultComponent(e,t,n){this.agGridDefaults[e]=t,n&&(this.agGridDefaultParams[e]=n)}registerJsComponent(e,t){this.jsComps[e]=t}retrieve(e,t){const n=(e,t,n)=>({componentFromFramework:t,component:e,params:n}),i=this.getFrameworkOverrides().frameworkComponent(t,this.gos.get("components"));if(null!=i)return n(i,!0);const r=this.jsComps[t];if(r){return n(r,this.getFrameworkOverrides().isFrameworkComponent(r))}const s=this.agGridDefaults[t];if(s)return n(s,!1,this.agGridDefaultParams[t]);const o=this.enterpriseAgDefaultCompsModule[t];return o?this.gos.assertModuleRegistered(o,`AG Grid '${e}' component: ${t}`):wt((()=>{this.warnAboutMissingComponent(e,t)}),"MissingComp"+t),null}warnAboutMissingComponent(e,t){const n=[...Object.keys(this.agGridDefaults).filter((e=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(e))),...Object.keys(this.jsComps)],i=Ws({inputValue:t,allSuggestions:n,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;bt(`Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.`),i.length>0&&bt(`         Did you mean: [${i.slice(0,3)}]?`),bt(`If using a custom component check it has been registered as described in: ${this.getFrameworkOverrides().getDocLink("components/")}`)}},Xs=class e{constructor(e){this.status=0,this.resolution=null,this.waiters=[],e((e=>this.onDone(e)),(e=>this.onReject(e)))}static all(t){return t.length?new e((e=>{let n=t.length;const i=new Array(n);t.forEach(((t,r)=>{t.then((t=>{i[r]=t,n--,0===n&&e(i)}))}))})):e.resolve()}static resolve(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new e((e=>e(t)))}then(t){return new e((e=>{1===this.status?e(t(this.resolution)):this.waiters.push((n=>e(t(n))))}))}onDone(e){this.status=1,this.resolution=e,this.waiters.forEach((t=>t(e)))}onReject(e){}},Ks={propertyName:"dateComponent",cellRenderer:!1},$s={propertyName:"dragAndDropImageComponent",cellRenderer:!1},Zs={propertyName:"headerComponent",cellRenderer:!1},Ys={propertyName:"headerGroupComponent",cellRenderer:!1},Js={propertyName:"cellRenderer",cellRenderer:!0},Qs={propertyName:"cellRenderer",cellRenderer:!1},eo={propertyName:"loadingCellRenderer",cellRenderer:!0},to={propertyName:"cellEditor",cellRenderer:!1},no={propertyName:"innerRenderer",cellRenderer:!0},io={propertyName:"loadingOverlayComponent",cellRenderer:!1},ro={propertyName:"noRowsOverlayComponent",cellRenderer:!1},so={propertyName:"tooltipComponent",cellRenderer:!1},oo={propertyName:"filter",cellRenderer:!1},ao={propertyName:"floatingFilterComponent",cellRenderer:!1},lo={propertyName:"toolPanel",cellRenderer:!1},co={propertyName:"statusPanel",cellRenderer:!1},uo={propertyName:"fullWidthCellRenderer",cellRenderer:!0},ho={propertyName:"loadingCellRenderer",cellRenderer:!0},po={propertyName:"groupRowRenderer",cellRenderer:!0},go={propertyName:"detailCellRenderer",cellRenderer:!0},fo={propertyName:"menuItem",cellRenderer:!1},mo=class e extends Vn{constructor(){super(...arguments),this.beanName="userComponentFactory"}wireBeans(e){this.agComponentUtils=e.agComponentUtils,this.componentMetadataProvider=e.componentMetadataProvider,this.userComponentRegistry=e.userComponentRegistry,this.frameworkComponentWrapper=e.frameworkComponentWrapper,this.gridOptions=e.gridOptions}getDragAndDropImageCompDetails(e){return this.getCompDetails(this.gridOptions,$s,"agDragAndDropImage",e,!0)}getHeaderCompDetails(e,t){return this.getCompDetails(e,Zs,"agColumnHeader",t)}getHeaderGroupCompDetails(e){const t=e.columnGroup.getColGroupDef();return this.getCompDetails(t,Ys,"agColumnGroupHeader",e)}getFullWidthCellRendererDetails(e){return this.getCompDetails(this.gridOptions,uo,null,e,!0)}getFullWidthLoadingCellRendererDetails(e){return this.getCompDetails(this.gridOptions,ho,"agLoadingCellRenderer",e,!0)}getFullWidthGroupCellRendererDetails(e){return this.getCompDetails(this.gridOptions,po,"agGroupRowRenderer",e,!0)}getFullWidthDetailCellRendererDetails(e){return this.getCompDetails(this.gridOptions,go,"agDetailCellRenderer",e,!0)}getInnerRendererDetails(e,t){return this.getCompDetails(e,no,null,t)}getFullWidthGroupRowInnerCellRenderer(e,t){return this.getCompDetails(e,no,null,t)}getCellRendererDetails(e,t){return this.getCompDetails(e,Js,null,t)}getEditorRendererDetails(e,t){return this.getCompDetails(e,Qs,null,t)}getLoadingCellRendererDetails(e,t){return this.getCompDetails(e,eo,"agSkeletonCellRenderer",t,!0)}getCellEditorDetails(e,t){return this.getCompDetails(e,to,"agCellEditor",t,!0)}getFilterDetails(e,t,n){return this.getCompDetails(e,oo,n,t,!0)}getDateCompDetails(e){return this.getCompDetails(this.gridOptions,Ks,"agDateInput",e,!0)}getLoadingOverlayCompDetails(e){return this.getCompDetails(this.gridOptions,io,"agLoadingOverlay",e,!0)}getNoRowsOverlayCompDetails(e){return this.getCompDetails(this.gridOptions,ro,"agNoRowsOverlay",e,!0)}getTooltipCompDetails(e){return this.getCompDetails(e.colDef,so,"agTooltipComponent",e,!0)}getSetFilterCellRendererDetails(e,t){return this.getCompDetails(e,Js,null,t)}getFloatingFilterCompDetails(e,t,n){return this.getCompDetails(e,ao,n,t)}getToolPanelCompDetails(e,t){return this.getCompDetails(e,lo,null,t,!0)}getStatusPanelCompDetails(e,t){return this.getCompDetails(e,co,null,t,!0)}getMenuItemCompDetails(e,t){return this.getCompDetails(e,fo,"agMenuItem",t,!0)}getCompDetails(t,n,i,r){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{propertyName:o,cellRenderer:a}=n;let l,{compName:c,jsComp:u,fwComp:h,paramsFromSelector:d,popupFromSelector:p,popupPositionFromSelector:g}=e.getCompKeys(this.frameworkOverrides,t,n,r);const f=e=>{const t=this.userComponentRegistry.retrieve(o,e);t&&(u=t.componentFromFramework?void 0:t.component,h=t.componentFromFramework?t.component:void 0,l=t.params)};if(null!=c&&f(c),null==u&&null==h&&null!=i&&f(i),u&&a&&!this.agComponentUtils.doesImplementIComponent(u)&&(u=this.agComponentUtils.adaptFunction(o,u)),!u&&!h)return void(s&&xt(`Could not find component ${c}, did you forget to configure this component?`));const m=this.mergeParamsWithApplicationProvidedParams(t,n,r,d,l),v=null==u,y=u||h;return{componentFromFramework:v,componentClass:y,params:m,type:n,popupFromSelector:p,popupPositionFromSelector:g,newAgStackInstance:()=>this.newAgStackInstance(y,v,m,n)}}static getCompKeys(e,t,n,i){const{propertyName:r}=n;let s,o,a,l,c,u;if(t){const n=t,h=n[r+"Selector"],d=h?h(i):null,p=t=>{if("string"===typeof t)s=t;else if(null!=t&&!0!==t){e.isFrameworkComponent(t)?a=t:o=t}};d?(p(d.component),l=d.params,c=d.popup,u=d.popupPosition):p(n[r])}return{compName:s,jsComp:o,fwComp:a,paramsFromSelector:l,popupFromSelector:c,popupPositionFromSelector:u}}newAgStackInstance(e,t,n,i){const r=i.propertyName;let s;if(!t)s=new e;else{const t=this.componentMetadataProvider.retrieve(r);s=this.frameworkComponentWrapper.wrap(e,t.mandatoryMethodList,t.optionalMethodList,i)}const o=this.initComponent(s,n);return null==o?Xs.resolve(s):o.then((()=>s))}mergeParamsWithApplicationProvidedParams(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4?arguments[4]:void 0;const s=this.gos.getGridCommonParams();ai(s,n),r&&ai(s,r);const o=e&&e[t.propertyName+"Params"];if("function"===typeof o){ai(s,o(n))}else"object"===typeof o&&ai(s,o);return ai(s,i),s}initComponent(e,t){if(this.createBean(e),null!=e.init)return e.init(t)}};function vo(e){const t=e;return null!=t&&null!=t.getFrameworkComponentInstance?t.getFrameworkComponentInstance():e}var yo=class e{static register(t){e.__register(t,!0,void 0)}static registerModules(t){e.__registerModules(t,!0,void 0)}static __register(t,n,i){e.runVersionChecks(t),void 0!==i?(e.areGridScopedModules=!0,void 0===e.gridModulesMap[i]&&(e.gridModulesMap[i]={}),e.gridModulesMap[i][t.moduleName]=t):e.globalModulesMap[t.moduleName]=t,e.setModuleBased(n)}static __unRegisterGridModules(t){delete e.gridModulesMap[t]}static __registerModules(t,n,i){e.setModuleBased(n),t&&t.forEach((t=>e.__register(t,n,i)))}static isValidModuleVersion(t){const[n,i]=t.version.split(".")||[],[r,s]=e.currentModuleVersion.split(".")||[];return n===r&&i===s}static runVersionChecks(t){e.currentModuleVersion||(e.currentModuleVersion=t.version);const n=e=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${e} Please update all modules to the same version.`;if(t.version?e.isValidModuleVersion(t)||xt(n(`'${t.moduleName}' is version ${t.version} but the other modules are version ${e.currentModuleVersion}.`)):xt(n(`'${t.moduleName}' is incompatible.`)),t.validate){const e=t.validate();if(!e.isValid){xt(`${e.message}`)}}}static setModuleBased(t){void 0===e.moduleBased?e.moduleBased=t:e.moduleBased!==t&&(xt("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),xt("Please see https://www.ag-grid.com/javascript-grid/modules/ for more information."))}static __setIsBundled(){e.isBundled=!0}static __assertRegistered(t,n,i){if(this.__isRegistered(t,i))return!0;let r;if(e.isBundled)r=`AG Grid: unable to use ${n} as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:\n        \n        <script src="https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js"><\/script>\n        \nFor more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise`;else if(e.moduleBased||void 0===e.moduleBased){const s=Object.entries(yt).find((e=>{let[n,i]=e;return i===t}))?.[0];r=`AG Grid: unable to use ${n} as the ${s} is not registered${e.areGridScopedModules?` for gridId: ${i}`:""}. Check if you have registered the module:\n           \n    import { ModuleRegistry } from '@ag-grid-community/core';\n    import { ${s} } from '${t}';\n    \n    ModuleRegistry.registerModules([ ${s} ]);\n\nFor more info see: https://www.ag-grid.com/javascript-grid/modules/`}else r=`AG Grid: unable to use ${n} as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:\n            \n    import 'ag-grid-enterprise';`;return xt(r),!1}static __isRegistered(t,n){return!!e.globalModulesMap[t]||!!e.gridModulesMap[n]?.[t]}static __getRegisteredModules(t){return[...Gt(e.globalModulesMap),...Gt(e.gridModulesMap[t]||{})]}static __getGridRegisteredModules(t){return Gt(e.gridModulesMap[t]??{})||[]}static __isPackageBased(){return!e.moduleBased}};yo.globalModulesMap={},yo.gridModulesMap={},yo.areGridScopedModules=!1;var Co=yo,wo=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,e&&e.beanClasses&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){Object.entries(e.providedBeanInstances).forEach((e=>{let[t,n]=e;this.beans[t]=n})),e.beanClasses.forEach((e=>{const t=new e;t.beanName?this.beans[t.beanName]=t:console.error(`Bean ${e.name} is missing beanName`),this.createdBeans.push(t)})),e.derivedBeans?.forEach((e=>{const{beanName:t,bean:n}=e(this);this.beans[t]=n,this.createdBeans.push(n)})),e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){if(!e)throw Error("Can't wire to bean since it is null");return this.initBeans([e],t),e}initBeans(e,t){e.forEach((e=>{e.preWireBeans?.(this.beans),e.wireBeans?.(this.beans)})),e.forEach((e=>e.preConstruct?.())),t&&e.forEach(t),e.forEach((e=>e.postConstruct?.()))}getBeans(){return this.beans}getBean(e){return this.beans[e]}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[]}destroyBean(e){e?.destroy?.()}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},So=class extends wo{init(e){this.gridId=e.gridId,this.beans.context=this,super.init(e)}destroy(){super.destroy(),Co.__unRegisterGridModules(this.gridId)}getGridId(){return this.gridId}},bo=(e=>(e[e.Left=0]="Left",e[e.Right=1]="Right",e))(bo||{}),xo=class extends Vn{constructor(){super(...arguments),this.beanName="dragAndDropService",this.dragSourceAndParamsList=[],this.dropTargets=[]}wireBeans(e){this.ctrlsService=e.ctrlsService,this.dragService=e.dragService,this.mouseEventService=e.mouseEventService,this.environment=e.environment,this.userComponentFactory=e.userComponentFactory}addDragSource(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push({params:n,dragSource:e}),this.dragService.addDragSource(n)}getDragAndDropImageComponent(){const{dragAndDropImageComp:e}=this;return e&&e.comp?e.comp:null}removeDragSource(e){const t=this.dragSourceAndParamsList.find((t=>t.dragSource===e));t&&(this.dragService.removeDragSource(t.params),An(this.dragSourceAndParamsList,t))}destroy(){this.dragSourceAndParamsList.forEach((e=>this.dragService.removeDragSource(e.params))),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){this.dragging&&this.onDragging(this.eventLastTime,!0)}onDragStart(e,t){this.dragging=!0,this.dragSource=e,this.eventLastTime=t,this.dragItem=this.dragSource.getDragItem(),this.dragSource.onDragStarted?.(),this.createDragAndDropImageComponent()}onDragStop(e){if(this.dragSource?.onDragStopped?.(),this.lastDropTarget?.onDragStop){const t=this.createDropTargetEvent(this.lastDropTarget,e,null,null,!1);this.lastDropTarget.onDragStop(t)}this.clearDragAndDropProperties()}onDragCancel(){this.dragSource?.onDragCancelled?.(),this.lastDropTarget?.onDragCancel&&this.lastDropTarget.onDragCancel(this.createDropTargetEvent(this.lastDropTarget,this.eventLastTime,null,null,!1)),this.clearDragAndDropProperties()}clearDragAndDropProperties(){this.eventLastTime=null,this.dragging=!1,this.lastDropTarget=void 0,this.dragItem=null,this.dragSource=null,this.removeDragAndDropImageComponent()}onDragging(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.getHorizontalDirection(e),i=this.getVerticalDirection(e);this.eventLastTime=e,this.positionDragAndDropImageComp(e);const r=this.dropTargets.filter((t=>this.isMouseOnDropTarget(e,t))),s=this.findCurrentDropTarget(e,r);if(s!==this.lastDropTarget){if(this.leaveLastTargetIfExists(e,n,i,t),null!==this.lastDropTarget&&null===s&&this.dragSource?.onGridExit?.(this.dragItem),null===this.lastDropTarget&&null!==s&&this.dragSource?.onGridEnter?.(this.dragItem),this.enterDragTargetIfExists(s,e,n,i,t),s&&this.dragAndDropImageComp){const{comp:e,promise:t}=this.dragAndDropImageComp;e?e.setIcon(s.getIconName?s.getIconName():null):t.then((e=>{e&&e.setIcon(s.getIconName?s.getIconName():null)}))}this.lastDropTarget=s}else if(s&&s.onDragging){const r=this.createDropTargetEvent(s,e,n,i,t);s.onDragging(r)}}getAllContainersFromDropTarget(e){const t=e.getSecondaryContainers?e.getSecondaryContainers():null,n=[[e.getContainer()]];return t?n.concat(t):n}allContainersIntersect(e,t){for(const n of t){const{width:t,height:i,left:r,right:s,top:o,bottom:a}=n.getBoundingClientRect();if(0===t||0===i)return!1;const l=e.clientX>=r&&e.clientX<s,c=e.clientY>=o&&e.clientY<a;if(!l||!c)return!1}return!0}isMouseOnDropTarget(e,t){const n=this.getAllContainersFromDropTarget(t);let i=!1;for(const o of n)if(this.allContainersIntersect(e,o)){i=!0;break}const{eElement:r,type:s}=this.dragSource;return!(t.targetContainsSource&&!t.getContainer().contains(r))&&(i&&t.isInterestedIn(s,r))}findCurrentDropTarget(e,t){const n=t.length;if(0===n)return null;if(1===n)return t[0];const i=nn(this.gos).elementsFromPoint(e.clientX,e.clientY);for(const s of i)for(const e of t){if(-1!==(r=this.getAllContainersFromDropTarget(e),r?.flatMap((e=>e))??[]).indexOf(s))return e}var r;return null}enterDragTargetIfExists(e,t,n,i,r){if(e&&e.onDragEnter){const s=this.createDropTargetEvent(e,t,n,i,r);e.onDragEnter(s)}}leaveLastTargetIfExists(e,t,n,i){if(!this.lastDropTarget)return;if(this.lastDropTarget.onDragLeave){const r=this.createDropTargetEvent(this.lastDropTarget,e,t,n,i);this.lastDropTarget.onDragLeave(r)}const r=this.getDragAndDropImageComponent();r&&r.setIcon(null)}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter((t=>t.getContainer()!==e.getContainer()))}hasExternalDropZones(){return this.dropTargets.some((e=>e.external))}findExternalZone(e){return this.dropTargets.filter((e=>e.external)).find((t=>t.getContainer()===e.getContainer()))||null}isDropZoneWithinThisGrid(e){const t=this.ctrlsService.getGridBodyCtrl().getGui(),{dropZoneTarget:n}=e;return t.contains(n)}getHorizontalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientX,n=e.clientX;return t===n?null:t>n?0:1}getVerticalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientY,n=e.clientY;return t===n?null:t>n?0:1}createDropTargetEvent(e,t,n,i,r){const s=e.getContainer(),o=s.getBoundingClientRect(),{dragItem:a,dragSource:l}=this,c=t.clientX-o.left,u=t.clientY-o.top;return this.gos.addGridCommonParams({event:t,x:c,y:u,vDirection:i,hDirection:n,dragSource:l,fromNudge:r,dragItem:a,dropZoneTarget:s})}positionDragAndDropImageComp(e){const t=this.getDragAndDropImageComponent();if(!t)return;const n=t.getGui(),i=n.getBoundingClientRect().height,r=(document.body?.clientWidth??(window.innerHeight||document.documentElement?.clientWidth||-1))-2,s=(document.body?.clientHeight??(window.innerHeight||document.documentElement?.clientHeight||-1))-2;if(!n.offsetParent)return;const o=Xr(n.offsetParent),{clientY:a,clientX:l}=e;let c=a-o.top-i/2,u=l-o.left-10;const h=en(this.gos),d=h.defaultView||window,p=d.pageYOffset||h.documentElement.scrollTop,g=d.pageXOffset||h.documentElement.scrollLeft;r>0&&u+n.clientWidth>r+g&&(u=r+g-n.clientWidth),u<0&&(u=0),s>0&&c+n.clientHeight>s+p&&(c=s+p-n.clientHeight),c<0&&(c=0),n.style.left=`${u}px`,n.style.top=`${c}px`}removeDragAndDropImageComponent(){if(this.dragAndDropImageComp){const{comp:e}=this.dragAndDropImageComp;if(e){const t=e.getGui();this.dragAndDropImageParent&&this.dragAndDropImageParent.removeChild(t),this.destroyBean(e)}}this.dragAndDropImageComp=null}createDragAndDropImageComponent(){const{dragSource:e}=this;if(!e)return;const t=this.userComponentFactory.getDragAndDropImageCompDetails({dragSource:e}).newAgStackInstance();this.dragAndDropImageComp={promise:t},t.then((e=>{e&&this.isAlive()&&(this.processDragAndDropImageComponent(e),this.dragAndDropImageComp.comp=e)}))}processDragAndDropImageComponent(e){const{dragSource:t,mouseEventService:n,environment:i}=this;if(!t)return;const r=e.getGui();r.style.setProperty("position","absolute"),r.style.setProperty("z-index","9999"),n.stampTopLevelGridCompWithGridInstance(r),i.applyThemeClasses(r),e.setIcon(null);let{dragItemName:s}=t;_t(s)&&(s=s()),e.setLabel(s||""),r.style.top="20px",r.style.left="20px";const o=en(this.gos);let a=null,l=null;try{a=o.fullscreenElement}catch(zD){}finally{a||(a=nn(this.gos));const e=a.querySelector("body");l=e||(a instanceof ShadowRoot?a:a instanceof Document?a?.documentElement:a)}this.dragAndDropImageParent=l,l?l.appendChild(r):bt("Could not find document body, it is needed for drag and drop.")}},_o=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=-1!==e.scrollAxis.indexOf("x"),this.scrollVertically=-1!==e.scrollAxis.indexOf("y"),this.scrollByTick=null!=e.scrollByTick?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}check(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this.shouldSkipVerticalScroll();if(t&&this.shouldSkipHorizontalScroll())return;const n=this.scrollContainer.getBoundingClientRect(),i=this.scrollByTick;this.tickLeft=e.clientX<n.left+i,this.tickRight=e.clientX>n.right-i,this.tickUp=e.clientY<n.top+i&&!t,this.tickDown=e.clientY>n.bottom-i&&!t,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){null===this.tickingInterval&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;const e=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){const t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){const t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},Mo=class extends Vn{wireBeans(e){this.dragAndDropService=e.dragAndDropService,this.rowModel=e.rowModel,this.pageBoundsService=e.pageBoundsService,this.focusService=e.focusService,this.sortController=e.sortController,this.filterManager=e.filterManager,this.selectionService=e.selectionService,this.mouseEventService=e.mouseEventService,this.ctrlsService=e.ctrlsService,this.funcColsService=e.funcColsService,this.rangeService=e.rangeService}constructor(e){super(),this.eContainer=e}postConstruct(){Vt(this.gos)&&(this.clientSideRowModel=this.rowModel),this.ctrlsService.whenReady(this,(e=>{const t=e.gridBodyCtrl;this.autoScrollService=new _o({scrollContainer:t.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:()=>t.getScrollFeature().getVScrollPosition().top,setVerticalPosition:e=>t.getScrollFeature().setVerticalScrollPosition(e),onScrollCallback:()=>{this.onDragging(this.lastDraggingEvent)}})}))}getContainer(){return this.eContainer}isInterestedIn(e){return 2===e}getIconName(){return this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?"notAllowed":"move"}shouldPreventRowMove(){if(this.funcColsService.getRowGroupColumns().length)return!0;const e=this.filterManager?.isAnyFilterPresent();if(e)return!0;return!!this.sortController.isSortActive()}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];const t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){const e=[...this.selectionService.getSelectedNodes()].sort(((e,t)=>null==e.rowIndex||null==t.rowIndex?0:this.getRowIndexNumber(e)-this.getRowIndexNumber(t)));if(-1!==e.indexOf(t))return e}return[t]}onDragEnter(e){e.dragItem.rowNodes=this.getRowNodes(e),this.dispatchGridEvent("rowDragEnter",e),this.getRowNodes(e).forEach((e=>{e.setDragging(!0)})),this.onEnterOrDragging(e)}onDragging(e){this.onEnterOrDragging(e)}isFromThisGrid(e){const{dragSourceDomDataKey:t}=e.dragSource;return t===this.gos.getDomDataKey()}onEnterOrDragging(e){this.dispatchGridEvent("rowDragMove",e),this.lastDraggingEvent=e;const t=this.mouseEventService.getNormalisedPosition(e).y;this.gos.get("rowDragManaged")&&this.doManagedDrag(e,t),this.autoScrollService.check(e.event)}doManagedDrag(e,t){const n=this.isFromThisGrid(e),i=this.gos.get("rowDragManaged"),r=e.dragItem.rowNodes;i&&this.shouldPreventRowMove()||(this.gos.get("suppressMoveWhenRowDragging")||!n?this.dragAndDropService.isDropZoneWithinThisGrid(e)&&this.clientSideRowModel.highlightRowAtPixel(r[0],t):this.moveRows(r,t))}getRowIndexNumber(e){const t=e.getRowIndexString();return parseInt(Rn(t.split("-")),10)}moveRowAndClearHighlight(e){const t=this.clientSideRowModel.getLastHighlightedRowNode(),n=t&&1===t.highlighted,i=this.mouseEventService.getNormalisedPosition(e).y,r=e.dragItem.rowNodes;let s=n?1:0;if(this.isFromThisGrid(e))r.forEach((e=>{e.rowTop<i&&(s-=1)})),this.moveRows(r,i,s);else{const e=gn(this.gos);let t=this.clientSideRowModel.getRowIndexAtPixel(i)+1;0===this.clientSideRowModel.getHighlightPosition(i)&&t--,this.clientSideRowModel.updateRowData({add:r.filter((t=>!this.clientSideRowModel.getRowNode(e?.({data:t.data,level:0,rowPinned:t.rowPinned})??t.data.id))).map((e=>e.data)),addIndex:t})}this.clearRowHighlight()}clearRowHighlight(){this.clientSideRowModel.highlightRowAtPixel(null)}moveRows(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.clientSideRowModel.ensureRowsAtPixel(e,t,n)&&(this.focusService.clearFocusedCell(),this.rangeService?.removeAllCellRanges())}addRowDropZone(e){if(!e.getContainer())return void bt("addRowDropZone - A container target needs to be provided");if(this.dragAndDropService.findExternalZone(e))return void bt("addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");let t={getContainer:e.getContainer};e.fromGrid?t=e:(e.onDragEnter&&(t.onDragEnter=t=>{e.onDragEnter(this.draggingToRowDragEvent("rowDragEnter",t))}),e.onDragLeave&&(t.onDragLeave=t=>{e.onDragLeave(this.draggingToRowDragEvent("rowDragLeave",t))}),e.onDragging&&(t.onDragging=t=>{e.onDragging(this.draggingToRowDragEvent("rowDragMove",t))}),e.onDragStop&&(t.onDragStop=t=>{e.onDragStop(this.draggingToRowDragEvent("rowDragEnd",t))}),e.onDragCancel&&(t.onDragCancel=t=>{e.onDragCancel(this.draggingToRowDragEvent("rowDragCancel",t))}));const n={isInterestedIn:e=>2===e,getIconName:()=>"move",external:!0,...t};this.dragAndDropService.addDropTarget(n),this.addDestroyFunc((()=>this.dragAndDropService.removeDropTarget(n)))}getRowDropZone(e){const t=this.getContainer.bind(this),n=this.onDragEnter.bind(this),i=this.onDragLeave.bind(this),r=this.onDragging.bind(this),s=this.onDragStop.bind(this),o=this.onDragCancel.bind(this);let a;return a=e?{getContainer:t,onDragEnter:e.onDragEnter?t=>{n(t),e.onDragEnter(this.draggingToRowDragEvent("rowDragEnter",t))}:n,onDragLeave:e.onDragLeave?t=>{i(t),e.onDragLeave(this.draggingToRowDragEvent("rowDragLeave",t))}:i,onDragging:e.onDragging?t=>{r(t),e.onDragging(this.draggingToRowDragEvent("rowDragMove",t))}:r,onDragStop:e.onDragStop?t=>{s(t),e.onDragStop(this.draggingToRowDragEvent("rowDragEnd",t))}:s,onDragCancel:e.onDragCancel?t=>{o(t),e.onDragCancel(this.draggingToRowDragEvent("rowDragCancel",t))}:o,fromGrid:!0}:{getContainer:t,onDragEnter:n,onDragLeave:i,onDragging:r,onDragStop:s,onDragCancel:o,fromGrid:!0},a}draggingToRowDragEvent(e,t){const n=this.mouseEventService.getNormalisedPosition(t).y;let i,r,s=-1;switch(n>this.pageBoundsService.getCurrentPageHeight()||(s=this.rowModel.getRowIndexAtPixel(n),i=this.rowModel.getRow(s)),t.vDirection){case 1:r="down";break;case 0:r="up";break;default:r=null}return this.gos.addGridCommonParams({type:e,event:t.event,node:t.dragItem.rowNode,nodes:t.dragItem.rowNodes,overIndex:s,overNode:i,y:n,vDirection:r})}dispatchGridEvent(e,t){const n=this.draggingToRowDragEvent(e,t);this.eventService.dispatchEvent(n)}onDragLeave(e){this.dispatchGridEvent("rowDragLeave",e),this.stopDragging(e),this.gos.get("rowDragManaged")&&this.clearRowHighlight()}onDragStop(e){this.dispatchGridEvent("rowDragEnd",e),this.stopDragging(e),this.gos.get("rowDragManaged")&&(this.gos.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(e))&&this.dragAndDropService.isDropZoneWithinThisGrid(e)&&this.moveRowAndClearHighlight(e)}onDragCancel(e){this.dispatchGridEvent("rowDragCancel",e),this.stopDragging(e),this.gos.get("rowDragManaged")&&(this.gos.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(e))&&this.dragAndDropService.isDropZoneWithinThisGrid(e)&&this.clearRowHighlight()}stopDragging(e){this.autoScrollService.ensureCleared(),this.getRowNodes(e).forEach((e=>{e.setDragging(!1)}))}},Eo=class extends Vn{constructor(){super(...arguments),this.beanName="dragService",this.dragEndFunctions=[],this.dragSources=[]}wireBeans(e){this.mouseEventService=e.mouseEventService}destroy(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0,super.destroy()}removeListener(e){const t=e.dragSource.eElement,n=e.mouseDownListener;if(t.removeEventListener("mousedown",n),e.touchEnabled){const n=e.touchStartListener;t.removeEventListener("touchstart",n,{passive:!0})}}removeDragSource(e){const t=this.dragSources.find((t=>t.dragSource===e));t&&(this.removeListener(t),An(this.dragSources,t))}isDragging(){return this.dragging}addDragSource(e){const t=this.onMouseDown.bind(this,e),{eElement:n,includeTouch:i,stopPropagationForTouch:r}=e;n.addEventListener("mousedown",t);let s=null;const o=this.gos.get("suppressTouch");i&&!o&&(s=t=>{Br(t.target)||(r&&t.stopPropagation(),this.onTouchStart(e,t))},n.addEventListener("touchstart",s,{passive:!1})),this.dragSources.push({dragSource:e,mouseDownListener:t,touchStartListener:s,touchEnabled:!!i})}getStartTarget(){return this.startTarget}onTouchStart(e,t){this.currentDragParams=e,this.dragging=!1;const n=t.touches[0];this.touchLastTime=n,this.touchStart=n;const i=t=>this.onTouchUp(t,e.eElement),r=t.target,s=[{target:nn(this.gos),type:"touchmove",listener:e=>{e.cancelable&&e.preventDefault()},options:{passive:!1}},{target:r,type:"touchmove",listener:t=>this.onTouchMove(t,e.eElement),options:{passive:!0}},{target:r,type:"touchend",listener:i,options:{passive:!0}},{target:r,type:"touchcancel",listener:i,options:{passive:!0}}];this.addTemporaryEvents(s),0===e.dragStartPixels&&this.onCommonMove(n,this.touchStart,e.eElement)}onMouseDown(e,t){const n=t;if(e.skipMouseEvent&&e.skipMouseEvent(t))return;if(n._alreadyProcessedByDragService)return;if(n._alreadyProcessedByDragService=!0,0!==t.button)return;this.shouldPreventMouseEvent(t)&&t.preventDefault(),this.currentDragParams=e,this.dragging=!1,this.mouseStartEvent=t,this.startTarget=t.target;const i=nn(this.gos),r=[{target:i,type:"mousemove",listener:t=>this.onMouseMove(t,e.eElement)},{target:i,type:"mouseup",listener:t=>this.onMouseUp(t,e.eElement)},{target:i,type:"contextmenu",listener:e=>e.preventDefault()},{target:i,type:"keydown",listener:t=>{t.key===As.ESCAPE&&this.cancelDrag(e.eElement)}}];this.addTemporaryEvents(r),0===e.dragStartPixels&&this.onMouseMove(t,e.eElement)}addTemporaryEvents(e){e.forEach((e=>{const{target:t,type:n,listener:i,options:r}=e;t.addEventListener(n,i,r)})),this.dragEndFunctions.push((()=>{e.forEach((e=>{const{target:t,type:n,listener:i,options:r}=e;t.removeEventListener(n,i,r)}))}))}isEventNearStartEvent(e,t){const{dragStartPixels:n}=this.currentDragParams;return ws(e,t,Dt(n)?n:4)}getFirstActiveTouch(e){for(let t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}onCommonMove(e,t,n){if(!this.dragging){if(this.isEventNearStartEvent(e,t))return;if(this.dragging=!0,this.eventService.dispatchEvent({type:"dragStarted",target:n}),this.currentDragParams.onDragStart(t),!this.currentDragParams)return void(this.dragging=!1);this.currentDragParams.onDragging(t)}this.currentDragParams?.onDragging(e)}onTouchMove(e,t){const n=this.getFirstActiveTouch(e.touches);n&&this.onCommonMove(n,this.touchStart,t)}onMouseMove(e,t){if(Rr()){const e=en(this.gos);e.getSelection()?.removeAllRanges()}this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.onCommonMove(e,this.mouseStartEvent,t)}shouldPreventMouseEvent(e){const t=this.gos.get("enableCellTextSelection"),n="mousemove"===e.type;return t&&n&&e.cancelable&&this.mouseEventService.isEventFromThisGrid(e)&&!this.isOverFormFieldElement(e)}isOverFormFieldElement(e){const t=e.target,n=t?.tagName.toLocaleLowerCase();return!!n?.match("^a$|textarea|input|select|button")}onTouchUp(e,t){let n=this.getFirstActiveTouch(e.changedTouches);n||(n=this.touchLastTime),this.onUpCommon(n,t)}onMouseUp(e,t){this.onUpCommon(e,t)}onUpCommon(e,t){this.dragging&&(this.dragging=!1,this.currentDragParams.onDragStop(e),this.eventService.dispatchEvent({type:"dragStopped",target:t})),this.resetDragProperties()}cancelDrag(e){this.eventService.dispatchEvent({type:"dragCancelled",target:e}),this.currentDragParams?.onDragCancel?.(),this.resetDragProperties()}resetDragProperties(){this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach((e=>e())),this.dragEndFunctions.length=0}},Ro=class extends fs{constructor(e,t,n,i,r,s){super(),this.cellValueFn=e,this.rowNode=t,this.column=n,this.customGui=i,this.dragStartPixels=r,this.suppressVisibilityChange=s,this.dragSource=null}wireBeans(e){this.beans=e}isCustomGui(){return null!=this.customGui}postConstruct(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(ys("rowDrag",this.gos,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){const e=this.gos.get("rowDragManaged")?new Ao(this,this.beans,this.rowNode,this.column):new Po(this,this.beans,this.rowNode,this.column);this.createManagedBean(e,this.beans.context)}}setDragElement(e,t){this.setTemplateFromElement(e,void 0,void 0,!0),this.addDragSource(t)}getSelectedNodes(){if(!this.gos.get("rowDragMultiRow"))return[this.rowNode];const e=this.beans.selectionService.getSelectedNodes();return-1!==e.indexOf(this.rowNode)?e:[this.rowNode]}checkCompatibility(){const e=this.gos.get("rowDragManaged");this.gos.get("treeData")&&e&&bt("If using row drag with tree data, you cannot have rowDragManaged=true")}getDragItem(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(e){if(e){const t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gos.get("rowDragText")}addDragSource(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;this.dragSource&&this.removeDragSource();const t=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(t,{mousedown:e=>{e?.preventDefault()}})[0]);const n=this.localeService.getLocaleTextFunc();this.dragSource={type:2,eElement:t,dragItemName:()=>{const e=this.getDragItem(),t=e.rowNodes?.length||1,i=this.getRowDragText(this.column);return i?i(e,t):1===t?this.cellValueFn():`${t} ${n("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}},To=class extends Vn{constructor(e,t,n){super(),this.parent=e,this.rowNode=t,this.column=n}setDisplayedOrVisible(e){const t={skipAriaHidden:!0};if(e)this.parent.setDisplayed(!1,t);else{let e=!0,n=!1;this.column&&(e=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),n=_t(this.column.getColDef().rowDrag)),n?(this.parent.setDisplayed(!0,t),this.parent.setVisible(e,t)):(this.parent.setDisplayed(e,t),this.parent.setVisible(!0,t))}}},Po=class extends To{constructor(e,t,n,i){super(e,n,i),this.beans=t}postConstruct(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this));const e=this.workOutVisibility.bind(this);this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.addManagedListeners(this.beans.eventService,{newColumnsLoaded:e}),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.gos.get("suppressRowDrag");this.setDisplayedOrVisible(e)}},Ao=class extends To{constructor(e,t,n,i){super(e,n,i),this.beans=t}postConstruct(){const e=this.workOutVisibility.bind(this);this.addManagedListeners(this.beans.eventService,{sortChanged:e,filterChanged:e,columnRowGroupChanged:e,newColumnsLoaded:e}),this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),t=e&&e.shouldPreventRowMove(),n=this.gos.get("suppressRowDrag"),i=this.beans.dragAndDropService.hasExternalDropZones(),r=t&&!i||n;this.setDisplayedOrVisible(r)}},Fo=new Set(["localEventService","__objectId","sticky","__autoHeights","checkAutoHeightsDebounced"]),Do=class e{constructor(t){this.rowIndex=null,this.key=null,this.sourceRowIndex=-1,this.childrenMapped={},this.treeNode=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=e.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=t}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){const n=this.data;this.data=e,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();const i=this.createDataChangedEvent(e,n,t);this.localEventService?.dispatchEvent(i)}updateDataOnDetailNode(){this.detailNode&&(this.detailNode.data=this.data)}createDataChangedEvent(e,t,n){return{type:"dataChanged",node:this,oldData:t,newData:e,update:n}}getRowIndexString(){return null==this.rowIndex?(xt("Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid."),null):"top"===this.rowPinned?e.ID_PREFIX_TOP_PINNED+this.rowIndex:"bottom"===this.rowPinned?e.ID_PREFIX_BOTTOM_PINNED+this.rowIndex:this.rowIndex.toString()}createDaemonNode(){const t=new e(this.beans);return t.id=this.id,t.data=this.data,t.__daemon=!0,t.selected=this.selected,t.level=this.level,t}setDataAndId(e,t){const n=Dt(this.id)?this.createDaemonNode():null,i=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),this.checkRowSelectable(),this.beans.selectionService.syncInRowNode(this,n);const r=this.createDataChangedEvent(e,i,!1);this.localEventService?.dispatchEvent(r)}checkRowSelectable(){const e=Sn(this.beans.gos);this.setRowSelectable(!e||e(this))}setRowSelectable(e,t){if(this.selectable!==e){if(this.selectable=e,this.dispatchRowEvent("selectableChanged"),t)return;if(Mn(this.beans.gos)){const e=this.calculateSelectedFromChildren();return void this.setSelectedParams({newValue:e??!1,source:"selectableChanged"})}this.isSelected()&&!this.selectable&&this.setSelectedParams({newValue:!1,source:"selectableChanged"})}}setId(t){const n=gn(this.beans.gos);if(n)if(this.data){const t=this.parent?.getRoute()??[];this.id=n({data:this.data,parentKeys:t.length>0?t:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(e.ID_PREFIX_ROW_GROUP)&&xt(`Row IDs cannot start with ${e.ID_PREFIX_ROW_GROUP}, this is a reserved prefix for AG Grid's row grouping feature.`)}else this.id=void 0;else this.id=t}setRowTop(e){this.oldRowTop=this.rowTop,this.rowTop!==e&&(this.rowTop=e,this.dispatchRowEvent("topChanged"),this.setDisplayed(null!==e))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(e){this.hovered=e}isHovered(){return this.hovered}setMaster(e){this.master!==e&&(this.master&&!e&&(this.expanded=!1),this.master=e,this.dispatchRowEvent("masterChanged"))}setGroup(e){this.group!==e&&(this.group&&!e&&(this.expanded=!1),this.group=e,this.updateHasChildren(),this.checkRowSelectable(),this.dispatchRowEvent("groupChanged"))}setRowHeight(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.rowHeight=e,this.rowHeightEstimated=t,this.dispatchRowEvent("heightChanged")}setRowAutoHeight(e,t){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[t.getId()]=e,null!=e&&(null==this.checkAutoHeightsDebounced&&(this.checkAutoHeightsDebounced=Pt(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())}checkAutoHeights(){let e=!1,t=!0,n=0;const i=this.__autoHeights;if(null==i)return;if(this.beans.visibleColsService.getAllAutoHeightCols().forEach((r=>{let s=i[r.getId()];if(null==s){if(!this.beans.columnModel.isColSpanActive())return void(e=!0);{let t=[];switch(r.getPinned()){case"left":t=this.beans.visibleColsService.getLeftColsForRow(this);break;case"right":t=this.beans.visibleColsService.getRightColsForRow(this);break;case null:t=this.beans.columnViewportService.getColsWithinViewport(this)}if(t.includes(r))return void(e=!0);s=-1}}else t=!1;s>n&&(n=s)})),e)return;if((t||n<10)&&(n=$t(this.beans.gos,this).height),n==this.rowHeight)return;this.setRowHeight(n);const r=this.beans.rowModel;r.onRowHeightChangedDebounced?.()}setExpanded(e,t,n){if(this.expanded===e)return;this.expanded=e,this.dispatchRowEvent("expandedChanged");const i={...this.createGlobalRowEvent("rowGroupOpened"),expanded:e,event:t||null};this.beans.rowNodeEventThrottle.dispatchExpanded(i,n),this.beans.rowRenderer.refreshCells({rowNodes:[this]})}createGlobalRowEvent(e){return this.beans.gos.addGridCommonParams({type:e,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned})}setDataValue(e,t,n){const i=(()=>"string"!==typeof e?e:this.beans.columnModel.getCol(e)??this.beans.columnModel.getColDefCol(e))(),r=this.beans.valueService.getValueForDisplay(i,this);if(this.beans.gos.get("readOnlyEdit"))return this.beans.eventService.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column:i,colDef:i.getColDef(),data:this.data,node:this,oldValue:r,newValue:t,value:t,source:n}),!1;const s=this.beans.valueService.setValue(this,i,t,n);return this.dispatchCellChangedEvent(i,t,r),this.checkRowSelectable(),s}setGroupValue(e,t){const n=this.beans.columnModel.getCol(e);Lt(this.groupData)&&(this.groupData={});const i=n.getColId(),r=this.groupData[i];r!==t&&(this.groupData[i]=t,this.dispatchCellChangedEvent(n,t,r))}setAggData(e){const t=this.aggData;if(this.aggData=e,this.localEventService){const n=e=>{const n=this.aggData?this.aggData[e]:void 0,i=t?t[e]:void 0;if(n===i)return;const r=this.beans.columnModel.getCol(e);r&&this.dispatchCellChangedEvent(r,n,i)};for(const e in t)n(e);for(const i in e)t&&i in t||n(i)}}updateHasChildren(){let e=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(Wt(this.beans.gos)){const t=this.beans.gos.get("treeData"),n=this.beans.gos.get("isServerSideGroup");e=!this.stub&&!this.footer&&(t?!!n&&n(this.data):!!this.group)}e!==this.__hasChildren&&(this.__hasChildren=!!e,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return null==this.__hasChildren&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(e,t,n){const i={type:"cellChanged",node:this,column:e,newValue:t,oldValue:n};this.localEventService?.dispatchEvent(i)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return!this.footer&&(this.beans.columnModel.isPivotMode()?this.hasChildren()&&!this.leafGroup:this.hasChildren()||!!this.master)}isSelected(){return this.footer?this.sibling.isSelected():this.selected}depthFirstSearch(e){this.childrenAfterGroup&&this.childrenAfterGroup.forEach((t=>t.depthFirstSearch(e))),e(this)}calculateSelectedFromChildren(){let e=!1,t=!1;if(!this.childrenAfterGroup?.length)return this.selectable?this.selected:null;for(let n=0;n<this.childrenAfterGroup.length;n++){const i=this.childrenAfterGroup[n];let r=i.isSelected();if(!i.selectable){const e=i.calculateSelectedFromChildren();if(null===e)continue;r=e}switch(r){case!0:e=!0;break;case!1:t=!0;break;default:return}}return e&&t?void 0:!!e||!t&&(this.selectable?this.selected:null)}setSelectedInitialValue(e){this.selected=e}dispatchRowEvent(e){this.localEventService?.dispatchEvent({type:e,node:this})}selectThisNode(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";const i=!this.selectable&&e,r=this.selected===e;if(i||r)return!1;this.selected=e,this.dispatchRowEvent("rowSelected");const s=this.sibling;return s&&s.footer&&s.localEventService&&s.dispatchRowEvent("rowSelected"),this.beans.eventService.dispatchEvent({...this.createGlobalRowEvent("rowSelected"),event:t||null,source:n}),!0}setSelected(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";"boolean"!==typeof n?this.setSelectedParams({newValue:e,clearSelection:t,rangeSelect:!1,source:n}):bt("since version v30, rowNode.setSelected() property `suppressFinishActions` has been removed, please use `gridApi.setNodesSelected()` for bulk actions, and the event `source` property for ignoring events instead.")}setSelectedParams(e){return this.rowPinned?(bt("cannot select pinned rows"),0):void 0===this.id?(bt("cannot select node until id for node is known"),0):this.beans.selectionService.setNodesSelected({...e,nodes:[this.footer?this.sibling:this]})}isRowPinned(){return!!this.rowPinned}addEventListener(e,t){this.localEventService||(this.localEventService=new vt),this.beans.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.localEventService.setFrameworkOverrides(this.beans.frameworkOverrides),this.frameworkEventListenerService=new ti(this.beans.frameworkOverrides));const n=this.frameworkEventListenerService?.wrap(t)??t;this.localEventService.addEventListener(e,n)}removeEventListener(e,t){if(!this.localEventService)return;const n=this.frameworkEventListenerService?.unwrap(t)??t;this.localEventService.removeEventListener(e,n),this.localEventService.noRegisteredListenersExist()&&(this.localEventService=null)}onMouseEnter(){this.dispatchRowEvent("mouseEnter")}onMouseLeave(){this.dispatchRowEvent("mouseLeave")}isFullWidthCell(){if(bt("since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option."),this.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return!!e&&e({rowNode:this})}getRoute(){if(-1===this.level)return[];if(null==this.key)return;const e=[];let t=this;for(;t&&null!=t.key;)e.push(t.key),t=t.parent;return e.reverse()}createFooter(){if(this.sibling)return;const t=new e(this.beans);Object.keys(this).forEach((e=>{Fo.has(e)||(t[e]=this[e])})),t.footer=!0,t.setRowTop(null),t.setRowIndex(null),t.oldRowTop=null,t.id="rowGroupFooter_"+this.id,t.sibling=this,this.sibling=t}destroyFooter(){this.sibling&&(this.sibling.setRowTop(null),this.sibling.setRowIndex(null),this.sibling=void 0)}setFirstChild(e){this.firstChild!==e&&(this.firstChild=e,this.dispatchRowEvent("firstChildChanged"))}setLastChild(e){this.lastChild!==e&&(this.lastChild=e,this.dispatchRowEvent("lastChildChanged"))}setChildIndex(e){this.childIndex!==e&&(this.childIndex=e,this.dispatchRowEvent("childIndexChanged"))}setDisplayed(e){this.displayed!==e&&(this.displayed=e,this.dispatchRowEvent("displayedChanged"))}setDragging(e){this.dragging!==e&&(this.dragging=e,this.dispatchRowEvent("draggingChanged"))}setHighlighted(e){this.highlighted!==e&&(this.highlighted=e,this.dispatchRowEvent("rowHighlightChanged"))}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.dispatchRowEvent("allChildrenCountChanged"))}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.dispatchRowEvent("rowIndexChanged"))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.dispatchRowEvent("uiLevelChanged"))}};Do.ID_PREFIX_ROW_GROUP="row-group-",Do.ID_PREFIX_TOP_PINNED="t-",Do.ID_PREFIX_BOTTOM_PINNED="b-",Do.OBJECT_ID_SEQUENCE=0;var Lo=Do,Io=class extends fs{constructor(e,t){super('<div class="ag-filter"></div>'),this.column=e,this.source=t,this.filterWrapper=null}wireBeans(e){this.filterManager=e.filterManager,this.columnModel=e.columnModel}postConstruct(){this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return!!this.filterWrapper}getFilter(){return this.filterWrapper?.filterPromise??null}afterInit(){return this.filterWrapper?.filterPromise?.then((()=>{}))??Xs.resolve()}afterGuiAttached(e){this.filterWrapper?.filterPromise?.then((t=>{t?.afterGuiAttached?.(e)}))}afterGuiDetached(){this.filterWrapper?.filterPromise?.then((e=>{e?.afterGuiDetached?.()}))}createFilter(e){const{column:t,source:n}=this;this.filterWrapper=this.filterManager?.getOrCreateFilterWrapper(t)??null,this.filterWrapper?.filterPromise&&this.filterWrapper.filterPromise.then((i=>{const r=i.getGui();Dt(r)||bt(`getGui method from filter returned ${r}; it should be a DOM element.`),this.appendChild(r),e&&this.eventService.dispatchEvent({type:"filterOpened",column:t,source:n,eGui:this.getGui()})}))}onFilterDestroyed(e){"api"!==e.source&&"paramsUpdated"!==e.source||e.column.getId()!==this.column.getId()||!this.columnModel.getColDefCol(this.column)||(Yr(this.getGui()),this.createFilter())}destroy(){this.filterWrapper=null,super.destroy()}},ko="ag-resizer-wrapper",Oo=(e,t)=>`<div data-ref="${e}Resizer" class="ag-resizer ag-resizer-${t}"></div>`,No=`<div class="${ko}">\n        ${Oo("eTopLeft","topLeft")}\n        ${Oo("eTop","top")}\n        ${Oo("eTopRight","topRight")}\n        ${Oo("eRight","right")}\n        ${Oo("eBottomRight","bottomRight")}\n        ${Oo("eBottom","bottom")}\n        ${Oo("eBottomLeft","bottomLeft")}\n        ${Oo("eLeft","left")}\n    </div>`,Bo=class extends Vn{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}wireBeans(e){this.popupService=e.popupService,this.resizeObserverService=e.resizeObserverService,this.dragService=e.dragService}center(){const{clientHeight:e,clientWidth:t}=this.offsetParent,n=t/2-this.getWidth()/2,i=e/2-this.getHeight()/2;this.offsetElement(n,i)}initialisePosition(){if(this.positioned)return;const{centered:e,forcePopupParentAsOffsetParent:t,minWidth:n,width:i,minHeight:r,height:s,x:o,y:a}=this.config;this.offsetParent||this.setOffsetParent();let l=0,c=0;const u=es(this.element);if(u){const e=this.findBoundaryElement(),t=window.getComputedStyle(e);if(null!=t.minWidth){const n=e.offsetWidth-this.element.offsetWidth;c=parseInt(t.minWidth,10)-n}if(null!=t.minHeight){const n=e.offsetHeight-this.element.offsetHeight;l=parseInt(t.minHeight,10)-n}}if(this.minHeight=r||l,this.minWidth=n||c,i&&this.setWidth(i),s&&this.setHeight(s),i&&s||this.refreshSize(),e)this.center();else if(o||a)this.offsetElement(o,a);else if(u&&t){let e=this.boundaryEl,t=!0;if(e||(e=this.findBoundaryElement(),t=!1),e){const n=parseFloat(e.style.top),i=parseFloat(e.style.left);t?this.offsetElement(isNaN(i)?0:i,isNaN(n)?0:n):this.setPosition(i,n)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;const n=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragService.addDragSource(n),this.moveElementDragListener=n):(this.dragService.removeDragSource(n),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),"boolean"===typeof e){if(!1===e)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach((t=>{const n=!!e[t],i=this.getResizerElement(t),r={dragStartPixels:0,eElement:i,onDragStart:e=>this.onResizeStart(e,t),onDragging:this.onResize.bind(this),onDragStop:e=>this.onResizeEnd(e,t)};(n||!this.isAlive()&&!n)&&(n?(this.dragService.addDragSource(r),this.resizeListeners.push(r),i.style.pointerEvents="all"):i.style.pointerEvents="none",this.resizable[t]=n)}))}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:e,width:t}=this.lastSize;-1!==t&&(this.element.style.width=`${t}px`),-1!==e&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){const{popup:t}=this.config,n=this.element;let i=!1;if("string"===typeof e&&-1!==e.indexOf("%"))rs(n,e),e=jr(n),i=!0;else if(e=Math.max(this.minHeight,e),this.positioned){const t=this.getAvailableHeight();t&&e>t&&(e=t)}this.getHeight()!==e&&(i?(n.style.maxHeight="unset",n.style.minHeight="unset"):t?rs(n,e):(n.style.height=`${e}px`,n.style.flex="0 0 auto",this.lastSize.height="number"===typeof e?e:parseFloat(e)))}getAvailableHeight(){const{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();const{clientHeight:n}=this.offsetParent;if(!n)return null;const i=this.element.getBoundingClientRect(),r=this.offsetParent.getBoundingClientRect(),s=e?this.position.y:i.top,o=e?0:r.top;let a=0;if(t){const e=this.element.parentElement;if(e){const{bottom:t}=e.getBoundingClientRect();a=t-i.bottom}}return n+o-s-a}getWidth(){return this.element.offsetWidth}setWidth(e){const t=this.element,{popup:n}=this.config;let i=!1;if("string"===typeof e&&-1!==e.indexOf("%"))is(t,e),e=qr(t),i=!0;else if(this.positioned){e=Math.max(this.minWidth,e);const{clientWidth:t}=this.offsetParent,i=n?this.position.x:this.element.getBoundingClientRect().left;t&&e+i>t&&(e=t-i)}this.getWidth()!==e&&(i?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?is(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width="number"===typeof e?e:parseFloat(e)))}offsetElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{forcePopupParentAsOffsetParent:n}=this.config,i=n?this.boundaryEl:this.element;i&&(this.popupService.positionPopup({ePopup:i,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t})}),this.setPosition(parseFloat(i.style.left),parseFloat(i.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;const t=()=>{const e=this.getAvailableHeight();this.element.style.setProperty("max-height",`${e}px`)};e?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),t):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){const{e:t,isLeft:n,isTop:i,anywhereWithin:r,topBuffer:s}=e,o=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y;return{movementX:this.shouldSkipX(t,!!n,!!r,o)?0:o,movementY:this.shouldSkipY(t,!!i,s,a)?0:a}}shouldSkipX(e,t,n,i){const r=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:r.left;let l=a<=0&&s.left>=e.clientX||s.right<=e.clientX&&s.right<=o.right;return!!l||(l=t?i<0&&e.clientX>a+s.left||i>0&&e.clientX<a+s.left:n?i<0&&e.clientX>o.right||i>0&&e.clientX<a+s.left:i<0&&e.clientX>o.right||i>0&&e.clientX<o.right,l)}shouldSkipY(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const r=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:r.top;let l=a<=0&&s.top>=e.clientY||s.bottom<=e.clientY&&s.bottom<=o.bottom;return!!l||(l=t?i<0&&e.clientY>a+s.top+n||i>0&&e.clientY<a+s.top:i<0&&e.clientY>o.bottom||i>0&&e.clientY<o.bottom,l)}createResizeMap(){const e=this.element;this.resizerMap={topLeft:{element:e.querySelector("[data-ref=eTopLeftResizer]")},top:{element:e.querySelector("[data-ref=eTopResizer]")},topRight:{element:e.querySelector("[data-ref=eTopRightResizer]")},right:{element:e.querySelector("[data-ref=eRightResizer]")},bottomRight:{element:e.querySelector("[data-ref=eBottomRightResizer]")},bottom:{element:e.querySelector("[data-ref=eBottomResizer]")},bottomLeft:{element:e.querySelector("[data-ref=eBottomLeftResizer]")},left:{element:e.querySelector("[data-ref=eLeftResizer]")}}}addResizers(){if(this.resizersAdded)return;const e=this.element;if(!e)return;const t=(new DOMParser).parseFromString(No,"text/html").body;e.appendChild(t.firstChild),this.createResizeMap(),this.resizersAdded=!0}removeResizers(){this.resizerMap=void 0;const e=this.element.querySelector(`.${ko}`);e&&this.element.removeChild(e),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");const{popup:n,forcePopupParentAsOffsetParent:i}=this.config;n||i||this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const e=this.element.parentElement;return e?Array.prototype.slice.call(e.children).filter((e=>!e.classList.contains("ag-hidden"))):null}getMinSizeOfSiblings(){const e=this.getSiblings()||[];let t=0,n=0;for(let i=0;i<e.length;i++){const r=e[i],s=!!r.style.flex&&"0 0 auto"!==r.style.flex;if(r===this.element)continue;let o=this.minHeight||0,a=this.minWidth||0;if(s){const e=window.getComputedStyle(r);e.minHeight&&(o=parseInt(e.minHeight,10)),e.minWidth&&(a=parseInt(e.minWidth,10))}else o=r.offsetHeight,a=r.offsetWidth;t+=o,n+=a}return{height:t,width:n}}applySizeToSiblings(e){let t=null;const n=this.getSiblings();if(n){for(let i=0;i<n.length;i++){const r=n[i];r!==t&&(e?r.style.height=`${r.offsetHeight}px`:r.style.width=`${r.offsetWidth}px`,r.style.flex="0 0 auto",r===this.element&&(t=n[i+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some((e=>e))}onResize(e){if(!this.isResizing||!this.currentResizer)return;const{popup:t,forcePopupParentAsOffsetParent:n}=this.config,{isTop:i,isRight:r,isBottom:s,isLeft:o}=this.currentResizer,a=r||o,l=s||i,{movementX:c,movementY:u}=this.calculateMouseMovement({e:e,isLeft:o,isTop:i}),h=this.position.x,d=this.position.y;let p=0,g=0;if(a&&c){const e=o?-1:1,t=this.getWidth(),n=t+c*e;let i=!1;o&&(p=t-n,(h+p<=0||n<=this.minWidth)&&(i=!0,p=0)),i||this.setWidth(n)}if(l&&u){const e=i?-1:1,t=this.getHeight(),n=t+u*e;let r=!1;i?(g=t-n,(d+g<=0||n<=this.minHeight)&&(r=!0,g=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&t<n&&this.getMinSizeOfSiblings().height+n>this.element.parentElement.offsetHeight&&(r=!0),r||this.setHeight(n)}this.updateDragStartPosition(e.clientX,e.clientY),((t||n)&&p||g)&&this.offsetElement(h+p,d+g)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){const e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x:t,y:n}=this.position;let i;this.config.calculateTopBuffer&&(i=this.config.calculateTopBuffer());const{movementX:r,movementY:s}=this.calculateMouseMovement({e:e,isTop:!0,anywhereWithin:!0,topBuffer:i});this.offsetElement(t+r,n+s),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent?this.offsetParent=this.popupService.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if("static"!==window.getComputedStyle(e).position)return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const e=this.resizeListeners.pop();this.dragService.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},zo=class e extends Vn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.eFocusableElement=e,this.callbacks=t,this.callbacks={shouldStopEventPropagation:()=>!1,onTabKeyDown:e=>{if(e.defaultPrevented)return;const t=this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e.shiftKey);t&&(t.focus(),e.preventDefault())},...t}}wireBeans(e){this.focusService=e.focusService}postConstruct(){this.eFocusableElement.classList.add(e.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedElementListeners(this.eFocusableElement,{focusin:this.callbacks.onFocusIn}),this.callbacks.onFocusOut&&this.addManagedElementListeners(this.eFocusableElement,{focusout:this.callbacks.onFocusOut})}addKeyDownListeners(e){this.addManagedElementListeners(e,{keydown:e=>{e.defaultPrevented||zn(e)||(this.callbacks.shouldStopEventPropagation(e)?Bn(e):e.key===As.TAB?this.callbacks.onTabKeyDown(e):this.callbacks.handleKeyDown&&this.callbacks.handleKeyDown(e))}})}};zo.FOCUS_MANAGED_CLASS="ag-focus-managed";var Ho=zo,Go={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"};function Uo(e,t){return Vo(e)?(null!=e.debounceMs&&bt("debounceMs is ignored when apply button is present"),0):null!=e.debounceMs?e.debounceMs:t}function Vo(e){return!!e.buttons&&e.buttons.indexOf("apply")>=0}var Wo=class extends fs{constructor(e){super(),this.filterNameKey=e,this.applyActive=!1,this.hidePopup=null,this.debouncePending=!1,this.appliedModel=null,this.eFilterBody=gs,this.buttonListeners=[]}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){this.resetTemplate(),this.createManagedBean(new Ho(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new Bo(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)}handleKeyDown(e){}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return!!this.appliedModel}resetTemplate(e){let t=this.getGui();t&&t.removeEventListener("submit",this.onFormSubmit);const n=`\n            <form class="ag-filter-wrapper">\n                <div class="ag-filter-body-wrapper ag-${this.getCssIdentifier()}-body-wrapper" data-ref="eFilterBody">\n                    ${this.createBodyTemplate()}\n                </div>\n            </form>`;this.setTemplate(n,this.getAgComponents(),e),t=this.getGui(),t&&t.addEventListener("submit",this.onFormSubmit)}isReadOnly(){return!!this.providedFilterParams.readOnly}init(e){this.setParams(e),this.resetUiToDefaults(!0).then((()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()}))}setParams(e){this.providedFilterParams=e,this.applyActive=Vo(e),this.resetButtonsPanel(e)}updateParams(e){this.providedFilterParams=e,this.applyActive=Vo(e),this.resetUiToActiveModel(this.getModel(),(()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()}))}resetButtonsPanel(e,t){const{buttons:n,readOnly:i}=t??{},{buttons:r,readOnly:s}=e;if(i===s&&zt(n,r))return;const o=r&&r.length>0&&!this.isReadOnly();if(this.eButtonsPanel?(Yr(this.eButtonsPanel),this.buttonListeners.forEach((e=>e())),this.buttonListeners=[]):o&&(this.eButtonsPanel=document.createElement("div"),this.eButtonsPanel.classList.add("ag-filter-apply-panel")),!o)return void(this.eButtonsPanel&&Jr(this.eButtonsPanel));const a=document.createDocumentFragment(),l=e=>{let t,n;switch(e){case"apply":t=this.translate("applyFilter"),n=e=>this.onBtApply(!1,!1,e);break;case"clear":t=this.translate("clearFilter"),n=()=>this.onBtClear();break;case"reset":t=this.translate("resetFilter"),n=()=>this.onBtReset();break;case"cancel":t=this.translate("cancelFilter"),n=e=>{this.onBtCancel(e)};break;default:return void bt("Unknown button type specified")}const i=ts(`<button\n                    type="${"apply"===e?"submit":"button"}"\n                    data-ref="${e}FilterButton"\n                    class="ag-button ag-standard-button ag-filter-apply-panel-button"\n                >${t}\n                </button>`);this.buttonListeners.push(...this.addManagedElementListeners(i,{click:n})),a.append(i)};r.forEach((e=>l(e))),this.eButtonsPanel.append(a),this.getGui().appendChild(this.eButtonsPanel)}getDefaultDebounceMs(){return 0}setupOnBtApplyDebounce(){const e=Uo(this.providedFilterParams,this.getDefaultDebounceMs()),t=Pt(this.checkApplyDebounce.bind(this),e);this.onBtApplyDebounce=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())}getModel(){return this.appliedModel?this.appliedModel:null}setModel(e){return(null!=e?this.setModelIntoUi(e):this.resetUiToDefaults()).then((()=>{this.updateUiVisibility(),this.applyModel("api")}))}onBtCancel(e){this.resetUiToActiveModel(this.getModel(),(()=>{this.handleCancelEnd(e)}))}handleCancelEnd(e){this.providedFilterParams.closeOnApply&&this.close(e)}resetUiToActiveModel(e,t){const n=()=>{this.onUiChanged(!1,"prevent"),t?.()};null!=e?this.setModelIntoUi(e).then(n):this.resetUiToDefaults().then(n)}onBtClear(){this.resetUiToDefaults().then((()=>this.onUiChanged()))}onBtReset(){this.onBtClear(),this.onBtApply()}applyModel(){const e=this.getModelFromUi();if(!this.isModelValid(e))return!1;const t=this.appliedModel;return this.appliedModel=e,!this.areModelsEqual(t,e)}isModelValid(e){return!0}onFormSubmit(e){e.preventDefault()}onBtApply(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;if(n&&n.preventDefault(),this.applyModel(t?"rowDataUpdated":"ui")){const n="columnFilter";this.providedFilterParams.filterChangedCallback({afterFloatingFilter:e,afterDataChange:t,source:n})}const{closeOnApply:i}=this.providedFilterParams;i&&this.applyActive&&!e&&!t&&this.close(n)}onNewRowsLoaded(){}close(e){if(!this.hidePopup)return;const t=e,n=t&&t.key;let i;"Enter"!==n&&"Space"!==n||(i={keyboardEvent:t}),this.hidePopup(i),this.hidePopup=null}onUiChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;if(this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){const e=this.isModelValid(this.getModelFromUi()),t=this.queryForHtmlElement('[data-ref="applyFilterButton"]');t&&Hr(t,!e)}e&&!t||"immediately"===t?this.onBtApply(e):(this.applyActive||t)&&"debounce"!==t||this.onBtApplyDebounce()}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup),this.refreshFilterResizer(e?.container)}refreshFilterResizer(e){if(!this.positionableFeature||"toolPanel"===e)return;const t="floatingFilter"===e||"columnFilter"===e,{positionableFeature:n,gos:i}=this;t?(n.restoreLastSize(),n.setResizable(i.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)}refresh(e){const t=this.providedFilterParams;return this.providedFilterParams=e,this.resetButtonsPanel(e,t),!0}destroy(){const e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),this.appliedModel=null,super.destroy()}translate(e){return this.localeService.getLocaleTextFunc()(e,Go[e])}getCellValue(e){return this.providedFilterParams.getValue(e)}getPositionableElement(){return this.eFilterBody}},jo=class extends Is{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){e.selected&&e.name&&this.eInput.name&&this.eInput.name===e.name&&e.id&&this.eInput.id!==e.id&&this.setValue(!1,!0)}},qo=class extends fs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(`<div class="ag-list ag-${e}-list" role="listbox"></div>`),this.cssIdentifier=e,this.unFocusable=t,this.activeClass="ag-active-item",this.options=[],this.itemEls=[]}postConstruct(){const e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()}),this.unFocusable||this.addManagedElementListeners(e,{keydown:this.handleKeyDown.bind(this)})}handleKeyDown(e){const t=e.key;switch(t){case As.ENTER:if(this.highlightedEl){const e=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(e)}else this.setValue(this.getValue());break;case As.DOWN:case As.UP:e.preventDefault(),this.navigate(t);break;case As.PAGE_DOWN:case As.PAGE_UP:case As.PAGE_HOME:case As.PAGE_END:e.preventDefault(),this.navigateToPage(t)}}navigate(e){const t=e===As.DOWN;let n;if(this.highlightedEl){let e=this.itemEls.indexOf(this.highlightedEl)+(t?1:-1);e=Math.min(Math.max(e,0),this.itemEls.length-1),n=this.itemEls[e]}else n=this.itemEls[t?0:this.itemEls.length-1];this.highlightItem(n)}navigateToPage(e){if(!this.highlightedEl||0===this.itemEls.length)return;const t=this.itemEls.indexOf(this.highlightedEl),n=this.options.length-1,i=this.itemEls[0].clientHeight,r=Math.floor(this.getGui().clientHeight/i);let s=-1;e===As.PAGE_HOME?s=0:e===As.PAGE_END?s=n:e===As.PAGE_DOWN?s=Math.min(t+r,n):e===As.PAGE_UP&&(s=Math.max(t-r,0)),-1!==s&&this.highlightItem(this.itemEls[s])}addOptions(e){return e.forEach((e=>this.addOption(e))),this}addOption(e){const{value:t,text:n}=e,i=n||t;return this.options.push({value:t,text:i}),this.renderOption(t,i),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0),this.itemEls.forEach((e=>{Jr(e)})),this.itemEls=[]}updateIndices(){const e=this.getGui().querySelectorAll(".ag-list-item");e.forEach(((t,n)=>{ur(t,"posinset",n+1),function(e,t){ur(e,"setsize",t)}(t,e.length)}))}renderOption(e,t){const n=en(this.gos),i=n.createElement("div");pr(i,"option"),i.classList.add("ag-list-item",`ag-${this.cssIdentifier}-list-item`);const r=n.createElement("span");i.appendChild(r),r.textContent=t,this.unFocusable||(i.tabIndex=-1),this.itemEls.push(i),this.addManagedListeners(i,{mouseover:()=>this.highlightItem(i),mousedown:t=>{t.preventDefault(),t.stopPropagation(),this.setValue(e)}}),this.createManagedBean(new ds({getTooltipValue:()=>t,getGui:()=>i,getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>r.scrollWidth>r.clientWidth})),this.getGui().appendChild(i)}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(null==e)return this.reset(t),this;const n=this.options.findIndex((t=>t.value===e));if(-1!==n){const e=this.options[n];this.value=e.value,this.displayValue=e.text,this.highlightItem(this.itemEls[n]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const e=this.options.findIndex((e=>e.value===this.value));-1!==e&&this.highlightItem(this.itemEls[e])}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}highlightItem(e){if(!es(e))return;this.clearHighlighted(),this.highlightedEl=e,this.highlightedEl.classList.add(this.activeClass),Mr(this.highlightedEl,!0);const t=this.getGui(),{scrollTop:n,clientHeight:i}=t,{offsetTop:r,offsetHeight:s}=e;(r+s>n+i||r<n)&&this.highlightedEl.scrollIntoView({block:"nearest"}),this.unFocusable||this.highlightedEl.focus()}clearHighlighted(){this.highlightedEl&&es(this.highlightedEl)&&(this.highlightedEl.classList.remove(this.activeClass),Mr(this.highlightedEl,!1),this.highlightedEl=null)}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},Xo=class extends Ds{constructor(e){if(super(e,e?.template||'\n            <div class="ag-picker-field" role="presentation">\n                <div data-ref="eLabel"></div>\n                <div data-ref="eWrapper" class="ag-wrapper ag-picker-field-wrapper ag-picker-collapsed">\n                    <div data-ref="eDisplayField" class="ag-picker-field-display"></div>\n                    <div data-ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                </div>\n            </div>',e?.agComponents||[],e?.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=gs,this.eWrapper=gs,this.eDisplayField=gs,this.eIcon=gs,this.ariaRole=e?.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;const{pickerGap:t,maxPickerHeight:n,variableWidth:i,minPickerWidth:r,maxPickerWidth:s}=e;null!=t&&(this.pickerGap=t),this.variableWidth=!!i,null!=n&&this.setPickerMaxHeight(n),null!=r&&this.setPickerMinWidth(r),null!=s&&this.setPickerMaxWidth(s)}wireBeans(e){this.popupService=e.popupService}postConstruct(){super.postConstruct(),this.setupAria();const e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);const t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});const{pickerIcon:n,inputWidth:i}=this.config;if(n){const e=ys(n,this.gos);e&&this.eIcon.appendChild(e)}null!=i&&this.setInputWidth(i)}setupAria(){const e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),yr(e,!1),this.ariaRole&&pr(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){const t=this.getFocusableElement();if(t!==this.eWrapper&&e?.target===t)return;e.preventDefault(),this.getFocusableElement().focus()}this.skipClick?this.skipClick=!1:this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case As.UP:case As.DOWN:case As.ENTER:case As.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case As.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker())}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));const t=this.localeService.getLocaleTextFunc(),{pickerAriaLabelKey:n,pickerAriaLabelValue:i,modalPicker:r=!0}=this.config,s={modal:r,eChild:e,closeOnEsc:!0,closedCallback:()=>{const e=sn(this.gos);this.beforeHidePicker(),e&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:t(n,i),anchorToElement:this.eWrapper};e.style.position="absolute";const o=this.popupService.addPopup(s),{maxPickerHeight:a,minPickerWidth:l,maxPickerWidth:c,variableWidth:u}=this;u?(l&&(e.style.minWidth=l),e.style.width=ss(qr(this.eWrapper)),c&&(e.style.maxWidth=c)):ns(e,c??qr(this.eWrapper));const h=a??`${Vr(this.popupService.getPopupParent())}px`;return e.style.setProperty("max-height",h),this.alignPickerToComponent(),o.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerType:e}=this.config,{pickerGap:t}=this,n=this.gos.get("enableRtl")?"right":"left";this.popupService.positionPopupByComponent({type:e,eventSource:this.eWrapper,ePopup:this.pickerComponent.getGui(),position:"under",alignSide:n,keepWithinBounds:!0,nudgeY:t})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;yr(this.getAriaElement(),e),this.eWrapper.classList.toggle("ag-picker-expanded",e),this.eWrapper.classList.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){this.pickerComponent?.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker&&this.hideCurrentPicker()}setInputWidth(e){return ns(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return"number"===typeof e&&(e=`${e}px`),this.minPickerWidth=null==e?void 0:e,this}setPickerMaxWidth(e){return"number"===typeof e&&(e=`${e}px`),this.maxPickerWidth=null==e?void 0:e,this}setPickerMaxHeight(e){return"number"===typeof e&&(e=`${e}px`),this.maxPickerHeight=null==e?void 0:e,this}destroy(){this.hidePicker(),super.destroy()}},Ko=class extends Xo{constructor(e){super({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"smallDown",ariaRole:"combobox",...e})}postConstruct(){super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{options:e,value:t,placeholder:n}=this.config;null!=e&&this.addOptions(e),null!=t&&this.setValue(t,!0),n&&null==t&&(this.eDisplayField.textContent=n),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){this.listComponent=this.createBean(new qo("select",!0)),this.listComponent.setParentComponent(this);const e=this.listComponent.getAriaElement(),t=`ag-select-list-${this.listComponent.getCompId()}`;var n,i;e.setAttribute("id",t),cr(n=this.getAriaElement(),"controls",(i=e).id),fr(i,n.id),this.listComponent.addManagedListeners(this.listComponent,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})}}),this.listComponent.addManagedListeners(this.listComponent,{fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}onKeyDown(e){const{key:t}=e;switch(t===As.TAB&&this.hidePicker(),t){case As.ENTER:case As.UP:case As.DOWN:case As.PAGE_UP:case As.PAGE_DOWN:case As.PAGE_HOME:case As.PAGE_END:e.preventDefault(),this.isPickerDisplayed?this.listComponent?.handleKeyDown(e):super.onKeyDown(e);break;case As.ESCAPE:super.onKeyDown(e);break;case As.SPACE:this.isPickerDisplayed?e.preventDefault():super.onKeyDown(e)}}showPicker(){this.listComponent&&(super.showPicker(),this.listComponent.refreshHighlighted())}addOptions(e){return e.forEach((e=>this.addOption(e))),this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){return this.listComponent?.clearOptions(),this}setValue(e,t,n){if(this.value===e||!this.listComponent)return this;n||this.listComponent.setValue(e,!0);if(this.listComponent.getValue()===this.getValue())return this;let i=this.listComponent.getDisplayValue();return null==i&&this.config.placeholder&&(i=this.config.placeholder),this.eDisplayField.textContent=i,this.setTooltip({newTooltipText:i??null,shouldDisplayTooltip:()=>this.eDisplayField.scrollWidth>this.eDisplayField.clientWidth}),super.setValue(e,t)}destroy(){this.listComponent&&(this.listComponent=this.destroyBean(this.listComponent)),super.destroy()}},$o={selector:"AG-SELECT",component:Ko},Zo=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions||t,this.mapCustomOptions(),this.selectDefaultItem(e)}getFilterOptions(){return this.filterOptions}mapCustomOptions(){this.filterOptions&&this.filterOptions.forEach((e=>{if("string"===typeof e)return;[["displayKey"],["displayName"],["predicate","test"]].every((t=>!!t.some((t=>null!=e[t]))||(bt(`ignoring FilterOptionDef as it doesn't contain one of '${t}'`),!1)))?this.customFilterOptions[e.displayKey]=e:this.filterOptions=this.filterOptions.filter((t=>t===e))||[]}))}selectDefaultItem(e){if(e.defaultOption)this.defaultOption=e.defaultOption;else if(this.filterOptions.length>=1){const e=this.filterOptions[0];"string"===typeof e?this.defaultOption=e:e.displayKey?this.defaultOption=e.displayKey:bt("invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else bt("no filter options for filter")}getDefaultOption(){return this.defaultOption}getCustomOption(e){return this.customFilterOptions[e]}},Yo=class extends Wo{constructor(){super(...arguments),this.eTypes=[],this.eJoinOperatorPanels=[],this.eJoinOperatorsAnd=[],this.eJoinOperatorsOr=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}getNumberOfInputs(e){const t=this.optionsFactory.getCustomOption(e);if(t){const{numberOfInputs:e}=t;return null!=e?e:1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:"inRange"===e?2:1}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged(!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach(((t,n)=>{0===n?t.setValue(e,!0):t.setValue(this.optionsFactory.getDefaultOption(),!0)}))}getModelFromUi(){const e=this.getUiCompleteConditions();return 0===e.length?null:this.maxNumConditions>1&&e.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map((e=>e.getValue()))}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){return 0===this.eJoinOperatorsOr.length?this.defaultJoinOperator:!0===this.eJoinOperatorsOr[0].getValue()?"OR":"AND"}areModelsEqual(e,t){if(!e&&!t)return!0;if(!e&&t||e&&!t)return!1;const n=!e.operator,i=!t.operator;if(!n&&i||n&&!i)return!1;let r;if(n){const n=e,i=t;r=this.areSimpleModelsEqual(n,i)}else{const n=e,i=t;r=n.operator===i.operator&&Tn(n.conditions,i.conditions,((e,t)=>this.areSimpleModelsEqual(e,t)))}return r}shouldRefresh(e){const t=this.getModel(),n=t?t.conditions??[t]:null,i=e.filterOptions?.map((e=>"string"===typeof e?e:e.displayKey))??this.getDefaultFilterOptions();return!(n&&!n.every((e=>void 0!==i.find((t=>t===e.type)))))&&!("number"===typeof e.maxNumConditions&&n&&n.length>e.maxNumConditions)}refresh(e){if(!this.shouldRefresh(e))return!1;return!!super.refresh(e)&&(this.setParams(e),this.removeConditionsAndOperators(0),this.createOption(),this.setModel(this.getModel()),!0)}setModelIntoUi(e){if(e.operator){const t=e;let n=t.conditions;null==n&&(n=[],bt("Filter model is missing 'conditions'"));const i=this.validateAndUpdateConditions(n),r=this.getNumConditions();if(i<r)this.removeConditionsAndOperators(i);else if(i>r)for(let e=r;e<i;e++)this.createJoinOperatorPanel(),this.createOption();const s="OR"===t.operator;this.eJoinOperatorsAnd.forEach((e=>e.setValue(!s,!0))),this.eJoinOperatorsOr.forEach((e=>e.setValue(s,!0))),n.forEach(((e,t)=>{this.eTypes[t].setValue(e.type,!0),this.setConditionIntoUi(e,t)}))}else{const t=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(t.type,!0),this.setConditionIntoUi(t,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),Xs.resolve()}validateAndUpdateConditions(e){let t=e.length;return t>this.maxNumConditions&&(e.splice(this.maxNumConditions),bt('Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.'),t=this.maxNumConditions),t}doesFilterPass(e){const t=this.getModel();if(null==t)return!0;const{operator:n}=t,i=[];if(n){const e=t;i.push(...e.conditions??[])}else i.push(t);return i[n&&"OR"===n?"some":"every"]((t=>this.individualConditionPasses(e,t)))}setParams(e){super.setParams(e),this.setNumConditions(e),this.defaultJoinOperator=this.getDefaultJoinOperator(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.optionsFactory=new Zo,this.optionsFactory.init(e,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators(),this.isReadOnly()&&this.eFilterBody.setAttribute("tabindex","-1")}setNumConditions(e){this.maxNumConditions=e.maxNumConditions??2,this.maxNumConditions<1&&(bt('"filterParams.maxNumConditions" must be greater than or equal to zero.'),this.maxNumConditions=1),this.numAlwaysVisibleConditions=e.numAlwaysVisibleConditions??1,this.numAlwaysVisibleConditions<1&&(bt('"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.'),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(bt('"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".'),this.numAlwaysVisibleConditions=this.maxNumConditions)}createOption(){const e=this.createManagedBean(new Ko);this.eTypes.push(e),e.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(e.getGui());const t=this.createValueElement();this.eConditionBodies.push(t),this.eFilterBody.appendChild(t),this.putOptionsIntoDropdown(e),this.resetType(e);const n=this.getNumConditions()-1;this.forEachPositionInput(n,(e=>this.resetInput(e))),this.addChangedListeners(e,n)}createJoinOperatorPanel(){const e=document.createElement("div");this.eJoinOperatorPanels.push(e),e.classList.add("ag-filter-condition");const t=this.createJoinOperator(this.eJoinOperatorsAnd,e,"and"),n=this.createJoinOperator(this.eJoinOperatorsOr,e,"or");this.eFilterBody.appendChild(e);const i=this.eJoinOperatorPanels.length-1,r=this.joinOperatorId++;this.resetJoinOperatorAnd(t,i,r),this.resetJoinOperatorOr(n,i,r),this.isReadOnly()||(t.onValueChange(this.listener),n.onValueChange(this.listener))}createJoinOperator(e,t,n){const i=this.createManagedBean(new jo);return e.push(i),i.addCssClass("ag-filter-condition-operator"),i.addCssClass(`ag-filter-condition-operator-${n}`),t.appendChild(i.getGui()),i}getDefaultJoinOperator(e){return"AND"===e||"OR"===e?e:"AND"}createFilterListOptions(){const e=this.optionsFactory.getFilterOptions();this.filterListOptions=e.map((e=>"string"===typeof e?this.createBoilerplateListOption(e):this.createCustomListOption(e)))}putOptionsIntoDropdown(e){this.filterListOptions.forEach((t=>{e.addOption(t)})),e.setDisabled(this.filterListOptions.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){const{displayKey:t}=e,n=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:n?this.localeService.getLocaleTextFunc()(n.displayKey,n.displayName):this.translate(t)}}createBodyTemplate(){return""}getAgComponents(){return[]}getCssIdentifier(){return"simple-filter"}updateUiVisibility(){const e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let n=0;n<this.getNumConditions();n++)this.isConditionUiComplete(n)?e=n:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{const t=this.lastUiCompletePosition??this.getNumConditions()-2;if(e<t){this.removeConditionsAndOperators(t+1);const n=e+1,i=t-n;i>0&&this.removeConditionsAndOperators(n,i),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach(((t,n)=>{const i=this.isConditionDisabled(n,e);t.setDisabled(i||this.filterListOptions.length<=1),1===n&&(Hr(this.eJoinOperatorPanels[0],i),this.eJoinOperatorsAnd[0].setDisabled(i),this.eJoinOperatorsOr[0].setDisabled(i))})),this.eConditionBodies.forEach(((e,t)=>{zr(e,this.isConditionBodyVisible(t))}));const n="OR"===(t??this.getJoinOperator());this.eJoinOperatorsAnd.forEach((e=>{e.setValue(!n,!0)})),this.eJoinOperatorsOr.forEach((e=>{e.setValue(n,!0)})),this.forEachInput(((t,n,i,r)=>{this.setElementDisplayed(t,n<r),this.setElementDisabled(t,this.isConditionDisabled(i,e))})),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;this.removeComponents(this.eTypes,e,t),this.removeElements(this.eConditionBodies,e,t),this.removeValueElements(e,t);const n=Math.max(e-1,0);this.removeElements(this.eJoinOperatorPanels,n,t),this.removeComponents(this.eJoinOperatorsAnd,n,t),this.removeComponents(this.eJoinOperatorsOr,n,t)}removeElements(e,t,n){this.removeItems(e,t,n).forEach((e=>Jr(e)))}removeComponents(e,t,n){this.removeItems(e,t,n).forEach((e=>{Jr(e.getGui()),this.destroyBean(e)}))}removeItems(e,t,n){return null==n?e.splice(t):e.splice(t,n)}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!e?.suppressFocus)if(this.isReadOnly())this.eFilterBody.focus();else{const e=this.getInputs(0)[0];if(!e)return;e instanceof Ls&&e.getInputElement().focus()}}afterGuiDetached(){super.afterGuiDetached();const e=this.getModel();this.resetUiToActiveModel(e);let t=-1,n=-1,i=!1;const r=this.getJoinOperator();for(let o=this.getNumConditions()-1;o>=0;o--)if(this.isConditionUiComplete(o))-1===t&&(t=o,n=o);else{const e=o<t;(o>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(o-1)||e)&&(this.removeConditionsAndOperators(o,1),i=!0,e&&n--)}let s=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),s=!0),this.shouldAddNewConditionAtEnd(n===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),s=!0),s&&this.updateConditionStatusesAndValues(n,r),i&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=n}getPlaceholderText(e,t){let n=this.translate(e);if(_t(this.filterPlaceholder)){const e=this.filterPlaceholder,i=this.eTypes[t].getValue();n=e({filterOptionKey:i,filterOption:this.translate(i),placeholder:n})}else"string"===typeof this.filterPlaceholder&&(n=this.filterPlaceholder);return n}resetPlaceholder(){const e=this.localeService.getLocaleTextFunc();this.forEachInput(((t,n,i,r)=>{if(!(t instanceof Ls))return;const s=0===n&&r>1?"inRangeStart":0===n?"filterOoo":"inRangeEnd",o=0===n&&r>1?e("ariaFilterFromValue","Filter from value"):0===n?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");t.setInputPlaceholder(this.getPlaceholderText(s,i)),t.setInputAriaLabel(o)}))}setElementValue(e,t,n){e instanceof Ls&&e.setValue(null!=t?String(t):null,!0)}setElementDisplayed(e,t){e instanceof fs&&zr(e.getGui(),t)}setElementDisabled(e,t){e instanceof fs&&Hr(e.getGui(),t)}attachElementOnChange(e,t){e instanceof Ls&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach(((t,n)=>{this.forEachPositionTypeInput(n,t,e)}))}forEachPositionInput(e,t){const n=this.getConditionType(e);this.forEachPositionTypeInput(e,n,t)}forEachPositionTypeInput(e,t,n){const i=this.getNumberOfInputs(t),r=this.getInputs(e);for(let s=0;s<r.length;s++){const t=r[s];null!=t&&n(t,s,e,i)}}isConditionDisabled(e,t){return!!this.isReadOnly()||0!==e&&e>t+1}isConditionBodyVisible(e){const t=this.getConditionType(e);return this.getNumberOfInputs(t)>0}isConditionUiComplete(e){if(e>=this.getNumConditions())return!1;return"empty"!==this.getConditionType(e)&&!this.getValues(e).some((e=>null==e))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach((e=>this.resetType(e))),this.eJoinOperatorsAnd.forEach(((e,t)=>this.resetJoinOperatorAnd(e,t,this.joinOperatorId+t))),this.eJoinOperatorsOr.forEach(((e,t)=>this.resetJoinOperatorOr(e,t,this.joinOperatorId+t))),this.joinOperatorId++,this.forEachInput((e=>this.resetInput(e))),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,e||this.onUiChanged(),Xs.resolve()}resetType(e){const t=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(t).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,n){this.resetJoinOperator(e,t,this.isDefaultOperator("AND"),this.translate("andCondition"),n)}resetJoinOperatorOr(e,t,n){this.resetJoinOperator(e,t,this.isDefaultOperator("OR"),this.translate("orCondition"),n)}resetJoinOperator(e,t,n,i,r){this.updateJoinOperatorDisabled(e.setValue(n,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${r}`).setLabel(i),t)}updateJoinOperatorsDisabled(){this.eJoinOperatorsAnd.forEach(((e,t)=>this.updateJoinOperatorDisabled(e,t))),this.eJoinOperatorsOr.forEach(((e,t)=>this.updateJoinOperatorDisabled(e,t)))}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){const n=this.mapValuesFromModel(e);this.forEachInput(((e,i,r)=>{r===t&&this.setElementValue(e,null!=n[i]?n[i]:null)}))}setValueFromFloatingFilter(e){this.forEachInput(((t,n,i)=>{this.setElementValue(t,0===n&&0===i?e:null,!0)}))}isDefaultOperator(e){return e===this.defaultJoinOperator}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,(e=>{this.attachElementOnChange(e,this.listener)})))}individualConditionPasses(e,t){const n=this.getCellValue(e.node),i=this.mapValuesFromModel(t),r=this.optionsFactory.getCustomOption(t.type),s=this.evaluateCustomFilter(r,i,n);return null!=s?s:null==n?this.evaluateNullValue(t.type):this.evaluateNonNullValue(i,n,t,e)}evaluateCustomFilter(e,t,n){if(null==e)return;const{predicate:i}=e;return null==i||t.some((e=>null==e))?void 0:i(t,n)}isBlank(e){return null==e||"string"===typeof e&&0===e.trim().length}hasInvalidInputs(){return!1}},Jo=class extends Yo{setParams(e){super.setParams(e),this.scalarFilterParams=e}evaluateNullValue(e){switch(e){case"equals":if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case"notEqual":if(this.scalarFilterParams.includeBlanksInNotEqual)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case"lessThan":case"lessThanOrEqual":if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case"inRange":if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,n){const i=this.comparator(),r=null!=e[0]?i(e[0],t):0;switch(n.type){case"equals":return 0===r;case"notEqual":return 0!==r;case"greaterThan":return r>0;case"greaterThanOrEqual":return r>=0;case"lessThan":return r<0;case"lessThanOrEqual":return r<=0;case"inRange":{const n=i(e[1],t);return this.scalarFilterParams.inRangeInclusive?r>=0&&n<=0:r>0&&n<0}case"blank":return this.isBlank(t);case"notBlank":return!this.isBlank(t);default:return bt('Unexpected type of filter "'+n.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}}};function Qo(e){if(e.altKey||e.ctrlKey||e.metaKey)return!1;return 1===e.key?.length}function ea(e,t,n,i,r){const s=i?i.getColDef().suppressKeyboardEvent:void 0;if(!s)return!1;const o=e.addGridCommonParams({event:t,editing:r,column:i,node:n,data:n.data,colDef:i.getColDef()});if(s){if(s(o))return!0}return!1}var ta=class extends Ls{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ag-text-field",arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text")}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){return this.eInput.value!==e&&(this.eInput.value=Dt(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){const e=new RegExp(`[${this.config.allowedCharPattern}]`);this.addManagedListeners(this.eInput,{keydown:t=>{Qo(t)&&t.key&&!e.test(t.key)&&t.preventDefault()},paste:t=>{const n=t.clipboardData?.getData("text");n&&n.split("").some((t=>!e.test(t)))&&t.preventDefault()}})}},na={selector:"AG-INPUT-TEXT-FIELD",component:ta},ia=class extends ta{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct(),this.addManagedListeners(this.eInput,{blur:()=>{const e=parseFloat(this.eInput.value),t=isNaN(e)?"":this.normalizeValue(e.toString());this.value!==t&&this.setValue(t)},wheel:this.onWheel.bind(this)}),this.eInput.step="any";const{precision:e,min:t,max:n,step:i}=this.config;"number"===typeof e&&this.setPrecision(e),"number"===typeof t&&this.setMin(t),"number"===typeof n&&this.setMax(n),"number"===typeof i&&this.setStep(i)}onWheel(e){rn(this.gos)===this.eInput&&e.preventDefault()}normalizeValue(e){if(""===e)return"";null!=this.precision&&(e=this.adjustPrecision(e));const t=parseFloat(e);return null!=this.min&&t<this.min?e=this.min.toString():null!=this.max&&t>this.max&&(e=this.max.toString()),e}adjustPrecision(e,t){if(null==this.precision)return e;if(t){const t=parseFloat(e).toFixed(this.precision);return parseFloat(t).toString()}const n=String(e).split(".");if(n.length>1){if(n[1].length<=this.precision)return e;if(this.precision>0)return`${n[0]}.${n[1].slice(0,this.precision)}`}return n[0]}setMin(e){return this.min===e||(this.min=e,as(this.eInput,"min",e)),this}setMax(e){return this.max===e||(this.max=e,as(this.eInput,"max",e)),this}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e||(this.step=e,as(this.eInput,"step",e)),this}setValue(e,t){return this.setValueOrInputValue((e=>super.setValue(e,t)),(()=>this),e)}setStartValue(e){return this.setValueOrInputValue((e=>super.setValue(e,!0)),(e=>{this.eInput.value=e}),e)}setValueOrInputValue(e,t,n){if(Dt(n)){let i=this.isScientificNotation(n);if(i&&this.eInput.validity.valid)return e(n);if(!i){i=(n=this.adjustPrecision(n))!=this.normalizeValue(n)}if(i)return t(n)}return e(n)}getValue(){if(!this.eInput.validity.valid)return;const e=this.eInput.value;return this.isScientificNotation(e)?this.adjustPrecision(e,!0):super.getValue()}isScientificNotation(e){return"string"===typeof e&&e.includes("e")}},ra={selector:"AG-INPUT-NUMBER-FIELD",component:ia},sa=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"],oa=class{constructor(e,t,n){this.localeService=e,this.optionsFactory=t,this.valueFormatter=n}getModelAsString(e){if(!e)return null;const t=null!=e.operator,n=this.localeService.getLocaleTextFunc();if(t){const t=e,i=(t.conditions??[]).map((e=>this.getModelAsString(e))),r="AND"===t.operator?"andCondition":"orCondition";return i.join(` ${n(r,Go[r])} `)}if("blank"===e.type||"notBlank"===e.type)return n(e.type,e.type);{const t=e,i=this.optionsFactory.getCustomOption(t.type),{displayKey:r,displayName:s,numberOfInputs:o}=i||{};return r&&s&&0===o?(n(r,s),s):this.conditionToString(t,i)}}updateParams(e){this.optionsFactory=e.optionsFactory}formatValue(e){return this.valueFormatter?this.valueFormatter(e??null)??"":String(e)}},aa=class extends oa{conditionToString(e,t){const{numberOfInputs:n}=t||{};return"inRange"==e.type||2===n?`${this.formatValue(e.filter)}-${this.formatValue(e.filterTo)}`:null!=e.filter?this.formatValue(e.filter):`${e.type}`}};function la(e){const{allowedCharPattern:t}=e??{};return t??null}var ca=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],ua=class extends oa{conditionToString(e,t){const{numberOfInputs:n}=t||{};return"inRange"==e.type||2===n?`${e.filter}-${e.filterTo}`:null!=e.filter?`${e.filter}`:`${e.type}`}};function ha(e){const t=e&&e.trim();return""===t?e:t}function da(e){if("number"===typeof e)return e;if("string"===typeof e){const t=parseInt(e);if(isNaN(t))return;return t}}function pa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;return n=>{const i=da(n);if(!(null==i||i<e||i>t))return i}}function ga(e,t){return e.toString().padStart(t,"0")}function fa(e,t,n){return"number"!==typeof e?"":e.toString().replace(".",n).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${t}`)}function ma(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-";if(!e)return null;let i=[e.getFullYear(),e.getMonth()+1,e.getDate()].map((e=>ga(e,2))).join(n);return t&&(i+=" "+[e.getHours(),e.getMinutes(),e.getSeconds()].map((e=>ga(e,2))).join(":")),i}var va=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function ya(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";const n=ga(e.getFullYear(),4),i=["January","February","March","April","May","June","July","August","September","October","November","December"],r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s={YYYY:()=>n.slice(n.length-4,n.length),YY:()=>n.slice(n.length-2,n.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>i[e.getMonth()],MMM:()=>i[e.getMonth()].slice(0,3),MM:()=>ga(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${va(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${va(e.getDate())}`,DD:()=>ga(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>r[e.getDay()],ddd:()=>r[e.getDay()].slice(0,3),dd:()=>r[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${va(e.getDay())}`,d:()=>`${e.getDay()}`},o=new RegExp(Object.keys(s).join("|"),"g");return t.replace(o,(e=>e in s?s[e]():e))}function Ca(e){if(!e)return null;const[t,n]=e.split(" ");if(!t)return null;const i=t.split("-").map((e=>parseInt(e,10)));if(3!==i.filter((e=>!isNaN(e))).length)return null;const[r,s,o]=i,a=new Date(r,s-1,o);if(a.getFullYear()!==r||a.getMonth()!==s-1||a.getDate()!==o)return null;if(!n||"00:00:00"===n)return a;const[l,c,u]=n.split(":").map((e=>parseInt(e,10)));return l>=0&&l<24&&a.setHours(l),c>=0&&c<60&&a.setMinutes(c),u>=0&&u<60&&a.setSeconds(u),a}var wa=class{constructor(e,t,n,i,r){this.alive=!0,this.context=e,this.eParent=i;t.getDateCompDetails(n).newAgStackInstance().then((t=>{this.alive?(this.dateComp=t,t&&(i.appendChild(t.getGui()),t.afterGuiAttached&&t.afterGuiAttached(),this.tempValue&&t.setDate(this.tempValue),null!=this.disabled&&this.setDateCompDisabled(this.disabled),r?.(this))):e.destroyBean(t)}))}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){this.dateComp?this.dateComp.setDate(e):this.tempValue=e}setDisabled(e){this.dateComp?this.setDateCompDisabled(e):this.disabled=e}setDisplayed(e){zr(this.eParent,e)}setInputPlaceholder(e){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(e)}setInputAriaLabel(e){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(e)}afterGuiAttached(e){this.dateComp&&"function"===typeof this.dateComp.afterGuiAttached&&this.dateComp.afterGuiAttached(e)}updateParams(e){let t=!1;if(this.dateComp?.refresh&&"function"===typeof this.dateComp.refresh){null!==this.dateComp.refresh(e)&&(t=!0)}if(!t&&this.dateComp?.onParamsUpdated&&"function"===typeof this.dateComp.onParamsUpdated){null!==this.dateComp.onParamsUpdated(e)&&bt("Custom date component method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")}}setDateCompDisabled(e){null!=this.dateComp&&null!=this.dateComp.setDisabled&&this.dateComp.setDisabled(e)}},Sa=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"],ba=class extends oa{constructor(e,t,n){super(t,n),this.dateFilterParams=e}conditionToString(e,t){const{type:n}=e,{numberOfInputs:i}=t||{},r="inRange"==n||2===i,s=Ca(e.dateFrom),o=Ca(e.dateTo),a=this.dateFilterParams.inRangeFloatingFilterDateFormat;if(r){return`${null!==s?ya(s,a):"null"}-${null!==o?ya(o,a):"null"}`}return null!=s?ya(s,a):`${n}`}updateParams(e){super.updateParams(e),this.dateFilterParams=e.dateFilterParams}},xa=1/0,_a=class extends Vn{constructor(e,t,n,i){super(),this.columnOrGroup=e,this.columnOrGroup=e,this.eCell=t,this.ariaEl=this.eCell.querySelector("[role=columnheader]")||this.eCell,this.colsSpanning=i,this.beans=n}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){return this.beans.gos.get("enableRtl")&&this.colsSpanning?Rn(this.colsSpanning):this.columnOrGroup}postConstruct(){const e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){const e=this.beans.gos.get("suppressColumnMoveAnimation"),t=Dt(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&t&&!e?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=e.getLeft(),n=e.getOldLeft(),i=this.modifyLeftForPrintLayout(e,n),r=this.modifyLeftForPrintLayout(e,t);this.setLeft(i),this.actualLeft=r,this.beans.columnAnimationService.executeNextVMTurn((()=>{this.actualLeft===r&&this.setLeft(r)}))}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){if(!jt(this.beans.gos,"print"))return t;if("left"===e.getPinned())return t;const n=this.beans.visibleColsService.getColsLeftWidth();if("right"===e.getPinned()){return n+this.beans.visibleColsService.getBodyContainerWidth()+t}return n+t}setLeft(e){if(Dt(e)&&(this.eCell.style.left=`${e}px`),Ni(this.columnOrGroup)){const e=this.columnOrGroup.getLeafColumns();if(!e.length)return;e.length>1&&(t=this.ariaEl,n=e.length,ur(t,"colspan",n))}var t,n}};function Ma(e,t,n,i){return Lt(e)?[]:Ra(e.headerClass,e,t,n,i)}function Ea(e,t,n){e.addOrRemoveCssClass("ag-column-first",n.isColAtEdge(t,"first")),e.addOrRemoveCssClass("ag-column-last",n.isColAtEdge(t,"last"))}function Ra(e,t,n,i,r){if(Lt(e))return[];let s;if("function"===typeof e){const o=function(e,t,n,i){return t.addGridCommonParams({colDef:e,column:n,columnGroup:i})}(t,n,i,r);s=e(o)}else s=e;return"string"===typeof s?[s]:Array.isArray(s)?[...s]:[]}var Ta=0,Pa=class e extends Vn{constructor(e,t,n){super(),this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.columnGroupChild=e,this.parentRowCtrl=n,this.beans=t,this.instanceId=e.getUniqueId()+"-"+Ta++}wireBeans(e){this.pinnedWidthService=e.pinnedWidthService,this.focusService=e.focusService,this.userComponentFactory=e.userComponentFactory,this.ctrlsService=e.ctrlsService,this.dragAndDropService=e.dragAndDropService,this.menuService=e.menuService}postConstruct(){const e=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],e),this.addManagedEventListeners({overlayExclusiveChanged:e})}shouldStopEventPropagation(e){const{headerRowIndex:t,column:n}=this.focusService.getFocusedHeader();return function(e,t,n,i){const r=i.getDefinition(),s=r&&r.suppressHeaderKeyboardEvent;return!!Dt(s)&&!!s(e.addGridCommonParams({colDef:r,column:i,headerRowIndex:n,event:t}))}(this.gos,e,t,n)}getWrapperHasFocus(){return rn(this.gos)===this.eGui}setGui(e,t){this.eGui=e,this.addDomData(t),t.addManagedListeners(this.beans.eventService,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),t.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}onGuiFocus(){this.eventService.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(e){const{wrapperElement:t,checkMeasuringCallback:n,compBean:i}=e,{animationFrameService:r,resizeObserverService:s,columnModel:o,gos:a}=this.beans,l=e=>{if(!this.isAlive()||!i.isAlive())return;const{paddingTop:n,paddingBottom:s,borderBottomWidth:c,borderTopWidth:u}=Ur(this.getGui()),h=n+s+c+u,d=t.offsetHeight+h;if(e<5){const n=en(a);if(!n||!n.contains(t)||0==d)return void r.requestAnimationFrame((()=>l(e+1)))}o.setColHeaderHeight(this.column,d)};let c,u=!1;const h=()=>{const e=this.column.isAutoHeaderHeight();e&&!u&&d(),!e&&u&&p()},d=()=>{u=!0,l(0),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),c=s.observeResize(t,(()=>l(0)))},p=()=>{u=!1,c&&c(),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),c=void 0};h(),i.addDestroyFunc((()=>p())),i.addManagedListeners(this.column,{widthChanged:()=>u&&l(0)}),i.addManagedEventListeners({sortChanged:()=>{u&&window.setTimeout((()=>l(0)))}}),n&&n(h)}onDisplayedColumnsChanged(){const{comp:e,column:t,beans:n,eGui:i}=this;e&&t&&i&&(Ea(e,t,n.visibleColsService),br(i,n.visibleColsService.getAriaColIndex(t)))}addResizeAndMoveKeyboardListeners(e){this.resizeFeature&&e.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){const e=this.focusService.isHeaderFocusSuppressed();this.eGui&&as(this.eGui,"tabindex",e?null:"-1")}onGuiKeyDown(e){const t=rn(this.gos),n=e.key===As.LEFT||e.key===As.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),t!==this.eGui||!e.shiftKey&&!e.altKey)return;if((this.isResizing||n)&&(e.preventDefault(),e.stopImmediatePropagation()),!n)return;const i=e.key===As.LEFT!==this.gos.get("enableRtl"),r=bo[i?"Left":"Right"];if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const t=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(t,e.shiftKey),this.resizeFeature?.toggleColumnResizing(!0)}else this.moveHeader(r)}getViewportAdjustedResizeDiff(e){let t=this.getResizeDiff(e);if(this.column.getPinned()){const e=this.pinnedWidthService.getPinnedLeftWidth(),n=this.pinnedWidthService.getPinnedRightWidth(),i=Wr(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50;if(e+n+t>i){if(!(i>e+n))return 0;t=i-e-n}}return t}getResizeDiff(e){let t=e.key===As.LEFT!==this.gos.get("enableRtl");const n=this.column.getPinned(),i=this.gos.get("enableRtl");return n&&i!==("right"===n)&&(t=!t),(t?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout((()=>{this.resizeFeature?.toggleColumnResizing(!1)}),150))}handleKeyDown(e){const t=this.getWrapperHasFocus();switch(e.key){case As.PAGE_DOWN:case As.PAGE_UP:case As.PAGE_HOME:case As.PAGE_END:t&&e.preventDefault()}}addDomData(t){const n=e.DOM_DATA_KEY_HEADER_CTRL;Qt(this.gos,this.eGui,n,this),t.addDestroyFunc((()=>Qt(this.gos,this.eGui,n,null)))}getGui(){return this.eGui}focus(e){return!!this.eGui&&(this.lastFocusEvent=e||null,this.eGui.focus(),!0)}getRowIndex(){return this.parentRowCtrl.getRowIndex()}getParentRowCtrl(){return this.parentRowCtrl}getPinned(){return this.parentRowCtrl.getPinned()}getColumnGroupChild(){return this.columnGroupChild}removeDragSource(){this.dragSource&&(this.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,t,n){const i=e??t;this.gos.get("preventDefaultOnContextMenu")&&i.preventDefault(),this.menuService.isHeaderContextMenuEnabled(n)&&this.menuService.showHeaderContextMenu(n,e,t),this.dispatchColumnMouseEvent("columnHeaderContextMenu",n)}dispatchColumnMouseEvent(e,t){this.eventService.dispatchEvent({type:e,column:t})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.columnGroupChild=null,this.parentRowCtrl=null}};Pa.DOM_DATA_KEY_HEADER_CTRL="headerCtrl";var Aa=Pa,Fa=class extends Vn{wireBeans(e){this.columnHoverService=e.columnHoverService}constructor(e,t){super(),this.columns=e,this.element=t}postConstruct(){this.gos.get("columnHoverHighlight")&&this.addMouseHoverListeners()}addMouseHoverListeners(){this.addManagedListeners(this.element,{mouseout:this.onMouseOut.bind(this),mouseover:this.onMouseOver.bind(this)})}onMouseOut(){this.columnHoverService.clearMouseOver()}onMouseOver(){this.columnHoverService.setMouseOver(this.columns)}};var Da="32.3.3";var La={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},Ia=["january","february","march","april","may","june","july","august","september","october","november","december"];var ka=class extends fs{wireBeans(e){this.columnNameService=e.columnNameService}getDefaultDebounceMs(){return 0}destroy(){super.destroy()}isEventFromFloatingFilter(e){return e&&e.afterFloatingFilter}isEventFromDataChange(e){return e?.afterDataChange}getLastType(){return this.lastType}isReadOnly(){return this.readOnly}setLastTypeFromModel(e){if(!e)return void(this.lastType=this.optionsFactory.getDefaultOption());let t;if(e.operator){t=e.conditions[0]}else t=e;this.lastType=t.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;const t=e;return this.isTypeEditable(t.type)}init(e){this.setSimpleParams(e,!1)}setSimpleParams(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.optionsFactory=new Zo,this.optionsFactory.init(e.filterParams,this.getDefaultFilterOptions()),t||(this.lastType=this.optionsFactory.getDefaultOption()),this.readOnly=!!e.filterParams.readOnly;const n=this.isTypeEditable(this.optionsFactory.getDefaultOption());this.setEditable(n)}onParamsUpdated(e){this.refresh(e)}refresh(e){this.setSimpleParams(e)}doesFilterHaveSingleInput(e){const t=this.optionsFactory.getCustomOption(e),{numberOfInputs:n}=t||{};return null==n||1==n}isTypeEditable(e){return!!e&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(e)&&["inRange","empty","blank","notBlank"].indexOf(e)<0}getAriaLabel(e){return`${this.columnNameService.getDisplayNameForColumn(e.column,"header",!0)} ${this.localeService.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}},Oa=class extends Vn{constructor(e){super(),this.params=e,this.eFloatingFilterTextInput=gs,this.valueChangedListener=()=>{}}setupGui(e){this.eFloatingFilterTextInput=this.createManagedBean(new ta(this.params?.config));const t=this.eFloatingFilterTextInput.getGui();e.appendChild(t);const n=e=>this.valueChangedListener(e);this.addManagedListeners(t,{input:n,keydown:n})}setEditable(e){this.eFloatingFilterTextInput.setDisabled(!e)}setAutoComplete(e){this.eFloatingFilterTextInput.setAutoComplete(e)}getValue(){return this.eFloatingFilterTextInput.getValue()}setValue(e,t){this.eFloatingFilterTextInput.setValue(e,t)}setValueChangedListener(e){this.valueChangedListener=e}setParams(e){this.setAriaLabel(e.ariaLabel),void 0!==e.autoComplete&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eFloatingFilterTextInput.setInputAriaLabel(e)}},Na=class extends ka{constructor(){super(...arguments),this.eFloatingFilterInputContainer=gs}postConstruct(){this.setTemplate('\n            <div class="ag-floating-filter-input" role="presentation" data-ref="eFloatingFilterInputContainer"></div>\n        ')}getDefaultDebounceMs(){return 500}onParentModelChanged(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(e)))}init(e){this.setupFloatingFilterInputService(e),super.init(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.floatingFilterInputService=this.createFloatingFilterInputService(e),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){this.params=e;const t=e.browserAutoComplete??!1;if(this.floatingFilterInputService.setParams({ariaLabel:this.getAriaLabel(e),autoComplete:t}),this.applyActive=Vo(this.params.filterParams),!this.isReadOnly()){const e=Uo(this.params.filterParams,this.getDefaultDebounceMs()),t=Pt(this.syncUpWithParentFilter.bind(this),e);this.floatingFilterInputService.setValueChangedListener(t)}}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){const t=this.floatingFilterInputService.getValue();Yr(this.eFloatingFilterInputContainer),this.destroyBean(this.floatingFilterInputService),this.setupFloatingFilterInputService(e),this.floatingFilterInputService.setValue(t,!0)}syncUpWithParentFilter(e){const t=e.key===As.ENTER;if(this.applyActive&&!t)return;let n=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(n=ha(n),this.floatingFilterInputService.setValue(n,!0)),this.params.parentFilterInstance((e=>{e&&e.onFloatingFilterChanged(this.getLastType()||null,n||null)}))}setEditable(e){this.floatingFilterInputService.setEditable(e)}},Ba=class extends Vn{constructor(){super(...arguments),this.valueChangedListener=()=>{},this.numberInputActive=!0}setupGui(e){this.eFloatingFilterNumberInput=this.createManagedBean(new ia),this.eFloatingFilterTextInput=this.createManagedBean(new ta),this.eFloatingFilterTextInput.setDisabled(!0);const t=this.eFloatingFilterNumberInput.getGui(),n=this.eFloatingFilterTextInput.getGui();e.appendChild(t),e.appendChild(n),this.setupListeners(t,(e=>this.valueChangedListener(e))),this.setupListeners(n,(e=>this.valueChangedListener(e)))}setEditable(e){this.numberInputActive=e,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eFloatingFilterNumberInput.setAutoComplete(e),this.eFloatingFilterTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput}setValueChangedListener(e){this.valueChangedListener=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams(e){this.setAriaLabel(e.ariaLabel),void 0!==e.autoComplete&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eFloatingFilterNumberInput.setInputAriaLabel(e),this.eFloatingFilterTextInput.setInputAriaLabel(e)}};var za={version:Da,moduleName:"@ag-grid-community/filter-core",beans:[class extends Vn{constructor(){super(...arguments),this.beanName="filterManager",this.advancedFilterModelUpdateQueue=[]}wireBeans(e){this.columnModel=e.columnModel,this.dataTypeService=e.dataTypeService,this.quickFilterService=e.quickFilterService,this.advancedFilterService=e.advancedFilterService,this.columnFilterService=e.columnFilterService}postConstruct(){const e=this.refreshFiltersForAggregations.bind(this),t=this.updateAdvancedFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:e,columnPivotChanged:e,columnPivotModeChanged:e,newColumnsLoaded:t,columnVisible:t,advancedFilterEnabledChanged:e=>{let{enabled:t}=e;return this.onAdvancedFilterEnabledChanged(t)},dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],(()=>{this.onFilterChanged({source:"api"})})),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",(()=>{this.updateAggFiltering(),this.onFilterChanged()})),this.addManagedPropertyListener("advancedFilterModel",(e=>this.setAdvancedFilterModel(e.currentValue))),this.quickFilterService&&this.addManagedListeners(this.quickFilterService,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})})}isExternalFilterPresentCallback(){const e=this.gos.getCallback("isExternalFilterPresent");return"function"===typeof e&&e({})}doesExternalFilterPass(e){const t=this.gos.get("doesExternalFilterPass");return"function"===typeof t&&t(e)}setFilterModel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.isAdvancedFilterEnabled()?this.warnAdvancedFilters():this.columnFilterService?.setFilterModel(e,t)}getFilterModel(){return this.columnFilterService?.getFilterModel()??{}}isColumnFilterPresent(){return!!this.columnFilterService?.isColumnFilterPresent()}isAggregateFilterPresent(){return!!this.columnFilterService?.isAggregateFilterPresent()}isExternalFilterPresent(){return this.externalFilterPresent}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}isAdvancedFilterPresent(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isFilterPresent()}onAdvancedFilterEnabledChanged(e){e?this.columnFilterService?.disableColumnFilters()&&this.onFilterChanged({source:"advancedFilter"}):this.advancedFilterService?.isFilterPresent()&&(this.advancedFilterService.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvancedFilterEnabled(){return!!this.advancedFilterService?.isEnabled()}isAdvancedFilterHeaderActive(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isHeaderActive()}isAnyFilterPresent(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}resetQuickFilterCache(){this.quickFilterService?.resetQuickFilterCache()}refreshFiltersForAggregations(){cn(this.gos)&&this.onFilterChanged()}onFilterChanged(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{source:t,additionalEventAttributes:n,columns:i=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.columnFilterService?this.columnFilterService.updateBeforeFilterChanged(e):Xs.resolve()).then((()=>{const e={source:t,type:"filterChanged",columns:i};n&&ai(e,n),this.eventService.dispatchEvent(e),this.columnFilterService?.updateAfterFilterChanged()}))}isSuppressFlashingCellsBecauseFiltering(){return!!this.columnFilterService?.isSuppressFlashingCellsBecauseFiltering()}isQuickFilterPresent(){return!!this.quickFilterService?.isQuickFilterPresent()}updateAggFiltering(){this.aggFiltering=!!cn(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.columnModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,filterInstanceToSkip:e})}doesRowPassAggregateFilters(e){return!(this.isAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(e.rowNode))&&!(this.isAggregateFilterPresent()&&!this.columnFilterService.doAggregateFiltersPass(e.rowNode,e.filterInstanceToSkip))}doesRowPassFilter(e){return!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(e.rowNode))&&(!(this.isExternalFilterPresent()&&!this.doesExternalFilterPass(e.rowNode))&&(!(this.isColumnFilterPresent()&&!this.columnFilterService.doColumnFiltersPass(e.rowNode,e.filterInstanceToSkip))&&!(this.isAdvancedFilterPresent()&&!this.advancedFilterService.doesFilterPass(e.rowNode))))}isFilterActive(e){return!!this.columnFilterService?.isFilterActive(e)}getOrCreateFilterWrapper(e){return this.columnFilterService?.getOrCreateFilterWrapper(e)??null}getDefaultFloatingFilter(e){return this.columnFilterService.getDefaultFloatingFilter(e)}createFilterParams(e,t){return this.columnFilterService.createFilterParams(e,t)}isFilterAllowed(e){return!this.isAdvancedFilterEnabled()&&!!this.columnFilterService?.isFilterAllowed(e)}getFloatingFilterCompDetails(e,t){return this.columnFilterService?.getFloatingFilterCompDetails(e,t)}getCurrentFloatingFilterParentModel(e){return this.columnFilterService?.getCurrentFloatingFilterParentModel(e)}destroyFilter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.columnFilterService?.destroyFilter(e,t)}areFilterCompsDifferent(e,t){return!!this.columnFilterService?.areFilterCompsDifferent(e,t)}getAdvancedFilterModel(){return this.isAdvancedFilterEnabled()?this.advancedFilterService.getModel():null}setAdvancedFilterModel(e){this.isAdvancedFilterEnabled()&&(this.dataTypeService?.isPendingInference()?this.advancedFilterModelUpdateQueue.push(e):(this.advancedFilterService.setModel(e??null),this.onFilterChanged({source:"advancedFilter"})))}toggleAdvancedFilterBuilder(e,t){this.isAdvancedFilterEnabled()&&this.advancedFilterService.getCtrl().toggleFilterBuilder({source:t,force:e})}updateAdvancedFilterColumns(){this.isAdvancedFilterEnabled()&&this.advancedFilterService.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return!this.isAdvancedFilterEnabled()&&!!this.columnFilterService?.hasFloatingFilters()}getFilterInstance(e,t){if(!this.isAdvancedFilterEnabled())return this.columnFilterService?.getFilterInstance(e,t);this.warnAdvancedFilters()}getColumnFilterInstance(e){return this.isAdvancedFilterEnabled()?(this.warnAdvancedFilters(),Promise.resolve(void 0)):this.columnFilterService?.getColumnFilterInstance(e)??Promise.resolve(void 0)}warnAdvancedFilters(){bt("Column Filter API methods have been disabled as Advanced Filters are enabled.")}setupAdvancedFilterHeaderComp(e){this.advancedFilterService?.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvancedFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvancedFilterHeaderActive()?this.advancedFilterService.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){this.advancedFilterModelUpdateQueue.forEach((e=>this.setAdvancedFilterModel(e))),this.advancedFilterModelUpdateQueue=[]}getColumnFilterModel(e){return this.columnFilterService?.getColumnFilterModel(e)}setColumnFilterModel(e,t){return this.isAdvancedFilterEnabled()?(this.warnAdvancedFilters(),Promise.resolve()):this.columnFilterService?.setColumnFilterModel(e,t)??Promise.resolve()}setColDefPropertiesForDataType(e,t,n){this.columnFilterService?.setColDefPropertiesForDataType(e,t,n)}}]},Ha={version:Da,moduleName:"@ag-grid-community/filter-api",apiFunctions:{isAnyFilterPresent:function(e){return!!e.filterManager?.isAnyFilterPresent()},onFilterChanged:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";e.filterManager?.onFilterChanged({source:t})}},dependantModules:[za]},Ga={version:Da,moduleName:"@ag-grid-community/column-filter",beans:[class extends Vn{constructor(){super(...arguments),this.beanName="columnFilterService",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue=[]}wireBeans(e){this.valueService=e.valueService,this.columnModel=e.columnModel,this.rowModel=e.rowModel,this.userComponentFactory=e.userComponentFactory,this.rowRenderer=e.rowRenderer,this.dataTypeService=e.dataTypeService,this.filterManager=e.filterManager}postConstruct(){this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),rowDataUpdated:()=>this.onNewRowsLoaded("rowDataUpdated"),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.initialFilterModel={...this.gos.get("initialState")?.filter?.filterModel??{}}}setFilterModel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";if(this.dataTypeService?.isPendingInference())return void this.filterModelUpdateQueue.push({model:e,source:t});const n=[],i=this.getFilterModel(!0);if(e){const t=new Set(Object.keys(e));this.allColumnFilters.forEach(((i,r)=>{const s=e[r];n.push(this.setModelOnFilterWrapper(i.filterPromise,s)),t.delete(r)})),t.forEach((t=>{const i=this.columnModel.getColDefCol(t)||this.columnModel.getCol(t);if(!i)return void bt("setFilterModel() - no column found for colId: "+t);if(!i.isFilterAllowed())return void bt("setFilterModel() - unable to fully apply model, filtering disabled for colId: "+t);const r=this.getOrCreateFilterWrapper(i);r?n.push(this.setModelOnFilterWrapper(r.filterPromise,e[t])):bt("setFilterModel() - unable to fully apply model, unable to create filter for colId: "+t)}))}else this.allColumnFilters.forEach((e=>{n.push(this.setModelOnFilterWrapper(e.filterPromise,null))}));Xs.all(n).then((()=>{const e=this.getFilterModel(!0),n=[];this.allColumnFilters.forEach(((t,r)=>{zt(i?i[r]:null,e?e[r]:null)||n.push(t.column)})),n.length>0&&this.filterManager?.onFilterChanged({columns:n,source:t})}))}setModelOnFilterWrapper(e,t){return new Xs((n=>{e.then((e=>{"function"!==typeof e.setModel&&(bt("filter missing setModel method, which is needed for setFilterModel"),n()),(e.setModel(t)||Xs.resolve()).then((()=>n()))}))}))}getFilterModel(e){const t={},{allColumnFilters:n,initialFilterModel:i}=this;return n.forEach(((e,n)=>{const i=this.getModelFromFilterWrapper(e);Dt(i)&&(t[n]=i)})),e||Object.entries(i).forEach((e=>{let[i,r]=e;Dt(r)&&!n.has(i)&&this.columnModel.getCol(i)?.isFilterAllowed()&&(t[i]=r)})),t}getModelFromFilterWrapper(e){const{filter:t}=e;return t?"function"!==typeof t.getModel?(bt("filter API missing getModel method, which is needed for getFilterModel"),null):t.getModel():this.getModelFromInitialState(e.column)}getModelFromInitialState(e){return this.initialFilterModel[e.getColId()]??null}isColumnFilterPresent(){return this.activeColumnFilters.length>0}isAggregateFilterPresent(){return!!this.activeAggregateFilters.length}disableColumnFilters(){return!!this.allColumnFilters.size&&(this.allColumnFilters.forEach((e=>this.disposeFilterWrapper(e,"advancedFilterEnabled"))),!0)}doAggregateFiltersPass(e,t){return this.doColumnFiltersPass(e,t,!0)}updateActiveFilters(){const e=!!cn(this.gos),t=t=>{if(!t.isPrimary())return!0;const n=!this.columnModel.isPivotActive();return!(!t.isValueActive()||!n)&&(!!this.columnModel.isPivotMode()||e)},n=[],i=[];return this.forEachColumnFilter(((e,r)=>{const s=(e=>!!e&&(e.isFilterActive?e.isFilterActive():(bt("Filter is missing isFilterActive() method"),!1)))(e);s&&(t(r.column)?n.push(e):i.push(e))})).then((()=>{this.activeAggregateFilters=n,this.activeColumnFilters=i}))}updateFilterFlagInColumns(e,t){return this.forEachColumnFilter(((n,i)=>i.column.setFilterActive(n.isFilterActive(),e,t)))}forEachColumnFilter(e){return Xs.all(Array.from(this.allColumnFilters.values()).map((t=>t.filterPromise.then((n=>e(n,t))))))}doColumnFiltersPass(e,t,n){const{data:i,aggData:r}=e,s=n?this.activeAggregateFilters:this.activeColumnFilters,o=n?r:i;for(let a=0;a<s.length;a++){const n=s[a];if(null!=n&&n!==t){if("function"!==typeof n.doesFilterPass)throw new Error("Filter is missing method doesFilterPass");if(!n.doesFilterPass({node:e,data:o}))return!1}}return!0}callOnFilterChangedOutsideRenderCycle(e){const t=()=>this.filterManager?.onFilterChanged(e);this.rowRenderer.isRefreshInProgress()?setTimeout(t,0):t()}updateBeforeFilterChanged(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{filterInstance:t,additionalEventAttributes:n}=e;return this.updateDependentFilters(),this.updateActiveFilters().then((()=>this.updateFilterFlagInColumns("filterChanged",n).then((()=>{this.allColumnFilters.forEach((e=>{e.filterPromise&&e.filterPromise.then((e=>{e&&e!==t&&e.onAnyFilterChanged&&e.onAnyFilterChanged()}))})),this.processingFilterChange=!0}))))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!(this.gos.get("allowShowChangeAfterFilter")??!1)&&this.processingFilterChange}onNewRowsLoaded(e){this.forEachColumnFilter((e=>{e.onNewRowsLoaded&&e.onNewRowsLoaded()})).then((()=>this.updateFilterFlagInColumns(e,{afterDataChange:!0}))).then((()=>this.updateActiveFilters()))}createValueGetter(e){return t=>{let{node:n}=t;return this.valueService.getValue(e,n,!0)}}createGetValue(e){return(t,n)=>{const i=n?this.columnModel.getCol(n):e;return i?this.valueService.getValue(i,t,!0):void 0}}isFilterActive(e){const{filter:t}=this.cachedFilter(e)??{};return t?t.isFilterActive():null!=this.getModelFromInitialState(e)}getOrCreateFilterWrapper(e){if(!e.isFilterAllowed())return null;let t=this.cachedFilter(e);return t||(t=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,t)),t}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e){let t;if(En(this.gos))t="agSetColumnFilter";else{const n=this.dataTypeService?.getBaseDataType(e);t="number"===n?"agNumberColumnFilter":"date"===n||"dateString"===n?"agDateColumnFilter":"agTextColumnFilter"}return t}getDefaultFloatingFilter(e){let t;if(En(this.gos))t="agSetColumnFloatingFilter";else{const n=this.dataTypeService?.getBaseDataType(e);t="number"===n?"agNumberColumnFloatingFilter":"date"===n||"dateString"===n?"agDateColumnFloatingFilter":"agTextColumnFloatingFilter"}return t}createFilterInstance(e,t){const n=this.getDefaultFilter(e),i=e.getColDef();let r;const s={...this.createFilterParams(e,i),filterModifiedCallback:()=>this.filterModifiedCallbackFactory(r,e)(),filterChangedCallback:t=>this.filterChangedCallbackFactory(r,e)(t),doesRowPassOtherFilter:e=>!this.filterManager||this.filterManager.doesRowPassOtherFilters(r,e)},o=this.userComponentFactory.getFilterDetails(i,s,n);return o?{filterPromise:()=>{const e=o.newAgStackInstance();return null!=e&&e.then((e=>{r=e,t&&(t.filter=e)})),e},compDetails:o}:{filterPromise:null,compDetails:null}}createFilterParams(e,t){return this.gos.addGridCommonParams({column:e,colDef:ri(t),rowModel:this.rowModel,filterChangedCallback:()=>{},filterModifiedCallback:()=>{},valueGetter:this.createValueGetter(e),getValue:this.createGetValue(e),doesRowPassOtherFilter:()=>!0})}createFilterWrapper(e){const t={column:e,filterPromise:null,compiledElement:null,compDetails:null},{filterPromise:n,compDetails:i}=this.createFilterInstance(e,t);return t.filterPromise=n?.()??null,t.compDetails=i,t}onColumnsChanged(){const e=[];this.allColumnFilters.forEach(((t,n)=>{let i;i=t.column.isPrimary()?this.columnModel.getColDefCol(n):this.columnModel.getCol(n),i&&i===t.column||(e.push(t.column),this.disposeFilterWrapper(t,"columnChanged"),this.disposeColumnListener(n))}));const t=e.every((e=>"agGroupColumnFilter"===e.getColDef().filter));e.length>0&&!t?this.filterManager?.onFilterChanged({columns:e,source:"api"}):this.updateDependentFilters()}updateDependentFilters(){const e=this.columnModel.getAutoCols();e?.forEach((e=>{"agGroupColumnFilter"===e.getColDef().filter&&this.getOrCreateFilterWrapper(e)}))}isFilterAllowed(e){if(!e.isFilterAllowed())return!1;const{filter:t}=this.allColumnFilters.get(e.getColId())??{};return!t||("function"!==typeof t?.isFilterAllowed||t.isFilterAllowed())}getFloatingFilterCompDetails(e,t){const n=t=>{const n=this.getOrCreateFilterWrapper(e)?.filterPromise;null!=n&&n.then((e=>{t(vo(e))}))},i=e.getColDef(),r={...this.createFilterParams(e,i),filterChangedCallback:()=>n((t=>this.filterChangedCallbackFactory(t,e)()))},s=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(i,oo,r);let o=function(e,t,n){if(null==t)return null;let i=null;const{compName:r,jsComp:s,fwComp:o}=mo.getCompKeys(e,t,oo);r?i={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[r]:null==s&&null==o&&!0===t.filter&&(i=n());return i}(this.frameworkOverrides,i,(()=>this.getDefaultFloatingFilter(e)));null==o&&(o="agReadOnlyFloatingFilter");const a={column:e,filterParams:s,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:n,showParentFilter:t,suppressFilterButton:!1};return this.userComponentFactory.getFloatingFilterCompDetails(i,a,o)}getCurrentFloatingFilterParentModel(e){return this.getModelFromFilterWrapper(this.cachedFilter(e)??{column:e})}destroyFilter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";const n=e.getColId(),i=this.allColumnFilters.get(n);this.disposeColumnListener(n),delete this.initialFilterModel[n],i&&(this.disposeFilterWrapper(i,t),this.filterManager?.onFilterChanged({columns:[e],source:"api"}))}disposeColumnListener(e){const t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){e.filterPromise.then((n=>{this.destroyBean(n),e.column.setFilterActive(!1,"filterDestroyed"),this.allColumnFilters.delete(e.column.getColId()),this.eventService.dispatchEvent({type:"filterDestroyed",source:t,column:e.column})}))}filterModifiedCallbackFactory(e,t){return()=>{this.eventService.dispatchEvent({type:"filterModified",column:t,filterInstance:e})}}filterChangedCallbackFactory(e,t){return n=>{const i={filter:e,additionalEventAttributes:n,columns:[t],source:n?.source??"columnFilter"};this.callOnFilterChangedOutsideRenderCycle(i)}}checkDestroyFilter(e){const t=this.allColumnFilters.get(e);if(!t)return;const n=t.column,{compDetails:i}=n.isFilterAllowed()?this.createFilterInstance(n):{compDetails:null};if(this.areFilterCompsDifferent(t.compDetails,i))return void this.destroyFilter(n,"paramsUpdated");const r=n.getColDef().filterParams;t.filterPromise?t.filterPromise.then((e=>{!1===(!e?.refresh||e.refresh({...this.createFilterParams(n,n.getColDef()),filterModifiedCallback:this.filterModifiedCallbackFactory(e,n),filterChangedCallback:this.filterChangedCallbackFactory(e,n),doesRowPassOtherFilter:t=>!this.filterManager||this.filterManager.doesRowPassOtherFilters(e,t),...r}))&&this.destroyFilter(n,"paramsUpdated")})):this.destroyFilter(n,"paramsUpdated")}setColumnFilterWrapper(e,t){const n=e.getColId();this.allColumnFilters.set(n,t),this.allColumnListeners.set(n,this.addManagedListeners(e,{colDefChanged:()=>this.checkDestroyFilter(n)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;const{componentClass:n}=e,{componentClass:i}=t;return!(n===i||n?.render&&i?.render&&n.render===i.render)}hasFloatingFilters(){return this.columnModel.getCols().some((e=>e.getColDef().floatingFilter))}getFilterInstance(e,t){t&&this.getFilterInstanceImpl(e).then((e=>{const n=vo(e);t(n)}))}getColumnFilterInstance(e){return new Promise((t=>{this.getFilterInstanceImpl(e).then((e=>{t(vo(e))}))}))}getFilterInstanceImpl(e){const t=this.columnModel.getColDefCol(e);if(!t)return Xs.resolve(void 0);const n=this.getOrCreateFilterWrapper(t)?.filterPromise;return n??Xs.resolve(null)}processFilterModelUpdateQueue(){this.filterModelUpdateQueue.forEach((e=>{let{model:t,source:n}=e;return this.setFilterModel(t,n)})),this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue.forEach((e=>{let{key:t,model:n,resolve:i}=e;this.setColumnFilterModel(t,n).then((()=>i()))})),this.columnFilterModelUpdateQueue=[]}getColumnFilterModel(e){const t=this.getFilterWrapper(e);return t?this.getModelFromFilterWrapper(t):null}setColumnFilterModel(e,t){if(this.dataTypeService?.isPendingInference()){let n=()=>{};const i=new Promise((e=>{n=e}));return this.columnFilterModelUpdateQueue.push({key:e,model:t,resolve:n}),i}const n=this.columnModel.getColDefCol(e),i=n?this.getOrCreateFilterWrapper(n):null;return i?(r=this.setModelOnFilterWrapper(i.filterPromise,t),new Promise((e=>{r.then((t=>e(t)))}))):Promise.resolve();var r}getFilterWrapper(e){const t=this.columnModel.getColDefCol(e);return t?this.cachedFilter(t)??null:null}setColDefPropertiesForDataType(e,t,n){const i=En(this.gos),r=this.localeService.getLocaleTextFunc(),s=t=>{const{filterParams:n}=e;e.filterParams="object"===typeof n?{...n,...t}:t};switch(t.baseDataType){case"number":i&&s({comparator:(e,t)=>{const n=null==e?0:parseInt(e),i=null==t?0:parseInt(t);return n===i?0:n>i?1:-1}});break;case"boolean":s(i?{valueFormatter:e=>Dt(e.value)?r(String(e.value),e.value?"True":"False"):r("blanks","(Blanks)")}:{maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(e,t)=>t,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(e,t)=>!1===t,numberOfInputs:0}]});break;case"date":i&&s({valueFormatter:e=>{const t=n(e);return Dt(t)?t:r("blanks","(Blanks)")},treeList:!0,treeListFormatter:(e,t)=>{if(1===t&&null!=e){const t=Ia[Number(e)-1];return r(t,La[t])}return e??r("blanks","(Blanks)")}});break;case"dateString":{const e=t.dateParser;s(i?{valueFormatter:e=>{const t=n(e);return Dt(t)?t:r("blanks","(Blanks)")},treeList:!0,treeListPathGetter:t=>{const n=e(t??void 0);return n?[String(n.getFullYear()),String(n.getMonth()+1),String(n.getDate())]:null},treeListFormatter:(e,t)=>{if(1===t&&null!=e){const t=Ia[Number(e)-1];return r(t,La[t])}return e??r("blanks","(Blanks)")}}:{comparator:(t,n)=>{const i=e(n);return null==n||i<t?-1:i>t?1:0}});break}case"object":i?s({valueFormatter:e=>{const t=n(e);return Dt(t)?t:r("blanks","(Blanks)")}}):e.filterValueGetter=e=>n({column:e.column,node:e.node,value:this.valueService.getValue(e.column,e.node)})}}destroy(){super.destroy(),this.allColumnFilters.forEach((e=>this.disposeFilterWrapper(e,"gridDestroyed"))),this.allColumnListeners.clear()}}],dependantModules:[za]},Ua={version:Da,moduleName:"@ag-grid-community/column-filter-api",apiFunctions:{isColumnFilterPresent:function(e){return!!e.filterManager?.isColumnFilterPresent()||!!e.filterManager?.isAggregateFilterPresent()},getFilterInstance:function(e,t,n){return e.filterManager?.getFilterInstance(t,n)},getColumnFilterInstance:function(e,t){return e.filterManager?.getColumnFilterInstance(t)??Promise.resolve(void 0)},destroyFilter:function(e,t){const n=e.columnModel.getColDefCol(t);if(n)return e.filterManager?.destroyFilter(n,"api")},setFilterModel:function(e,t){e.frameworkOverrides.wrapIncoming((()=>e.filterManager?.setFilterModel(t)))},getFilterModel:function(e){return e.filterManager?.getFilterModel()??{}},getColumnFilterModel:function(e,t){return e.filterManager?.getColumnFilterModel(t)??null},setColumnFilterModel:function(e,t,n){return e.filterManager?.setColumnFilterModel(t,n)??Promise.resolve()},showColumnFilter:function(e,t){const n=e.columnModel.getCol(t);n?e.menuService.showFilterMenu({column:n,containerType:"columnFilter",positionBy:"auto"}):xt(`column '${t}' not found`)}},dependantModules:[Ga,Ha]},Va={version:Da,moduleName:"@ag-grid-community/floating-filter-core",controllers:[{name:"headerFilterCell",classImp:class extends Aa{constructor(e,t,n){super(e,t,n),this.iconCreated=!1,this.column=e}setComp(e,t,n,i,r){this.comp=e,r=Yi(this,this.beans.context,r),this.eButtonShowMainFilter=n,this.eFloatingFilterBody=i,this.setGui(t,r),this.setupActive(),this.setupWidth(r),this.setupLeft(r),this.setupHover(r),this.setupFocus(r),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(r),this.setupUi(),r.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(r),r.addManagedListeners(this.column,{colDefChanged:()=>this.onColDefChanged(r)}),r.addDestroyFunc((()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()}))}resizeHeader(){}moveHeader(){}setupActive(){const e=this.column.getColDef(),t=!!e.filter,n=!!e.floatingFilter;this.active=t&&n}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const e=ys("filter",this.gos,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(e){e.createManagedBean(new Ho(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const e=this.localeService.getLocaleTextFunc();gr(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){if(rn(this.gos)===this.eGui)return;const t=this.focusService.findNextFocusableElement(this.eGui,null,e.shiftKey);if(t)return this.beans.headerNavigationService.scrollToColumn(this.column),e.preventDefault(),void t.focus();const n=this.findNextColumnWithFloatingFilter(e.shiftKey);n&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:n},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){const t=this.beans.visibleColsService;let n=this.column;do{if(n=e?t.getColBefore(n):t.getColAfter(n),!n)break}while(!n.getColDef().filter||!n.getColDef().floatingFilter);return n}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();switch(e.key){case As.UP:case As.DOWN:t||e.preventDefault();case As.LEFT:case As.RIGHT:if(t)return;e.stopPropagation();case As.ENTER:t&&this.focusService.focusInto(this.eGui)&&e.preventDefault();break;case As.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const t=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),n=!!e.relatedTarget&&Gr(e.relatedTarget,"ag-floating-filter");if(t&&n&&e.target===this.eGui){const e=this.lastFocusEvent,t=!(!e||e.key!==As.TAB);if(e&&t){const t=e.shiftKey;this.focusService.focusInto(this.eGui,t)}}const i=this.getRowIndex();this.beans.focusService.setFocusedHeader(i,this.column)}setupHover(e){e.createManagedBean(new Fa([this.column],this.eGui));const t=()=>{if(!this.gos.get("columnHoverHighlight"))return;const e=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",e)};e.addManagedEventListeners({columnHoverChanged:t}),t()}setupLeft(e){const t=new _a(this.column,this.eGui,this.beans);e.createManagedBean(t)}setupFilterButton(){this.suppressFilterButton=!this.menuService.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!this.menuService.isLegacyMenuEnabled()}setupUserComp(){if(!this.active)return;const e=this.beans.filterManager?.getFloatingFilterCompDetails(this.column,(()=>this.showParentFilter()));e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){const e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.menuService.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(e){if(!this.active)return;const{filterManager:t}=this.beans,n=e=>{if("filterDestroyed"===e?.source&&!this.isAlive())return;const n=this.comp.getFloatingFilterComp();n&&n.then((n=>{if(n){const i=t?.getCurrentFloatingFilterParentModel(this.column),r=e?{...e,columns:e.columns??[],source:"api"===e.source?"api":"columnFilter"}:null;n.onParentModelChanged(i,r)}}))};[this.destroySyncListener]=e.addManagedListeners(this.column,{filterChanged:n}),t?.isFilterActive(this.column)&&n(null)}setupWidth(e){const t=()=>{const e=`${this.column.getActualWidth()}px`;this.comp.setWidth(e)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupFilterChangedListener(e){this.active&&([this.destroyFilterChangedListener]=e.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){const e=!!this.beans.filterManager?.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(e),this.highlightFilterButtonWhenActive&&e&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(e){const t=this.active;this.setupActive();const n=!t&&this.active;t&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());const i=this.active?this.beans.filterManager?.getFloatingFilterCompDetails(this.column,(()=>this.showParentFilter())):null,r=this.comp.getFloatingFilterComp();r&&i?r.then((t=>{!t||this.beans.filterManager?.areFilterCompsDifferent(this.userCompDetails??null,i)?this.updateCompDetails(e,i,n):this.updateFloatingFilterParams(i)})):this.updateCompDetails(e,i,n)}updateCompDetails(e,t,n){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),n&&(this.setupSyncWithFilter(e),this.setupFilterChangedListener(e)))}updateFloatingFilterParams(e){if(!e)return;const t=e.params;this.comp.getFloatingFilterComp()?.then((e=>{let n=!1;if(e?.refresh&&"function"===typeof e.refresh){null!==e.refresh(t)&&(n=!0)}if(!n&&e?.onParamsUpdated&&"function"===typeof e.onParamsUpdated){null!==e.onParamsUpdated(t)&&bt("Custom floating filter method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")}}))}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}}}],dependantModules:[Ga]},Wa={version:Da,moduleName:"@ag-grid-community/read-only-floating-filter",userComponents:[{name:"agReadOnlyFloatingFilter",classImp:class extends fs{constructor(){super('\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field data-ref="eFloatingFilterText"></ag-input-text-field>\n            </div>',[na]),this.eFloatingFilterText=gs}wireBeans(e){this.columnNameService=e.columnNameService}destroy(){super.destroy()}init(e){this.params=e;const t=this.columnNameService.getDisplayNameForColumn(e.column,"header",!0),n=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${n("ariaFilterInput","Filter Input")}`)}onParentModelChanged(e){null!=e?this.params.parentFilterInstance((t=>{if(t.getModelAsString){const n=t.getModelAsString(e);this.eFloatingFilterText.setValue(n)}})):this.eFloatingFilterText.setValue("")}onParamsUpdated(e){this.refresh(e)}refresh(e){this.init(e)}}}],dependantModules:[Va]},ja={version:Da,moduleName:"@ag-grid-community/simple-filter",dependantModules:[Ga],userComponents:[{name:"agTextColumnFilter",classImp:class extends Yo{constructor(){super("textFilter"),this.defaultFormatter=e=>e,this.defaultLowercaseFormatter=e=>null==e?null:e.toString().toLowerCase(),this.defaultMatcher=e=>{let{filterOption:t,value:n,filterText:i}=e;if(null==i)return!1;switch(t){case"contains":return n.indexOf(i)>=0;case"notContains":return n.indexOf(i)<0;case"equals":return n===i;case"notEqual":return n!=i;case"startsWith":return 0===n.indexOf(i);case"endsWith":{const e=n.lastIndexOf(i);return e>=0&&e===n.length-i.length}default:return!1}},this.eValuesFrom=[],this.eValuesTo=[]}getDefaultDebounceMs(){return 500}setParams(e){this.textFilterParams=e,super.setParams(e),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?this.defaultFormatter:this.defaultLowercaseFormatter),this.filterModelFormatter=new ua(this.localeService,this.optionsFactory)}getTextMatcher(){const e=this.textFilterParams.textCustomComparator;return e?(bt("textCustomComparator is deprecated, use textMatcher instead."),t=>{let{filterOption:n,value:i,filterText:r}=t;return e(n,i,r)}):this.textFilterParams.textMatcher||this.defaultMatcher}createCondition(e){const t=this.getConditionType(e),n={filterType:this.getFilterType(),type:t},i=this.getValuesWithSideEffects(e,!0);return i.length>0&&(n.filter=i[0]),i.length>1&&(n.filterTo=i[1]),n}getFilterType(){return"text"}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}getValues(e){return this.getValuesWithSideEffects(e,!1)}getValuesWithSideEffects(e,t){const n=[];return this.forEachPositionInput(e,((e,i,r,s)=>{if(i<s){let i=Ft(e.getValue());t&&this.textFilterParams.trimInput&&(i=ha(i)??null,e.setValue(i,!0)),n.push(i)}})),n}getDefaultFilterOptions(){return ca}createValueElement(){const e=document.createElement("div");return e.classList.add("ag-filter-body"),pr(e,"presentation"),this.createFromToElement(e,this.eValuesFrom,"from"),this.createFromToElement(e,this.eValuesTo,"to"),e}createFromToElement(e,t,n){const i=this.createManagedBean(new ta);i.addCssClass(`ag-filter-${n}`),i.addCssClass("ag-filter-filter"),t.push(i),e.appendChild(i.getGui())}removeValueElements(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)}mapValuesFromModel(e){const{filter:t,filterTo:n,type:i}=e||{};return[t||null,n||null].slice(0,this.getNumberOfInputs(i))}evaluateNullValue(e){return!!e&&["notEqual","notContains","blank"].indexOf(e)>=0}evaluateNonNullValue(e,t,n,i){const r=e.map((e=>this.formatter(e)))||[],s=this.formatter(t),{api:o,colDef:a,column:l,context:c,textFormatter:u}=this.textFilterParams;if("blank"===n.type)return this.isBlank(t);if("notBlank"===n.type)return!this.isBlank(t);const h={api:o,colDef:a,column:l,context:c,node:i.node,data:i.data,filterOption:n.type,value:s,textFormatter:u};return r.some((e=>this.matcher({...h,filterText:e})))}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}}},{name:"agNumberColumnFilter",classImp:class extends Jo{constructor(){super("numberFilter"),this.eValuesFrom=[],this.eValuesTo=[]}refresh(e){return this.numberFilterParams.allowedCharPattern===e.allowedCharPattern&&super.refresh(e)}mapValuesFromModel(e){const{filter:t,filterTo:n,type:i}=e||{};return[this.processValue(t),this.processValue(n)].slice(0,this.getNumberOfInputs(i))}getDefaultDebounceMs(){return 500}comparator(){return(e,t)=>e===t?0:e<t?1:-1}setParams(e){this.numberFilterParams=e,super.setParams(e),this.filterModelFormatter=new aa(this.localeService,this.optionsFactory,this.numberFilterParams.numberFormatter)}getDefaultFilterOptions(){return sa}setElementValue(e,t,n){const i=!n&&this.numberFilterParams.numberFormatter?this.numberFilterParams.numberFormatter(t??null):t;super.setElementValue(e,i)}createValueElement(){const e=la(this.numberFilterParams),t=document.createElement("div");return t.classList.add("ag-filter-body"),pr(t,"presentation"),this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}createFromToElement(e,t,n,i){const r=this.createManagedBean(i?new ta({allowedCharPattern:i}):new ia);r.addCssClass(`ag-filter-${n}`),r.addCssClass("ag-filter-filter"),t.push(r),e.appendChild(r.getGui())}removeValueElements(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)}getValues(e){const t=[];return this.forEachPositionInput(e,((e,n,i,r)=>{n<r&&t.push(this.processValue(this.stringToFloat(e.getValue())))})),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getFilterType(){return"number"}processValue(e){return null==e||isNaN(e)?null:e}stringToFloat(e){if("number"===typeof e)return e;let t=Ft(e);return null!=t&&""===t.trim()&&(t=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(t):null==t||"-"===t.trim()?null:parseFloat(t)}createCondition(e){const t=this.getConditionType(e),n={filterType:this.getFilterType(),type:t},i=this.getValues(e);return i.length>0&&(n.filter=i[0]),i.length>1&&(n.filterTo=i[1]),n}getInputs(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}hasInvalidInputs(){let e=!1;return this.forEachInput((t=>{t.getInputElement().validity.valid||(e=!0)})),e}}},{name:"agDateColumnFilter",classImp:class extends Jo{constructor(){super("dateFilter"),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=1e3,this.maxValidYear=xa,this.minValidDate=null,this.maxValidDate=null}wireBeans(e){super.wireBeans(e),this.context=e.context,this.userComponentFactory=e.userComponentFactory}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e)}mapValuesFromModel(e){const{dateFrom:t,dateTo:n,type:i}=e||{};return[t&&Ca(t)||null,n&&Ca(n)||null].slice(0,this.getNumberOfInputs(i))}comparator(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)}defaultComparator(e,t){return null==t||t<e?-1:t>e?1:0}setParams(e){this.dateFilterParams=e,super.setParams(e);const t=(t,n)=>{if(null!=e[t]){if(!isNaN(e[t]))return null==e[t]?n:Number(e[t]);bt(`DateFilter ${t} is not a number`)}return n};this.minValidYear=t("minValidYear",1e3),this.maxValidYear=t("maxValidYear",xa),this.minValidYear>this.maxValidYear&&bt("DateFilter minValidYear should be <= maxValidYear"),e.minValidDate?this.minValidDate=e.minValidDate instanceof Date?e.minValidDate:Ca(e.minValidDate):this.minValidDate=null,e.maxValidDate?this.maxValidDate=e.maxValidDate instanceof Date?e.maxValidDate:Ca(e.maxValidDate):this.maxValidDate=null,this.minValidDate&&this.maxValidDate&&this.minValidDate>this.maxValidDate&&bt("DateFilter minValidDate should be <= maxValidDate"),this.filterModelFormatter=new ba(this.dateFilterParams,this.localeService,this.optionsFactory)}createDateCompWrapper(e){const t=new wa(this.context,this.userComponentFactory,{onDateChanged:()=>this.onUiChanged(),filterParams:this.dateFilterParams},e);return this.addDestroyFunc((()=>t.destroy())),t}setElementValue(e,t){e.setDate(t)}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}getDefaultFilterOptions(){return Sa}createValueElement(){const e=en(this.gos).createElement("div");return e.classList.add("ag-filter-body"),this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e}createFromToElement(e,t,n,i){const r=en(this.gos).createElement("div");r.classList.add(`ag-filter-${i}`),r.classList.add(`ag-filter-date-${i}`),t.push(r),e.appendChild(r),n.push(this.createDateCompWrapper(r))}removeValueElements(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),this.removeItems(this.eConditionPanelsFrom,e,t),this.removeItems(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,n){this.removeItems(e,t,n).forEach((e=>e.destroy()))}isValidDateValue(e){if(null===e)return!1;if(this.minValidDate){if(e<this.minValidDate)return!1}else if(e.getUTCFullYear()<this.minValidYear)return!1;if(this.maxValidDate){if(e>this.maxValidDate)return!1}else if(e.getUTCFullYear()>this.maxValidYear)return!1;return!0}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let t=!0;return this.forEachInput(((n,i,r,s)=>{r!==e||!t||i>=s||(t=t&&this.isValidDateValue(n.getDate()))})),t}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}getFilterType(){return"date"}createCondition(e){const t=this.getConditionType(e),n={},i=this.getValues(e);return i.length>0&&(n.dateFrom=ma(i[0])),i.length>1&&(n.dateTo=ma(i[1])),{dateFrom:null,dateTo:null,filterType:this.getFilterType(),type:t,...n}}resetPlaceholder(){const e=this.localeService.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),n=e("ariaFilterValue","Filter Value");this.forEachInput((e=>{e.setInputPlaceholder(t),e.setInputAriaLabel(n)}))}getInputs(e){return e>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[e],this.dateConditionToComps[e]]}getValues(e){const t=[];return this.forEachPositionInput(e,((e,n,i,r)=>{n<r&&t.push(e.getDate())})),t}translate(e){return"lessThan"===e?super.translate("before"):"greaterThan"===e?super.translate("after"):super.translate(e)}getModelAsString(e){return this.filterModelFormatter.getModelAsString(e)??""}}},{name:"agDateInput",classImp:class extends fs{constructor(){super('\n            <div class="ag-filter-filter">\n                <ag-input-text-field class="ag-date-filter" data-ref="eDateInput"></ag-input-text-field>\n            </div>',[na]),this.eDateInput=gs}destroy(){super.destroy()}init(e){this.params=e,this.setParams(e);const t=this.eDateInput.getInputElement();this.addManagedListeners(t,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus()},input:e=>{e.target===rn(this.gos)&&(this.eDateInput.isDisabled()||this.params.onDateChanged())}})}setParams(e){const t=this.eDateInput.getInputElement(),n=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=n&&Rr(),t.type=n?"date":"text";const{minValidYear:i,maxValidYear:r,minValidDate:s,maxValidDate:o}=e.filterParams||{};if(s&&i&&bt("DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored."),o&&r&&bt("DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored."),s&&o){const[e,t]=[s,o].map((e=>e instanceof Date?e:Ca(e)));e&&t&&e.getTime()>t.getTime()&&bt("DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.")}s?s instanceof Date?t.min=ya(s):t.min=s:i&&(t.min=`${i}-01-01`),o?o instanceof Date?t.max=ya(o):t.max=o:r&&(t.max=`${r}-12-31`)}onParamsUpdated(e){this.refresh(e)}refresh(e){this.params=e,this.setParams(e)}getDate(){return Ca(this.eDateInput.getValue())}setDate(e){this.eDateInput.setValue(ma(e,!1))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){e&&e.suppressFocus||this.eDateInput.getInputElement().focus()}shouldUseBrowserDatePicker(e){return e.filterParams&&null!=e.filterParams.browserDatePicker?e.filterParams.browserDatePicker:Pr()||Ar()||Rr()&&Tr()>=14.1}}}]},qa={version:Da,moduleName:"@ag-grid-community/simple-floating-filter",dependantModules:[ja,Va],userComponents:[{name:"agTextColumnFloatingFilter",classImp:class extends Na{init(e){super.init(e),this.filterModelFormatter=new ua(this.localeService,this.optionsFactory)}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return ca}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(){return this.createManagedBean(new Oa)}}},{name:"agNumberColumnFloatingFilter",classImp:class extends Na{init(e){super.init(e),this.filterModelFormatter=new aa(this.localeService,this.optionsFactory,e.filterParams?.numberFormatter)}onParamsUpdated(e){this.refresh(e)}refresh(e){la(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return sa}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(e){return this.allowedCharPattern=la(e.filterParams),this.allowedCharPattern?this.createManagedBean(new Oa({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new Ba)}}},{name:"agDateColumnFloatingFilter",classImp:class extends ka{constructor(){super('\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field data-ref="eReadOnlyText"></ag-input-text-field>\n                <div data-ref="eDateWrapper" style="display: flex;"></div>\n            </div>',[na]),this.eReadOnlyText=gs,this.eDateWrapper=gs}wireBeans(e){super.wireBeans(e),this.context=e.context,this.userComponentFactory=e.userComponentFactory}getDefaultFilterOptions(){return Sa}init(e){super.init(e),this.params=e,this.filterParams=e.filterParams,this.createDateComponent(),this.filterModelFormatter=new ba(this.filterParams,this.localeService,this.optionsFactory);const t=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.params=e,this.filterParams=e.filterParams,this.updateDateComponent(),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory,dateFilterParams:this.filterParams}),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){const t=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){if(e){const t=e;this.dateComp.setDate(Ca(t.dateFrom))}else this.dateComp.setDate(null);this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){zr(this.eDateWrapper,e),zr(this.eReadOnlyText.getGui(),!e)}onParentModelChanged(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(super.setLastTypeFromModel(e),this.updateCompOnModelChange(e))}onDateChanged(){const e=ma(this.dateComp.getDate());this.params.parentFilterInstance((t=>{if(t){const n=Ca(e);t.onFloatingFilterChanged(this.getLastType()||null,n)}}))}getDateComponentParams(){const e=Uo(this.params.filterParams,this.getDefaultDebounceMs());return{onDateChanged:Pt(this.onDateChanged.bind(this),e),filterParams:this.params.column.getColDef().filterParams}}createDateComponent(){this.dateComp=new wa(this.context,this.userComponentFactory,this.getDateComponentParams(),this.eDateWrapper,(e=>{e.setInputAriaLabel(this.getAriaLabel(this.params))})),this.addDestroyFunc((()=>this.dateComp.destroy()))}updateDateComponent(){const e=this.gos.addGridCommonParams(this.getDateComponentParams());this.dateComp.updateParams(e)}getFilterModelFormatter(){return this.filterModelFormatter}}}]},Xa={version:Da,moduleName:"@ag-grid-community/quick-filter-core",beans:[class extends Vn{constructor(){super(...arguments),this.beanName="quickFilterService",this.quickFilter=null,this.quickFilterParts=null}wireBeans(e){this.valueService=e.valueService,this.columnModel=e.columnModel,this.rowModel=e.rowModel,this.pivotResultColsService=e.pivotResultColsService}postConstruct(){const e=this.resetQuickFilterCache.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:e,columnRowGroupChanged:e,columnVisible:()=>{this.gos.get("includeHiddenColumnsInQuickFilter")||this.resetQuickFilterCache()}}),this.addManagedPropertyListener("quickFilterText",(e=>this.setQuickFilter(e.currentValue))),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],(()=>this.onQuickFilterColumnConfigChanged())),this.quickFilter=this.parseQuickFilter(this.gos.get("quickFilterText")),this.parser=this.gos.get("quickFilterParser"),this.matcher=this.gos.get("quickFilterMatcher"),this.setQuickFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],(()=>this.setQuickFilterParserAndMatcher()))}refreshQuickFilterCols(){const e=this.columnModel.isPivotMode(),t=this.columnModel.getAutoCols(),n=this.columnModel.getColDefCols();let i=(e&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")?this.pivotResultColsService.getPivotResultCols()?.list:n)??[];t&&(i=i.concat(t)),this.colsForQuickFilter=this.gos.get("includeHiddenColumnsInQuickFilter")?i:i.filter((e=>e.isVisible()||e.isRowGroupActive()))}isQuickFilterPresent(){return null!==this.quickFilter}doesRowPassQuickFilter(e){const t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassQuickFilterMatcher(t,e):this.quickFilterParts.every((n=>t?this.doesRowPassQuickFilterCache(e,n):this.doesRowPassQuickFilterNoCache(e,n)))}resetQuickFilterCache(){this.rowModel.forEachNode((e=>e.quickFilterAggregateText=null))}setQuickFilterParts(){const{quickFilter:e,parser:t}=this;this.quickFilterParts=e?t?t(e):e.split(" "):null}parseQuickFilter(e){return Dt(e)?Vt(this.gos)?e.toUpperCase():(bt("Quick filtering only works with the Client-Side Row Model"),null):null}setQuickFilter(e){if(null!=e&&"string"!==typeof e)return void bt("Grid option quickFilterText only supports string inputs, received: "+typeof e);const t=this.parseQuickFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setQuickFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setQuickFilterParserAndMatcher(){const e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),n=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,n&&(this.setQuickFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onQuickFilterColumnConfigChanged(){this.refreshQuickFilterCols(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassQuickFilterNoCache(e,t){return this.colsForQuickFilter.some((n=>{const i=this.getQuickFilterTextForColumn(n,e);return Dt(i)&&i.indexOf(t)>=0}))}doesRowPassQuickFilterCache(e,t){return this.checkGenerateQuickFilterAggregateText(e),e.quickFilterAggregateText.indexOf(t)>=0}doesRowPassQuickFilterMatcher(e,t){let n;e?(this.checkGenerateQuickFilterAggregateText(t),n=t.quickFilterAggregateText):n=this.getQuickFilterAggregateText(t);const{quickFilterParts:i,matcher:r}=this;return r(i,n)}checkGenerateQuickFilterAggregateText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getQuickFilterAggregateText(e))}getQuickFilterTextForColumn(e,t){let n=this.valueService.getValue(e,t,!0);const i=e.getColDef();if(i.getQuickFilterText){const r=this.gos.addGridCommonParams({value:n,node:t,data:t.data,column:e,colDef:i});n=i.getQuickFilterText(r)}return Dt(n)?n.toString().toUpperCase():null}getQuickFilterAggregateText(e){const t=[];return this.colsForQuickFilter.forEach((n=>{const i=this.getQuickFilterTextForColumn(n,e);Dt(i)&&t.push(i)})),t.join("\n")}}],dependantModules:[za]},Ka={version:Da,moduleName:"@ag-grid-community/filter",dependantModules:[qa,Wa,{version:Da,moduleName:"@ag-grid-community/quick-filter",dependantModules:[Xa,{version:Da,moduleName:"@ag-grid-community/quick-filter-api",apiFunctions:{isQuickFilterPresent:function(e){return!!e.filterManager?.isQuickFilterPresent()},getQuickFilter:function(e){return e.gos.get("quickFilterText")},resetQuickFilter:function(e){e.filterManager?.resetQuickFilterCache()}},dependantModules:[Xa]}]},Ua]},$a=(e=>(e.COLUMN_GROUP="group",e.COLUMN="column",e.FLOATING_FILTER="filter",e))($a||{}),Za=class extends Vn{constructor(){super(...arguments),this.beanName="headerNavigationService",this.currentHeaderRowWithoutSpan=-1}wireBeans(e){this.focusService=e.focusService,this.headerPositionUtils=e.headerPositionUtils,this.ctrlsService=e.ctrlsService,this.columnModel=e.columnModel,this.visibleColService=e.visibleColsService}postConstruct(){this.ctrlsService.whenReady(this,(e=>{this.gridBodyCon=e.gridBodyCtrl}));const e=en(this.gos);this.addManagedElementListeners(e,{mousedown:()=>this.setCurrentHeaderRowWithoutSpan(-1)})}getHeaderRowCount(){return this.ctrlsService.getHeaderRowContainerCtrl()?.getRowCount()??0}getHeaderPositionForColumn(e,t){let n;if("string"===typeof e?(n=this.columnModel.getCol(e),n||(n=this.visibleColService.getColumnGroup(e))):n=e,!n)return null;const i=this.ctrlsService.getHeaderRowContainerCtrl(),r=i?.getAllCtrls(),s="filter"===Rn(r||[]).getType(),o=this.getHeaderRowCount()-1;let a=-1,l=n;for(;l;)a++,l=l.getParent();let c=a;return t&&s&&c===o-1&&c++,-1===c?null:{headerRowIndex:c,column:n}}navigateVertically(e,t,n){if(t||(t=this.focusService.getFocusedHeader()),!t)return!1;const{headerRowIndex:i}=t,r=t.column,s=this.getHeaderRowCount(),o=0===e;let{headerRowIndex:a,column:l,headerRowIndexWithoutSpan:c}=o?this.headerPositionUtils.getColumnVisibleParent(r,i):this.headerPositionUtils.getColumnVisibleChild(r,i),u=!1;return a<0&&(a=0,l=r,u=!0),a>=s?(a=-1,this.setCurrentHeaderRowWithoutSpan(-1)):void 0!==c&&(this.currentHeaderRowWithoutSpan=c),!(!u&&!l)&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a,column:l},allowUserOverride:!0,event:n})}setCurrentHeaderRowWithoutSpan(e){this.currentHeaderRowWithoutSpan=e}navigateHorizontally(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const i=this.focusService.getFocusedHeader(),r=2===e,s=this.gos.get("enableRtl");let o,a;if(-1!==this.currentHeaderRowWithoutSpan?i.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=i.headerRowIndex,r!==s?(a="Before",o=this.headerPositionUtils.findHeader(i,a)):(a="After",o=this.headerPositionUtils.findHeader(i,a)),o||!t)return this.focusService.focusHeaderPosition({headerPosition:o,direction:a,fromTab:t,allowUserOverride:!0,event:n});if(t){const e=this.gos.getCallback("tabToNextHeader");if(e)return this.focusService.focusHeaderPositionFromUserFunc({userFunc:e,headerPosition:o,direction:a})}return this.focusNextHeaderRow(i,a,n)}focusNextHeaderRow(e,t,n){const i=e.headerRowIndex;let r,s=null;if("Before"===t?i>0&&(r=i-1,this.currentHeaderRowWithoutSpan-=1,s=this.headerPositionUtils.findColAtEdgeForHeaderRow(r,"end")):(r=i+1,this.currentHeaderRowWithoutSpan<this.getHeaderRowCount()?this.currentHeaderRowWithoutSpan+=1:this.setCurrentHeaderRowWithoutSpan(-1),s=this.headerPositionUtils.findColAtEdgeForHeaderRow(r,"start")),!s)return!1;const{column:o,headerRowIndex:a}=this.headerPositionUtils.getHeaderIndexToFocus(s.column,s?.headerRowIndex);return this.focusService.focusHeaderPosition({headerPosition:{column:o,headerRowIndex:a},direction:t,fromTab:!0,allowUserOverride:!0,event:n})}scrollToColumn(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"After";if(!e.getPinned()){if(Ni(e)){const i=e.getDisplayedLeafColumns();t="Before"===n?Rn(i):i[0]}else t=e;this.gridBodyCon.getScrollFeature().ensureColumnVisible(t)}}},Ya=class extends Vn{wireBeans(e){this.animationFrameService=e.animationFrameService,this.headerNavigationService=e.headerNavigationService,this.focusService=e.focusService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.ctrlsService=e.ctrlsService,this.filterManager=e.filterManager,this.menuService=e.menuService}setComp(e,t,n){this.comp=e,this.eGui=t,this.createManagedBean(new Ho(n,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),this.onPivotModeChanged(),this.setupHeaderHeight();const i=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:i}),this.mockContextMenuForIPad(i),this.ctrlsService.register("gridHeaderCtrl",this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({displayedColumnsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>this.animationFrameService.requestAnimationFrame((()=>e())),gridStylesChanged:e,advancedFilterEnabledChanged:e})}getHeaderHeight(){return this.headerHeight}setHeaderHeight(){const{columnModel:e}=this;let t=0;const n=this.columnModel.getGroupRowsHeight().reduce(((e,t)=>e+t),0),i=this.columnModel.getColumnHeaderRowHeight();if(this.filterManager?.hasFloatingFilters()&&(t+=e.getFloatingFiltersHeight()),t+=n,t+=i,this.headerHeight===t)return;this.headerHeight=t;const r=`${t+1}px`;this.comp.setHeightAndMinHeight(r),this.eventService.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(){const e=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",e),this.comp.addOrRemoveCssClass("ag-pivot-off",!e)}onDisplayedColumnsChanged(){const e=this.visibleColsService.getAllCols().some((e=>e.isSpanHeaderHeight()));this.comp.addOrRemoveCssClass("ag-header-allow-overflow",e)}onTabKeyDown(e){const t=this.gos.get("enableRtl"),n=e.shiftKey,i=n!==t?2:3;(this.headerNavigationService.navigateHorizontally(i,!0,e)||!n&&this.focusService.focusOverlay(!1)||this.focusService.focusNextGridCoreContainer(n,!0))&&e.preventDefault()}handleKeyDown(e){let t=null;switch(e.key){case As.LEFT:t=2;case As.RIGHT:Dt(t)||(t=3),this.headerNavigationService.navigateHorizontally(t,!1,e)&&e.preventDefault();break;case As.UP:t=0;case As.DOWN:Dt(t)||(t=1),this.headerNavigationService.navigateVertically(t,null,e)&&e.preventDefault();break;default:return}}onFocusOut(e){const{relatedTarget:t}=e;!t&&this.eGui.contains(rn(this.gos))||this.eGui.contains(t)||this.focusService.clearFocusedHeader()}onHeaderContextMenu(e,t,n){if(!e&&!n||!this.menuService.isHeaderContextMenuEnabled())return;const{target:i}=e??t;i!==this.eGui&&i!==this.ctrlsService.getHeaderRowContainerCtrl()?.getViewportElement()||this.menuService.showHeaderContextMenu(void 0,e,n)}mockContextMenuForIPad(e){if(!Dr())return;const t=new Ss(this.eGui);this.addManagedListeners(t,{longTap:t=>{e(void 0,t.touchStart,t.touchEvent)}}),this.addDestroyFunc((()=>t.destroy()))}},Ja=class extends Vn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.callback=e,this.addSpacer=t}wireBeans(e){this.visibleColsService=e.visibleColsService,this.scrollVisibleService=e.scrollVisibleService}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){const e=jt(this.gos,"print"),t=this.visibleColsService.getBodyContainerWidth(),n=this.visibleColsService.getColsLeftWidth(),i=this.visibleColsService.getDisplayedColumnsRightWidth();let r;if(e)r=t+n+i;else if(r=t,this.addSpacer){0===(this.gos.get("enableRtl")?n:i)&&this.scrollVisibleService.isVerticalScrollShowing()&&(r+=this.scrollVisibleService.getScrollbarWidth())}this.callback(r)}},Qa=class extends Vn{constructor(e){super(),this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=e}wireBeans(e){this.funcColsService=e.funcColsService}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const t=e.dragItem.columns;t&&t.forEach((e=>{e.isPrimary()&&(e.isAnyFunctionActive()||(e.isAllowValue()?this.columnsToAggregate.push(e):e.isAllowRowGroup()?this.columnsToGroup.push(e):e.isAllowPivot()&&this.columnsToPivot.push(e)))}))}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){this.columnsToAggregate.length>0&&this.funcColsService.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.funcColsService.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.funcColsService.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")}onDragCancel(){this.clearColumnsList()}};function el(e){const{isFromHeader:t,fromLeft:n,xPosition:i,fromEnter:r,fakeEvent:s,pinned:o,gos:a,columnModel:l,columnMoveService:c,visibleColsService:u}=e;let{allMovingColumns:h}=e;if(t){const e=[];h.forEach((t=>{let n=null,i=t.getParent();for(;null!=i&&1===i.getDisplayedLeafColumns().length;)n=i,i=i.getParent();if(null!=n){(!!n.getColGroupDef()?.marryChildren?n.getProvidedColumnGroup().getLeafColumns():n.getLeafColumns()).forEach((t=>{e.includes(t)||e.push(t)}))}else e.includes(t)||e.push(t)})),h=e}const d=h.slice();l.sortColsLikeCols(d);const p=function(e){const{movingCols:t,draggingRight:n,xPosition:i,pinned:r,gos:s,columnModel:o,visibleColsService:a}=e,l=s.get("suppressMovableColumns")||t.some((e=>e.getColDef().suppressMovable));if(l)return[];const c=function(e,t){switch(t){case"left":return e.getLeftCols();case"right":return e.getRightCols();default:return e.getCenterCols()}}(a,r),u=o.getCols(),h=c.filter((e=>Ln(t,e))),d=c.filter((e=>!Ln(t,e))),p=u.filter((e=>!Ln(t,e)));let g,f=0,m=i;if(n){let e=0;h.forEach((t=>e+=t.getActualWidth())),m-=e}if(m>0){for(let e=0;e<d.length;e++){if(m-=d[e].getActualWidth(),m<0)break;f++}n&&f++}if(f>0){const e=d[f-1];g=p.indexOf(e)+1}else g=p.indexOf(d[0]),-1===g&&(g=0);const v=[g],y=(e,t)=>e-t;if(n){let e=g+1;const t=u.length-1;for(;e<=t;)v.push(e),e++;v.sort(y)}else{let e=g;const t=u.length-1;let n=u[e];for(;e<=t&&c.indexOf(n)<0;)e++,v.push(e),n=u[e];e=g-1;const i=0;for(;e>=i;)v.push(e),e--;v.sort(y).reverse()}return v}({movingCols:d,draggingRight:n,xPosition:i,pinned:o,gos:a,columnModel:l,visibleColsService:u}),g=function(e,t){const n=t.getCols(),i=(o=e.map((e=>n.indexOf(e))),o.sort(((e,t)=>e-t))),r=i[0],s=Rn(i);var o;return s-r!==i.length-1?null:r}(d,l);if(0===p.length)return;const f=p[0];let m=null!==g&&!r;if(t&&(m=null!==g),m&&!s){if(!n&&f>=g)return;if(n&&f<=g)return}const v=u.getAllCols(),y=[];let C=null;for(let S=0;S<p.length;S++){const e=p[S],t=c.getProposedColumnOrder(d,e);if(!c.doesOrderPassRules(t))continue;const n=t.filter((e=>v.includes(e)));if(null===C)C=n;else if(!Tn(n,C))break;const i=nl(t);y.push({move:e,fragCount:i})}if(0===y.length)return;y.sort(((e,t)=>e.fragCount-t.fragCount));const w=y[0].move;return w>l.getCols().length-h.length?void 0:{columns:h,toIndex:w}}function tl(e){const{columns:t,toIndex:n}=el(e)||{},{finished:i,columnMoveService:r}=e;return t&&null!=n?(r.moveColumns(t,n,"uiColumnMoved",i),i?null:{columns:t,toIndex:n}):null}function nl(e){function t(e){const t=[];let n=e.getOriginalParent();for(;null!=n;)t.push(n),n=n.getOriginalParent();return t}let n=0;for(let i=0;i<e.length-1;i++){let r=t(e[i]),s=t(e[i+1]);[r,s]=r.length>s.length?[r,s]:[s,r],r.forEach((e=>{-1===s.indexOf(e)&&n++}))}return n}function il(e){const{pinned:t,fromKeyboard:n,gos:i,ctrlsService:r,useHeaderRow:s,skipScrollPadding:o}=e;let a=r.getHeaderRowContainerCtrl(t)?.getViewportElement(),{x:l}=e;return a?(n&&(l-=a.getBoundingClientRect().left),i.get("enableRtl")&&(s&&(a=a.querySelector(".ag-header-row")),l=a.clientWidth-l),null!=t||o||(l+=r.get("center").getCenterViewportScrollLeft()),l):0}function rl(e,t){for(const n of e)n.setMoving(t,"uiColumnMoved")}var sl=class extends Vn{constructor(e){super(),this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=e,this.isCenterContainer=!Dt(e)}wireBeans(e){this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.columnMoveService=e.columnMoveService,this.dragAndDropService=e.dragAndDropService,this.ctrlsService=e.ctrlsService}postConstruct(){this.ctrlsService.whenReady(this,(e=>{this.gridBodyCon=e.gridBodyCtrl}))}getIconName(){const e=this.lastDraggingEvent?.dragItem.columns??[];for(const t of e){const e=t.getPinned();if(t.getColDef().lockPinned){if(e==this.pinned)return"move"}else{if(e===this.pinned||!this.pinned)return"move";if(!e&&this.pinned)return"pinned"}}return"notAllowed"}onDragEnter(e){const t=e.dragItem.columns;if(0===e.dragSource.type)this.setColumnsVisible(t,!0,"uiColumnDragged");else{const n=e.dragItem.visibleState,i=(t||[]).filter((e=>n[e.getId()]));this.setColumnsVisible(i,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(t,this.pinned),this.onDragging(e,!0,!0)}onDragging(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.lastDraggingEvent,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=this.gos.get("suppressMoveWhenColumnDragging");if(i&&!r)return void this.finishColumnMoving();if(this.lastDraggingEvent=e,!e||!i&&Lt(e.hDirection))return;const{pinned:s,gos:o,ctrlsService:a}=this,l=il({x:e.x,pinned:s,gos:o,ctrlsService:a});t||this.checkCenterForScrolling(l),r?this.handleColumnDragWhileSuppressingMovement(e,t,n,l,i):this.handleColumnDragWhileAllowingMovement(e,t,n,l,i)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,n){if(!e)return;const i=e.filter((e=>!e.getColDef().lockVisible));this.columnModel.setColsVisible(i,t,n)}finishColumnMoving(){if(this.clearHighlighted(),!this.lastMovedInfo)return;const{columns:e,toIndex:t}=this.lastMovedInfo;this.columnMoveService.moveColumns(e,t,"uiColumnMoved",!0)}handleColumnDragWhileSuppressingMovement(e,t,n,i,r){const s=this.getAllMovingColumns(e,!0);if(r){const e=this.isAttemptingToPin(s);e&&this.attemptToPinColumns(s,void 0,!0);const{fromLeft:i,xPosition:r}=this.getNormalisedXPositionInfo(s,e)||{};if(null==i||null==r)return void this.finishColumnMoving();this.moveColumnsAfterHighlight({allMovingColumns:s,xPosition:r,fromEnter:t,fakeEvent:n,fromLeft:i})}else{if(!this.dragAndDropService.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(s,i)}}handleColumnDragWhileAllowingMovement(e,t,n,i,r){const s=this.getAllMovingColumns(e),o=1===this.normaliseDirection(e.hDirection),a=1===e.dragSource.type,l=tl({...this.getMoveColumnParams({allMovingColumns:s,isFromHeader:a,xPosition:i,fromLeft:o,fromEnter:t,fakeEvent:n}),finished:r});l&&(this.lastMovedInfo=l)}getAllMovingColumns(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.dragSource.getDragItem();let i=null;t?(i=n.columnsInSplit,i||(i=n.columns)):i=n.columns;return i?i.filter((e=>!e.getColDef().lockPinned||e.getPinned()==this.pinned)):[]}getMoveColumnParams(e){const{allMovingColumns:t,isFromHeader:n,xPosition:i,fromLeft:r,fromEnter:s,fakeEvent:o}=e,{pinned:a,gos:l,columnModel:c,columnMoveService:u,visibleColsService:h}=this;return{allMovingColumns:t,isFromHeader:n,fromLeft:r,xPosition:i,pinned:a,fromEnter:s,fakeEvent:o,gos:l,columnModel:c,columnMoveService:u,visibleColsService:h}}findFirstAndLastMovingColumns(e){const t=e.length;let n,i;for(let r=0;r<=t;r++){if(!n){const t=e[r];null!=t.getLeft()&&(n=t)}if(!i){const n=e[t-1-r];null!=n.getLeft()&&(i=n)}if(n&&i)break}return{firstMovingCol:n,lastMovingCol:i}}highlightHoveredColumn(e,t){const{gos:n,columnModel:i}=this,r=n.get("enableRtl"),s=i.getCols().filter((e=>e.isVisible()&&e.getPinned()===this.pinned));let o,a=null,l=null,c=null;for(const u of s){if(l=u.getActualWidth(),a=this.getNormalisedColumnLeft(u,0,r),null!=a){if(a<=t&&a+l>=t){c=u;break}}a=null,l=null}if(c)-1!==e.indexOf(c)&&(c=null);else{for(let e=s.length-1;e>=0;e--){const t=s[e],n=s[e].getParent();if(!n){c=t;break}const i=n?.getDisplayedLeafColumns();if(i.length){c=Rn(i);break}}if(!c)return;a=this.getNormalisedColumnLeft(c,0,r),l=c.getActualWidth()}this.lastHighlightedColumn?.column!==c&&this.clearHighlighted(),null!=c&&null!=a&&null!=l&&(o=t-a<l/2!==r?0:1,c.setHighlighted(o),this.lastHighlightedColumn={column:c,position:o})}getNormalisedXPositionInfo(e,t){const{gos:n,visibleColsService:i}=this,r=n.get("enableRtl"),{firstMovingCol:s,column:o,position:a}=this.getColumnMoveAndTargetInfo(e,t,r);if(!s||!o||null==a)return;const l=i.getAllCols(),c=l.indexOf(s),u=l.indexOf(o),h=0===a!==r,d=c<u||c===u&&!h;let p=0;if(h?d&&(p-=1):d||(p+=1),u+p===c)return;const g=l[u+p];if(!g)return;return{fromLeft:d,xPosition:this.getNormalisedColumnLeft(g,20,r)}}getColumnMoveAndTargetInfo(e,t,n){const i=this.lastHighlightedColumn||{},{firstMovingCol:r,lastMovingCol:s}=this.findFirstAndLastMovingColumns(e);if(!r||!s||i.column||!t)return{firstMovingCol:r,...i};const o="left"===this.getPinDirection();return{firstMovingCol:r,position:o?1:0,column:o!==n?r:s}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case 0:return 1;case 1:return 0}return e}getNormalisedColumnLeft(e,t,n){const{gos:i,ctrlsService:r}=this,s=e.getLeft();if(null==s)return null;const o=e.getActualWidth();return il({x:n?s+o-t:s+t,pinned:e.getPinned(),useHeaderRow:n,skipScrollPadding:!0,gos:i,ctrlsService:r})}isAttemptingToPin(e){const t=this.needToMoveLeft||this.needToMoveRight,n=this.failedMoveAttempts>7;return t&&n||e.some((e=>e.getPinned()!==this.pinned))}moveColumnsAfterHighlight(e){const{allMovingColumns:t,xPosition:n,fromEnter:i,fakeEvent:r,fromLeft:s}=e,o=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:n,fromLeft:s,fromEnter:i,fakeEvent:r}),{columns:a,toIndex:l}=el(o)||{};a&&null!=l&&(this.lastMovedInfo={columns:a,toIndex:l}),this.finishColumnMoving()}clearHighlighted(){this.lastHighlightedColumn&&(this.lastHighlightedColumn.column.setHighlighted(null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;const t=this.ctrlsService.get("center"),n=t.getCenterViewportScrollLeft(),i=n+t.getCenterWidth();this.gos.get("enableRtl")?(this.needToMoveRight=e<n+50,this.needToMoveLeft=e>i-50):(this.needToMoveLeft=e<n+50,this.needToMoveRight=e>i-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.dragAndDropService.getDragAndDropImageComponent()?.setIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.dragAndDropService.getDragAndDropImageComponent()?.setIcon(this.getIconName()))}moveInterval(){let e;this.intervalCount++,e=10+5*this.intervalCount,e>100&&(e=100);let t=null;const n=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?t=n.scrollHorizontally(-e):this.needToMoveRight&&(t=n.scrollHorizontally(e)),0!==t)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{if(this.failedMoveAttempts++,this.failedMoveAttempts<=8)return;if(this.dragAndDropService.getDragAndDropImageComponent()?.setIcon("pinned"),!this.gos.get("suppressMoveWhenColumnDragging")){const e=this.lastDraggingEvent?.dragItem.columns;this.attemptToPinColumns(e,void 0,!0)}}}getPinDirection(){return this.needToMoveLeft||"left"===this.pinned?"left":this.needToMoveRight||"right"===this.pinned?"right":void 0}attemptToPinColumns(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=(e||[]).filter((e=>!e.getColDef().lockPinned));return i.length?(n&&(t=this.getPinDirection()),this.columnModel.setColsPinned(i,t,"uiColumnDragged"),n&&this.dragAndDropService.nudge(),i.length):0}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}},ol=class extends Vn{wireBeans(e){this.dragAndDropService=e.dragAndDropService,this.columnModel=e.columnModel,this.ctrlsService=e.ctrlsService}constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){this.ctrlsService.whenReady(this,(e=>{switch(this.pinned){case"left":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.left.getContainerElement()],[e.bottomLeft.getContainerElement()],[e.topLeft.getContainerElement()]];break;case"right":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.right.getContainerElement()],[e.bottomRight.getContainerElement()],[e.topRight.getContainerElement()]];break;default:this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.center.getViewportElement()],[e.bottomCenter.getViewportElement()],[e.topCenter.getViewportElement()]]}})),this.moveColumnFeature=this.createManagedBean(new sl(this.pinned)),this.bodyDropPivotTarget=this.createManagedBean(new Qa(this.pinned)),this.dragAndDropService.addDropTarget(this),this.addDestroyFunc((()=>this.dragAndDropService.removeDropTarget(this)))}isInterestedIn(e){return 1===e||0===e&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.columnModel.isPivotMode()&&0===e.dragSource.type}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}},al=class extends Vn{wireBeans(e){this.horizontalResizeService=e.horizontalResizeService,this.pinnedWidthService=e.pinnedWidthService,this.ctrlsService=e.ctrlsService,this.columnSizeService=e.columnSizeService,this.columnAutosizeService=e.columnAutosizeService}constructor(e,t,n,i,r){super(),this.pinned=e,this.column=t,this.eResize=n,this.comp=i,this.ctrl=r}postConstruct(){const e=[];let t,n;const i=()=>{if(zr(this.eResize,t),!t)return;const i=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(e.push(i),n){const t=this.gos.get("skipHeaderOnAutoSize"),n=()=>{this.columnAutosizeService.autoSizeColumn(this.column,"uiColumnResized",t)};this.eResize.addEventListener("dblclick",n);const i=new Ss(this.eResize);i.addEventListener("doubleTap",n),e.push((()=>{this.eResize.removeEventListener("dblclick",n),i.removeEventListener("doubleTap",n),i.destroy()}))}},r=()=>{e.forEach((e=>e())),e.length=0},s=()=>{const e=this.column.isResizable(),s=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(e!==t||s!==n)&&(t=e,n=s,r(),i())};s(),this.addDestroyFunc(r),this.ctrl.setRefreshFunction("resize",s)}onResizing(e,t){const{column:n,lastResizeAmount:i,resizeStartWidth:r}=this,s=this.normaliseResizeAmount(t),o=[{key:n,newWidth:r+s}];if(this.column.getPinned()){if(this.pinnedWidthService.getPinnedLeftWidth()+this.pinnedWidthService.getPinnedRightWidth()+(s-i)>Wr(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50)return}this.lastResizeAmount=s,this.columnSizeService.setColumnWidths(o,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e;const n="left"!==this.pinned,i="right"===this.pinned;return this.gos.get("enableRtl")?n&&(t*=-1):i&&(t*=-1),t}},ll=class extends Vn{constructor(e){super(),this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1,this.column=e}wireBeans(e){this.rowModel=e.rowModel,this.selectionService=e.selectionService}onSpaceKeyDown(e){const t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(rn(this.gos))&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e,this.cbSelectAll=this.createManagedBean(new Is),this.cbSelectAll.addCssClass("ag-header-select-all"),pr(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedEventListeners({newColumnsLoaded:this.onNewColumnsLoaded.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:this.onSelectionChanged.bind(this),paginationChanged:this.onSelectionChanged.bind(this),modelUpdated:this.onModelChanged.bind(this)}),this.addManagedListeners(this.cbSelectAll,{fieldValueChanged:this.onCbSelectAll.bind(this)}),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onNewColumnsLoaded(){this.showOrHideSelectAll()}onDisplayedColumnsChanged(){this.isAlive()&&this.showOrHideSelectAll()}showOrHideSelectAll(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()}onModelChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}onSelectionChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}updateStateOfCheckbox(){if(this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const e=this.selectionService.getSelectAllState(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setValue(e);const t=this.selectionService.hasNodesToSelect(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setDisabled(!t),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(){const e=this.localeService.getLocaleTextFunc(),t=this.cbSelectAll.getValue()?e("ariaChecked","checked"):e("ariaUnchecked","unchecked"),n=e("ariaRowSelectAll","Press Space to toggle all rows selection");this.cbSelectAllVisible?this.headerCellCtrl.setAriaDescriptionProperty("selectAll",`${n} (${t})`):this.headerCellCtrl.setAriaDescriptionProperty("selectAll",null),this.cbSelectAll.setInputAriaLabel(e("ariaHeaderSelection","Column with Header Selection")),this.headerCellCtrl.announceAriaDescription()}checkSelectionType(e){return!!xn(this.gos)||(bt(`${e} is only available if using 'multiRow' selection mode.`),!1)}checkRightRowModelType(e){return!(!Vt(this.gos)&&!Wt(this.gos))||(bt(`${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${this.rowModel.getType()}.`),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox)return;if(!this.cbSelectAllVisible)return;const e=this.cbSelectAll.getValue(),t=this.isFilteredOnly(),n=this.isCurrentPageOnly();let i="uiSelectAll";n?i="uiSelectAllCurrentPage":t&&(i="uiSelectAllFiltered");const r={source:i,justFiltered:t,justCurrentPage:n};e?this.selectionService.selectAllRowNodes(r):this.selectionService.deselectAllRowNodes(r)}isCheckboxSelection(){const e=this.gos.get("rowSelection"),t="object"===typeof e&&mn(e)&&Qn(this.column),n=this.column.getColDef().headerCheckboxSelection;let i=!1;return i=!!t||("function"===typeof n?n(this.gos.addGridCommonParams({column:this.column,colDef:this.column.getColDef()})):!!n),i&&this.checkRightRowModelType(t?"headerCheckbox":"headerCheckboxSelection")&&this.checkSelectionType(t?"headerCheckbox":"headerCheckboxSelection")}isFilteredOnly(){const e=this.gos.get("rowSelection");return"object"===typeof e?"multiRow"===e.mode&&"filtered"===e.selectAll:!!this.column.getColDef().headerCheckboxSelectionFilteredOnly}isCurrentPageOnly(){const e=this.gos.get("rowSelection");return"object"===typeof e?"multiRow"===e.mode&&"currentPage"===e.selectAll:!!this.column.getColDef().headerCheckboxSelectionCurrentPageOnly}},cl=class extends Aa{constructor(e,t,n){super(e,t,n),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map,this.column=e}setComp(e,t,n,i,r){this.comp=e,r=Yi(this,this.beans.context,r),this.setGui(t,r),this.updateState(),this.setupWidth(r),this.setupMovingCss(r),this.setupMenuClass(r),this.setupSortableClass(r),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:i,checkMeasuringCallback:e=>this.setRefreshFunction("measuring",e),compBean:r}),this.addColumnHoverListener(r),this.setupFilterClass(r),this.setupClassesFromColDef(),this.setupTooltip(r),this.addActiveHeaderMouseListeners(r),this.setupSelectAll(r),this.setupUserComp(r),this.refreshAria(),this.resizeFeature=r.createManagedBean(new al(this.getPinned(),this.column,n,e,this)),r.createManagedBean(new Fa([this.column],t)),r.createManagedBean(new _a(this.column,t,this.beans)),r.createManagedBean(new Ho(t,{shouldStopEventPropagation:e=>this.shouldStopEventPropagation(e),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(r),r.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader"],(()=>this.refresh(r))),r.addManagedListeners(this.column,{colDefChanged:()=>this.refresh(r)}),r.addManagedListeners(this.column,{headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});const s=()=>this.checkDisplayName(r);r.addManagedEventListeners({columnValueChanged:s,columnRowGroupChanged:s,columnPivotChanged:s,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),r.addDestroyFunc((()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()}))}resizeHeader(e,t){if(!this.column.isResizable())return;const n=this.column.getActualWidth(),i=this.column.getMinWidth(),r=this.column.getMaxWidth(),s=Math.min(Math.max(n+e,i),r);this.beans.columnSizeService.setColumnWidths([{key:this.column,newWidth:s}],t,!0,"uiColumnResized")}moveHeader(e){const{eGui:t,beans:n,column:i,ctrlsService:r}=this,{gos:s,columnModel:o,columnMoveService:a,visibleColsService:l}=n,c=this.getPinned(),u=t.getBoundingClientRect().left,h=i.getActualWidth(),d=il({x:0===e!==s.get("enableRtl")?u-20:u+h+20,pinned:c,fromKeyboard:!0,gos:s,ctrlsService:r}),p=this.focusService.getFocusedHeader();tl({allMovingColumns:[i],isFromHeader:!0,fromLeft:1===e,xPosition:d,pinned:c,fromEnter:!1,fakeEvent:!1,gos:s,columnModel:o,columnMoveService:a,visibleColsService:l,finished:!0}),r.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(i,"auto"),this.isAlive()&&!this.beans.gos.get("ensureDomOrder")||!p||this.restoreFocus(p)}restoreFocus(e){this.focusService.focusHeaderPosition({headerPosition:{...e,column:this.column}})}setupUserComp(e){const t=this.lookupUserCompDetails(e);this.setCompDetails(t)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(e){const t=this.createParams(e),n=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(n,t)}createParams(e){return this.gos.addGridCommonParams({column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&this.menuService.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!this.openFilterEnabled||this.menuService.isLegacyMenuEnabled(),showColumnMenu:e=>{this.menuService.showColumnMenu({column:this.column,buttonElement:e,positionBy:"button"})},showColumnMenuAfterMouseClick:e=>{this.menuService.showColumnMenu({column:this.column,mouseEvent:e,positionBy:"mouse"})},showFilter:e=>{this.menuService.showFilterMenu({column:this.column,buttonElement:e,containerType:"columnFilter",positionBy:"button"})},progressSort:e=>{this.beans.sortController.progressSort(this.column,!!e,"uiColumnSorted")},setSort:(e,t)=>{this.beans.sortController.setSortForColumn(this.column,e,!!t,"uiColumnSorted")},eGridHeader:this.getGui(),setTooltip:(t,n)=>{this.setupTooltip(e,t,n)}})}setupSelectAll(e){this.selectAllFeature=e.createManagedBean(new ll(this.column)),this.selectAllFeature.setComp(this)}getSelectAllGui(){return this.selectAllFeature.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===As.SPACE&&this.selectAllFeature.onSpaceKeyDown(e),e.key===As.ENTER&&this.onEnterKeyDown(e),e.key===As.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){if(e.ctrlKey||e.metaKey)this.showMenuOnKeyPress(e,!0);else if(this.sortable){const t=e.shiftKey;this.beans.sortController.progressSort(this.column,t,"uiColumnSorted")}}showMenuOnKeyPress(e,t){const n=this.comp.getUserCompInstance();n&&n instanceof Es&&n.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){if(!this.getGui().contains(e.relatedTarget)){const e=this.getRowIndex();this.focusService.setFocusedHeader(e,this.column),this.announceAriaDescription()}this.focusService.isKeyboardMode()&&this.setActiveHeader(!0)}onFocusOut(e){this.getGui().contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t,n){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const i="whenTruncated"===this.gos.get("tooltipShowMode"),r=this.eGui,s=this.column.getColDef();n||!i||s.headerComponent||(n=()=>{const e=r.querySelector(".ag-header-cell-text");return!e||e.scrollWidth>e.clientWidth});const o={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getGui:()=>r,getLocation:()=>"header",getTooltipValue:()=>{if(null!=t)return t;return this.column.getColDef().headerTooltip},shouldDisplayTooltip:n},a=e.createManagedBean(new ds(o));this.setRefreshFunction("tooltip",(()=>a.refreshToolTip()))}setupClassesFromColDef(){const e=()=>{const e=Ma(this.column.getColDef(),this.gos,this.column,null),t=this.userHeaderClasses;this.userHeaderClasses=new Set(e),e.forEach((e=>{t.has(e)?t.delete(e):this.comp.addOrRemoveCssClass(e,!0)})),t.forEach((e=>this.comp.addOrRemoveCssClass(e,!1)))};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){if(this.dragSourceElement=e,this.removeDragSource(),!e||!this.draggable)return;const{column:t,beans:n,displayName:i,dragAndDropService:r,gos:s}=this,{columnModel:o}=n;let a=!this.gos.get("suppressDragLeaveHidesColumns");const l=this.dragSource={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:()=>this.createDragItem(t),dragItemName:i,onDragStarted:()=>{a=!s.get("suppressDragLeaveHidesColumns"),rl([t],!0)},onDragStopped:()=>rl([t],!1),onDragCancelled:()=>rl([t],!1),onGridEnter:e=>{if(a){const t=e?.columns?.filter((e=>!e.getColDef().lockVisible))||[];o.setColsVisible(t,!0,"uiColumnMoved")}},onGridExit:e=>{if(a){const t=e?.columns?.filter((e=>!e.getColDef().lockVisible))||[];o.setColsVisible(t,!1,"uiColumnMoved")}}};r.addDragSource(l,!0)}createDragItem(e){const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t}}updateState(){this.menuEnabled=this.menuService.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=this.menuService.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(e){this.updateState(),this.refreshHeaderComp(e),this.refreshAria(),Object.values(this.refreshFunctions).forEach((e=>e()))}refreshHeaderComp(e){const t=this.lookupUserCompDetails(e);!!(null!=this.comp.getUserCompInstance()&&this.userCompDetails.componentClass==t.componentClass)&&this.attemptHeaderCompRefresh(t.params)?this.setDragSource(this.dragSourceElement):this.setCompDetails(t)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();if(!t)return!1;if(!t.refresh)return!1;return t.refresh(e)}calculateDisplayName(){return this.beans.columnNameService.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(e){this.displayName!==this.calculateDisplayName()&&this.refresh(e)}workOutDraggable(){const e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){const t=()=>{const e=this.column.getActualWidth();this.comp.setWidth(`${e}px`)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){const t=()=>{const e=this.column.isFilterActive();this.comp.addOrRemoveCssClass("ag-header-cell-filtered",e),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){const e=()=>{const e=!!this.column.getColDef().wrapHeaderText;this.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",e)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){const e=this.column.getHighlighted(),t=0===e,n=1===e;this.comp.addOrRemoveCssClass("ag-header-highlight-before",t),this.comp.addOrRemoveCssClass("ag-header-highlight-after",n)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui:e,column:t,comp:n,beans:i}=this,r=this.beans.columnModel.getGroupRowsHeight(),s=0===r.reduce(((e,t)=>e+t),0);if(n.addOrRemoveCssClass("ag-header-parent-hidden",s),!t.isSpanHeaderHeight())return e.style.removeProperty("top"),e.style.removeProperty("height"),n.addOrRemoveCssClass("ag-header-span-height",!1),void n.addOrRemoveCssClass("ag-header-span-total",!1);const{numberOfParents:o,isSpanningTotal:a}=this.column.getColumnGroupPaddingInfo();n.addOrRemoveCssClass("ag-header-span-height",o>0);const{columnModel:l}=i,c=l.getColumnHeaderRowHeight();if(0===o)return n.addOrRemoveCssClass("ag-header-span-total",!1),e.style.setProperty("top","0px"),void e.style.setProperty("height",`${c}px`);n.addOrRemoveCssClass("ag-header-span-total",a);let u=0;for(let h=0;h<o;h++)u+=r[r.length-1-h];e.style.setProperty("top",-u+"px"),e.style.setProperty("height",`${c+u}px`)}refreshAriaSort(){if(this.sortable){const e=this.localeService.getLocaleTextFunc(),t=this.beans.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(function(e){let t;return t="asc"===e?"ascending":"desc"===e?"descending":"mixed"===e?"other":"none",t}(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!this.menuService.isLegacyMenuEnabled()){const e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){const e=this.localeService.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){null!=t?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){if(!this.eGui.contains(rn(this.beans.gos)))return;const e=Array.from(this.ariaDescriptionProperties.keys()).sort(((e,t)=>"filter"===e?-1:t.charCodeAt(0)-e.charCodeAt(0))).map((e=>this.ariaDescriptionProperties.get(e))).join(". ");this.beans.ariaAnnouncementService.announceValue(e,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(e){const t=()=>{if(!this.gos.get("columnHoverHighlight"))return;const e=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",e)};e.addManagedEventListeners({columnHoverChanged:t}),t()}getColId(){return this.column.getColId()}addActiveHeaderMouseListeners(e){const t=e=>this.handleMouseOverChange("mouseenter"===e.type);e.addManagedListeners(this.getGui(),{mouseenter:t,mouseleave:t,click:()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column),contextmenu:e=>this.handleContextMenuMouseEvent(e,void 0,this.column)})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventService.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.addOrRemoveCssClass("ag-header-active",e)}getAnchorElementForMenu(e){const t=this.comp.getUserCompInstance();return t instanceof Es?t.getAnchorElementForMenu(e):this.getGui()}destroy(){super.destroy()}},ul=class extends Vn{wireBeans(e){this.horizontalResizeService=e.horizontalResizeService,this.autoWidthCalculator=e.autoWidthCalculator,this.visibleColsService=e.visibleColsService,this.columnSizeService=e.columnSizeService,this.columnAutosizeService=e.columnAutosizeService}constructor(e,t,n,i){super(),this.eResize=t,this.comp=e,this.pinned=n,this.columnGroup=i}postConstruct(){if(!this.columnGroup.isResizable())return void this.comp.setResizableDisplayed(!1);const e=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(e),!this.gos.get("suppressAutoSize")){const e=this.gos.get("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",(()=>{const t=[];this.columnGroup.getDisplayedLeafColumns().forEach((e=>{e.getColDef().suppressAutoSize||t.push(e.getColId())})),t.length>0&&this.columnAutosizeService.autoSizeCols({colKeys:t,skipHeader:e,stopAtGroup:this.columnGroup,source:"uiColumnResized"}),this.resizeLeafColumnsToFit("uiColumnResized")}))}}onResizeStart(e){const t=this.getInitialValues(e);this.storeLocalValues(t),this.toggleColumnResizing(!0)}onResizing(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"uiColumnResized";const i=this.normaliseDragChange(t),r=this.resizeStartWidth+i;this.resizeColumnsFromLocalValues(r,n,e)}getInitialValues(e){const t=this.getColumnsToResize(),n=this.getInitialSizeOfColumns(t),i={columnsToResize:t,resizeStartWidth:n,resizeRatios:this.getSizeRatiosOfColumns(t,n)};let r=null;if(e&&(r=this.visibleColsService.getGroupAtDirection(this.columnGroup,"After")),r){const e=r.getDisplayedLeafColumns(),t=i.groupAfterColumns=e.filter((e=>e.isResizable())),n=i.groupAfterStartWidth=this.getInitialSizeOfColumns(t);i.groupAfterRatios=this.getSizeRatiosOfColumns(t,n)}else i.groupAfterColumns=void 0,i.groupAfterStartWidth=void 0,i.groupAfterRatios=void 0;return i}storeLocalValues(e){const{columnsToResize:t,resizeStartWidth:n,resizeRatios:i,groupAfterColumns:r,groupAfterStartWidth:s,groupAfterRatios:o}=e;this.resizeCols=t,this.resizeStartWidth=n,this.resizeRatios=i,this.resizeTakeFromCols=r,this.resizeTakeFromStartWidth=s,this.resizeTakeFromRatios=o}clearLocalValues(){this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}resizeLeafColumnsToFit(e){const t=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup),n=this.getInitialValues();t>n.resizeStartWidth&&this.resizeColumns(n,t,e,!0)}resizeColumnsFromLocalValues(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!this.resizeCols||!this.resizeRatios)return;const i={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols??void 0,groupAfterStartWidth:this.resizeTakeFromStartWidth??void 0,groupAfterRatios:this.resizeTakeFromRatios??void 0};this.resizeColumns(i,e,t,n)}resizeColumns(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const{columnsToResize:r,resizeStartWidth:s,resizeRatios:o,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:c}=e,u=[];if(u.push({columns:r,ratios:o,width:t}),a){const e=t-s;u.push({columns:a,ratios:c,width:l-e})}this.columnSizeService.resizeColumnSets({resizeSets:u,finished:i,source:n}),i&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter((e=>e.isResizable()))}getInitialSizeOfColumns(e){return e.reduce(((e,t)=>e+t.getActualWidth()),0)}getSizeRatiosOfColumns(e,t){return e.map((e=>e.getActualWidth()/t))}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?"left"!==this.pinned&&(t*=-1):"right"===this.pinned&&(t*=-1),t}destroy(){super.destroy(),this.clearLocalValues()}},hl=class extends Vn{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const e=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach((t=>{t.addEventListener("widthChanged",e),t.addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push((()=>{t.removeEventListener("widthChanged",e),t.removeEventListener("visibleChanged",e)}))}))}removeListenersOnChildrenColumns(){this.removeChildListenersFuncs.forEach((e=>e())),this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.addOrRemoveCssClass("ag-hidden",0===e)}},dl=class extends Aa{constructor(e,t,n){super(e,t,n),this.onSuppressColMoveChange=()=>{if(!this.isAlive()||this.isSuppressMoving())this.removeDragSource();else if(!this.dragSource){const e=this.getGui();this.setDragSource(e)}},this.column=e}setComp(e,t,n,i,r){this.comp=e,r=Yi(this,this.beans.context,r),this.setGui(t,r),this.displayName=this.beans.columnNameService.getDisplayNameForColumnGroup(this.column,"header"),this.addClasses(),this.setupMovingCss(r),this.setupExpandable(r),this.setupTooltip(r),this.setupAutoHeight({wrapperElement:i,compBean:r}),this.setupUserComp(r),this.addHeaderMouseListeners(r),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();const s=this.getParentRowCtrl().getPinned(),o=this.column.getProvidedColumnGroup().getLeafColumns();r.createManagedBean(new Fa(o,t)),r.createManagedBean(new _a(this.column,t,this.beans)),r.createManagedBean(new hl(e,this.column)),this.resizeFeature=r.createManagedBean(new ul(e,n,s,this.column)),r.createManagedBean(new Ho(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(r,o),r.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(r),r.addDestroyFunc((()=>this.clearComponent()))}refreshMaxHeaderHeight(){const{gos:e,comp:t}=this,n=e.get("groupHeaderHeight");null!=n?0===n?t.setHeaderWrapperHidden(!0):t.setHeaderWrapperMaxHeight(n):(t.setHeaderWrapperHidden(!1),t.setHeaderWrapperMaxHeight(null))}addHighlightListeners(e,t){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(const n of t)e.addManagedListeners(n,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,n)})}onLeafColumnHighlightChanged(e){const t=this.column.getDisplayedLeafColumns(),n=t[0]===e,i=Rn(t)===e;if(!n&&!i)return;const r=e.getHighlighted();let s=!1,o=!1;if(!!this.getParentRowCtrl().findHeaderCellCtrl((e=>e.getColumnGroupChild().isMoving()))){const e=this.beans.gos.get("enableRtl"),t=1===r,a=0===r;n&&(e?o=t:s=a),i&&(e?s=a:o=t)}this.comp.addOrRemoveCssClass("ag-header-highlight-before",s),this.comp.addOrRemoveCssClass("ag-header-highlight-after",o)}getColumn(){return this.column}resizeHeader(e,t){if(!this.resizeFeature)return;const n=this.resizeFeature.getInitialValues(t);this.resizeFeature.resizeColumns(n,n.resizeStartWidth+e,"uiColumnResized",!0)}moveHeader(e){const{beans:t,eGui:n,column:i,ctrlsService:r}=this,{gos:s,columnModel:o,columnMoveService:a,visibleColsService:l}=t,c=s.get("enableRtl"),u=0===e,h=this.getPinned(),d=n.getBoundingClientRect(),p=d.left,g=d.width,f=il({x:u!==c?p-20:p+g+20,pinned:h,fromKeyboard:!0,gos:s,ctrlsService:r}),m=i.getGroupId(),v=this.focusService.getFocusedHeader();tl({allMovingColumns:this.column.getLeafColumns(),isFromHeader:!0,fromLeft:1===e,xPosition:f,pinned:h,fromEnter:!1,fakeEvent:!1,gos:s,columnModel:o,columnMoveService:a,visibleColsService:l,finished:!0});const y=i.getDisplayedLeafColumns(),C=u?y[0]:Rn(y);this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(C,"auto"),this.isAlive()&&!this.beans.gos.get("ensureDomOrder")||!v||this.restoreFocus(m,i,v)}restoreFocus(e,t,n){const i=t.getLeafColumns();if(!i.length)return;const r=i[0].getParent();if(!r)return;const s=this.findGroupWidthId(r,e);s&&this.focusService.focusHeaderPosition({headerPosition:{...n,column:s}})}findGroupWidthId(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}return null}resizeLeafColumnsToFit(e){this.resizeFeature&&this.resizeFeature.resizeLeafColumnsToFit(e)}setupUserComp(e){const t=this.gos.addGridCommonParams({displayName:this.displayName,columnGroup:this.column,setExpanded:e=>{this.beans.columnModel.setColumnGroupOpened(this.column.getProvidedColumnGroup(),e,"gridInitializing")},setTooltip:(t,n)=>{this.setupTooltip(e,t,n)}}),n=this.userComponentFactory.getHeaderGroupCompDetails(t);this.comp.setUserCompDetails(n)}addHeaderMouseListeners(e){const t=e=>this.handleMouseOverChange("mouseenter"===e.type);e.addManagedListeners(this.getGui(),{mouseenter:t,mouseleave:t,click:()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column.getProvidedColumnGroup()),contextmenu:e=>this.handleContextMenuMouseEvent(e,void 0,this.column.getProvidedColumnGroup())})}handleMouseOverChange(e){this.eventService.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t,n){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const i=this.column.getColGroupDef(),r="whenTruncated"===this.gos.get("tooltipShowMode"),s=this.eGui;n||!r||i?.headerGroupComponent||(n=()=>{const e=s.querySelector(".ag-header-group-text");return!e||e.scrollWidth>e.clientWidth});const o={getColumn:()=>this.column,getGui:()=>s,getLocation:()=>"headerGroup",getTooltipValue:()=>t??(i&&i.headerTooltip),shouldDisplayTooltip:n};i&&(o.getColDef=()=>i),e.createManagedBean(new ds(o))}setupExpandable(e){const t=this.column.getProvidedColumnGroup();this.refreshExpanded();const n=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:n,expandableChanged:n})}refreshExpanded(){const{column:e}=this;this.expandable=e.isExpandable();const t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0)}getColId(){return this.column.getUniqueId()}addClasses(){const e=this.column.getColGroupDef(),t=Ma(e,this.gos,null,this.column);if(this.column.isPadding()){t.push("ag-header-group-cell-no-group");this.column.getLeafColumns().every((e=>e.isSpanHeaderHeight()))&&t.push("ag-header-span-height")}else t.push("ag-header-group-cell-with-group"),e?.wrapHeaderText&&t.push("ag-header-cell-wrap-text");t.forEach((e=>this.comp.addOrRemoveCssClass(e,!0)))}setupMovingCss(e){const t=this.column.getProvidedColumnGroup().getLeafColumns(),n=()=>this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving());t.forEach((t=>{e.addManagedListeners(t,{movingChanged:n})})),n()}onFocusIn(e){if(!this.eGui.contains(e.relatedTarget)){const e=this.getRowIndex();this.beans.focusService.setFocusedHeader(e,this.column)}}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();if(this.expandable&&t&&e.key===As.ENTER){const e=this.column,t=!e.isExpanded();this.beans.columnModel.setColumnGroupOpened(e.getProvidedColumnGroup(),t,"uiColumnExpanded")}}setDragSource(e){if(!this.isAlive()||this.isSuppressMoving())return;if(this.removeDragSource(),!e)return;const{beans:t,column:n,displayName:i,gos:r,dragAndDropService:s}=this,{columnModel:o}=t,a=n.getProvidedColumnGroup().getLeafColumns();let l=!r.get("suppressDragLeaveHidesColumns");const c=this.dragSource={type:1,eElement:e,getDefaultIconName:()=>l?"hide":"notAllowed",dragItemName:i,getDragItem:()=>this.getDragItemForGroup(n),onDragStarted:()=>{l=!r.get("suppressDragLeaveHidesColumns"),rl(a,!0)},onDragStopped:()=>rl(a,!1),onDragCancelled:()=>rl(a,!1),onGridEnter:e=>{if(l){const{columns:t=[],visibleState:n}=e??{},i=t.filter((e=>!e.getColDef().lockVisible&&(!n||n[e.getColId()])));o.setColsVisible(i,!0,"uiColumnMoved")}},onGridExit:e=>{if(l){const t=e?.columns?.filter((e=>!e.getColDef().lockVisible))||[];o.setColsVisible(t,!1,"uiColumnMoved")}}};s.addDragSource(c,!0)}getDragItemForGroup(e){const t=e.getProvidedColumnGroup().getLeafColumns(),n={};t.forEach((e=>n[e.getId()]=e.isVisible()));const i=[];this.beans.visibleColsService.getAllCols().forEach((e=>{t.indexOf(e)>=0&&(i.push(e),An(t,e))})),t.forEach((e=>i.push(e)));const r=[],s=e.getLeafColumns();for(const o of i)-1!==s.indexOf(o)&&r.push(o);return{columns:i,columnsInSplit:r,visibleState:n}}isSuppressMoving(){let e=!1;this.column.getLeafColumns().forEach((t=>{(t.getColDef().suppressMovable||t.getColDef().lockPosition)&&(e=!0)}));return e||this.gos.get("suppressMovableColumns")}destroy(){super.destroy()}},pl=0,gl=class extends Vn{constructor(e,t,n){super(),this.instanceId=pl++,this.rowIndex=e,this.pinned=t,this.type=n;const i="group"==n?"ag-header-row-column-group":"filter"==n?"ag-header-row-column-filter":"ag-header-row-column";this.headerRowClass=`ag-header-row ${i}`}wireBeans(e){this.beans=e}postConstruct(){this.isPrintLayout=jt(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return!!this.comp&&this.getHeaderCellCtrls().every((e=>null!=e.getGui()))}setComp(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.comp=e,t=Yi(this,this.beans.context,t),n&&(this.onRowHeightChanged(),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getHeaderRowClass(){return this.headerRowClass}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){const t=this.onRowHeightChanged.bind(this);e.addManagedEventListeners({columnResized:this.onColumnResized.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:e=>this.onVirtualColumnsChanged(e.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,gridStylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),e.addManagedPropertyListener("ensureDomOrder",(e=>this.isEnsureDomOrder=e.currentValue)),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}getHeaderCellCtrl(e){if(this.headerCellCtrls)return Gt(this.headerCellCtrls).find((t=>t.getColumnGroupChild()===e))}onDisplayedColumnsChanged(){this.isPrintLayout=jt(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}getType(){return this.type}onColumnResized(){this.setWidth()}setWidth(){const e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){const{visibleColsService:e}=this.beans;if(this.isPrintLayout){return null!=this.pinned?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null)}return e.getContainerWidth(this.pinned)}onRowHeightChanged(){const{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){const{columnModel:e,filterManager:t}=this.beans,n=[],i=e.getGroupRowsHeight(),r=e.getColumnHeaderRowHeight();n.push(...i),n.push(r),t?.hasFloatingFilters()&&n.push(e.getFloatingFiltersHeight());let s=0;for(let o=0;o<this.rowIndex;o++)s+=n[o];return{topOffset:s,rowHeight:n[this.rowIndex]}}getPinned(){return this.pinned}getRowIndex(){return this.rowIndex}onVirtualColumnsChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.getHeaderCtrls(),n=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,n,e)}getHeaderCtrls(){const e=this.headerCellCtrls;this.headerCellCtrls=new Map;const t=this.getColumnsInViewport();for(const i of t)this.recycleAndCreateHeaderCtrls(i,e);const n=e=>{const{focusService:t,visibleColsService:n}=this.beans;if(!t.isHeaderWrapperFocused(e))return!1;return n.isVisible(e.getColumnGroupChild())};if(e)for(const[i,r]of e){n(r)?this.headerCellCtrls.set(i,r):this.destroyBean(r)}return this.getHeaderCellCtrls()}getHeaderCellCtrls(){return Array.from(this.headerCellCtrls?.values()??[])}recycleAndCreateHeaderCtrls(e,t){if(!this.headerCellCtrls)return;if(e.isEmptyGroup())return;const n=e.getUniqueId();let i;t&&(i=t.get(n),t.delete(n));if(i&&i.getColumnGroupChild()!=e&&(this.destroyBean(i),i=void 0),null==i)switch(this.type){case"filter":i=this.createBean(this.beans.ctrlsFactory.getInstance("headerFilterCell",e,this.beans,this));break;case"group":i=this.createBean(new dl(e,this.beans,this));break;default:i=this.createBean(new cl(e,this.beans,this))}this.headerCellCtrls.set(n,i)}getColumnsInViewport(){return this.isPrintLayout?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()}getColumnsInViewportPrintLayout(){if(null!=this.pinned)return[];let e=[];const t=this.getActualDepth(),{columnViewportService:n}=this.beans;return["left",null,"right"].forEach((i=>{const r=n.getHeadersToRender(i,t);e=e.concat(r)})),e}getActualDepth(){return"filter"==this.type?this.rowIndex-1:this.rowIndex}getColumnsInViewportNormalLayout(){return this.beans.columnViewportService.getHeadersToRender(this.pinned,this.getActualDepth())}findHeaderCellCtrl(e){if(!this.headerCellCtrls)return;const t=this.getHeaderCellCtrls();let n;return n="function"===typeof e?t.find(e):t.find((t=>t.getColumnGroupChild()==e)),n}focusHeader(e,t){const n=this.findHeaderCellCtrl(e);if(!n)return!1;return n.focus(t)}destroy(){this.headerCellCtrls?.forEach((e=>{this.destroyBean(e)})),this.headerCellCtrls=void 0,super.destroy()}},fl=class extends Vn{constructor(e){super(),this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[],this.pinned=e}wireBeans(e){this.ctrlsService=e.ctrlsService,this.scrollVisibleService=e.scrollVisibleService,this.pinnedWidthService=e.pinnedWidthService,this.columnModel=e.columnModel,this.focusService=e.focusService,this.filterManager=e.filterManager}setComp(e,t){this.comp=e,this.eViewport=t,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport);const n=this.onDisplayedColumnsChanged.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),displayedColumnsChanged:n,advancedFilterEnabledChanged:n});const i=`${"string"===typeof this.pinned?this.pinned:"center"}Header`;this.ctrlsService.register(i,this),this.columnModel.isReady()&&this.refresh()}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=new cs,n=this.focusService.getFocusHeaderToUseAfterRefresh();(()=>{const e=this.columnModel.getHeaderRowCount()-1;this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls);for(let n=0;n<e;n++){const e=this.createBean(new gl(t.next(),this.pinned,"group"));this.groupsRowCtrls.push(e)}})(),(()=>{const n=t.next(),i=!this.hidden&&(null==this.columnsRowCtrl||!e||this.columnsRowCtrl.getRowIndex()!==n);(i||this.hidden)&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),i&&(this.columnsRowCtrl=this.createBean(new gl(n,this.pinned,"column")))})(),(()=>{this.includeFloatingFilter=!!this.filterManager?.hasFloatingFilters()&&!this.hidden;const n=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter)return void n();const i=t.next();if(this.filtersRowCtrl){const t=this.filtersRowCtrl.getRowIndex()!==i;e&&!t||n()}this.filtersRowCtrl||(this.filtersRowCtrl=this.createBean(new gl(i,this.pinned,"filter")))})();const i=this.getAllCtrls();this.comp.setCtrls(i),this.restoreFocusOnHeader(n)}getHeaderCtrlForColumn(e){if(pi(e))return this.columnsRowCtrl?.getHeaderCellCtrl(e);if(0!==this.groupsRowCtrls.length)for(let t=0;t<this.groupsRowCtrls.length;t++){const n=this.groupsRowCtrls[t].getHeaderCellCtrl(e);if(n)return n}}getHtmlElementForColumnHeader(e){const t=this.getHeaderCtrlForColumn(e);return t?t.getGui():null}getRowType(e){const t=this.getAllCtrls()[e];return t?t.getType():void 0}focusHeader(e,t,n){const i=this.getAllCtrls()[e];return!!i&&i.focusHeader(t,n)}getViewportElement(){return this.eViewport}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.getViewportElement(),{scroll:e})}destroy(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),super.destroy()}setupDragAndDrop(e){const t=new ol(this.pinned,e);this.createManagedBean(t)}restoreFocusOnHeader(e){if(!e)return;const{column:t}=e;t.getPinned()==this.pinned&&this.focusService.focusHeaderPosition({headerPosition:e})}onGridColumnsChanged(){this.refresh(!0)}onDisplayedColumnsChanged(){const e=this.filterManager?.hasFloatingFilters()&&!this.hidden;this.includeFloatingFilter!==e&&this.refresh(!0)}setupCenterWidth(){null==this.pinned&&this.createManagedBean(new Ja((e=>this.comp.setCenterWidth(`${e}px`)),!0))}setupPinnedWidth(){if(null==this.pinned)return;const e="left"===this.pinned,t="right"===this.pinned;this.hidden=!0;const n=()=>{const n=e?this.pinnedWidthService.getPinnedLeftWidth():this.pinnedWidthService.getPinnedRightWidth();if(null==n)return;const i=0==n,r=this.hidden!==i,s=this.gos.get("enableRtl"),o=this.scrollVisibleService.getScrollbarWidth(),a=this.scrollVisibleService.isVerticalScrollShowing()&&(s&&e||!s&&t)?n+o:n;this.comp.setPinnedContainerWidth(`${a}px`),this.comp.setDisplayed(!i),r&&(this.hidden=i,this.refresh())};this.addManagedEventListeners({leftPinnedWidthChanged:n,rightPinnedWidthChanged:n,scrollVisibilityChanged:n,scrollbarWidthChanged:n})}},ml=class extends Vn{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.getDomLayout(),t={autoHeight:"autoHeight"===e,normal:"normal"===e,print:"print"===e},n=t.autoHeight?"ag-layout-auto-height":t.print?"ag-layout-print":"ag-layout-normal";this.view.updateLayoutClasses(n,t)}getDomLayout(){const e=this.gos.get("domLayout")??"normal";return-1===["normal","print","autoHeight"].indexOf(e)?(bt(`${e} is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.`),"normal"):e}},vl=class extends fs{constructor(){super('\n            <div class="ag-overlay" role="presentation">\n                <div class="ag-overlay-panel" role="presentation">\n                    <div class="ag-overlay-wrapper" data-ref="eOverlayWrapper" role="presentation"></div>\n                </div>\n            </div>'),this.eOverlayWrapper=gs,this.activePromise=null,this.activeOverlay=null,this.updateListenerDestroyFunc=null,this.activeOverlayWrapperCssClass=null,this.elToFocusAfter=null}wireBeans(e){this.overlayService=e.overlayService,this.focusService=e.focusService,this.visibleColsService=e.visibleColsService}handleKeyDown(e){if(e.key!==As.TAB||e.defaultPrevented||zn(e))return;if(this.focusService.findNextFocusableElement(this.eOverlayWrapper,!1,e.shiftKey))return;let t=!1;t=e.shiftKey?this.focusService.focusGridView(Rn(this.visibleColsService.getAllCols()),!0,!1):this.focusService.focusNextGridCoreContainer(!1),t&&e.preventDefault()}updateLayoutClasses(e,t){const n=this.eOverlayWrapper.classList;n.toggle("ag-layout-auto-height",t.autoHeight),n.toggle("ag-layout-normal",t.normal),n.toggle("ag-layout-print",t.print)}postConstruct(){this.createManagedBean(new ml(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.overlayService.setOverlayWrapperComp(this),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}setWrapperTypeClass(e){const t=this.eOverlayWrapper.classList;this.activeOverlayWrapperCssClass&&t.toggle(this.activeOverlayWrapperCssClass,!1),this.activeOverlayWrapperCssClass=e,t.toggle(e,!0)}showOverlay(e,t,n,i){if(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,e){if(this.setDisplayed(!0,{skipAriaHidden:!0}),n&&this.focusService.isGridFocused()){const e=rn(this.gos);e&&!sn(this.gos)&&(this.elToFocusAfter=e)}e.then((t=>{if(this.activePromise!==e)return void(this.activeOverlay!==t&&(this.destroyBean(t),t=null));if(this.activePromise=null,!t)return;if(this.activeOverlay!==t&&(this.eOverlayWrapper.appendChild(t.getGui()),this.activeOverlay=t,i)){const e=t;this.updateListenerDestroyFunc=this.addManagedPropertyListener(i,(t=>{let{currentValue:n}=t;e.refresh?.(this.gos.addGridCommonParams({...n??{}}))}))}const r=this.focusService;n&&r.isGridFocused()&&r.focusInto(this.eOverlayWrapper)}))}}updateOverlayWrapperPaddingTop(e){this.eOverlayWrapper.style.setProperty("padding-top",`${e}px`)}destroyActiveOverlay(){this.activePromise=null;const e=this.activeOverlay;if(!e)return;let t=this.elToFocusAfter;this.activeOverlay=null,this.elToFocusAfter=null,t&&!this.focusService.isGridFocused()&&(t=null);const n=this.updateListenerDestroyFunc;n&&(n(),this.updateListenerDestroyFunc=null),this.destroyBean(e),Yr(this.eOverlayWrapper),t?.focus?.({preventScroll:!0})}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.overlayService.setOverlayWrapperComp(void 0),super.destroy()}},yl=class extends fs{constructor(e,t){super(),this.direction=t,this.eViewport=gs,this.eContainer=gs,this.hideTimeout=null,this.setTemplate(e)}wireBeans(e){this.animationFrameService=e.animationFrameService}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",Fr()||Dr())}initialiseInvisibleScrollbar(){void 0===this.invisibleScrollbar&&(this.invisibleScrollbar=Or(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const e=this.getGui(),t=()=>this.addOrRemoveCssClass("ag-scrollbar-active",!0),n=()=>this.addOrRemoveCssClass("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:n,touchend:n})}onScrollVisibilityChanged(){void 0===this.invisibleScrollbar&&this.initialiseInvisibleScrollbar(),this.animationFrameService.requestAnimationFrame((()=>this.setScrollVisible()))}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(null!==this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=null),this.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout((()=>{this.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),this.hideTimeout=null}),400)}})}attemptSettingScrollPosition(e){const t=this.getViewportElement();!function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,i=arguments.length>3?arguments[3]:void 0;const r=(new Date).getTime();let s=null,o=!1;const a=()=>{const a=(new Date).getTime()-r>n;(e()||a)&&(t(),o=!0,null!=s&&(window.clearInterval(s),s=null),a&&i&&bt(i))};a(),o||(s=window.setInterval(a,10))}((()=>es(t)),(()=>this.setScrollPosition(e)),100)}getViewportElement(){return this.eViewport}getContainer(){return this.eContainer}onScrollCallback(e){this.addManagedElementListeners(this.getViewportElement(),{scroll:e})}},Cl=class extends yl{constructor(){super('<div class="ag-body-horizontal-scroll" aria-hidden="true">\n            <div class="ag-horizontal-left-spacer" data-ref="eLeftSpacer"></div>\n            <div class="ag-body-horizontal-scroll-viewport" data-ref="eViewport">\n                <div class="ag-body-horizontal-scroll-container" data-ref="eContainer"></div>\n            </div>\n            <div class="ag-horizontal-right-spacer" data-ref="eRightSpacer"></div>\n        </div>',"horizontal"),this.eLeftSpacer=gs,this.eRightSpacer=gs}wireBeans(e){super.wireBeans(e),this.visibleColsService=e.visibleColsService,this.pinnedRowModel=e.pinnedRowModel,this.ctrlsService=e.ctrlsService,this.scrollVisibleService=e.scrollVisibleService}postConstruct(){super.postConstruct();const e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.ctrlsService.register("fakeHScrollComp",this),this.createManagedBean(new Ja((e=>this.eContainer.style.width=`${e}px`))),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}initialiseInvisibleScrollbar(){void 0===this.invisibleScrollbar&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}onPinnedRowDataChanged(){this.refreshCompBottom()}refreshCompBottom(){if(!this.invisibleScrollbar)return;const e=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const e=this.scrollVisibleService.isVerticalScrollShowing();let t=this.visibleColsService.getDisplayedColumnsRightWidth();const n=!this.enableRtl&&e,i=this.scrollVisibleService.getScrollbarWidth();n&&(t+=i),is(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=i);let r=this.visibleColsService.getColsLeftWidth();this.enableRtl&&e&&(r+=i),is(this.eLeftSpacer,r),this.eLeftSpacer.classList.toggle("ag-scroller-corner",r<=i)}setScrollVisible(){const e=this.scrollVisibleService.isHorizontalScrollShowing(),t=this.invisibleScrollbar,n=this.gos.get("suppressHorizontalScroll"),i=e&&this.scrollVisibleService.getScrollbarWidth()||0,r=n?0:0===i&&t?16:i;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),rs(this.getGui(),r),rs(this.eViewport,r),rs(this.eContainer,r),this.setDisplayed(e,{skipAriaHidden:!0})}getScrollPosition(){return $r(this.getViewportElement(),this.enableRtl)}setScrollPosition(e){es(this.getViewportElement())||this.attemptSettingScrollPosition(e),Zr(this.getViewportElement(),e,this.enableRtl)}},wl=class extends Vn{wireBeans(e){this.maxDivHeightScaler=e.rowContainerHeightService}constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this)})}onHeightChanged(){const e=this.maxDivHeightScaler.getUiContainerHeight(),t=null!=e?`${e}px`:"";this.eContainer.style.height=t,this.eViewport&&(this.eViewport.style.height=t)}},Sl=class extends yl{wireBeans(e){super.wireBeans(e),this.ctrlsService=e.ctrlsService,this.scrollVisibleService=e.scrollVisibleService}constructor(){super('<div class="ag-body-vertical-scroll" aria-hidden="true">\n            <div class="ag-body-vertical-scroll-viewport" data-ref="eViewport">\n                <div class="ag-body-vertical-scroll-container" data-ref="eContainer"></div>\n            </div>\n        </div>',"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new wl(this.eContainer)),this.ctrlsService.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this)})}setScrollVisible(){const e=this.scrollVisibleService.isVerticalScrollShowing(),t=this.invisibleScrollbar,n=e&&this.scrollVisibleService.getScrollbarWidth()||0,i=0===n&&t?16:n;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),is(this.getGui(),i),is(this.eViewport,i),is(this.eContainer,i),this.setDisplayed(e,{skipAriaHidden:!0})}onRowContainerHeightChanged(){const{ctrlsService:e}=this,t=e.getGridBodyCtrl().getBodyViewportElement(),n=this.getScrollPosition(),i=t.scrollTop;n!=i&&this.setScrollPosition(i,!0)}getScrollPosition(){return this.getViewportElement().scrollTop}setScrollPosition(e,t){t||es(this.getViewportElement())||this.attemptSettingScrollPosition(e),this.getViewportElement().scrollTop=e}},bl=(e=>(e.FakeHScrollbar="fakeHScrollComp",e.Header="centerHeader",e.PinnedTop="topCenter",e.PinnedBottom="bottomCenter",e.StickyTop="stickyTopCenter",e.StickyBottom="stickyBottomCenter",e))(bl||{}),xl=class extends Vn{constructor(e){super(),this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.eBodyViewport=e,this.resetLastHScrollDebounced=Pt((()=>this.lastScrollSource[1]=null),500),this.resetLastVScrollDebounced=Pt((()=>this.lastScrollSource[0]=null),500)}wireBeans(e){this.ctrlsService=e.ctrlsService,this.animationFrameService=e.animationFrameService,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService,this.rowModel=e.rowModel,this.heightScaler=e.rowContainerHeightService,this.rowRenderer=e.rowRenderer,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this)}),this.ctrlsService.whenReady(this,(e=>{this.centerRowsCtrl=e.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()}))}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.getViewportElement(),{scroll:this.onHScroll.bind(this,"Viewport")});for(const e of Object.values(bl)){const t=this.ctrlsService.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){const e=this.ctrlsService.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),n=t?Pt(this.onVScroll.bind(this,"Viewport"),100):this.onVScroll.bind(this,"Viewport"),i=t?Pt(this.onVScroll.bind(this,"fakeVScrollComp"),100):this.onVScroll.bind(this,"fakeVScrollComp");this.addManagedElementListeners(this.eBodyViewport,{scroll:n}),this.registerScrollPartner(e,i)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){null==this.centerRowsCtrl||(void 0===e&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(const t of[...Object.values(bl),"Viewport"]){if(this.lastScrollSource[1]===t)continue;Zr(this.getViewportForSource(t),e,this.enableRtl)}}getViewportForSource(e){return"Viewport"===e?this.centerRowsCtrl.getViewportElement():this.ctrlsService.get(e).getViewportElement()}isControllingScroll(e,t){return null==this.lastScrollSource[t]?(0===t?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;const t=this.centerRowsCtrl.getViewportElement(),{scrollLeft:n}=t;if(this.shouldBlockScrollUpdate(1,n,!0))return;const i=$r(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(i),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;t="Viewport"===e?this.eBodyViewport.scrollTop:this.ctrlsService.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,t,!0)||(this.animationFrameService.setScrollTop(t),this.nextScrollTop=t,"Viewport"===e?this.ctrlsService.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,this.gos.get("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced())}doHorizontalScroll(e){const t=this.ctrlsService.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}fireScrollEvent(e){const t={type:"bodyScroll",direction:1===e?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout((()=>{this.eventService.dispatchEvent({...t,type:"bodyScrollEnd"})}),100)}shouldBlockScrollUpdate(e,t){return!(arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&!Dr())&&(0===e?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t))}shouldBlockVerticalScroll(e){const t=Vr(this.eBodyViewport),{scrollHeight:n}=this.eBodyViewport;return e<0||e+t>n}shouldBlockHorizontalScroll(e){const t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:n}=this.centerRowsCtrl.getViewportElement();if(this.enableRtl&&Kr()){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>n}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){this.scrollLeft!==this.centerRowsCtrl.getCenterViewportScrollLeft()&&this.onHScroll("Viewport")}scrollGridIfNeeded(){const e=this.scrollTop!=this.nextScrollTop;return e&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),e}setHorizontalScrollPosition(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.centerRowsCtrl.getViewportElement().scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(e=this.enableRtl&&Kr()?e>0?0:n:Math.min(Math.max(e,0),n)),Zr(this.centerRowsCtrl.getViewportElement(),Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.eBodyViewport.scrollTop=e}getVScrollPosition(){this.lastScrollTop=this.eBodyViewport.scrollTop,this.lastOffsetHeight=this.eBodyViewport.offsetHeight;return{top:this.lastScrollTop,bottom:this.lastScrollTop+this.lastOffsetHeight}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.centerRowsCtrl.isHorizontalScrollShowing()}scrollHorizontally(e){const t=this.centerRowsCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.getViewportElement().scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.rowModel.getRowCount();let i=-1;for(let r=0;r<n;r++){const t=this.rowModel.getRow(r);if("function"===typeof e){if(t&&e(t)){i=r;break}}else if(e===t||e===t.data){i=r;break}}i>=0&&this.ensureIndexVisible(i,t)}ensureIndexVisible(e,t){if(jt(this.gos,"print"))return;const n=this.rowModel.getRowCount();if("number"!==typeof e||e<0||e>=n)return void bt("Invalid row index for ensureIndexVisible: "+e);const i=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.getFrameworkOverrides().wrapIncoming((()=>{i||this.paginationService?.goToPageWithIndex(e);const n=this.ctrlsService.getGridBodyCtrl(),r=n.getStickyTopHeight(),s=n.getStickyBottomHeight(),o=this.rowModel.getRow(e);let a;do{const e=o.rowTop,n=o.rowHeight,i=this.pageBoundsService.getPixelOffset(),l=o.rowTop-i,c=l+o.rowHeight,u=this.getVScrollPosition(),h=this.heightScaler.getDivStretchOffset(),d=u.top+h,p=u.bottom+h,g=p-d,f=this.heightScaler.getScrollPositionForPixel(l),m=this.heightScaler.getScrollPositionForPixel(c-g),v=Math.min((f+m)/2,l);let y=null;"top"===t?y=f:"bottom"===t?y=m:"middle"===t?y=v:d+r>l?y=f-r:p-s<c&&(y=m+s),null!==y&&(this.setVerticalScrollPosition(y),this.rowRenderer.redraw({afterScroll:!0})),a=e!==o.rowTop||n!==o.rowHeight}while(a);this.animationFrameService.flushAllFrames()}))}ensureColumnVisible(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const n=this.columnModel.getCol(e);if(!n)return;if(n.isPinned())return;if(!this.visibleColsService.isColDisplayed(n))return;const i=this.getPositionedHorizontalScroll(n,t);this.getFrameworkOverrides().wrapIncoming((()=>{null!==i&&this.centerRowsCtrl.setCenterViewportScrollLeft(i),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()}))}setScrollPosition(e,t){this.getFrameworkOverrides().wrapIncoming((()=>{this.centerRowsCtrl.setCenterViewportScrollLeft(t),this.setVerticalScrollPosition(e),this.rowRenderer.redraw({afterScroll:!0}),this.animationFrameService.flushAllFrames()}))}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:n,columnAfterEnd:i}=this.isColumnOutsideViewport(e),r=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),s=this.centerRowsCtrl.getCenterWidth(),o=this.enableRtl;let a=(o?n:i)||r,l=o?i:n;"auto"!==t&&(a="start"===t,l="end"===t);const c="middle"===t;if(a||l||c){const{colLeft:t,colMiddle:n,colRight:i}=this.getColumnBounds(e);return c?n-s/2:a?o?i:t:o?t-s:i-s}return null}isColumnOutsideViewport(e){const{start:t,end:n}=this.getViewportBounds(),{colLeft:i,colRight:r}=this.getColumnBounds(e),s=this.enableRtl;return{columnBeforeStart:s?t>r:n<r,columnAfterEnd:s?n<i:t>i}}getColumnBounds(e){const t=this.enableRtl,n=this.visibleColsService.getBodyContainerWidth(),i=e.getActualWidth(),r=e.getLeft(),s=t?-1:1,o=t?n-r:r;return{colLeft:o,colMiddle:o+i/2*s,colRight:o+i*s}}getViewportBounds(){const e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft();return{start:t,end:e+t,width:e}}},_l=class extends Vn{wireBeans(e){this.animationFrameService=e.animationFrameService,this.ctrlsService=e.ctrlsService,this.pinnedWidthService=e.pinnedWidthService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.columnSizeService=e.columnSizeService,this.scrollVisibleService=e.scrollVisibleService,this.columnViewportService=e.columnViewportService}constructor(e){super(),this.centerContainerCtrl=e}postConstruct(){this.ctrlsService.whenReady(this,(e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()})),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],(()=>{this.checkViewportAndScrolls()}))}listenForResize(){const e=()=>{this.animationFrameService.requestAnimationFrame((()=>{this.onCenterViewportResized()}))};this.centerContainerCtrl.registerViewportResizeListener(e),this.gridBodyCtrl.registerBodyViewportResizeListener(e)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleService.onCentreViewportResized(),this.centerContainerCtrl.isViewportInTheDOMTree()){this.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const e=this.centerContainerCtrl.getCenterWidth();e!==this.centerWidth&&(this.centerWidth=e,this.columnSizeService.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}keepPinnedColumnsNarrowerThanViewport(){const e=Wr(this.gridBodyCtrl.getBodyViewportElement());if(e<=50)return;let t=this.getPinnedColumnsOverflowingViewport(e-50);const n=this.gos.getCallback("processUnpinnedColumns");if(t.length){if(n){t=n({columns:t,viewportWidth:e})}this.columnModel.setColsPinned(t,null,"viewportSizeFeature")}}getPinnedColumnsOverflowingViewport(e){const t=this.pinnedWidthService.getPinnedRightWidth()+this.pinnedWidthService.getPinnedLeftWidth();if(t<e)return[];const n=[...this.visibleColsService.getLeftCols()],i=[...this.visibleColsService.getRightCols()];let r=0,s=0;const o=[];let a=t-0-e;for(;(s<n.length||r<i.length)&&a>0;){if(r<i.length){const e=i[r++];a-=e.getActualWidth(),o.push(e)}if(s<n.length&&a>0){const e=n[s++];a-=e.getActualWidth(),o.push(e)}}return o}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const e=Vr(this.gridBodyCtrl.getBodyViewportElement());this.bodyHeight!==e&&(this.bodyHeight=e,this.eventService.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){const e={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(e)}isHorizontalScrollShowing(){return this.centerContainerCtrl.isHorizontalScrollShowing()}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.columnViewportService.setScrollPosition(e,t)}},Ml=class extends Vn{wireBeans(e){this.dragService=e.dragService,this.rangeService=e.rangeService}constructor(e){super(),this.eContainer=e}postConstruct(){if(!this.rangeService)return;this.params={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)},this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],(()=>{vn(this.gos)?this.enableFeature():this.disableFeature()})),this.addDestroyFunc((()=>this.disableFeature()));vn(this.gos)&&this.enableFeature()}enableFeature(){this.dragService.addDragSource(this.params)}disableFeature(){this.dragService.removeDragSource(this.params)}},El=class extends fs{constructor(){super('\n            <div class="ag-selection-checkbox" role="presentation">\n                <ag-checkbox role="presentation" data-ref="eCheckbox"></ag-checkbox>\n            </div>',[ks]),this.eCheckbox=gs}postConstruct(){this.eCheckbox.setPassive(!0)}getCheckboxId(){return this.eCheckbox.getInputElement().id}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const e=this.localeService.getLocaleTextFunc(),t=this.rowNode.isSelected(),n=Er(e,t),[i,r]=this.rowNode.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],s=e(i,r);this.eCheckbox.setValue(t,!0),this.eCheckbox.setInputAriaLabel(`${s} (${n})`)}onClicked(e,t,n){return this.rowNode.setSelectedParams({newValue:e,rangeSelect:n.shiftKey,groupSelectsFiltered:t,event:n,source:"checkboxSelected"})}init(e){this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getInputElement(),{dblclick:e=>Bn(e),click:e=>{Bn(e);const t="filteredDescendants"===_n(this.gos),n=this.eCheckbox.getValue();if(this.shouldHandleIndeterminateState(n,t)){0===this.onClicked(!0,t,e||{})&&this.onClicked(!1,t,e)}else n?this.onClicked(!1,t,e):this.onClicked(!0,t,e||{})}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)});if(Sn(this.gos)||"function"===typeof this.getIsVisible()){const e=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e}),this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}shouldHandleIndeterminateState(e,t){return t&&(void 0===this.eCheckbox.getPreviousValue()||void 0===e)&&Vt(this.gos)}showOrHideSelect(){let e=this.rowNode.selectable;const t=this.getIsVisible();if(e)if("function"===typeof t){const n=this.overrides?.callbackParams;if(this.column){const i=this.column.createColumnFunctionCallbackParams(this.rowNode);e=t({...n,...i})}else e=t({...n,node:this.rowNode,data:this.rowNode.data})}else e=t??!1;const n=this.gos.get("rowSelection");var i;if(n&&"string"!==typeof n?(i=n,!i?.hideDisabledCheckboxes):this.column?.getColDef().showDisabledCheckboxes)return this.eCheckbox.setDisabled(!e),this.setVisible(!0),void this.setDisplayed(!0);this.overrides?.removeHidden?this.setDisplayed(e):this.setVisible(e)}getIsVisible(){if(this.overrides)return this.overrides.isVisible;const e=this.gos.get("rowSelection");return e&&"string"!==typeof e?fn(e):this.column?.getColDef()?.checkboxSelection}},Rl=class extends fs{constructor(e,t,n){super('<div class="ag-drag-handle ag-row-drag" draggable="true"></div>'),this.rowNode=e,this.column=t,this.eCell=n}postConstruct(){this.getGui().appendChild(ys("rowDrag",this.gos,null)),this.addGuiEventListener("mousedown",(e=>{e.stopPropagation()})),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){const t=this.column.getColDef().dndSourceOnRowDrag;e.dataTransfer.setDragImage(this.eCell,0,0);const n=()=>{try{const t=JSON.stringify(this.rowNode.data);e.dataTransfer.setData("application/json",t),e.dataTransfer.setData("text/plain",t)}catch(zD){}};if(t){t(this.gos.addGridCommonParams({rowNode:this.rowNode,dragEvent:e}))}else n()}checkVisibility(){const e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}},Tl=class extends Vn{constructor(e,t){super(),this.staticClasses=[],this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode()}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const e=this.column.getColDef(),{cellClassRules:t}=e,n=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:e,column:this.column,rowIndex:this.rowNode.rowIndex});this.beans.stylingService.processClassRules(t===this.cellClassRules?void 0:this.cellClassRules,t,n,(e=>this.cellComp.addOrRemoveCssClass(e,!0)),(e=>this.cellComp.addOrRemoveCssClass(e,!1))),this.cellClassRules=t}applyUserStyles(){const e=this.column.getColDef();if(!e.cellStyle)return;let t;if("function"===typeof e.cellStyle){const n=this.beans.gos.addGridCommonParams({column:this.column,value:this.cellCtrl.getValue(),colDef:e,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex});t=(0,e.cellStyle)(n)}else t=e.cellStyle;t&&this.cellComp.setUserStyles(t)}applyClassesFromColDef(){const e=this.column.getColDef(),t=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef:e,rowIndex:this.rowNode.rowIndex});this.staticClasses.length&&this.staticClasses.forEach((e=>this.cellComp.addOrRemoveCssClass(e,!1))),this.staticClasses=this.beans.stylingService.getStaticCellClasses(e,t),this.staticClasses.length&&this.staticClasses.forEach((e=>this.cellComp.addOrRemoveCssClass(e,!0)))}destroy(){super.destroy()}},Pl=class extends Vn{constructor(e,t,n,i,r){super(),this.cellCtrl=e,this.beans=t,this.rowNode=i,this.rowCtrl=r}setComp(e){this.eGui=e}onKeyDown(e){const t=e.key;switch(t){case As.ENTER:this.onEnterKeyDown(e);break;case As.F2:this.onF2KeyDown(e);break;case As.ESCAPE:this.onEscapeKeyDown(e);break;case As.TAB:this.onTabKeyDown(e);break;case As.BACKSPACE:case As.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case As.DOWN:case As.UP:case As.RIGHT:case As.LEFT:this.onNavigationKeyDown(e,t)}}onNavigationKeyDown(e,t){this.cellCtrl.isEditing()||(e.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(e):this.beans.navigationService.navigateToNextCell(e,t,this.cellCtrl.getCellPosition(),!0),e.preventDefault())}onShiftRangeSelect(e){if(!this.beans.rangeService)return;const t=this.beans.rangeService.extendLatestRangeInDirection(e);t&&this.beans.navigationService.ensureCellVisible(t)}onTabKeyDown(e){this.beans.navigationService.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){const{cellCtrl:n,beans:i,rowNode:r}=this,{gos:s,rangeService:o,eventService:a}=i;if(!n.isEditing()){if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e===As.DELETE||!t&&e===As.BACKSPACE&&Fr()}(e,s.get("enableCellEditingOnBackspace"))){if(o&&vn(s))o.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(n.isCellEditable()){const e=n.getColumn(),t=this.beans.valueService.getDeleteValue(e,r);r.setDataValue(e,t,"cellClear")}}else n.startRowOrCellEdit(e,t);a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}}onEnterKeyDown(e){if(this.cellCtrl.isEditing()||this.rowCtrl.isEditing())this.cellCtrl.stopEditingAndFocus(!1,e.shiftKey);else if(this.beans.gos.get("enterNavigatesVertically")){const t=e.shiftKey?As.UP:As.DOWN;this.beans.navigationService.navigateToNextCell(null,t,this.cellCtrl.getCellPosition(),!1)}else this.cellCtrl.startRowOrCellEdit(As.ENTER,e),this.cellCtrl.isEditing()&&e.preventDefault()}onF2KeyDown(e){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(As.F2,e)}onEscapeKeyDown(e){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))}processCharacter(e){if(e.target!==this.eGui||this.cellCtrl.isEditing())return;const t=e.key;" "===t?this.onSpaceKeyDown(e):this.cellCtrl.startRowOrCellEdit(t,e)&&e.preventDefault()}onSpaceKeyDown(e){const{gos:t}=this.beans;if(!this.cellCtrl.isEditing()&&qt(t)){const n=this.rowNode.isSelected(),i=!n,r="filteredDescendants"===_n(t),s=this.rowNode.setSelectedParams({newValue:i,rangeSelect:e.shiftKey,groupSelectsFiltered:r,event:e,source:"spaceKey"});void 0===n&&0===s&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:e.shiftKey,groupSelectsFiltered:r,event:e,source:"spaceKey"})}e.preventDefault()}destroy(){super.destroy()}},Al=class extends Vn{constructor(e,t,n){super(),this.cellCtrl=e,this.beans=t,this.column=n}onMouseEvent(e,t){if(!zn(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t)}}onCellClicked(e){if(this.isDoubleClickOnIPad())return this.onCellDoubleClicked(e),void e.preventDefault();const{eventService:t,rangeService:n,gos:i}=this.beans,r=e.ctrlKey||e.metaKey;n&&r&&n.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&n.intersectLastRange(!0);const s=this.cellCtrl.createEvent(e,"cellClicked");t.dispatchEvent(s);const o=this.column.getColDef();o.onCellClicked&&window.setTimeout((()=>{this.beans.frameworkOverrides.wrapOutgoing((()=>{o.onCellClicked(s)}))}),0);!((i.get("singleClickEdit")||o.singleClickEdit)&&!i.get("suppressClickEdit"))||e.shiftKey&&0!=n?.getCellRanges().length||this.cellCtrl.startRowOrCellEdit()}isDoubleClickOnIPad(){if(!Dr()||Hn("dblclick"))return!1;const e=(new Date).getTime(),t=e-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=e,t}onCellDoubleClicked(e){const{column:t,beans:n,cellCtrl:i}=this,{eventService:r,frameworkOverrides:s,gos:o}=n,a=t.getColDef(),l=i.createEvent(e,"cellDoubleClicked");r.dispatchEvent(l),"function"===typeof a.onCellDoubleClicked&&window.setTimeout((()=>{s.wrapOutgoing((()=>{a.onCellDoubleClicked(l)}))}),0);!o.get("singleClickEdit")&&!o.get("suppressClickEdit")&&i.startRowOrCellEdit(null,e)}onMouseDown(e){const{ctrlKey:t,metaKey:n,shiftKey:i}=e,r=e.target,{cellCtrl:s,beans:o}=this,{eventService:a,rangeService:l,focusService:c,gos:u}=o;if(this.isRightClickInExistingRange(e))return;const h=l&&0!=l.getCellRanges().length;if(!i||!h){const t=u.get("enableCellTextSelection")&&e.defaultPrevented,n=(Rr()||t)&&!s.isEditing()&&!Br(r);s.focusCell(n)}if(i&&h&&!c.isCellFocused(s.getCellPosition())){e.preventDefault();const t=c.getFocusedCell();if(t){const{column:e,rowIndex:n,rowPinned:i}=t,r=o.rowRenderer.getRowByPosition({rowIndex:n,rowPinned:i}),s=r?.getCellCtrl(e);s?.isEditing()&&s.stopEditing(),c.setFocusedCell({column:e,rowIndex:n,rowPinned:i,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}}if(!this.containsWidget(r)){if(l){const e=this.cellCtrl.getCellPosition();if(i)l.extendLatestRangeToCell(e);else{const i=t||n;l.setRangeToCell(e,i)}}a.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseDown"))}}isRightClickInExistingRange(e){const{rangeService:t}=this.beans;if(t){const n=t.isCellInAnyRange(this.cellCtrl.getCellPosition()),i=2===e.button||e.ctrlKey&&this.beans.gos.get("allowContextMenuWithControlKey");if(n&&i)return!0}return!1}containsWidget(e){return Gr(e,"ag-selection-checkbox",3)}onMouseOut(e){this.mouseStayingInsideCell(e)||(this.beans.eventService.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),this.beans.columnHoverService.clearMouseOver())}onMouseOver(e){this.mouseStayingInsideCell(e)||(this.beans.eventService.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),this.beans.columnHoverService.setMouseOver([this.column]))}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.getGui(),n=t.contains(e.target),i=t.contains(e.relatedTarget);return n&&i}destroy(){super.destroy()}},Fl=class extends Vn{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode()}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventService,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}setComp(e){this.eGui=e,this.setupColSpan(),this.setupRowSpan(),this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()}onNewColumnsLoaded(){const e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this.applyRowSpan(!0))}onDisplayColumnsChanged(){const e=this.getColSpanningList();Tn(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){null!=this.column.getColDef().colSpan&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventService,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eGui)return;const e=this.getCellWidth();this.eGui.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce(((e,t)=>e+t.getActualWidth()),0):this.column.getActualWidth()}getColSpanningList(){const e=this.column.getColSpan(this.rowNode),t=[];if(1===e)t.push(this.column);else{let n=this.column;const i=this.column.getPinned();for(let r=0;n&&r<e&&(t.push(n),n=this.beans.visibleColsService.getColAfter(n),n&&!Lt(n))&&i===n.getPinned();r++);}return t}onLeftChanged(){if(!this.eGui)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=e+"px"}getCellLeft(){let e;return e=this.beans.gos.get("enableRtl")&&this.colsSpanning?Rn(this.colsSpanning):this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.isPrintLayout()||"left"===this.column.getPinned())return e;const t=this.beans.visibleColsService.getColsLeftWidth();if("right"===this.column.getPinned()){return t+this.beans.visibleColsService.getBodyContainerWidth()+(e||0)}return t+(e||0)}applyRowSpan(e){if(1===this.rowSpan&&!e)return;const t=Zt(this.beans.gos)*this.rowSpan;this.eGui.style.height=`${t}px`,this.eGui.style.zIndex="1"}destroy(){super.destroy()}},Dl="ag-cell-range-selected",Ll=class{constructor(e,t){this.beans=e,this.rangeService=e.rangeService,this.selectionHandleFactory=e.selectionHandleFactory,this.cellCtrl=t}setComp(e,t){this.cellComp=e,this.eGui=t,this.onCellSelectionChanged()}onCellSelectionChanged(){this.cellComp&&(this.rangeCount=this.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass(Dl,0!==this.rangeCount),this.cellComp.addOrRemoveCssClass(`${Dl}-1`,1===this.rangeCount),this.cellComp.addOrRemoveCssClass(`${Dl}-2`,2===this.rangeCount),this.cellComp.addOrRemoveCssClass(`${Dl}-3`,3===this.rangeCount),this.cellComp.addOrRemoveCssClass(`${Dl}-4`,this.rangeCount>=4),this.cellComp.addOrRemoveCssClass("ag-cell-range-chart",this.hasChartRange),Mr(this.eGui,this.rangeCount>0||void 0),this.cellComp.addOrRemoveCssClass("ag-cell-range-single-cell",this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())}updateRangeBorders(){const e=this.getRangeBorders(),t=this.isSingleCell(),n=!t&&e.top,i=!t&&e.right,r=!t&&e.bottom,s=!t&&e.left;this.cellComp.addOrRemoveCssClass("ag-cell-range-top",n),this.cellComp.addOrRemoveCssClass("ag-cell-range-right",i),this.cellComp.addOrRemoveCssClass("ag-cell-range-bottom",r),this.cellComp.addOrRemoveCssClass("ag-cell-range-left",s)}isSingleCell(){const{rangeService:e}=this.beans;return 1===this.rangeCount&&!!e&&!e.isMoreThanOneCell()}getHasChartRange(){const{rangeService:e}=this.beans;if(!this.rangeCount||!e)return!1;const t=e.getCellRanges();return t.length>0&&t.every((e=>Ln([1,0],e.type)))}updateRangeBordersIfRangeCount(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())}getRangeBorders(){const e=this.beans.gos.get("enableRtl");let t=!1,n=!1,i=!1,r=!1;const s=this.cellCtrl.getCellPosition().column,o=this.beans.visibleColsService;let a,l;e?(a=o.getColAfter(s),l=o.getColBefore(s)):(a=o.getColBefore(s),l=o.getColAfter(s));const c=this.rangeService.getCellRanges().filter((e=>this.rangeService.isCellInSpecificRange(this.cellCtrl.getCellPosition(),e)));a||(r=!0),l||(n=!0);for(let u=0;u<c.length&&!(t&&n&&i&&r);u++){const e=c[u],s=this.rangeService.getRangeStartRow(e),o=this.rangeService.getRangeEndRow(e);!t&&this.beans.rowPositionUtils.sameRow(s,this.cellCtrl.getCellPosition())&&(t=!0),!i&&this.beans.rowPositionUtils.sameRow(o,this.cellCtrl.getCellPosition())&&(i=!0),!r&&a&&e.columns.indexOf(a)<0&&(r=!0),!n&&l&&e.columns.indexOf(l)<0&&(n=!0)}return{top:t,right:n,bottom:i,left:r}}refreshHandle(){if(this.beans.context.isDestroyed())return;const e=this.shouldHaveSelectionHandle();this.selectionHandle&&!e&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),e&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass("ag-cell-range-handle",!!this.selectionHandle)}shouldHaveSelectionHandle(){const e=this.beans.gos,t=this.rangeService.getCellRanges(),n=t.length;if(this.rangeCount<1||n<1)return!1;const i=Rn(t),r=this.cellCtrl.getCellPosition(),s=yn(e)&&!this.cellCtrl.isSuppressFillHandle(),o=function(e){const t=e.get("cellSelection");return void 0!==t?"boolean"!==typeof t&&"range"===t.handle?.mode:e.get("enableRangeHandle")}(e);let a=1===n&&!this.cellCtrl.isEditing()&&(s||o);if(this.hasChartRange){const e=1===t[0].type&&this.rangeService.isCellInSpecificRange(r,t[0]);this.cellComp.addOrRemoveCssClass("ag-cell-range-chart-category",e),a=0===i.type}return a&&null!=i.endRow&&this.rangeService.isContiguousRange(i)&&this.rangeService.isBottomRightCell(i,r)}addSelectionHandle(){const e=Rn(this.rangeService.getCellRanges()).type,t=yn(this.beans.gos)&&Lt(e)?0:1;this.selectionHandle&&this.selectionHandle.getType()!==t&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.selectionHandleFactory.createSelectionHandle(t)),this.selectionHandle.refresh(this.cellCtrl)}destroy(){this.beans.context.destroyBean(this.selectionHandle)}},Il=0,kl=class e extends Vn{constructor(e,t,n,i){super(),this.column=e,this.rowNode=t,this.beans=n,this.rowCtrl=i,this.cellRangeFeature=void 0,this.cellPositionFeature=void 0,this.cellCustomStyleFeature=void 0,this.tooltipFeature=void 0,this.cellMouseListenerFeature=void 0,this.cellKeyboardListenerFeature=void 0,this.suppressRefreshCell=!1,this.onCellCompAttachedFuncs=[],this.onCellEditorAttachedFuncs=[],this.instanceId=e.getId()+"-"+Il++,this.colIdSanitised=Di(this.column.getId()),this.createCellPosition(),this.updateAndFormatValue(!1)}shouldRestoreFocus(){return this.beans.focusService.shouldRestoreFocus(this.cellPosition)}onFocusOut(){this.beans.focusService.clearRestoreFocus()}addFeatures(){this.cellPositionFeature=new Fl(this,this.beans),this.cellCustomStyleFeature=new Tl(this,this.beans),this.cellMouseListenerFeature=new Al(this,this.beans,this.column),this.cellKeyboardListenerFeature=new Pl(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.column.isTooltipEnabled()&&this.enableTooltipFeature();this.beans.rangeService&&vn(this.beans.gos)&&(this.cellRangeFeature=new Ll(this.beans,this))}removeFeatures(){const e=this.beans.context;this.cellPositionFeature=e.destroyBean(this.cellPositionFeature),this.cellCustomStyleFeature=e.destroyBean(this.cellCustomStyleFeature),this.cellMouseListenerFeature=e.destroyBean(this.cellMouseListenerFeature),this.cellKeyboardListenerFeature=e.destroyBean(this.cellKeyboardListenerFeature),this.cellRangeFeature=e.destroyBean(this.cellRangeFeature),this.disableTooltipFeature()}enableTooltipFeature(e,t){const n="whenTruncated"===this.beans.gos.get("tooltipShowMode");t||!n||this.isCellRenderer()||(t=()=>{const e=this.getGui(),t=0===e.children.length?e:e.querySelector(".ag-cell-value");return!t||t.scrollWidth>t.clientWidth});const i={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getRowIndex:()=>this.cellPosition.rowIndex,getRowNode:()=>this.rowNode,getGui:()=>this.getGui(),getLocation:()=>"cell",getTooltipValue:null!=e?()=>e:()=>{const e=this.column.getColDef(),t=this.rowNode.data;if(e.tooltipField&&Dt(t))return li(t,e.tooltipField,this.column.isTooltipFieldContainsDots());const n=e.tooltipValueGetter;return n?n(this.beans.gos.addGridCommonParams({location:"cell",colDef:this.column.getColDef(),column:this.column,rowIndex:this.cellPosition.rowIndex,node:this.rowNode,data:this.rowNode.data,value:this.value,valueFormatted:this.valueFormatted})):null},getValueFormatted:()=>this.valueFormatted,shouldDisplayTooltip:t};this.tooltipFeature=new ds(i,this.beans)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}setComp(e,t,n,i,r,s){this.cellComp=e,this.eGui=t,this.printLayout=i,s??(s=this),this.addDomData(s),this.addFeatures(),s.addDestroyFunc((()=>this.removeFeatures())),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.onCellFocused(this.focusEventToRestore),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(n,s),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),this.cellPositionFeature?.setComp(t),this.cellCustomStyleFeature?.setComp(e),this.tooltipFeature?.refreshToolTip(),this.cellKeyboardListenerFeature?.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(e,t),r&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach((e=>e())),this.onCellCompAttachedFuncs=[])}setupAutoHeight(e,t){if(this.isAutoHeight=this.column.isAutoHeight(),!this.isAutoHeight||!e)return;const n=e.parentElement,i=$t(this.beans.gos,this.rowNode).height,r=s=>{if(this.editing)return;if(!this.isAlive()||!t.isAlive())return;const{paddingTop:o,paddingBottom:a,borderBottomWidth:l,borderTopWidth:c}=Ur(n),u=o+a+l+c,h=e.offsetHeight+u;if(s<5){const t=en(this.beans.gos);if(!t||!t.contains(e)||0==h)return void window.setTimeout((()=>r(s+1)),0)}const d=Math.max(h,i);this.rowNode.setRowAutoHeight(d,this.column)},s=()=>r(0);s();const o=this.beans.resizeObserverService.observeResize(e,s);t.addDestroyFunc((()=>{o(),this.rowNode.setRowAutoHeight(void 0,this.column)}))}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}isCellRenderer(){const e=this.column.getColDef();return null!=e.cellRenderer||null!=e.cellRendererSelector}getValueToDisplay(){return this.valueFormatted??this.value}showValue(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{beans:t,column:n,rowNode:i,cellRangeFeature:r,cellComp:s}=this,{userComponentFactory:o,animationFrameService:a}=t,l=this.getValueToDisplay();let c;if(i.stub&&null==i.groupData?.[this.column.getId()]){const e=this.createCellRendererParams();c=o.getLoadingCellRendererDetails(n.getColDef(),e)}else if(this.isCellRenderer()){const e=this.createCellRendererParams();c=o.getCellRendererDetails(n.getColDef(),e)}s.setRenderDetails(c,l,e),a.requestAnimationFrame((()=>r?.refreshHandle()))}setupControlComps(){const e=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(e)),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}isIncludeControl(e){return!(null!=this.rowNode.rowPinned)&&("function"===typeof e||!0===e)}isCheckboxSelection(e){const{rowSelection:t}=this.beans.gridOptions;return e.checkboxSelection||Qn(this.column)&&t&&"string"!==typeof t&&fn(t)}refreshShouldDestroy(){const e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(e)),n=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),i=this.includeDndSource!=this.isIncludeControl(e.dndSource),r=this.isAutoHeight!=this.column.isAutoHeight();return t||n||i||r}startEditing(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const{editService:i}=this.beans;return!(this.isCellEditable()&&!this.editing&&i)||(this.cellComp?i.startEditing(this,e,t,n):(this.onCellCompAttachedFuncs.push((()=>{this.startEditing(e,t,n)})),!0))}setEditing(e,t){this.editCompDetails=t,this.editing!==e&&(this.editing=e)}stopRowOrCellEdit(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];"fullRow"===this.beans.gos.get("editType")?this.rowCtrl.stopEditing(e):this.stopEditing(e)}onPopupEditorClosed(){this.editing&&this.stopEditingAndFocus()}stopEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.onCellEditorAttachedFuncs=[];const{editService:t}=this.beans;return!(!this.editing||!t)&&t.stopEditing(this,e)}createCellRendererParams(){return this.beans.gos.addGridCommonParams({value:this.value,valueFormatted:this.valueFormatted,getValue:()=>this.beans.valueService.getValueForDisplay(this.column,this.rowNode),setValue:e=>this.beans.valueService.setValue(this.rowNode,this.column,e),formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:(e,t,n,i)=>this.registerRowDragger(e,t,i),setTooltip:(e,t)=>{this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(e,t),this.tooltipFeature?.refreshToolTip()}})}setFocusOutOnEditor(){this.editing&&this.beans.editService?.setFocusOutOnEditor(this)}setFocusInOnEditor(){this.editing&&this.beans.editService?.setFocusInOnEditor(this)}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){this.refreshShouldDestroy()?this.rowCtrl?.recreateCell(this):this.refreshCell(e)}refreshCell(e){if(this.suppressRefreshCell||this.editing)return;const t=this.column.getColDef(),n=null!=e&&!!e.newData,i=null!=e&&!!e.suppressFlash||!!t.suppressCellFlash,r=null==t.field&&null==t.valueGetter&&null==t.showRowGroup,s=e&&e.forceRefresh||r||n,o=!!this.cellComp,a=this.updateAndFormatValue(o);if(o){if(s||a){this.showValue(n);const e=this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering();!i&&!e&&(this.beans.gos.get("enableCellChangeFlash")||t.enableCellChangeFlash)&&this.flashCell(),this.cellCustomStyleFeature?.applyUserStyles(),this.cellCustomStyleFeature?.applyClassesFromColDef()}this.tooltipFeature?.refreshToolTip(),this.cellCustomStyleFeature?.applyCellClassRules()}}stopEditingAndFocus(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.beans.editService?.stopEditingAndFocus(this,e,t)}flashCell(e){const t=e?.flashDuration??e?.flashDelay,n=e?.fadeDuration??e?.fadeDelay;this.animateCell("data-changed",t,n)}animateCell(e,t,n){if(!this.cellComp)return;const{gos:i}=this.beans;if(t||(t=i.get("cellFlashDuration")),0===t)return;Dt(n)||(n=i.get("cellFadeDuration"));const r=`ag-cell-${e}`,s=`ag-cell-${e}-animation`;this.cellComp.addOrRemoveCssClass(r,!0),this.cellComp.addOrRemoveCssClass(s,!1),this.beans.frameworkOverrides.wrapIncoming((()=>{window.setTimeout((()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(r,!1),this.cellComp.addOrRemoveCssClass(s,!0),this.eGui.style.transition=`background-color ${n}ms`,window.setTimeout((()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(s,!1),this.eGui.style.transition="")}),n))}),t)}))}onFlashCells(e){if(!this.cellComp)return;const t=this.beans.cellPositionUtils.createId(this.getCellPosition());e.cells[t]&&this.animateCell("highlight")}isCellEditable(){return this.column.isCellEditable(this.rowNode)}isSuppressFillHandle(){return this.column.isSuppressFillHandle()}formatValue(e){return this.callValueFormatter(e)??e}callValueFormatter(e){return this.beans.valueService.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){const t=this.value,n=this.valueFormatted;return this.value=this.beans.valueService.getValueForDisplay(this.column,this.rowNode),this.valueFormatted=this.callValueFormatter(this.value),!e||(!this.valuesAreEqual(t,this.value)||this.valueFormatted!=n)}valuesAreEqual(e,t){const n=this.column.getColDef();return n.equals?n.equals(e,t):e===t}getComp(){return this.cellComp}getValue(){return this.value}addDomData(t){const n=this.getGui();Qt(this.beans.gos,n,e.DOM_DATA_KEY_CELL_CTRL,this),t.addDestroyFunc((()=>Qt(this.beans.gos,n,e.DOM_DATA_KEY_CELL_CTRL,null)))}createEvent(e,t){return this.beans.gos.addGridCommonParams({type:t,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),rowPinned:this.rowNode.rowPinned,event:e,rowIndex:this.rowNode.rowIndex})}processCharacter(e){this.cellKeyboardListenerFeature?.processCharacter(e)}onKeyDown(e){this.cellKeyboardListenerFeature?.onKeyDown(e)}onMouseEvent(e,t){this.cellMouseListenerFeature?.onMouseEvent(e,t)}getGui(){return this.eGui}getColSpanningList(){return this.cellPositionFeature.getColSpanningList()}onLeftChanged(){this.cellComp&&this.cellPositionFeature?.onLeftChanged()}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{cellComp:e,column:t,beans:n}=this;Ea(e,t,n.visibleColsService)}refreshAriaColIndex(){const e=this.beans.visibleColsService.getAriaColIndex(this.column);br(this.getGui(),e)}isSuppressNavigable(){return this.column.isSuppressNavigable(this.rowNode)}onWidthChanged(){return this.cellPositionFeature?.onWidthChanged()}getColumn(){return this.column}getRowNode(){return this.rowNode}isPrintLayout(){return this.printLayout}getCellPosition(){return this.cellPosition}isEditing(){return this.editing}startRowOrCellEdit(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.cellComp?"fullRow"===this.beans.gos.get("editType")?this.rowCtrl.startRowEditing(e,this):this.startEditing(e,!0,t):(this.onCellCompAttachedFuncs.push((()=>{this.startRowOrCellEdit(e,t)})),!0)}getRowCtrl(){return this.rowCtrl}getRowPosition(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}}updateRangeBordersIfRangeCount(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()}onCellSelectionChanged(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onCellSelectionChanged()}isRangeSelectionEnabled(){return null!=this.cellRangeFeature}focusCell(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus:e})}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onCellSelectionChanged()}onSuppressCellFocusChanged(e){this.eGui&&as(this.eGui,"tabindex",e?void 0:-1)}onFirstRightPinnedChanged(){if(!this.cellComp)return;const e=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass("ag-cell-first-right-pinned",e)}onLastLeftPinnedChanged(){if(!this.cellComp)return;const e=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass("ag-cell-last-left-pinned",e)}onCellFocused(e){if(this.beans.focusService.isCellFocusSuppressed())return;const t=this.beans.focusService.isCellFocused(this.cellPosition);if(!this.cellComp)return void(t&&e?.forceBrowserFocus&&(this.focusEventToRestore=e));if(this.focusEventToRestore=void 0,this.cellComp.addOrRemoveCssClass("ag-cell-focus",t),t&&e&&e.forceBrowserFocus){let t=this.cellComp.getFocusableElement();if(this.editing){const e=this.beans.focusService.findFocusableElements(t,null,!0);e.length&&(t=e[0])}t.focus({preventScroll:!!e.preventScrollOnBrowserFocus})}const n="fullRow"===this.beans.gos.get("editType");t||n||!this.editing||this.stopRowOrCellEdit(),t&&this.rowCtrl.announceDescription()}createCellPosition(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:Ft(this.rowNode.rowPinned),column:this.column}}applyStaticCssClasses(){this.cellComp.addOrRemoveCssClass("ag-cell",!0),this.cellComp.addOrRemoveCssClass("ag-cell-not-inline-editing",!0);const e=1==this.column.isAutoHeight();this.cellComp.addOrRemoveCssClass("ag-cell-auto-height",e),this.cellComp.addOrRemoveCssClass("ag-cell-normal-height",!e)}onColumnHover(){if(!this.cellComp)return;if(!this.beans.gos.get("columnHoverHighlight"))return;const e=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass("ag-column-hover",e)}onColDefChanged(){if(!this.cellComp)return;this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editing?this.beans.editService?.handleColDefChanged(this):this.refreshOrDestroyCell({forceRefresh:!0,suppressFlash:!0})}setWrapText(){const e=1==this.column.getColDef().wrapText;this.cellComp.addOrRemoveCssClass("ag-cell-wrap-text",e)}dispatchCellContextMenuEvent(e){const t=this.column.getColDef(),n=this.createEvent(e,"cellContextMenu");this.beans.eventService.dispatchEvent(n),t.onCellContextMenu&&window.setTimeout((()=>{this.beans.frameworkOverrides.wrapOutgoing((()=>{t.onCellContextMenu(n)}))}),0)}getCellRenderer(){return this.cellComp?this.cellComp.getCellRenderer():null}getCellEditor(){return this.cellComp?this.cellComp.getCellEditor():null}destroy(){this.onCellCompAttachedFuncs=[],this.onCellEditorAttachedFuncs=[],super.destroy()}createSelectionCheckbox(){const e=new El;return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){const e=new Rl(this.rowNode,this.column,this.eGui);return this.beans.context.createBean(e),e}registerRowDragger(e,t,n){if(this.customRowDragComp)return void this.customRowDragComp.setDragElement(e,t);const i=this.createRowDragComp(e,t,n);i&&(this.customRowDragComp=i,this.addDestroyFunc((()=>{this.beans.context.destroyBean(i),this.customRowDragComp=null})))}createRowDragComp(e,t,n){const i=this.beans.gos.get("pagination"),r=this.beans.gos.get("rowDragManaged"),s=Vt(this.beans.gos);if(r){if(!s)return void bt("managed row dragging is only allowed in the Client Side Row Model");if(i)return void bt("managed row dragging is not possible when doing pagination")}const o=new Ro((()=>this.value),this.rowNode,this.column,e,t,n);return this.beans.context.createBean(o),o}setSuppressRefreshCell(e){this.suppressRefreshCell=e}getEditCompDetails(){return this.editCompDetails}onCellEditorAttached(e){this.onCellEditorAttachedFuncs.push(e)}cellEditorAttached(){this.onCellEditorAttachedFuncs.forEach((e=>e())),this.onCellEditorAttachedFuncs=[]}};kl.DOM_DATA_KEY_CELL_CTRL="cellCtrl";var Ol=kl,Nl=0,Bl=class e extends Vn{constructor(e,t,n,i,r){super(),this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKeySanitised=null,this.beans=t,this.gos=t.gos,this.rowNode=e,this.paginationPage=t.paginationService?.getCurrentPage()??0,this.useAnimationFrameForCreate=i,this.printLayout=r,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+Nl++,this.rowId=Di(e.id),this.initRowBusinessKey(),this.rowFocused=t.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=t.rowCssClassCalculator.calculateRowLevel(this.rowNode),this.setRowType(),this.setAnimateFlags(n),this.rowStyles=this.processStylesFromGridOptions(),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if("function"!==typeof this.businessKeyForNodeFunc)return;const e=this.businessKeyForNodeFunc(this.rowNode);this.businessKeySanitised=Di(e)}getRowId(){return this.rowId}getRowStyles(){return this.rowStyles}isSticky(){return this.rowNode.sticky}updateGui(e,t){"left"===e?this.leftGui=t:"right"===e?this.rightGui=t:"fullWidth"===e?this.fullWidthGui=t:this.centerGui=t}setComp(e,t,n,i){const r={rowComp:e,element:t,containerType:n,compBean:i=Yi(this,this.beans.context,i)};this.allRowGuis.push(r),this.updateGui(n,r),this.initialiseRowComp(r),"FullWidthLoading"===this.rowType||this.rowNode.rowPinned||this.beans.rowRenderer.dispatchFirstDataRenderedEvent()}unsetComp(e){this.allRowGuis=this.allRowGuis.filter((t=>t.containerType!==e)),this.updateGui(e,void 0)}isCacheable(){return"FullWidthDetail"===this.rowType&&this.gos.get("keepDetailRows")}setCached(e){const t=e?"none":"";this.allRowGuis.forEach((e=>e.element.style.display=t))}initialiseRowComp(t){const n=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(t),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights(),this.onRowHeightChanged(t),this.updateRowIndexes(t),this.setFocusedClasses(t),this.setStylesFromGridOptions(!1,t),qt(n)&&this.rowNode.selectable&&this.onRowSelected(t),this.updateColumnLists(!this.useAnimationFrameForCreate);const i=t.rowComp;this.getInitialRowClasses(t.containerType).forEach((e=>i.addOrRemoveCssClass(e,!0))),this.executeSlideAndFadeAnimations(t),this.rowNode.group&&yr(t.element,1==this.rowNode.expanded),this.setRowCompRowId(i),this.setRowCompRowBusinessKey(i),Qt(n,t.element,e.DOM_DATA_KEY_ROW_CTRL,this),t.compBean.addDestroyFunc((()=>Qt(n,t.element,e.DOM_DATA_KEY_ROW_CTRL,null))),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,t),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(t),this.isFullWidth()&&this.setupFullWidth(t),n.get("rowDragEntireRow")&&this.addRowDraggerToRow(t),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask((()=>{this.isAlive()&&t.rowComp.addOrRemoveCssClass("ag-after-created",!0)})),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){null!=this.businessKeySanitised&&e.setRowBusinessKey(this.businessKeySanitised)}getBusinessKey(){return this.businessKeySanitised}setRowCompRowId(e){this.rowId=Di(this.rowNode.id),null!=this.rowId&&e.setRowId(this.rowId)}executeSlideAndFadeAnimations(e){const{containerType:t}=e;this.slideInAnimation[t]&&(Tt((()=>{this.onTopChanged()})),this.slideInAnimation[t]=!1);this.fadeInAnimation[t]&&(Tt((()=>{e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)})),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){if(vn(this.gos))return void bt("Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `cellSelection: true`");const t=this.beans.localeService.getLocaleTextFunc(),n=new Ro((()=>`1 ${t("rowDragRow","row")}`),this.rowNode,void 0,e.element,void 0,!0),i=this.createBean(n,this.beans.context);this.rowDragComps.push(i),e.compBean.addDestroyFunc((()=>{this.rowDragComps=this.rowDragComps.filter((e=>e!==i)),this.destroyBean(i,this.beans.context)}))}setupFullWidth(e){const t=this.getPinnedForContainer(e.containerType);if("FullWidthDetail"==this.rowType&&!this.gos.assertModuleRegistered("@ag-grid-enterprise/master-detail","cell renderer 'agDetailCellRenderer' (for master detail)"))return;const n=this.createFullWidthCompDetails(e.element,t);e.rowComp.showFullWidth(n)}isPrintLayout(){return this.printLayout}getFullWidthCellRenderers(){return this.gos.get("embedFullWidthRows")?this.allRowGuis.map((e=>e?.rowComp?.getFullWidthCellRenderer())):[this.fullWidthGui?.rowComp?.getFullWidthCellRenderer()]}getCellElement(e){const t=this.getCellCtrl(e);return t?t.getGui():null}executeProcessRowPostCreateFunc(){const e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;e({eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)})}areAllContainersReady(){const e=!!this.leftGui||!this.beans.visibleColsService.isPinningLeft(),t=!!this.centerGui,n=!!this.rightGui||!this.beans.visibleColsService.isPinningRight();return e&&t&&n}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return!!e&&e({rowNode:this.rowNode})}setRowType(){const e=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow")&&!this.gos.get("groupHideOpenParents"),t=this.isNodeFullWidthCell(),n=this.gos.get("masterDetail")&&this.rowNode.detail,i=this.beans.columnModel.isPivotMode(),r=!!this.rowNode.group&&!this.rowNode.footer&&pn(this.gos,i);this.rowType=e?"FullWidthLoading":n?"FullWidthDetail":t?"FullWidth":r?"FullWidthGroup":"Normal"}updateColumnLists(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isFullWidth())return;e||this.gos.get("suppressAnimationFrame")||this.printLayout?this.updateColumnListsImpl(t):this.updateColumnListsPending||(this.beans.animationFrameService.createTask((()=>{this.active&&this.updateColumnListsImpl(!0)}),this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0)}createCellCtrls(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i={list:[],map:{}},r=(e,t)=>{i.list.push(t),i.map[e]=t};return t.forEach((t=>{const n=t.getInstanceId();let i=e.map[n];i||(i=new Ol(t,this.rowNode,this.beans,this)),r(n,i)})),e.list.forEach((e=>{const t=e.getColumn().getInstanceId();if(null!=i.map[t])return;this.isCellEligibleToBeRemoved(e,n)?e.destroy():r(t,e)})),i}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){this.allRowGuis.forEach((t=>{const n=this.getCellCtrlsForContainer(t.containerType);t.rowComp.setCellCtrls(n,e)}))}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){const e=this.beans.columnViewportService,t=this.beans.visibleColsService;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.getAllCols()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const n=e.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,n);const i=t.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,i,"left");const r=t.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,r,"right")}}isCellEligibleToBeRemoved(e,t){const n=!0;if(e.getColumn().getPinned()!=t)return n;const i=e.isEditing(),r=this.beans.focusService.isCellFocused(e.getCellPosition());if(i||r){const t=e.getColumn();return!(this.beans.visibleColsService.getAllCols().indexOf(t)>=0)&&n}return n}getDomOrder(){return this.gos.get("ensureDomOrder")||jt(this.gos,"print")}listenOnDomOrder(e){e.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],(()=>{e.rowComp.setDomOrder(this.getDomOrder())}))}setAnimateFlags(e){if(this.isSticky()||!e)return;const t=Dt(this.rowNode.oldRowTop),n=this.beans.visibleColsService.isPinningLeft(),i=this.beans.visibleColsService.isPinningRight();if(t){if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows"))return void(this.slideInAnimation.fullWidth=!0);this.slideInAnimation.center=!0,this.slideInAnimation.left=n,this.slideInAnimation.right=i}else{if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows"))return void(this.fadeInAnimation.fullWidth=!0);this.fadeInAnimation.center=!0,this.fadeInAnimation.left=n,this.fadeInAnimation.right=i}}isEditing(){return this.editingRow}isFullWidth(){return"Normal"!==this.rowType}refreshFullWidth(){const e=(e,t)=>!e||e.rowComp.refreshFullWidth((()=>this.createFullWidthCompDetails(e.element,t).params)),t=e(this.fullWidthGui,null),n=e(this.centerGui,null),i=e(this.leftGui,"left"),r=e(this.rightGui,"right");return t&&n&&i&&r}addListeners(){this.addManagedListeners(this.rowNode,{heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this),expandedChanged:this.updateExpandedCss.bind(this),hasChildrenChanged:this.updateExpandedCss.bind(this)}),this.rowNode.detail&&this.addManagedListeners(this.rowNode.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(this.rowNode,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this)}),this.addManagedListeners(this.beans.eventService,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),this.addDestroyFunc((()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,this.beans.context),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature,this.beans.context))})),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",(()=>{this.gos.get("rowDragEntireRow")?this.allRowGuis.forEach((e=>{this.addRowDraggerToRow(e)})):this.rowDragComps=this.destroyBeans(this.rowDragComps,this.beans.context)})),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{this.getAllCellCtrls().forEach((e=>e.onRowIndexChanged()))},cellChanged:e=>{this.getAllCellCtrls().forEach((t=>t.onCellChanged(e)))}})}onRowNodeDataChanged(e){if(this.isFullWidth()!==!!this.isNodeFullWidthCell())this.beans.rowRenderer.redrawRow(this.rowNode);else if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode)}else this.getAllCellCtrls().forEach((t=>t.refreshCell({suppressFlash:!e.update,newData:!e.update}))),this.allRowGuis.forEach((e=>{this.setRowCompRowId(e.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(e.rowComp)})),this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const e=this.rowNode.highlighted;this.allRowGuis.forEach((t=>{const n=0===e,i=1===e;t.rowComp.addOrRemoveCssClass("ag-row-highlight-above",n),t.rowComp.addOrRemoveCssClass("ag-row-highlight-below",i)}))}postProcessRowDragging(){const e=this.rowNode.dragging;this.allRowGuis.forEach((t=>t.rowComp.addOrRemoveCssClass("ag-row-dragging",e)))}updateExpandedCss(){const e=this.rowNode.isExpandable(),t=1==this.rowNode.expanded;this.allRowGuis.forEach((n=>{n.rowComp.addOrRemoveCssClass("ag-row-group",e),n.rowComp.addOrRemoveCssClass("ag-row-group-expanded",e&&t),n.rowComp.addOrRemoveCssClass("ag-row-group-contracted",e&&!t),yr(n.element,e&&t)}))}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:Ft(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}findFullWidthRowGui(e){return this.allRowGuis.find((t=>t.element.contains(e)))}onKeyboardNavigate(e){const t=this.findFullWidthRowGui(e.target);if(!((t?t.element:null)===e.target))return;const n=this.rowNode,i=this.beans.focusService.getFocusedCell(),r={rowIndex:n.rowIndex,rowPinned:n.rowPinned,column:i?.column??this.getColumnForFullWidth(t)};this.beans.navigationService.navigateToNextCell(e,e.key,r,!0),e.preventDefault()}onTabKeyDown(e){if(e.defaultPrevented||zn(e))return;const t=this.allRowGuis.find((t=>t.element.contains(e.target))),n=t?t.element:null,i=n===e.target,r=rn(this.gos);let s=!1;n&&r&&(s=n.contains(r)&&r.classList.contains("ag-cell"));let o=null;i||s||(o=this.beans.focusService.findNextFocusableElement(n,!1,e.shiftKey)),(this.isFullWidth()&&i||!o)&&this.beans.navigationService.onTabKeyDown(this,e)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){const e=this.allRowGuis.find((e=>es(e.element)))?.element;return e?e.getBoundingClientRect().top:0}onSuppressCellFocusChanged(e){const t=this.isFullWidth()&&e?void 0:-1;this.allRowGuis.forEach((e=>{as(e.element,"tabindex",t)}))}onFullWidthRowFocused(e){const t=this.rowNode,n=!!e&&(this.isFullWidth()&&e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned),i=this.fullWidthGui?this.fullWidthGui.element:this.centerGui?.element;i&&(i.classList.toggle("ag-full-width-focus",n),n&&e?.forceBrowserFocus&&i.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,t){const n={list:[],map:{}};return e.list.forEach((e=>{e!==t&&(n.list.push(e),n.map[e.getColumn().getInstanceId()]=e)})),n}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t)}}createRowEvent(e,t){return this.gos.addGridCommonParams({type:e,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,event:t})}createRowEventWithSource(e,t){const n=this.createRowEvent(e,t);return n.source=this,n}onRowDblClick(e){zn(e)||this.beans.eventService.dispatchEvent(this.createRowEventWithSource("rowDoubleClicked",e))}getColumnForFullWidth(e){const{visibleColsService:t}=this.beans;switch(e?.containerType){case"center":return t.getCenterCols()[0];case"left":return t.getLeftCols()[0];case"right":return t.getRightCols()[0];default:return t.getAllCols()[0]}}onRowMouseDown(e){if(this.lastMouseDownOnDragger=Gr(e.target,"ag-row-drag",3),!this.isFullWidth())return;const t=this.rowNode;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges();const n=this.findFullWidthRowGui(e.target),i=n?.element,r=e.target;let s=!0;i&&i.contains(r)&&Br(r)&&(s=!1),this.beans.focusService.setFocusedCell({rowIndex:t.rowIndex,column:this.getColumnForFullWidth(n),rowPinned:t.rowPinned,forceBrowserFocus:s})}onRowClick(e){if(zn(e)||this.lastMouseDownOnDragger)return;const{gos:t}=this;this.beans.eventService.dispatchEvent(this.createRowEventWithSource("rowClicked",e));const n=e.ctrlKey||e.metaKey,i=e.shiftKey,r=this.rowNode.isSelected(),s=Mn(t),o=wn(t),a=function(e){const t=Cn(e);return!0===t||"enableSelection"===t}(t);if(s&&this.rowNode.group||this.isRowSelectionBlocked()||!a&&!r||!o&&r)return;const l=function(e){const t=e.get("rowSelection");return"string"===typeof t?e.get("rowMultiSelectWithClick"):t?.enableSelectionWithoutKeys??!1}(t),c="rowClicked";if(r)l?this.rowNode.setSelectedParams({newValue:!1,event:e,source:c}):n?o&&this.rowNode.setSelectedParams({newValue:!1,event:e,source:c}):a&&this.rowNode.setSelectedParams({newValue:!0,clearSelection:!i,rangeSelect:i,event:e,source:c});else{const t=!l&&!n;this.rowNode.setSelectedParams({newValue:!0,clearSelection:t,rangeSelect:i,event:e,source:c})}}isRowSelectionBlocked(){return!this.rowNode.selectable||!!this.rowNode.rowPinned||!qt(this.gos)}setupDetailRowAutoHeight(e){if("FullWidthDetail"!==this.rowType)return;if(!this.gos.get("detailRowAutoHeight"))return;const t=()=>{const t=e.clientHeight;if(null!=t&&t>0){const e=()=>{this.rowNode.setRowHeight(t),(Vt(this.gos)||Wt(this.gos))&&this.beans.rowModel.onRowHeightChanged()};window.setTimeout(e,0)}},n=this.beans.resizeObserverService.observeResize(e,t);this.addDestroyFunc(n),t()}createFullWidthCompDetails(e,t){const{gos:n,rowNode:i}=this,r=n.addGridCommonParams({fullWidth:!0,data:i.data,node:i,value:i.key,valueFormatted:i.key,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(e,t,n,i)=>this.addFullWidthRowDragging(e,t,n,i),setTooltip:(e,t)=>this.refreshRowTooltip(e,t)}),s=this.beans.userComponentFactory;switch(this.rowType){case"FullWidthDetail":return s.getFullWidthDetailCellRendererDetails(r);case"FullWidthGroup":return s.getFullWidthGroupCellRendererDetails(r);case"FullWidthLoading":return s.getFullWidthLoadingCellRendererDetails(r);default:return s.getFullWidthCellRendererDetails(r)}}refreshRowTooltip(e,t){if(!this.fullWidthGui)return;const n={getGui:()=>this.fullWidthGui.element,getTooltipValue:()=>e,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:t};this.tooltipFeature&&this.destroyBean(this.tooltipFeature,this.beans.context),this.tooltipFeature=this.createBean(new ds(n,this.beans))}addFullWidthRowDragging(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3?arguments[3]:void 0;if(!this.isFullWidth())return;const r=new Ro((()=>n),this.rowNode,void 0,e,t,i);this.createBean(r,this.beans.context),this.addDestroyFunc((()=>{this.destroyBean(r,this.beans.context)}))}onUiLevelChanged(){const e=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=e){const t="ag-row-level-"+e,n="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach((e=>{e.rowComp.addOrRemoveCssClass(t,!0),e.rowComp.addOrRemoveCssClass(n,!1)}))}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBoundsService.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBoundsService.getLastRow()}refreshFirstAndLastRowStyles(){const e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();this.firstRowOnPage!==e&&(this.firstRowOnPage=e,this.allRowGuis.forEach((t=>t.rowComp.addOrRemoveCssClass("ag-row-first",e)))),this.lastRowOnPage!==t&&(this.lastRowOnPage=t,this.allRowGuis.forEach((e=>e.rowComp.addOrRemoveCssClass("ag-row-last",t))))}stopEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.stoppingRowEdit||this.beans.rowEditService?.stopEditing(this,e)}setInlineEditingCss(){const e=this.editingRow||this.getAllCellCtrls().some((e=>e.isEditing()));this.allRowGuis.forEach((t=>{t.rowComp.addOrRemoveCssClass("ag-row-inline-editing",e),t.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!e)}))}setEditingRow(e){this.editingRow=e}startRowEditing(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return!!this.editingRow||(this.beans.rowEditService?.startEditing(this,e,t,n)??!0)}getAllCellCtrls(){if(0===this.leftCellCtrls.list.length&&0===this.rightCellCtrls.list.length)return this.centerCellCtrls.list;return[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const e=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);e&&e.length&&e.forEach((e=>{this.allRowGuis.forEach((t=>t.rowComp.addOrRemoveCssClass(e,!0)))}))}postProcessRowClassRules(){this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,(e=>{this.allRowGuis.forEach((t=>t.rowComp.addOrRemoveCssClass(e,!0)))}),(e=>{this.allRowGuis.forEach((t=>t.rowComp.addOrRemoveCssClass(e,!1)))}))}setStylesFromGridOptions(e,t){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(t,(e=>e.rowComp.setUserStyles(this.rowStyles)))}getPinnedForContainer(e){return"left"===e||"right"===e?e:null}getInitialRowClasses(e){const t=this.getPinnedForContainer(e),n={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[e],rowIsEven:this.rowNode.rowIndex%2===0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned:t};return this.beans.rowCssClassCalculator.getInitialRowClasses(n)}processStylesFromGridOptions(){const e=this.gos.get("rowStyle");if(e&&"function"===typeof e)return void bt("rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead");const t=this.gos.getCallback("getRowStyle");let n;if(t){n=t({data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex})}return n||e?Object.assign({},e,n):this.emptyStyle}onRowSelected(e){const t=!!this.rowNode.isSelected();this.forEachGui(e,(e=>{e.rowComp.addOrRemoveCssClass("ag-row-selected",t),Mr(e.element,t);!e.element.contains(rn(this.gos))||e!==this.centerGui&&e!==this.fullWidthGui||this.announceDescription()}))}announceDescription(){if(this.isRowSelectionBlocked())return;const e=this.rowNode.isSelected();if(e&&!wn(this.gos))return;const t=this.beans.localeService.getLocaleTextFunc()(e?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${e?"deselect":"select"} this row.`);this.beans.ariaAnnouncementService.announceValue(t,"rowSelection")}addHoverFunctionality(e){if(!this.active)return;const{element:t,compBean:n}=e,{rowNode:i,beans:r,gos:s}=this;n.addManagedListeners(t,{mouseenter:()=>i.onMouseEnter(),mouseleave:()=>i.onMouseLeave()}),n.addManagedListeners(i,{mouseEnter:()=>{r.dragService.isDragging()||s.get("suppressRowHoverHighlight")||(t.classList.add("ag-row-hover"),i.setHovered(!0))},mouseLeave:()=>{t.classList.remove("ag-row-hover"),i.setHovered(!1)}})}roundRowTopToBounds(e){const t=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getApproximateVScollPosition(),n=this.applyPaginationOffset(t.top,!0)-100,i=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(n,e),i)}getFrameworkOverrides(){return this.beans.frameworkOverrides}forEachGui(e,t){e?t(e):this.allRowGuis.forEach(t)}onRowHeightChanged(e){if(null==this.rowNode.rowHeight)return;const t=this.rowNode.rowHeight,n=this.beans.environment.getDefaultRowHeight(),i=Kt(this.gos)?$t(this.gos,this.rowNode).height:void 0,r=i?Math.min(n,i)-2+"px":void 0;this.forEachGui(e,(e=>{e.element.style.height=`${t}px`,r&&e.element.style.setProperty("--ag-line-height",r)}))}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}destroyFirstPass(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.active=!1,!e&&on(this.gos)&&!this.isSticky()){if(null!=this.rowNode.rowTop){const e=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(e)}else this.allRowGuis.forEach((e=>e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0)))}this.rowNode.setHovered(!1);const t=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(t),this.beans.eventService.dispatchEvent(t),super.destroy()}destroySecondPass(){this.allRowGuis.length=0,this.stopEditing();const e=e=>(e.list.forEach((e=>e.destroy())),{list:[],map:{}});this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,(e=>{e.rowComp.addOrRemoveCssClass("ag-row-focus",this.rowFocused),e.rowComp.addOrRemoveCssClass("ag-row-no-focus",!this.rowFocused)}))}onCellFocusChanged(){const e=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);e!==this.rowFocused&&(this.rowFocused=e,this.setFocusedClasses()),!e&&this.editingRow&&this.stopEditing(!1)}onPaginationChanged(){const e=this.beans.paginationService?.getCurrentPage()??0;this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;return e+this.beans.pageBoundsService.getPixelOffset()*(t?1:-1)}setRowTop(e){if(!this.printLayout&&Dt(e)){const t=this.applyPaginationOffset(e),n=`${this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeightService.getRealPixelPosition(t)}px`;this.setRowTopStyle(n)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(e){if(this.printLayout)return"";const t=this.rowNode;let n;if(this.isSticky())n=t.stickyRowTop;else{const i=this.slideInAnimation[e]?this.roundRowTopToBounds(t.oldRowTop):t.rowTop,r=this.applyPaginationOffset(i);n=t.isRowPinned()?r:this.beans.rowContainerHeightService.getRealPixelPosition(r)}return n+"px"}setRowTopStyle(e){this.allRowGuis.forEach((t=>this.suppressRowTransform?t.rowComp.setTop(e):t.rowComp.setTransform(`translateY(${e})`)))}getRowNode(){return this.rowNode}getCellCtrl(e){let t=null;return this.getAllCellCtrls().forEach((n=>{n.getColumn()==e&&(t=n)})),null!=t||this.getAllCellCtrls().forEach((n=>{n.getColSpanningList().indexOf(e)>=0&&(t=n)})),t}onRowIndexChanged(){null!=this.rowNode.rowIndex&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}getRowIndex(){return this.rowNode.getRowIndexString()}updateRowIndexes(e){const t=this.rowNode.getRowIndexString();if(null===t)return;const n=this.beans.headerNavigationService.getHeaderRowCount()+(this.beans.filterManager?.getHeaderRowCount()??0),i=this.rowNode.rowIndex%2===0,r=n+this.rowNode.rowIndex+1;this.forEachGui(e,(e=>{e.rowComp.setRowIndex(t),e.rowComp.addOrRemoveCssClass("ag-row-even",i),e.rowComp.addOrRemoveCssClass("ag-row-odd",!i),wr(e.element,r)}))}setStoppingRowEdit(e){this.stoppingRowEdit=e}};Bl.DOM_DATA_KEY_ROW_CTRL="renderedRow";var zl=Bl,Hl=class extends Vn{wireBeans(e){this.mouseEventService=e.mouseEventService,this.valueService=e.valueService,this.menuService=e.menuService,this.ctrlsService=e.ctrlsService,this.navigationService=e.navigationService,this.focusService=e.focusService,this.undoRedoService=e.undoRedoService,this.visibleColsService=e.visibleColsService,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel,this.rangeService=e.rangeService,this.clipboardService=e.clipboardService}constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.mockContextMenuForIPad()}addKeyboardListeners(){const e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){["dblclick","contextmenu","mouseover","mouseout","click",Hn("touchstart")?"touchstart":"mousedown"].forEach((e=>{const t=this.processMouseEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}))}processMouseEvent(e,t){if(!this.mouseEventService.isEventFromThisGrid(t)||zn(t))return;const n=this.getRowForEvent(t),i=this.mouseEventService.getRenderedCellForEvent(t);"contextmenu"===e?this.handleContextMenuMouseEvent(t,void 0,n,i):(i&&i.onMouseEvent(e,t),n&&n.onMouseEvent(e,t))}mockContextMenuForIPad(){if(!Dr())return;const e=new Ss(this.element);this.addManagedListeners(e,{longTap:e=>{const t=this.getRowForEvent(e.touchEvent),n=this.mouseEventService.getRenderedCellForEvent(e.touchEvent);this.handleContextMenuMouseEvent(void 0,e.touchEvent,t,n)}}),this.addDestroyFunc((()=>e.destroy()))}getRowForEvent(e){let t=e.target;for(;t;){const e=Jt(this.gos,t,zl.DOM_DATA_KEY_ROW_CTRL);if(e)return e;t=t.parentElement}return null}handleContextMenuMouseEvent(e,t,n,i){const r=n?n.getRowNode():null,s=i?i.getColumn():null;let o=null;if(s){const n=e||t;i.dispatchCellContextMenuEvent(n??null),o=this.valueService.getValue(s,r)}const a=this.ctrlsService.getGridBodyCtrl(),l=i?i.getGui():a.getGridBodyElement();this.menuService.showContextMenu({mouseEvent:e,touchEvent:t,rowNode:r,column:s,value:o,anchorToElement:l})}getControlsForEventTarget(e){return{cellCtrl:Gn(this.gos,e,Ol.DOM_DATA_KEY_CELL_CTRL),rowCtrl:Gn(this.gos,e,zl.DOM_DATA_KEY_ROW_CTRL)}}processKeyboardEvent(e,t){const{cellCtrl:n,rowCtrl:i}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(n?this.processCellKeyboardEvent(n,e,t):i&&i.isFullWidth()&&this.processFullWidthRowKeyboardEvent(i,e,t))}processCellKeyboardEvent(e,t,n){const i=e.getRowNode(),r=e.getColumn(),s=e.isEditing();if(!ea(this.gos,n,i,r,s)&&"keydown"===t){!s&&this.navigationService.handlePageScrollingKey(n)||e.onKeyDown(n),this.doGridOperations(n,e.isEditing()),Qo(n)&&e.processCharacter(n)}"keydown"===t&&this.eventService.dispatchEvent(e.createEvent(n,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,n){const i=e.getRowNode(),r=this.focusService.getFocusedCell(),s=r&&r.column;if(!ea(this.gos,n,i,s,!1)){const i=n.key;if("keydown"===t)switch(i){case As.PAGE_HOME:case As.PAGE_END:case As.PAGE_UP:case As.PAGE_DOWN:this.navigationService.handlePageScrollingKey(n,!0);break;case As.UP:case As.DOWN:e.onKeyboardNavigate(n);break;case As.TAB:e.onTabKeyDown(n)}}"keydown"===t&&this.eventService.dispatchEvent(e.createRowEvent("cellKeyDown",n))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey)return;if(t)return;if(!this.mouseEventService.isEventFromThisGrid(e))return;const n=function(e){const{keyCode:t}=e;let n;switch(t){case 65:n=As.A;break;case 67:n=As.C;break;case 86:n=As.V;break;case 68:n=As.D;break;case 90:n=As.Z;break;case 89:n=As.Y;break;default:n=e.code}return n}(e);return n===As.A?this.onCtrlAndA(e):n===As.C?this.onCtrlAndC(e):n===As.D?this.onCtrlAndD(e):n===As.V?this.onCtrlAndV(e):n===As.X?this.onCtrlAndX(e):n===As.Y?this.onCtrlAndY():n===As.Z?this.onCtrlAndZ(e):void 0}onCtrlAndA(e){const{pinnedRowModel:t,rowModel:n,rangeService:i}=this;if(i&&n.isRowsToRender()){const[e,r]=[t.isEmpty("top"),t.isEmpty("bottom")],s=e?null:"top";let o,a;r?(o=null,a=n.getRowCount()-1):(o="bottom",a=t.getPinnedBottomRowCount()-1);const l=this.visibleColsService.getAllCols();if(It(l))return;i.setCellRange({rowStartIndex:0,rowStartPinned:s,rowEndIndex:a,rowEndPinned:o,columnStart:l[0],columnEnd:Rn(l)})}e.preventDefault()}onCtrlAndC(e){if(!this.clipboardService||this.gos.get("enableCellTextSelection"))return;const{cellCtrl:t,rowCtrl:n}=this.getControlsForEventTarget(e.target);t?.isEditing()||n?.isEditing()||(e.preventDefault(),this.clipboardService.copyToClipboard())}onCtrlAndX(e){if(!this.clipboardService||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl:t,rowCtrl:n}=this.getControlsForEventTarget(e.target);t?.isEditing()||n?.isEditing()||(e.preventDefault(),this.clipboardService.cutToClipboard(void 0,"ui"))}onCtrlAndV(e){const{cellCtrl:t,rowCtrl:n}=this.getControlsForEventTarget(e.target);t?.isEditing()||n?.isEditing()||this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()}onCtrlAndD(e){this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),e.preventDefault()}onCtrlAndZ(e){this.gos.get("undoRedoCellEditing")&&this.undoRedoService&&(e.preventDefault(),e.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))}onCtrlAndY(){this.undoRedoService?.redo("ui")}},Gl=class extends Vn{wireBeans(e){this.pinnedWidthService=e.pinnedWidthService}constructor(e){super(),this.element=e}postConstruct(){this.addManagedEventListeners({leftPinnedWidthChanged:this.onPinnedLeftWidthChanged.bind(this)})}onPinnedLeftWidthChanged(){const e=this.pinnedWidthService.getPinnedLeftWidth(),t=e>0;zr(this.element,t),is(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedLeftWidth()}},Ul=class extends Vn{wireBeans(e){this.pinnedWidthService=e.pinnedWidthService}constructor(e){super(),this.element=e}postConstruct(){this.addManagedEventListeners({rightPinnedWidthChanged:this.onPinnedRightWidthChanged.bind(this)})}onPinnedRightWidthChanged(){const e=this.pinnedWidthService.getPinnedRightWidth(),t=e>0;zr(this.element,t),is(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedRightWidth()}},Vl=e=>e.getTopRowCtrls(),Wl=e=>e.getStickyTopRowCtrls(),jl=e=>e.getStickyBottomRowCtrls(),ql=e=>e.getBottomRowCtrls(),Xl=e=>e.getCentreRowCtrls(),Kl={center:{type:"center",container:"ag-center-cols-container",viewport:"ag-center-cols-viewport",getRowCtrls:Xl},left:{type:"left",container:"ag-pinned-left-cols-container",pinnedType:"left",getRowCtrls:Xl},right:{type:"right",container:"ag-pinned-right-cols-container",pinnedType:"right",getRowCtrls:Xl},fullWidth:{type:"fullWidth",container:"ag-full-width-container",fullWidth:!0,getRowCtrls:Xl},topCenter:{type:"center",container:"ag-floating-top-container",viewport:"ag-floating-top-viewport",getRowCtrls:Vl},topLeft:{type:"left",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:Vl},topRight:{type:"right",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:Vl},topFullWidth:{type:"fullWidth",container:"ag-floating-top-full-width-container",fullWidth:!0,getRowCtrls:Vl},stickyTopCenter:{type:"center",container:"ag-sticky-top-container",viewport:"ag-sticky-top-viewport",getRowCtrls:Wl},stickyTopLeft:{type:"left",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:Wl},stickyTopRight:{type:"right",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:Wl},stickyTopFullWidth:{type:"fullWidth",container:"ag-sticky-top-full-width-container",fullWidth:!0,getRowCtrls:Wl},stickyBottomCenter:{type:"center",container:"ag-sticky-bottom-container",viewport:"ag-sticky-bottom-viewport",getRowCtrls:jl},stickyBottomLeft:{type:"left",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:jl},stickyBottomRight:{type:"right",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:jl},stickyBottomFullWidth:{type:"fullWidth",container:"ag-sticky-bottom-full-width-container",fullWidth:!0,getRowCtrls:jl},bottomCenter:{type:"center",container:"ag-floating-bottom-container",viewport:"ag-floating-bottom-viewport",getRowCtrls:ql},bottomLeft:{type:"left",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:ql},bottomRight:{type:"right",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:ql},bottomFullWidth:{type:"fullWidth",container:"ag-floating-bottom-full-width-container",fullWidth:!0,getRowCtrls:ql}};function $l(e){return Kl[e]}var Zl=["center","left","right","fullWidth"],Yl=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],Jl=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],Ql=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],ec=["stickyTopCenter","stickyTopLeft","stickyTopRight"],tc=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],nc=[...ec,"stickyTopFullWidth",...tc,"stickyBottomFullWidth"],ic=["topCenter","topLeft","topRight","bottomCenter","bottomLeft","bottomRight","center","left","right",...ec,...tc],rc=class extends Vn{constructor(e){super(),this.visible=!0,this.EMPTY_CTRLS=[],this.name=e,this.options=$l(e)}wireBeans(e){this.dragService=e.dragService,this.ctrlsService=e.ctrlsService,this.columnViewportService=e.columnViewportService,this.resizeObserverService=e.resizeObserverService,this.rowRenderer=e.rowRenderer}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],(()=>{this.viewportSizeFeature=this.createManagedBean(new _l(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})}))}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.ctrlsService.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}getContainerElement(){return this.eContainer}getViewportSizeFeature(){return this.viewportSizeFeature}setComp(e,t,n){this.comp=e,this.eContainer=t,this.eViewport=n,this.createManagedBean(new Hl(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();const i=()=>this.onPinnedWidthChanged();this.forContainers(Jl,(()=>{this.pinnedWidthFeature=this.createManagedBean(new Gl(this.eContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:i})})),this.forContainers(Ql,(()=>{this.pinnedWidthFeature=this.createManagedBean(new Ul(this.eContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:i})})),this.forContainers(Zl,(()=>this.createManagedBean(new wl(this.eContainer,"center"===this.name?n:void 0)))),this.forContainers(ic,(()=>this.createManagedBean(new Ml(this.eContainer)))),this.forContainers(Yl,(()=>this.createManagedBean(new Ja((e=>this.comp.setContainerWidth(`${e}px`)))))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.getViewportElement(),{scroll:e})}addListeners(){this.addManagedEventListeners({displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),displayedRowsChanged:e=>this.onDisplayedRowsChanged(e.afterScroll)}),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()}listenOnDomOrder(){if(nc.indexOf(this.name)>=0)return void this.comp.setDomOrder(!0);const e=()=>{const e=this.gos.get("ensureDomOrder"),t=jt(this.gos,"print");this.comp.setDomOrder(e||t)};this.addManagedPropertyListener("domLayout",e),e()}onDisplayedColumnsChanged(){this.forContainers(["center"],(()=>this.onHorizontalViewportChanged()))}onDisplayedColumnsWidthChanged(){this.forContainers(["center"],(()=>this.onHorizontalViewportChanged()))}addPreventScrollWhileDragging(){const e=e=>{this.dragService.isDragging()&&e.cancelable&&e.preventDefault()};this.eContainer.addEventListener("touchmove",e,{passive:!1}),this.addDestroyFunc((()=>this.eContainer.removeEventListener("touchmove",e)))}onHorizontalViewportChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.getCenterWidth(),n=this.getCenterViewportScrollLeft();this.columnViewportService.setScrollPosition(t,n,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return Wr(this.eViewport)}getCenterViewportScrollLeft(){return $r(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){const t=this.resizeObserverService.observeResize(this.eViewport,e);this.addDestroyFunc((()=>t()))}isViewportInTheDOMTree(){return Qr(this.eViewport)}getViewportScrollLeft(){return $r(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||(e=this.eViewport).clientWidth<e.scrollWidth;var e}getViewportElement(){return this.eViewport}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){Zr(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(null!=this.options.pinnedType)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.options.getRowCtrls(this.rowRenderer);if(!this.visible||0===t.length)return void this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});const n=jt(this.gos,"print"),i=this.gos.get("embedFullWidthRows")||n,r=t.filter((e=>{const t=e.isFullWidth();return this.options.fullWidth?!i&&t:i||!t}));this.comp.setRowCtrls({rowCtrls:r,useFlushSync:e})}},sc="ag-force-vertical-scroll",oc=class extends Vn{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.animationFrameService=e.animationFrameService,this.rowContainerHeightService=e.rowContainerHeightService,this.ctrlsService=e.ctrlsService,this.columnModel=e.columnModel,this.columnSizeService=e.columnSizeService,this.scrollVisibleService=e.scrollVisibleService,this.menuService=e.menuService,this.headerNavigationService=e.headerNavigationService,this.dragAndDropService=e.dragAndDropService,this.pinnedRowModel=e.pinnedRowModel,this.rowRenderer=e.rowRenderer,this.popupService=e.popupService,this.mouseEventService=e.mouseEventService,this.rowModel=e.rowModel,this.filterManager=e.filterManager,this.environment=e.environment}getScrollFeature(){return this.bodyScrollFeature}getBodyViewportElement(){return this.eBodyViewport}setComp(e,t,n,i,r,s,o){this.comp=e,this.eGridBody=t,this.eBodyViewport=n,this.eTop=i,this.eBottom=r,this.eStickyTop=s,this.eStickyBottom=o,this.eCenterColsViewport=n.querySelector(`.${$l("center").viewport}`),this.eFullWidthContainer=n.querySelector(`.${$l("fullWidth").container}`),this.eStickyTopFullWidthContainer=s.querySelector(`.${$l("stickyTopFullWidth").container}`),this.eStickyBottomFullWidthContainer=o.querySelector(`.${$l("stickyBottomFullWidth").container}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",(e=>this.setCellTextSelection(e.currentValue))),this.createManagedBean(new ml(this.comp)),this.bodyScrollFeature=this.createManagedBean(new xl(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([i,n,r,s,o]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),this.filterManager?.setupAdvancedFilterHeaderComp(i),this.ctrlsService.register("gridBodyCtrl",this)}getComp(){return this.comp}addEventListeners(){const e=this.setFloatingHeights.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.onScrollGapChanged.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,headerHeightChanged:this.onHeaderHeightChanged.bind(this)})}addFocusListeners(e){e.forEach((e=>{this.addManagedElementListeners(e,{focusin:t=>{const{target:n}=t,i=Gr(n,"ag-root",e);e.classList.toggle("ag-has-focus",!i)},focusout:t=>{const{target:n,relatedTarget:i}=t,r=e.contains(i),s=Gr(i,"ag-root",e);Gr(n,"ag-root",e)||r&&!s||e.classList.remove("ag-has-focus")}})}))}setColumnMovingCss(e){this.comp.setColumnMovingCss("ag-column-moving",e)}setCellTextSelection(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.comp.setCellSelectableCss("ag-selectable",e)}onScrollVisibilityChanged(){const e=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(e),this.setStickyWidth(e),this.setStickyBottomOffsetBottom();const t=`calc(100% + ${(e&&this.scrollVisibleService.getScrollbarWidth()||0)+(Or()?16:0)}px)`;this.animationFrameService.requestAnimationFrame((()=>this.comp.setBodyViewportWidth(t))),this.updateScrollingClasses()}onScrollGapChanged(){this.updateScrollingClasses()}updateScrollingClasses(){this.eGridBody.classList.toggle("ag-body-vertical-content-no-gap",!this.scrollVisibleService.hasVerticalScrollGap()),this.eGridBody.classList.toggle("ag-body-horizontal-content-no-gap",!this.scrollVisibleService.hasHorizontalScrollGap())}onGridColumnsChanged(){const e=this.columnModel.getCols();this.comp.setColumnCount(e.length)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){if(!this.gos.get("stopEditingWhenCellsLoseFocus"))return;const e=e=>{const n=e.relatedTarget;if(null===Ir(n))return void this.rowRenderer.stopEditing();let i=t.some((e=>e.contains(n)))&&this.mouseEventService.isElementInThisGrid(n);if(!i){const e=this.popupService;i=e.getActivePopups().some((e=>e.contains(n)))||e.isElementWithinCustomPopup(n)}i||this.rowRenderer.stopEditing()},t=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom];t.forEach((t=>this.addManagedElementListeners(t,{focusout:e})))}updateRowCount(){const e=this.headerNavigationService.getHeaderRowCount()+(this.filterManager?.getHeaderRowCount()??0),t=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1,n=-1===t?-1:e+t;this.comp.setRowCount(n)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){const t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){const e=this.gos.get("alwaysShowVerticalScroll"),t=e?sc:null,n=jt(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||n&&(i=this.eBodyViewport).clientHeight<i.scrollHeight;var i}setupRowAnimationCssClass(){let e=this.environment.hasMeasuredSizes();const t=()=>{const t=e&&on(this.gos)&&!this.rowContainerHeightService.isStretching(),n=t?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(n,t)};t(),this.addManagedEventListeners({heightScaleChanged:t}),this.addManagedPropertyListener("animateRows",t),this.addManagedEventListeners({gridStylesChanged:()=>{!e&&this.environment.hasMeasuredSizes()&&(e=!0,t())}})}getGridBodyElement(){return this.eGridBody}addBodyViewportListener(){const e=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(this.eBodyViewport,{contextmenu:e}),this.mockContextMenuForIPad(e),this.addManagedElementListeners(this.eBodyViewport,{wheel:this.onBodyViewportWheel.bind(this)}),this.addManagedElementListeners(this.eStickyTop,{wheel:this.onStickyWheel.bind(this)}),this.addManagedElementListeners(this.eStickyBottom,{wheel:this.onStickyWheel.bind(this)}),this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){const{deltaX:t,deltaY:n,shiftKey:i}=e;(i||Math.abs(t)>Math.abs(n))&&this.mouseEventService.isEventFromThisGrid(e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){const{deltaX:t,deltaY:n,shiftKey:i}=e,r=i||Math.abs(t)>Math.abs(n),s=e.target;r?(this.eStickyTopFullWidthContainer.contains(s)||this.eStickyBottomFullWidthContainer.contains(s))&&this.scrollGridBodyToMatchEvent(e):(e.preventDefault(),this.scrollVertically(n))}scrollGridBodyToMatchEvent(e){const{deltaX:t,deltaY:n}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||n})}onBodyViewportContextMenu(e,t,n){if(!e&&!n)return;if(this.gos.get("preventDefaultOnContextMenu")){(e||n).preventDefault()}const{target:i}=e||t;i!==this.eBodyViewport&&i!==this.ctrlsService.get("center").getViewportElement()||this.menuService.showContextMenu({mouseEvent:e,touchEvent:n,value:null,anchorToElement:this.eGridBody})}mockContextMenuForIPad(e){if(!Dr())return;const t=new Ss(this.eBodyViewport);this.addManagedListeners(t,{longTap:t=>{e(void 0,t.touchStart,t.touchEvent)}}),this.addDestroyFunc((()=>t.destroy()))}onBodyViewportWheel(e){this.gos.get("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&e.preventDefault()}getGui(){return this.eGridBody}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}addRowDragListener(){this.rowDragFeature=this.createManagedBean(new Mo(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature),this.addDestroyFunc((()=>this.dragAndDropService.removeDropTarget(this.rowDragFeature)))}getRowDragFeature(){return this.rowDragFeature}setFloatingHeights(){const{pinnedRowModel:e}=this,t=e.getPinnedTopTotalHeight(),n=e.getPinnedBottomTotalHeight();this.comp.setTopHeight(t),this.comp.setBottomHeight(n),this.comp.setTopDisplay(t?"inherit":"none"),this.comp.setBottomDisplay(n?"inherit":"none"),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}getStickyTopHeight(){return this.stickyTopHeight}setStickyBottomHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}getStickyBottomHeight(){return this.stickyBottomHeight}setStickyWidth(e){if(e){const e=this.scrollVisibleService.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${e}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${e}px)`)}else this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%")}onHeaderHeightChanged(){this.setStickyTopOffsetTop()}setStickyTopOffsetTop(){const e=this.ctrlsService.get("gridHeaderCtrl").getHeaderHeight()+(this.filterManager?.getHeaderHeight()??0),t=this.pinnedRowModel.getPinnedTopTotalHeight();let n=0;e>0&&(n+=e),t>0&&(n+=t),n>0&&(n+=1),this.comp.setStickyTopTop(`${n}px`)}setStickyBottomOffsetBottom(){const e=this.pinnedRowModel.getPinnedBottomTotalHeight()+(this.scrollVisibleService.isHorizontalScrollShowing()&&this.scrollVisibleService.getScrollbarWidth()||0);this.comp.setStickyBottomBottom(`${e}px`)}sizeColumnsToFit(e,t){const n=this.isVerticalScrollShowing()?this.scrollVisibleService.getScrollbarWidth():0,i=Wr(this.eGridBody)-n;i>0?this.columnSizeService.sizeColumnsToFit(i,"sizeColumnsToFit",!1,e):void 0===t?window.setTimeout((()=>{this.sizeColumnsToFit(e,100)}),0):100===t?window.setTimeout((()=>{this.sizeColumnsToFit(e,500)}),100):500===t?window.setTimeout((()=>{this.sizeColumnsToFit(e,-1)}),500):bt("tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")}addScrollEventListener(e){this.eBodyViewport.addEventListener("scroll",e,{passive:!0})}removeScrollEventListener(e){this.eBodyViewport.removeEventListener("scroll",e)}};function ac(e){return e.map((e=>`<ag-row-container name="${e}"></ag-row-container>`)).join("")}ac(["topLeft","topCenter","topRight","topFullWidth"]),ac(["left","center","right","fullWidth"]),ac(["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"]),ac(["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"]),ac(["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"]);var lc=class extends Vn{constructor(){super(...arguments),this.beanName="scrollVisibleService"}wireBeans(e){this.ctrlsService=e.ctrlsService,this.columnAnimationService=e.columnAnimationService}postConstruct(){this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this)})}onDisplayedColumnsChanged(){this.updateScrollVisible()}onDisplayedColumnsWidthChanged(){this.updateScrollVisible()}onCentreViewportResized(){this.updateScrollGap()}updateScrollVisible(){this.columnAnimationService.isActive()?this.columnAnimationService.executeLaterVMTurn((()=>{this.columnAnimationService.executeLaterVMTurn((()=>this.updateScrollVisibleImpl()))})):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){const e=this.ctrlsService.get("center");if(!e||this.columnAnimationService.isActive())return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){const e=this.ctrlsService.get("center"),t=e.hasHorizontalScrollGap(),n=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==n)&&(this.horizontalScrollGap=t,this.verticalScrollGap=n,this.eventService.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventService.dispatchEvent({type:"scrollVisibilityChanged"}))}isHorizontalScrollShowing(){return this.horizontalScrollShowing}isVerticalScrollShowing(){return this.verticalScrollShowing}hasHorizontalScrollGap(){return this.horizontalScrollGap}hasVerticalScrollGap(){return this.verticalScrollGap}getScrollbarWidth(){if(null==this.scrollbarWidth){const e=this.gos.get("scrollbarWidth"),t="number"===typeof e&&e>=0?e:(null==sr&&kr(),sr);null!=t&&(this.scrollbarWidth=t,this.eventService.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},cc="__ag_grid_instance",uc=class e extends Vn{constructor(){super(...arguments),this.beanName="mouseEventService",this.gridInstanceId=e.gridInstanceSequence.next()}wireBeans(e){this.ctrlsService=e.ctrlsService}stampTopLevelGridCompWithGridInstance(e){e[cc]=this.gridInstanceId}getRenderedCellForEvent(e){return Gn(this.gos,e.target,Ol.DOM_DATA_KEY_CELL_CTRL)}isEventFromThisGrid(e){return this.isElementInThisGrid(e.target)}isElementInThisGrid(e){let t=e;for(;t;){const e=t[cc];if(Dt(e)){return e===this.gridInstanceId}t=t.parentElement}return!1}getCellPositionForEvent(e){const t=this.getRenderedCellForEvent(e);return t?t.getCellPosition():null}getNormalisedPosition(e){const t=jt(this.gos,"normal"),n=e;let i,r;if(null!=n.clientX||null!=n.clientY?(i=n.clientX,r=n.clientY):(i=n.x,r=n.y),t){const e=this.ctrlsService.getGridBodyCtrl(),t=e.getScrollFeature().getVScrollPosition();i+=e.getScrollFeature().getHScrollPosition().left,r+=t.top}return{x:i,y:r}}};uc.gridInstanceSequence=new cs;var hc=uc,dc=class extends Vn{constructor(){super(),this.beanName="navigationService",this.onPageDown=At(this.onPageDown,100),this.onPageUp=At(this.onPageUp,100)}wireBeans(e){this.mouseEventService=e.mouseEventService,this.pageBoundsService=e.pageBoundsService,this.focusService=e.focusService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.rowModel=e.rowModel,this.ctrlsService=e.ctrlsService,this.rowRenderer=e.rowRenderer,this.headerNavigationService=e.headerNavigationService,this.rowPositionUtils=e.rowPositionUtils,this.cellNavigationService=e.cellNavigationService,this.pinnedRowModel=e.pinnedRowModel,this.scrollVisibleService=e.scrollVisibleService,this.rangeService=e.rangeService}postConstruct(){this.ctrlsService.whenReady(this,(e=>{this.gridBodyCon=e.gridBodyCtrl}))}handlePageScrollingKey(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.key,i=e.altKey,r=e.ctrlKey||e.metaKey,s=!!this.rangeService&&e.shiftKey,o=this.mouseEventService.getCellPositionForEvent(e);let a=!1;switch(n){case As.PAGE_HOME:case As.PAGE_END:r||i||(this.onHomeOrEndKey(n),a=!0);break;case As.LEFT:case As.RIGHT:case As.UP:case As.DOWN:if(!o)return!1;!r||i||s||(this.onCtrlUpDownLeftRight(n,o),a=!0);break;case As.PAGE_DOWN:case As.PAGE_UP:r||i||(a=this.handlePageUpDown(n,o,t))}return a&&e.preventDefault(),a}handlePageUpDown(e,t,n){return n&&(t=this.focusService.getFocusedCell()),!!t&&(e===As.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0)}navigateTo(e){const{scrollIndex:t,scrollType:n,scrollColumn:i,focusIndex:r,focusColumn:s}=e;Dt(i)&&!i.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(i),Dt(t)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(t,n),e.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(r),this.focusService.setFocusedCell({rowIndex:r,column:s,rowPinned:null,forceBrowserFocus:!0}),this.rangeService?.setRangeToCell({rowIndex:r,rowPinned:null,column:s})}onPageDown(e){const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),n=this.getViewportHeight(),i=this.pageBoundsService.getPixelOffset(),r=t.top+n,s=this.rowModel.getRowIndexAtPixel(r+i);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,s):this.navigateToNextPage(e,s)}onPageUp(e){const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),n=this.pageBoundsService.getPixelOffset(),i=t.top,r=this.rowModel.getRowIndexAtPixel(i+n);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,r,!0):this.navigateToNextPage(e,r,!0)}navigateToNextPage(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.getViewportHeight(),r=this.pageBoundsService.getFirstRow(),s=this.pageBoundsService.getLastRow(),o=this.pageBoundsService.getPixelOffset(),a=this.rowModel.getRow(e.rowIndex),l=n?a?.rowHeight-i-o:i-o,c=a?.rowTop+l;let u,h=this.rowModel.getRowIndexAtPixel(c+o);if(h===e.rowIndex){const i=n?-1:1;t=h=e.rowIndex+i}n?(u="bottom",h<r&&(h=r),t<r&&(t=r)):(u="top",h>s&&(h=s),t>s&&(t=s)),this.isRowTallerThanView(h)&&(t=h,u="top"),this.navigateTo({scrollIndex:t,scrollType:u,scrollColumn:null,focusIndex:h,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.navigateTo({scrollIndex:t,scrollType:n?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout((()=>{const i=this.getNextFocusIndexForAutoHeight(e,n);this.navigateTo({scrollIndex:t,scrollType:n?"bottom":"top",scrollColumn:null,focusIndex:i,focusColumn:e.column,isAsync:!0})}),50)}getNextFocusIndexForAutoHeight(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?-1:1,n=this.getViewportHeight(),i=this.pageBoundsService.getLastRow();let r=0,s=e.rowIndex;for(;s>=0&&s<=i;){const e=this.rowModel.getRow(s);if(e){const t=e.rowHeight??0;if(r+t>n)break;r+=t}s+=t}return Math.max(0,Math.min(s,i))}getViewportHeight(){const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),t=this.scrollVisibleService.getScrollbarWidth();let n=e.bottom-e.top;return this.ctrlsService.get("center").isHorizontalScrollShowing()&&(n-=t),n}isRowTallerThanView(e){const t=this.rowModel.getRow(e);if(!t)return!1;const n=t.rowHeight;return"number"===typeof n&&n>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const n=this.cellNavigationService.getNextCellToFocus(e,t,!0),{rowIndex:i}=n,r=n.column;this.navigateTo({scrollIndex:i,scrollType:null,scrollColumn:r,focusIndex:i,focusColumn:r})}onHomeOrEndKey(e){const t=e===As.PAGE_HOME,n=this.visibleColsService.getAllCols(),i=t?n[0]:Rn(n),r=t?this.pageBoundsService.getFirstRow():this.pageBoundsService.getLastRow();this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:i,focusIndex:r,focusColumn:i})}onTabKeyDown(e,t){const n=t.shiftKey,i=this.tabToNextCellCommon(e,n,t);if(!1===i)if(n){const{rowIndex:n,rowPinned:i}=e.getRowPosition();(i?0===n:n===this.pageBoundsService.getFirstRow())&&(0===this.gos.get("headerHeight")||this.focusService.isHeaderFocusSuppressed()?this.focusService.focusNextGridCoreContainer(!0,!0):(t.preventDefault(),this.focusService.focusPreviousFromFirstCell(t)))}else e instanceof Ol&&e.focusCell(!0),(!n&&this.focusService.focusOverlay(!1)||this.focusService.focusNextGridCoreContainer(n))&&t.preventDefault();else i?t.preventDefault():null===i&&this.focusService.allowFocusForNextGridCoreContainer(n)}tabToNextCell(e,t){const n=this.focusService.getFocusedCell();if(!n)return!1;let i=this.getCellByPosition(n);return!!(i||(i=this.rowRenderer.getRowByPosition(n),i&&i.isFullWidth()))&&!!this.tabToNextCellCommon(i,e,t)}tabToNextCellCommon(e,t,n){let i,r=e.isEditing();if(!r&&e instanceof Ol){const t=e.getRowCtrl();t&&(r=t.isEditing())}return i=r?"fullRow"===this.gos.get("editType")?this.moveToNextEditingRow(e,t,n):this.moveToNextEditingCell(e,t,n):this.moveToNextCellNotEditing(e,t),null===i?i:i||!!this.focusService.getFocusedHeader()}moveToNextEditingCell(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=e.getCellPosition();e.getGui().focus(),e.stopEditing();const r=this.findNextCellToFocusOn(i,t,!0);return!1===r?null:null!=r&&(r.startEditing(null,!0,n),r.focusCell(!1),!0)}moveToNextEditingRow(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=e.getCellPosition(),r=this.findNextCellToFocusOn(i,t,!0);if(!1===r)return null;if(null==r)return!1;const s=r.getCellPosition(),o=this.isCellEditable(i),a=this.isCellEditable(s),l=s&&i.rowIndex===s.rowIndex&&i.rowPinned===s.rowPinned;if(o&&e.setFocusOutOnEditor(),!l){e.getRowCtrl().stopEditing();r.getRowCtrl().startRowEditing(void 0,void 0,n)}return a?(r.setFocusInOnEditor(),r.focusCell()):r.focusCell(!0),!0}moveToNextCellNotEditing(e,t){const n=this.visibleColsService.getAllCols();let i;i=e instanceof zl?{...e.getRowPosition(),column:t?n[0]:Rn(n)}:e.getCellPosition();const r=this.findNextCellToFocusOn(i,t,!1);if(!1===r)return null;if(r instanceof Ol)r.focusCell(!0);else if(r)return this.tryToFocusFullWidthRow(r.getRowPosition(),t);return Dt(r)}findNextCellToFocusOn(e,t,n){let i=e;for(;;){e!==i&&(e=i),t||(i=this.getLastCellOfColSpan(i)),i=this.cellNavigationService.getNextTabbedCell(i,t);const r=this.gos.getCallback("tabToNextCell");if(Dt(r)){const s=r({backwards:t,editing:n,previousCellPosition:e,nextCellPosition:i||null});if(!0===s||null===s)null===s&&bt("Returning `null` from tabToNextCell is deprecated. Return `true` to stay on the current cell, or `false` to let the browser handle the tab behaviour."),i=e;else{if(!1===s)return!1;i={rowIndex:s.rowIndex,column:s.column,rowPinned:s.rowPinned}}}if(!i)return null;if(i.rowIndex<0){const e=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:e+i.rowIndex,column:i.column},fromCell:!0}),null}const s="fullRow"===this.gos.get("editType");if(n&&!s){if(!this.isCellEditable(i))continue}this.ensureCellVisible(i);const o=this.getCellByPosition(i);if(!o){const e=this.rowRenderer.getRowByPosition(i);if(!e||!e.isFullWidth()||n)continue;return e}if(!o.isSuppressNavigable())return this.rangeService?.setRangeToCell(i),o}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return!!t&&e.column.isCellEditable(t)}getCellByPosition(e){const t=this.rowRenderer.getRowByPosition(e);return t?t.getCellCtrl(e.column):null}lookupRowNodeForCell(e){return"top"===e.rowPinned?this.pinnedRowModel.getPinnedTopRow(e.rowIndex):"bottom"===e.rowPinned?this.pinnedRowModel.getPinnedBottomRow(e.rowIndex):this.rowModel.getRow(e.rowIndex)}navigateToNextCell(e,t,n,i){let r=n,s=!1;for(;r&&(r===n||!this.isValidNavigateCell(r));)this.gos.get("enableRtl")?t===As.LEFT&&(r=this.getLastCellOfColSpan(r)):t===As.RIGHT&&(r=this.getLastCellOfColSpan(r)),r=this.cellNavigationService.getNextCellToFocus(t,r),s=Lt(r);if(s&&e&&e.key===As.UP&&(r={rowIndex:-1,rowPinned:null,column:n.column}),i){const i=this.gos.getCallback("navigateToNextCell");if(Dt(i)){const s=i({key:t,previousCellPosition:n,nextCellPosition:r||null,event:e});r=Dt(s)?{rowPinned:s.rowPinned,rowIndex:s.rowIndex,column:s.column}:null}}if(!r)return;if(r.rowIndex<0){const t=this.headerNavigationService.getHeaderRowCount();return void this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:t+r.rowIndex,column:n.column},event:e||void 0,fromCell:!0})}const o=this.getNormalisedPosition(r);o?this.focusPosition(o):this.tryToFocusFullWidthRow(r)}getNormalisedPosition(e){this.ensureCellVisible(e);const t=this.getCellByPosition(e);return t?(e=t.getCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){const n=this.visibleColsService.getAllCols(),i=this.rowRenderer.getRowByPosition(e);if(!i||!i.isFullWidth())return!1;const r=this.focusService.getFocusedCell(),s={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?Rn(n):n[0])};this.focusPosition(s);const o=null==t?null!=r&&this.rowPositionUtils.before(s,r):t;return this.eventService.dispatchEvent({type:"fullWidthRowFocused",rowIndex:s.rowIndex,rowPinned:s.rowPinned,column:s.column,isFullWidthCell:!0,fromBelow:o}),!0}focusPosition(e){this.focusService.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),this.rangeService?.setRangeToCell(e)}isValidNavigateCell(e){return!!this.rowPositionUtils.getRowNode(e)}getLastCellOfColSpan(e){const t=this.getCellByPosition(e);if(!t)return e;const n=t.getColSpanningList();return 1===n.length?e:{rowIndex:e.rowIndex,column:Rn(n),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=an(this.gos),n=this.rowModel.getRow(e.rowIndex);!(t&&n?.sticky)&&Lt(e.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(e.rowIndex),e.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(e.column)}},pc=class extends Vn{constructor(){super(...arguments),this.beanName="horizontalResizeService"}wireBeans(e){this.dragService=e.dragService,this.ctrlsService=e.ctrlsService}addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0};this.dragService.addDragSource(t);return()=>this.dragService.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const n=t instanceof MouseEvent&&!0===t.shiftKey;e.onResizeStart(n)}setResizeIcons(){const e=this.ctrlsService.get("gridCtrl");e.setResizeCursor(!0),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.ctrlsService.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}},gc=class extends Vn{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupService=e.popupService,this.focusService=e.focusService,this.ctrlsService=e.ctrlsService,this.menuService=e.menuService}hideActiveMenu(){this.hidePopup&&this.hidePopup()}showMenuAfterMouseEvent(e,t,n){this.showPopup(e,(i=>{this.popupService.positionPopupUnderMouseEvent({column:e,type:n,mouseEvent:t,ePopup:i})}),n,t.target,this.menuService.isLegacyMenuEnabled())}showMenuAfterButtonClick(e,t,n){let i=-1,r="left";const s=this.menuService.isLegacyMenuEnabled();!s&&this.gos.get("enableRtl")&&(i=1,r="right");const o=s?void 0:4*i,a=s?void 0:4;this.showPopup(e,(i=>{this.popupService.positionPopupByComponent({type:n,eventSource:t,ePopup:i,nudgeX:o,nudgeY:a,alignSide:r,keepWithinBounds:!0,position:"under",column:e})}),n,t,s)}showPopup(e,t,n,i,r){const s=e?this.createBean(new Io(e,"COLUMN_MENU")):void 0;if(this.activeMenu=s,!s?.hasFilter()||!e)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");const o=document.createElement("div");let a;pr(o,"presentation"),o.classList.add("ag-menu"),r||o.classList.add("ag-filter-menu"),[this.tabListener]=this.addManagedElementListeners(o,{keydown:e=>this.trapFocusWithin(e,o)}),o.appendChild(s?.getGui());const l=this.menuService.isColumnMenuAnchoringEnabled()?i??this.ctrlsService.getGridBodyCtrl().getGui():void 0,c=this.localeService.getLocaleTextFunc(),u=r&&"columnFilter"!==n?c("ariaLabelColumnMenu","Column Menu"):c("ariaLabelColumnFilter","Column Filter"),h=this.popupService.addPopup({modal:!0,eChild:o,closeOnEsc:!0,closedCallback:t=>{e.setMenuVisible(!1,"contextMenu");const r=t instanceof KeyboardEvent;if(this.tabListener&&(this.tabListener=this.tabListener()),r&&i&&es(i)){const e=this.focusService.findTabbableParent(i);e&&e.focus()}s?.afterGuiDetached(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,n,e)},positionCallback:()=>t(o),anchorToElement:l,ariaLabel:u});h&&(this.hidePopup=a=h.hideFunc),s.afterInit().then((()=>{t(o),s.afterGuiAttached({container:n,hidePopup:a})})),e.setMenuVisible(!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,n,e)}trapFocusWithin(e,t){e.key!==As.TAB||e.defaultPrevented||this.focusService.findNextFocusableElement(t,!1,e.shiftKey)||(e.preventDefault(),this.focusService.focusInto(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,n){this.eventService.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:n??null,columnGroup:null})}isMenuEnabled(e){return e.isFilterAllowed()&&(e.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},fc=class extends Vn{constructor(){super(...arguments),this.beanName="resizeObserverService"}observeResize(e,t){const n=tn(this.gos).ResizeObserver,i=n?new n(t):null;return i?.observe(e),()=>i?.disconnect()}},mc=class extends Vn{constructor(){super(...arguments),this.beanName="animationFrameService",this.createTasksP1={list:[],sorted:!1},this.createTasksP2={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastPage=0,this.lastScrollTop=0,this.taskCount=0,this.cancelledTasks=new Set}wireBeans(e){this.ctrlsService=e.ctrlsService,this.paginationService=e.paginationService}setScrollTop(e){const t=this.gos.get("pagination");if(this.scrollGoingDown=e>=this.lastScrollTop,t&&0===e){const e=this.paginationService?.getCurrentPage()??0;e!==this.lastPage&&(this.lastPage=e,this.scrollGoingDown=!0)}this.lastScrollTop=e}postConstruct(){this.useAnimationFrame=!this.gos.get("suppressAnimationFrame")}isOn(){return this.useAnimationFrame}verifyAnimationFrameOn(e){!1===this.useAnimationFrame&&bt(`AnimationFrameService.${e} called but animation frames are off`)}createTask(e,t,n){this.verifyAnimationFrameOn(n);const i={task:e,index:t,createOrder:++this.taskCount};this.addTaskToList(this[n],i),this.schedule()}cancelTask(e){this.cancelledTasks.add(e)}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const t=this.scrollGoingDown?1:-1;e.list.sort(((e,n)=>e.index!==n.index?t*(n.index-e.index):n.createOrder-e.createOrder)),e.sorted=!0}addDestroyTask(e){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(e),this.schedule()}executeFrame(e){this.verifyAnimationFrameOn("executeFrame");const t=this.createTasksP1,n=t.list,i=this.createTasksP2,r=i.list,s=this.destroyTasks,o=(new Date).getTime();let a=(new Date).getTime()-o;const l=e<=0,c=this.ctrlsService.getGridBodyCtrl();for(;l||a<e;){if(!c.getScrollFeature().scrollGridIfNeeded()){let e;if(n.length)this.sortTaskList(t),e=n.pop().task;else if(r.length)this.sortTaskList(i),e=r.pop().task;else{if(!s.length){this.cancelledTasks.clear();break}e=s.pop()}this.cancelledTasks.has(e)||e()}a=(new Date).getTime()-o}n.length||r.length||s.length?this.requestFrame():this.stopTicking()}stopTicking(){this.ticking=!1}flushAllFrames(){this.useAnimationFrame&&this.executeFrame(-1)}schedule(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const e=this.executeFrame.bind(this,60);this.requestAnimationFrame(e)}requestAnimationFrame(e){const t=tn(this.gos);t.requestAnimationFrame?t.requestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.setTimeout(e,0)}isQueueEmpty(){return!this.ticking}debounce(e){let t=!1;return()=>{this.isOn()?t||(t=!0,this.addDestroyTask((()=>{t=!1,e()}))):window.setTimeout(e,0)}}},vc=class extends Vn{constructor(){super(...arguments),this.beanName="expansionService"}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){this.isClientSideRowModel=Vt(this.gos)}expandRows(e){if(!this.isClientSideRowModel)return;const t=new Set(e);this.rowModel.forEachNode((e=>{e.id&&t.has(e.id)&&(e.expanded=!0)})),this.onGroupExpandedOrCollapsed()}getExpandedRows(){const e=[];return this.rowModel.forEachNode((t=>{let{expanded:n,id:i}=t;n&&i&&e.push(i)})),e}expandAll(e){this.isClientSideRowModel&&this.rowModel.expandOrCollapseAll(e)}setRowNodeExpanded(e,t,n,i){e&&(n&&e.parent&&-1!==e.parent.level&&this.setRowNodeExpanded(e.parent,t,n,i),e.setExpanded(t,void 0,i))}onGroupExpandedOrCollapsed(){this.isClientSideRowModel&&this.rowModel.refreshModel({step:"map"})}},yc=class extends Vn{constructor(){super(...arguments),this.beanName="menuService"}wireBeans(e){this.valueService=e.valueService,this.filterMenuFactory=e.filterMenuFactory,this.ctrlsService=e.ctrlsService,this.animationFrameService=e.animationFrameService,this.filterManager=e.filterManager,this.rowRenderer=e.rowRenderer,this.columnChooserFactory=e.columnChooserFactory,this.contextMenuFactory=e.contextMenuFactory,this.enterpriseMenuFactory=e.enterpriseMenuFactory}postConstruct(){this.activeMenuFactory=this.enterpriseMenuFactory??this.filterMenuFactory}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){const t=this.enterpriseMenuFactory&&this.isLegacyMenuEnabled()?this.enterpriseMenuFactory:this.filterMenuFactory;this.showColumnMenuCommon(t,e,e.containerType,!0)}showHeaderContextMenu(e,t,n){this.activeMenuFactory.showMenuAfterContextMenuEvent(e,t,n)}getContextMenuPosition(e,t){const n=this.getRowCtrl(e),i=this.getCellGui(n,t);if(!i)return n?{x:0,y:n.getRowYPosition()}:{x:0,y:0};const r=i.getBoundingClientRect();return{x:r.x+r.width/2,y:r.y+r.height/2}}showContextMenu(e){const t=e.rowNode,n=e.column;let{anchorToElement:i,value:r}=e;t&&n&&null==r&&(r=this.valueService.getValueForDisplay(n,t)),null==i&&(i=this.getContextMenuAnchorElement(t,n)),this.contextMenuFactory?.onContextMenu(e.mouseEvent??null,e.touchEvent??null,t??null,n??null,r,i)}showColumnChooser(e){this.columnChooserFactory?.showColumnChooser(e)}hidePopupMenu(){this.contextMenuFactory?.hideActiveMenu(),this.activeMenuFactory.hideActiveMenu()}hideColumnChooser(){this.columnChooserFactory?.hideActiveColumnChooser()}isColumnMenuInHeaderEnabled(e){const{suppressMenu:t,suppressHeaderMenuButton:n}=e.getColDef();return!(n??t)&&this.activeMenuFactory.isMenuEnabled(e)&&(this.isLegacyMenuEnabled()||!!this.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){return!e.getColDef().suppressHeaderFilterButton&&!!this.filterManager?.isFilterAllowed(e)}isHeaderContextMenuEnabled(e){const t=e&&pi(e)?e.getColDef():e?.getColGroupDef();return!t?.suppressHeaderContextMenu&&"new"===this.getColumnMenuType()}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const e=!this.isSuppressMenuHide();return!(Dr()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!this.isLegacyMenuEnabled()&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){return!!this.filterManager?.isFilterAllowed(e)&&!this.isLegacyMenuEnabled()&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isColumnMenuAnchoringEnabled(){return!this.isLegacyMenuEnabled()}areAdditionalColumnMenuItemsEnabled(){return"new"===this.getColumnMenuType()}isLegacyMenuEnabled(){return"legacy"===this.getColumnMenuType()}isFloatingFilterButtonEnabled(e){const t=e.getColDef(),n=t.floatingFilterComponentParams?.suppressFilterButton;return null!=n&&bt("As of v31.1, 'colDef.floatingFilterComponentParams.suppressFilterButton' is deprecated. Use 'colDef.suppressFloatingFilterButton' instead."),null==t.suppressFloatingFilterButton?!n:!t.suppressFloatingFilterButton}getColumnMenuType(){return this.gos.get("columnMenu")}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){const e=this.gos.get("suppressMenuHide");return this.isLegacyMenuEnabled()?!!this.gos.exists("suppressMenuHide")&&e:e}showColumnMenuCommon(e,t,n,i){const{positionBy:r}=t,s=t.column;if("button"===r){const{buttonElement:r}=t;e.showMenuAfterButtonClick(s,r,n,i)}else if("mouse"===r){const{mouseEvent:r}=t;e.showMenuAfterMouseEvent(s,r,n,i)}else s&&(this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(s,"auto"),this.animationFrameService.requestAnimationFrame((()=>{const t=this.ctrlsService.getHeaderRowContainerCtrl(s.getPinned())?.getHeaderCtrlForColumn(s);t&&e.showMenuAfterButtonClick(s,t.getAnchorElementForMenu(i),n,!0)})))}getRowCtrl(e){const{rowIndex:t,rowPinned:n}=e||{};if(null!=t)return this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:n})||void 0}getCellGui(e,t){if(!e||!t)return;const n=e.getCellCtrl(t);return n?.getGui()||void 0}getContextMenuAnchorElement(e,t){const n=this.ctrlsService.getGridBodyCtrl().getGridBodyElement(),i=this.getRowCtrl(e);if(!i)return n;const r=this.getCellGui(i,t);return r||(i.isFullWidth()?i.getFullWidthElement():n)}},Cc={selector:"AG-INPUT-TEXT-AREA",component:class extends Ls{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){const n=super.setValue(e,t);return this.eInput.value=e,n}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}}},wc=class extends Us{constructor(e){super('<div class="ag-popup-editor" tabindex="-1"/>'),this.params=e}postConstruct(){Qt(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){const e=this.getGui(),t=this.params;this.addManagedElementListeners(e,{keydown:e=>{ea(this.gos,e,t.node,t.column,!0)||t.onKeyDown(e)}})}},Sc=class extends Us{constructor(e){super(`\n            <div class="ag-cell-edit-wrapper">\n                ${e.getTemplate()}\n            </div>`,e.getAgComponents()),this.cellEditorInput=e,this.eInput=gs}init(e){this.params=e;const{cellStartedEdit:t,eventKey:n,suppressPreventDefault:i}=e,r=this.eInput;let s;this.cellEditorInput.init(r,e);let o=!0;t?(this.focusAfterAttached=!0,n===As.BACKSPACE||n===As.DELETE?s="":n&&1===n.length?i?o=!1:s=n:(s=this.cellEditorInput.getStartValue(),n!==As.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,s=this.cellEditorInput.getStartValue()),o&&null!=s&&r.setStartValue(s),this.addManagedElementListeners(r.getGui(),{keydown:e=>{const{key:t}=e;t!==As.PAGE_UP&&t!==As.PAGE_DOWN||e.preventDefault()}})}afterGuiAttached(){const e=this.localeService.getLocaleTextFunc(),t=this.eInput;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;Rr()||t.getFocusableElement().focus();const n=t.getInputElement();this.highlightAllOnFocus?n.select():this.cellEditorInput.setCaret?.()}focusIn(){const e=this.eInput,t=e.getFocusableElement(),n=e.getInputElement();t.focus(),n.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}},bc=class{getTemplate(){return'<ag-input-text-field class="ag-cell-editor" data-ref="eInput"></ag-input-text-field>'}getAgComponents(){return[na]}init(e,t){this.eInput=e,this.params=t,null!=t.maxLength&&e.setMaxLength(t.maxLength)}getValue(){const e=this.eInput.getValue();return Dt(e)||Dt(this.params.value)?this.params.parseValue(e):this.params.value}getStartValue(){return this.params.useFormatter||this.params.column.getColDef().refData?this.params.formatValue(this.params.value):this.params.value}setCaret(){const e=this.eInput.getValue(),t=Dt(e)&&e.length||0;t&&this.eInput.getInputElement().setSelectionRange(t,t)}},xc=class extends Sc{constructor(){super(new bc)}},_c=class{getTemplate(){return'<ag-input-number-field class="ag-cell-editor" data-ref="eInput"></ag-input-number-field>'}getAgComponents(){return[ra]}init(e,t){this.eInput=e,this.params=t,null!=t.max&&e.setMax(t.max),null!=t.min&&e.setMin(t.min),null!=t.precision&&e.setPrecision(t.precision),null!=t.step&&e.setStep(t.step);const n=e.getInputElement();t.preventStepping?e.addManagedElementListeners(n,{keydown:this.preventStepping}):t.showStepperButtons&&n.classList.add("ag-number-field-input-stepper")}preventStepping(e){e.key!==As.UP&&e.key!==As.DOWN||e.preventDefault()}getValue(){const e=this.eInput.getValue();if(!Dt(e)&&!Dt(this.params.value))return this.params.value;let t=this.params.parseValue(e);if(null==t)return t;if("string"===typeof t){if(""===t)return null;t=Number(t)}return isNaN(t)?null:t}getStartValue(){return this.params.value}setCaret(){Rr()&&this.eInput.getInputElement().focus({preventScroll:!0})}},Mc={selector:"AG-INPUT-DATE-FIELD",component:class extends ta{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct();const e=Rr();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||e||this.eInput.focus()}}),this.eInput.step="any"}onWheel(e){rn(this.gos)===this.eInput&&e.preventDefault()}setMin(e){const t=e instanceof Date?ma(e??null,!1)??void 0:e;return this.min===t||(this.min=t,as(this.eInput,"min",t)),this}setMax(e){const t=e instanceof Date?ma(e??null,!1)??void 0:e;return this.max===t||(this.max=t,as(this.eInput,"max",t)),this}setStep(e){return this.step===e||(this.step=e,as(this.eInput,"step",e)),this}getDate(){if(this.eInput.validity.valid)return Ca(this.getValue())??void 0}setDate(e,t){this.setValue(ma(e??null,!1),t)}}},Ec=class{getTemplate(){return'<ag-input-date-field class="ag-cell-editor" data-ref="eInput"></ag-input-date-field>'}getAgComponents(){return[Mc]}init(e,t){this.eInput=e,this.params=t,null!=t.min&&e.setMin(t.min),null!=t.max&&e.setMax(t.max),null!=t.step&&e.setStep(t.step)}getValue(){const e=this.eInput.getDate();return Dt(e)||Dt(this.params.value)?e??null:this.params.value}getStartValue(){const{value:e}=this.params;if(e instanceof Date)return ma(e,!1)}},Rc=class{constructor(e){this.getDataTypeService=e}getTemplate(){return'<ag-input-date-field class="ag-cell-editor" data-ref="eInput"></ag-input-date-field>'}getAgComponents(){return[Mc]}init(e,t){this.eInput=e,this.params=t,null!=t.min&&e.setMin(t.min),null!=t.max&&e.setMax(t.max),null!=t.step&&e.setStep(t.step)}getValue(){const e=this.formatDate(this.eInput.getDate());return Dt(e)||Dt(this.params.value)?this.params.parseValue(e??""):this.params.value}getStartValue(){return ma(this.parseDate(this.params.value??void 0)??null,!1)}parseDate(e){const t=this.getDataTypeService();return t?t.getDateParserFunction(this.params.column)(e):Ca(e)??void 0}formatDate(e){const t=this.getDataTypeService();return t?t.getDateFormatterFunction(this.params.column)(e):ma(e??null,!1)??void 0}},Tc=class{constructor(e){this.cellValueChanges=e}},Pc=class extends Tc{constructor(e,t,n,i){super(e),this.initialRange=t,this.finalRange=n,this.ranges=i}},Ac=class{constructor(e){this.actionStack=[],this.maxStackSize=e||10,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}};function Fc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"auto";e.frameworkOverrides.wrapIncoming((()=>e.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(t,n)),"ensureVisible")}function Dc(e,t,n){e.frameworkOverrides.wrapIncoming((()=>e.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureIndexVisible(t,n)),"ensureVisible")}var Lc={version:Da,moduleName:"@ag-grid-community/edit-core",beans:[class extends Vn{constructor(){super(...arguments),this.beanName="editService"}wireBeans(e){this.navigationService=e.navigationService,this.userComponentFactory=e.userComponentFactory,this.valueService=e.valueService}startEditing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=this.createCellEditorParams(e,t,n),s=e.getColumn().getColDef(),o=this.userComponentFactory.getCellEditorDetails(s,r),a=null!=o?.popupFromSelector?o.popupFromSelector:!!s.cellEditorPopup,l=null!=o?.popupPositionFromSelector?o.popupPositionFromSelector:s.cellEditorPopupPosition;return e.setEditing(!0,o),e.getComp().setEditDetails(o,a,l,this.gos.get("reactiveCustomComponents")),this.eventService.dispatchEvent(e.createEvent(i,"cellEditingStarted")),!o?.params?.suppressPreventDefault}stopEditing(e,t){const n=e.getComp(),{newValue:i,newValueExists:r}=this.takeValueFromCellEditor(t,n),s=e.getRowNode(),o=e.getColumn(),a=this.valueService.getValueForDisplay(o,s);let l=!1;return r&&(l=this.saveNewValue(e,a,i,s,o)),e.setEditing(!1,void 0),n.setEditDetails(),e.updateAndFormatValue(!1),e.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.eventService.dispatchEvent({...e.createEvent(null,"cellEditingStopped"),oldValue:a,newValue:i,valueChanged:l}),l}handleColDefChanged(e){const t=e.getCellEditor();if(t?.refresh){const{eventKey:n,cellStartedEdit:i}=e.getEditCompDetails().params,r=this.createCellEditorParams(e,n,i),s=e.getColumn().getColDef(),o=this.userComponentFactory.getCellEditorDetails(s,r);t.refresh(o.params)}}setFocusOutOnEditor(e){const t=e.getComp().getCellEditor();t&&t.focusOut&&t.focusOut()}setFocusInOnEditor(e){const t=e.getComp(),n=t.getCellEditor();n?.focusIn?n.focusIn():(e.focusCell(!0),e.onCellEditorAttached((()=>t.getCellEditor()?.focusIn?.())))}stopEditingAndFocus(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.stopRowOrCellEdit(),e.focusCell(!0),t||this.navigateAfterEdit(n,e.getCellPosition())}createPopupEditorWrapper(e){return new wc(e)}takeValueFromCellEditor(e,t){const n={newValueExists:!1};if(e)return n;const i=t.getCellEditor();if(!i)return n;if(i.isCancelAfterEnd&&i.isCancelAfterEnd())return n;return{newValue:i.getValue(),newValueExists:!0}}saveNewValue(e,t,n,i,r){if(n===t)return!1;e.setSuppressRefreshCell(!0);const s=i.setDataValue(r,n,"edit");return e.setSuppressRefreshCell(!1),s}createCellEditorParams(e,t,n){const i=e.getColumn(),r=e.getRowNode();return this.gos.addGridCommonParams({value:this.valueService.getValueForDisplay(i,r),eventKey:t,column:i,colDef:i.getColDef(),rowIndex:e.getCellPosition().rowIndex,node:r,data:r.data,cellStartedEdit:n,onKeyDown:e.onKeyDown.bind(e),stopEditing:e.stopEditingAndFocus.bind(e),eGridCell:e.getGui(),parseValue:t=>this.valueService.parseValue(i,r,t,e.getValue()),formatValue:e.formatValue.bind(e)})}navigateAfterEdit(e,t){if(this.gos.get("enterNavigatesVerticallyAfterEdit")){const n=e?As.UP:As.DOWN;this.navigationService.navigateToNextCell(null,n,t,!1)}}}]},Ic={version:Da,moduleName:"@ag-grid-community/edit-api",apiFunctions:{undoCellEditing:function(e){e.undoRedoService?.undo("api")},redoCellEditing:function(e){e.undoRedoService?.redo("api")},getCellEditorInstances:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.rowRenderer.getCellEditorInstances(t).map(vo)},getEditingCells:function(e){return e.rowRenderer.getEditingCells()},stopEditing:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.rowRenderer.stopEditing(t)},startEditingCell:function(e,t){const n=e.columnModel.getCol(t.colKey);if(!n)return void bt(`no column found for ${t.colKey}`);const i={rowIndex:t.rowIndex,rowPinned:t.rowPinned||null,column:n};null==t.rowPinned&&Dc(e,t.rowIndex),Fc(e,t.colKey);const r=e.navigationService.getCellByPosition(i);if(!r)return;const{focusService:s,gos:o}=e,a=o.get("stopEditingWhenCellsLoseFocus")&&(()=>{const e=rn(o),t=r.getGui();return e!==t&&!!t?.contains(e)})();!a&&s.isCellFocused(i)||s.setFocusedCell({...i,forceBrowserFocus:a,preventScrollOnBrowserFocus:!0}),r.startRowOrCellEdit(t.key)},getCurrentUndoSize:function(e){return e.undoRedoService?.getCurrentUndoStackSize()??0},getCurrentRedoSize:function(e){return e.undoRedoService?.getCurrentRedoStackSize()??0}},dependantModules:[Lc]},kc={version:Da,moduleName:"@ag-grid-community/default-editor",userComponents:[{name:"agCellEditor",classImp:xc}],dependantModules:[Lc]},Oc={version:Da,moduleName:"@ag-grid-community/editing",dependantModules:[Lc,{version:Da,moduleName:"@ag-grid-community/undo-redo-edit",beans:[class extends Vn{constructor(){super(...arguments),this.beanName="undoRedoService",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.onCellValueChanged=e=>{const t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},n=null!==this.activeCellEdit&&this.cellPositionUtils.equals(this.activeCellEdit,t),i=null!==this.activeRowEdit&&this.rowPositionUtils.sameRow(this.activeRowEdit,t);if(!(n||i||this.isPasting||this.isRangeInAction))return;const{rowPinned:r,rowIndex:s,column:o,oldValue:a,value:l}=e,c={rowPinned:r,rowIndex:s,columnId:o.getColId(),newValue:l,oldValue:a};this.cellValueChanges.push(c)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}wireBeans(e){this.focusService=e.focusService,this.ctrlsService=e.ctrlsService,this.cellPositionUtils=e.cellPositionUtils,this.rowPositionUtils=e.rowPositionUtils,this.columnModel=e.columnModel,this.rangeService=e.rangeService}postConstruct(){if(!this.gos.get("undoRedoCellEditing"))return;const e=this.gos.get("undoRedoCellEditingLimit");if(e<=0)return;this.undoStack=new Ac(e),this.redoStack=new Ac(e),this.addListeners();const t=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:e=>{e.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:t,newColumnsLoaded:t,columnGroupOpened:t,columnRowGroupChanged:t,columnMoved:t,columnPinned:t,columnVisible:t,rowDragEnd:t}),this.ctrlsService.whenReady(this,(e=>{this.gridBodyCtrl=e.gridBodyCtrl}))}getCurrentUndoStackSize(){return this.undoStack?this.undoStack.getCurrentStackSize():0}getCurrentRedoStackSize(){return this.redoStack?this.redoStack.getCurrentStackSize():0}undo(e){this.eventService.dispatchEvent({type:"undoStarted",source:e});const t=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo");this.eventService.dispatchEvent({type:"undoEnded",source:e,operationPerformed:t})}redo(e){this.eventService.dispatchEvent({type:"redoStarted",source:e});const t=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo");this.eventService.dispatchEvent({type:"redoEnded",source:e,operationPerformed:t})}undoRedo(e,t,n,i,r){if(!e)return!1;const s=e.pop();return!(!s||!s.cellValueChanges)&&(this.processAction(s,(e=>e[i]),r),s instanceof Pc?this.processRange(this.rangeService,s.ranges||[s[n]]):this.processCell(s.cellValueChanges),t.push(s),!0)}processAction(e,t,n){e.cellValueChanges.forEach((e=>{const{rowIndex:i,rowPinned:r,columnId:s}=e,o={rowIndex:i,rowPinned:r},a=this.rowPositionUtils.getRowNode(o);a.displayed&&a.setDataValue(s,t(e),n)}))}processRange(e,t){let n;e.removeAllCellRanges(!0),t.forEach(((i,r)=>{if(!i)return;const s=i.startRow,o=i.endRow;r===t.length-1&&(n={rowPinned:s.rowPinned,rowIndex:s.rowIndex,columnId:i.startColumn.getColId()},this.setLastFocusedCell(n));const a={rowStartIndex:s.rowIndex,rowStartPinned:s.rowPinned,rowEndIndex:o.rowIndex,rowEndPinned:o.rowPinned,columnStart:i.startColumn,columns:i.columns};e.addCellRange(a)}))}processCell(e){const t=e[0],{rowIndex:n,rowPinned:i}=t,r={rowIndex:n,rowPinned:i},s=this.rowPositionUtils.getRowNode(r),o={rowPinned:t.rowPinned,rowIndex:s.rowIndex,columnId:t.columnId};this.setLastFocusedCell(o,this.rangeService)}setLastFocusedCell(e,t){const{rowIndex:n,columnId:i,rowPinned:r}=e,s=this.gridBodyCtrl.getScrollFeature(),o=this.columnModel.getCol(i);if(!o)return;s.ensureIndexVisible(n),s.ensureColumnVisible(o);const a={rowIndex:n,column:o,rowPinned:r};this.focusService.setFocusedCell({...a,forceBrowserFocus:!0}),t?.setRangeToCell(a)}addListeners(){this.addManagedEventListeners({rowEditingStarted:e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}},rowEditingStopped:()=>{const e=new Tc(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null},cellEditingStarted:e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}},cellEditingStopped:e=>{this.activeCellEdit=null;if(e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const e=new Tc(this.cellValueChanges);this.pushActionsToUndoStack(e)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{const e=new Tc(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:e=>{const t=new Pc(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let e;e=this.rangeService&&vn(this.gos)?new Pc(this.cellValueChanges,void 0,void 0,[...this.rangeService.getCellRanges()]):new Tc(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1}})}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}}],dependantModules:[Lc]},{version:Da,moduleName:"@ag-grid-community/full-row-edit",beans:[class extends Vn{constructor(){super(...arguments),this.beanName="rowEditService"}startEditing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=!0;return e.getAllCellCtrls().reduce(((e,s)=>{const o=s===n;return o?r=s.startEditing(t,o,i):s.startEditing(null,o,i),!!e||s.isEditing()}),!1)&&this.setEditing(e,!0),r}stopEditing(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.getAllCellCtrls(),i=e.isEditing();e.setStoppingRowEdit(!0);let r=!1;for(const s of n){const e=s.stopEditing(t);i&&!t&&!r&&e&&(r=!0)}r&&this.eventService.dispatchEvent(e.createRowEvent("rowValueChanged")),i&&this.setEditing(e,!1),e.setStoppingRowEdit(!1)}setEditing(e,t){e.setEditingRow(t),e.forEachGui(void 0,(e=>e.rowComp.addOrRemoveCssClass("ag-row-editing",t)));const n=t?e.createRowEvent("rowEditingStarted"):e.createRowEvent("rowEditingStopped");this.eventService.dispatchEvent(n)}}],dependantModules:[Lc]},{version:Da,moduleName:"@ag-grid-community/all-editors",dependantModules:[kc,{version:Da,moduleName:"@ag-grid-community/data-type-editors",userComponents:[{name:"agTextCellEditor",classImp:xc},{name:"agNumberCellEditor",classImp:class extends Sc{constructor(){super(new _c)}},params:{suppressPreventDefault:!0}},{name:"agDateCellEditor",classImp:class extends Sc{constructor(){super(new Ec)}}},{name:"agDateStringCellEditor",classImp:class extends Sc{wireBeans(e){this.dataTypeService=e.dataTypeService}constructor(){super(new Rc((()=>this.dataTypeService)))}}},{name:"agCheckboxCellEditor",classImp:class extends Us{constructor(){super('\n            <div class="ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit">\n                <ag-checkbox role="presentation" data-ref="eCheckbox"></ag-checkbox>\n            </div>',[ks]),this.eCheckbox=gs}init(e){this.params=e;const t=e.value??void 0;this.eCheckbox.setValue(t);this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(t),this.addManagedListeners(this.eCheckbox,{fieldValueChanged:e=>this.setAriaLabel(e.selected)})}getValue(){return this.eCheckbox.getValue()}focusIn(){this.eCheckbox.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){const t=this.localeService.getLocaleTextFunc(),n=Er(t,e),i=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel(`${i} (${n})`)}}}],dependantModules:[kc]},{version:Da,moduleName:"@ag-grid-community/select-editor",userComponents:[{name:"agSelectCellEditor",classImp:class extends Us{constructor(){super('<div class="ag-cell-edit-wrapper">\n                <ag-select class="ag-cell-editor" data-ref="eSelect"></ag-select>\n            </div>',[$o]),this.eSelect=gs,this.startedByEnter=!1}wireBeans(e){this.valueService=e.valueService}init(e){this.focusAfterAttached=e.cellStartedEdit;const{eSelect:t,valueService:n,gos:i}=this,{values:r,value:s,eventKey:o}=e;if(Lt(r))return void bt("no values found for select cellEditor");this.startedByEnter=null!=o&&o===As.ENTER;let a=!1;r.forEach((i=>{const r={value:i},o=n.formatValue(e.column,null,i),l=null!==o&&void 0!==o;r.text=l?o:i,t.addOption(r),a=a||s===i})),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);const{valueListGap:l,valueListMaxWidth:c,valueListMaxHeight:u}=e;null!=l&&t.setPickerGap(l),null!=u&&t.setPickerMaxHeight(u),null!=c&&t.setPickerMaxWidth(c),"fullRow"!==i.get("editType")&&this.addManagedListeners(this.eSelect,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&setTimeout((()=>{this.isAlive()&&this.eSelect.showPicker()}))}focusIn(){this.eSelect.getFocusableElement().focus()}getValue(){return this.eSelect.getValue()}isPopup(){return!1}}}],dependantModules:[Lc]},{version:Da,moduleName:"@ag-grid-community/large-text-editor",userComponents:[{name:"agLargeTextCellEditor",classImp:class extends Us{constructor(){super('<div class="ag-large-text">\n        <ag-input-text-area data-ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>\n        </div>',[Cc]),this.eTextArea=gs}init(e){this.params=e,this.focusAfterAttached=e.cellStartedEdit,this.eTextArea.setMaxLength(e.maxLength||200).setCols(e.cols||60).setRows(e.rows||10),Dt(e.value,!0)&&this.eTextArea.setValue(e.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}onKeyDown(e){const t=e.key;(t===As.LEFT||t===As.UP||t===As.RIGHT||t===As.DOWN||e.shiftKey&&t===As.ENTER)&&e.stopPropagation()}afterGuiAttached(){const e=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(e("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()}getValue(){const e=this.eTextArea.getValue();return Dt(e)||Dt(this.params.value)?this.params.parseValue(e):this.params.value}}}],dependantModules:[Lc]}]},Ic]},Nc=class extends Vn{constructor(){super(...arguments),this.beanName="autoWidthCalculator"}wireBeans(e){this.rowRenderer=e.rowRenderer,this.ctrlsService=e.ctrlsService}postConstruct(){this.ctrlsService.whenReady(this,(e=>{this.centerRowContainerCtrl=e.center}))}getPreferredWidthForColumn(e,t){const n=this.getHeaderCellForColumn(e);if(!n)return-1;const i=this.rowRenderer.getAllCellsForColumn(e);return t||i.push(n),this.addElementsToContainerAndGetWidth(i)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.addElementsToContainerAndGetWidth([t]):-1}addElementsToContainerAndGetWidth(e){const t=document.createElement("form");t.style.position="fixed";const n=this.centerRowContainerCtrl.getContainerElement();e.forEach((e=>this.cloneItemIntoDummy(e,t))),n.appendChild(t);const i=t.offsetWidth;n.removeChild(t);return i+this.getAutoSizePadding()}getAutoSizePadding(){return this.gos.get("autoSizePadding")}getHeaderCellForColumn(e){let t=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach((n=>{const i=n.getHtmlElementForColumnHeader(e);null!=i&&(t=i)})),t}cloneItemIntoDummy(e,t){const n=e.cloneNode(!0);n.style.width="",n.style.position="static",n.style.left="";const i=document.createElement("div"),r=i.classList;["ag-header-cell","ag-header-group-cell"].some((e=>n.classList.contains(e)))?(r.add("ag-header","ag-header-row"),i.style.position="static"):r.add("ag-row");let s=e.parentElement;for(;s;){if(["ag-header-row","ag-row"].some((e=>s.classList.contains(e)))){for(let e=0;e<s.classList.length;e++){const t=s.classList[e];"ag-row-position-absolute"!=t&&r.add(t)}break}s=s.parentElement}i.appendChild(n),t.appendChild(i)}},Bc=class extends Vn{constructor(e,t){super(),this.createRowCon=e,this.destroyRowCtrls=t,this.stickyTopRowCtrls=[],this.stickyBottomRowCtrls=[],this.extraTopHeight=0,this.extraBottomHeight=0}wireBeans(e){this.rowModel=e.rowModel,this.rowRenderer=e.rowRenderer,this.ctrlsService=e.ctrlsService,this.pageBoundsService=e.pageBoundsService}postConstruct(){this.isClientSide=Vt(this.gos),this.ctrlsService.whenReady(this,(e=>{this.gridBodyCtrl=e.gridBodyCtrl})),this.resetStickyContainers()}getStickyTopRowCtrls(){return this.stickyTopRowCtrls}getStickyBottomRowCtrls(){return this.stickyBottomRowCtrls}setOffsetTop(e){this.extraTopHeight!==e&&(this.extraTopHeight=e,this.eventService.dispatchEvent({type:"stickyTopOffsetChanged",offset:e}))}setOffsetBottom(e){this.extraBottomHeight!==e&&(this.extraBottomHeight=e)}resetOffsets(){this.setOffsetBottom(0),this.setOffsetTop(0)}getExtraTopHeight(){return this.extraTopHeight}getExtraBottomHeight(){return this.extraBottomHeight}getLastPixelOfGroup(e){return this.isClientSide?this.getClientSideLastPixelOfGroup(e):this.getServerSideLastPixelOfGroup(e)}getFirstPixelOfGroup(e){return e.footer?e.sibling.rowTop+e.sibling.rowHeight-1:e.hasChildren()?e.rowTop-1:0}getServerSideLastPixelOfGroup(e){if(this.isClientSide)throw new Error("This func should only be called in server side row model.");if(e.isExpandable()||e.footer){if(e.master)return e.detailNode.rowTop+e.detailNode.rowHeight;if(!e.sibling||1===Math.abs(e.sibling.rowIndex-e.rowIndex)){let t=e.childStore?.getStoreBounds();return e.footer&&(t=e.sibling.childStore?.getStoreBounds()),(t?.heightPx??0)+(t?.topPx??0)}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}getClientSideLastPixelOfGroup(e){if(!this.isClientSide)throw new Error("This func should only be called in client side row model.");if(e.isExpandable()||e.footer){if(e.footer&&0===e.rowIndex)return Number.MAX_SAFE_INTEGER;if(!e.sibling||1===Math.abs(e.sibling.rowIndex-e.rowIndex)){let t=e.footer?e.sibling:e;for(;t.isExpandable()&&t.expanded;)if(t.master)t=t.detailNode;else if(t.childrenAfterSort){if(0===t.childrenAfterSort.length)break;t=Rn(t.childrenAfterSort)}return t.rowTop+t.rowHeight}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}updateStickyRows(e){const t="top"===e;let n=0;if(!this.canRowsBeSticky())return this.refreshNodesAndContainerHeight(e,new Set,n);const i=t?this.rowRenderer.getFirstVisibleVerticalPixel()-this.extraTopHeight:this.rowRenderer.getLastVisibleVerticalPixel()-this.extraTopHeight,r=new Set,s=e=>{if(r.add(e),t){const t=this.getLastPixelOfGroup(e),r=i+n+e.rowHeight;e.stickyRowTop=t<r?n+(t-r):n}else{const t=this.getFirstPixelOfGroup(e),r=i-(n+e.rowHeight);e.stickyRowTop=t>r?n-(t-r):n}n=0,r.forEach((e=>{const t=e.stickyRowTop+e.rowHeight;n<t&&(n=t)}))},o=this.areFooterRowsStickySuppressed(),a=this.gos.get("suppressGroupRowsSticky"),l=t=>{if(!t.displayed)return!1;if(t.footer){if(!0===o)return!1;if("grand"===o&&-1===t.level)return!1;if("group"===o&&t.level>-1)return!1;const n=!!t.sibling.rowIndex&&t.sibling.rowIndex+1===t.rowIndex;if("bottom"===e&&n)return!1;return!r.has(t)}if(t.isExpandable()){if(!0===a)return!1;if("bottom"===e)return!1;return!r.has(t)&&t.expanded}return!1};for(let c=0;c<100;c++){let e=i+n;t||(e=i-n);const r=this.rowModel.getRowIndexAtPixel(e),o=this.rowModel.getRow(r);if(null==o)break;const a=this.getStickyAncestors(o).find((e=>(t?e.rowIndex<r:e.rowIndex>r)&&l(e)));if(a){s(a);continue}if(!(t?o.rowTop<e:o.rowTop+o.rowHeight>e)||!l(o))break;s(o)}return t||r.forEach((e=>{e.stickyRowTop=n-(e.stickyRowTop+e.rowHeight)})),this.refreshNodesAndContainerHeight(e,r,n)}areFooterRowsStickySuppressed(){const e=this.gos.get("suppressStickyTotalRow");if(!0===e)return!0;const t=!!this.gos.get("groupIncludeFooter")||"group"===e,n=!!this.gos.get("groupIncludeTotalFooter")||"grand"===e;return!(!t||!n)||(n?"grand":!!t&&"group")}canRowsBeSticky(){const e=an(this.gos),t=this.areFooterRowsStickySuppressed(),n=this.gos.get("suppressGroupRowsSticky");return e&&(!t||!n)}getStickyAncestors(e){const t=[];let n=e.footer?e.sibling:e.parent;for(;n;)n.sibling&&t.push(n.sibling),t.push(n),n=n.parent;return t.reverse()}checkStickyRows(){const e=this.updateStickyRows("top"),t=this.updateStickyRows("bottom");return e||t}destroyStickyCtrls(){this.resetStickyContainers()}resetStickyContainers(){this.refreshNodesAndContainerHeight("top",new Set,0),this.refreshNodesAndContainerHeight("bottom",new Set,0)}refreshStickyNode(e){const t=new Set;if(this.stickyTopRowCtrls.some((t=>t.getRowNode()===e))){for(let n=0;n<this.stickyTopRowCtrls.length;n++){const i=this.stickyTopRowCtrls[n].getRowNode();i!==e&&t.add(i)}this.refreshNodesAndContainerHeight("top",t,this.topContainerHeight)&&this.checkStickyRows()}else{for(let n=0;n<this.stickyBottomRowCtrls.length;n++){const i=this.stickyBottomRowCtrls[n].getRowNode();i!==e&&t.add(i)}this.refreshNodesAndContainerHeight("bottom",t,this.bottomContainerHeight)&&this.checkStickyRows()}}refreshNodesAndContainerHeight(e,t,n){const i="top"===e,r=i?this.stickyTopRowCtrls:this.stickyBottomRowCtrls,s={},o=[];for(let d=0;d<r.length;d++){const e=r[d].getRowNode();!t.has(e)?(s[e.id]=r[d],e.sticky=!1):o.push(r[d])}const a=new Set;for(let d=0;d<o.length;d++)a.add(o[d].getRowNode());const l=[];t.forEach((e=>{a.has(e)||(e.sticky=!0,l.push(this.createRowCon(e,!1,!1)))}));let c=!!l.length||o.length!==r.length;i?this.topContainerHeight!==n&&(this.topContainerHeight=n,this.gridBodyCtrl.setStickyTopHeight(n),c=!0):this.bottomContainerHeight!==n&&(this.bottomContainerHeight=n,this.gridBodyCtrl.setStickyBottomHeight(n),c=!0),this.destroyRowCtrls(s,!1);const u=[...o,...l];u.sort(((e,t)=>t.getRowNode().rowIndex-e.getRowNode().rowIndex)),i||u.reverse(),u.forEach((e=>e.setRowTop(e.getRowNode().stickyRowTop)));let h=0;return i?(t.forEach((e=>{e.rowIndex<this.pageBoundsService.getFirstRow()&&(h+=e.rowHeight)})),h>this.topContainerHeight&&(h=this.topContainerHeight),this.setOffsetTop(h)):(t.forEach((e=>{e.rowIndex>this.pageBoundsService.getLastRow()&&(h+=e.rowHeight)})),h>this.bottomContainerHeight&&(h=this.bottomContainerHeight),this.setOffsetBottom(h)),!!c&&(i?this.stickyTopRowCtrls=u:this.stickyBottomRowCtrls=u,!0)}ensureRowHeightsValid(){let e=!1;const t=t=>{const n=t.getRowNode();if(n.rowHeightEstimated){const t=$t(this.gos,n);n.setRowHeight(t.height),e=!0}};return this.stickyTopRowCtrls.forEach(t),this.stickyBottomRowCtrls.forEach(t),e}},zc=class extends Vn{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const e=()=>{this.getAllCellCtrls().forEach((e=>e.onCellSelectionChanged()))},t=()=>{this.getAllCellCtrls().forEach((e=>e.updateRangeBordersIfRangeCount()))},n=()=>{this.eventService.addEventListener("cellSelectionChanged",e),this.eventService.addEventListener("columnMoved",t),this.eventService.addEventListener("columnPinned",t),this.eventService.addEventListener("columnVisible",t)},i=()=>{this.eventService.removeEventListener("cellSelectionChanged",e),this.eventService.removeEventListener("columnMoved",t),this.eventService.removeEventListener("columnPinned",t),this.eventService.removeEventListener("columnVisible",t)};this.addDestroyFunc((()=>i())),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],(()=>{vn(this.gos)?n():i()}));vn(this.gos)&&n()}}wireBeans(e){this.animationFrameService=e.animationFrameService,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusService=e.focusService,this.beans=e,this.rowContainerHeightService=e.rowContainerHeightService,this.ctrlsService=e.ctrlsService,this.environment=e.environment}postConstruct(){this.ctrlsService.whenReady(this,(e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()}))}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],(()=>this.onDomLayoutChanged())),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],(()=>this.redraw())),this.addManagedPropertyListener("suppressCellFocus",(e=>this.onSuppressCellFocusChanged(e.currentValue))),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection","rowSelection"],(()=>this.redrawRows())),an(this.gos)&&(Vt(this.gos)||Wt(this.gos))&&(this.stickyRowFeature=this.createManagedBean(new Bc(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this)))),this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=jt(this.gos,"print"),this.embedFullWidthRows=this.printLayout||this.gos.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const e=this.getKeepDetailRowsCount(),t=null!=e?e:3;this.cachedRowCtrls=new Hc(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyTopRowCtrls():[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyBottomRowCtrls():[]}updateAllRowCtrls(){const e=oi(this.rowCtrlsByRowIndex),t=oi(this.zombieRowCtrls),n=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];t.length>0||n.length>0?this.allRowCtrls=[...e,...t,...n]:this.allRowCtrls=e}onCellFocusChanged(e){this.getAllCellCtrls().forEach((t=>t.onCellFocused(e))),this.getFullWidthRowCtrls().forEach((t=>t.onFullWidthRowFocused(e)))}onSuppressCellFocusChanged(e){this.getAllCellCtrls().forEach((t=>t.onSuppressCellFocusChanged(e))),this.getFullWidthRowCtrls().forEach((t=>t.onSuppressCellFocusChanged(e)))}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>{this.onCellFocusChanged(e)},cellFocusCleared:()=>this.onCellFocusChanged(),flashCells:e=>{this.getAllCellCtrls().forEach((t=>t.onFlashCells(e)))},columnHoverChanged:()=>{this.getAllCellCtrls().forEach((e=>e.onColumnHover()))},displayedColumnsChanged:()=>{this.getAllCellCtrls().forEach((e=>e.onDisplayedColumnsChanged()))},displayedColumnsWidthChanged:()=>{this.printLayout&&this.getAllCellCtrls().forEach((e=>e.onLeftChanged()))}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){this.destroyFuncsForColumnListeners.forEach((e=>e())),this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();this.columnModel.getCols().forEach((e=>{const t=t=>{this.getAllCellCtrls().forEach((n=>{n.getColumn()===e&&t(n)}))},n=()=>{t((e=>e.onLeftChanged()))},i=()=>{t((e=>e.onWidthChanged()))},r=()=>{t((e=>e.onFirstRightPinnedChanged()))},s=()=>{t((e=>e.onLastLeftPinnedChanged()))},o=()=>{t((e=>e.onColDefChanged()))};e.addEventListener("leftChanged",n),e.addEventListener("widthChanged",i),e.addEventListener("firstRightPinnedChanged",r),e.addEventListener("lastLeftPinnedChanged",s),e.addEventListener("colDefChanged",o),this.destroyFuncsForColumnListeners.push((()=>{e.removeEventListener("leftChanged",n),e.removeEventListener("widthChanged",i),e.removeEventListener("firstRightPinnedChanged",r),e.removeEventListener("lastLeftPinnedChanged",s),e.removeEventListener("colDefChanged",o)}))}))}onDomLayoutChanged(){const e=jt(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),n=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,n&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){const t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsForColumn(e){const t=[];return this.getAllRowCtrls().forEach((n=>{const i=n.getCellElement(e);i&&t.push(i)})),t}refreshFloatingRowComps(){this.refreshFloatingRows(this.topRowCtrls,"top"),this.refreshFloatingRows(this.bottomRowCtrls,"bottom")}getTopRowCtrls(){return this.topRowCtrls}getCentreRowCtrls(){return this.allRowCtrls}getBottomRowCtrls(){return this.bottomRowCtrls}refreshFloatingRows(e,t){const{pinnedRowModel:n,beans:i,printLayout:r}=this,s=Object.fromEntries(e.map((e=>[e.getRowNode().id,e])));n.forEachPinnedRow(t,((o,a)=>{const l=e[a];l&&void 0===n.getPinnedRowById(l.getRowNode().id,t)&&(l.destroyFirstPass(),l.destroySecondPass()),o.id in s?(e[a]=s[o.id],delete s[o.id]):e[a]=new zl(o,i,!1,!1,r)}));const o="top"===t?n.getPinnedTopRowCount():n.getPinnedBottomRowCount();e.length=o}onPinnedRowDataChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.sticky)this.stickyRowFeature.refreshStickyNode(e);else{if(this.cachedRowCtrls?.has(e))return void this.cachedRowCtrls.removeRow(e);{const t=t=>{const n=t[e.rowIndex];n&&n.getRowNode()===e&&(n.destroyFirstPass(),n.destroySecondPass(),t[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":t(this.topRowCtrls);break;case"bottom":t(this.bottomRowCtrls);break;default:t(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){if(null!=e)return e?.forEach((e=>this.redrawRow(e,!0))),void this.dispatchDisplayedRowsChanged(!1);this.redrawAfterModelUpdate()}getCellToRestoreFocusToAfterRefresh(e){const t=e?.suppressKeepFocus?null:this.focusService.getFocusCellToUseAfterRefresh();if(null==t)return null;const n=rn(this.gos),i=Jt(this.gos,n,Ol.DOM_DATA_KEY_CELL_CTRL),r=Jt(this.gos,n,zl.DOM_DATA_KEY_ROW_CTRL);return i||r?t:null}redrawAfterModelUpdate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.getLockOnRefresh();const t=this.getCellToRestoreFocusToAfterRefresh(e);this.updateContainerHeights(),this.scrollToTopIfNewData(e);const n=!e.domLayoutChanged&&!!e.recycleRows,i=e.animate&&on(this.gos),r=n?this.getRowsToRecycle():null;if(n||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature){this.stickyRowFeature.checkStickyRows();const e=this.stickyRowFeature.getExtraTopHeight()+this.stickyRowFeature.getExtraBottomHeight();e&&this.updateContainerHeights(e)}this.recycleRows(r,i),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),null!=t&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){const t=e.newData||e.newPage,n=this.gos.get("suppressScrollOnNewData");t&&!n&&(this.gridBodyCtrl.getScrollFeature().scrollToTop(),this.stickyRowFeature?.resetOffsets())}updateContainerHeights(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.printLayout)return void this.rowContainerHeightService.setModelHeight(null);let t=this.pageBoundsService.getCurrentPageHeight();0===t&&(t=1),this.rowContainerHeightService.setModelHeight(t+e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0,this.frameworkOverrides.getLockOnRefresh?.()}releaseLockOnRefresh(){this.refreshInProgress=!1,this.frameworkOverrides.releaseLockOnRefresh?.()}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){e&&this.focusService.restoreFocusedCell(e,(()=>{this.onCellFocusChanged(this.gos.addGridCommonParams({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"}))}))}stopEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.getAllRowCtrls().forEach((t=>{t.stopEditing(e)}))}getAllCellCtrls(){const e=[],t=this.getAllRowCtrls(),n=t.length;for(let i=0;i<n;i++){const n=t[i].getAllCellCtrls(),r=n.length;for(let t=0;t<r;t++)e.push(n[t])}return e}getAllRowCtrls(){const e=this.stickyRowFeature&&this.stickyRowFeature.getStickyTopRowCtrls()||[],t=this.stickyRowFeature&&this.stickyRowFeature.getStickyBottomRowCtrls()||[],n=[...this.topRowCtrls,...this.bottomRowCtrls,...e,...t];for(const i in this.rowCtrlsByRowIndex)n.push(this.rowCtrlsByRowIndex[i]);return n}addRenderedRowListener(e,t,n){const i=this.rowCtrlsByRowIndex[t];i&&i.addEventListener(e,n)}flashCells(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.getCellCtrls(e.rowNodes,e.columns).forEach((t=>t.flashCell(e)))}refreshCells(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={forceRefresh:e.force,newData:!1,suppressFlash:e.suppressFlash};for(const n of this.getCellCtrls(e.rowNodes,e.columns))n.refreshOrDestroyCell(t);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=null;this.stickyRowFeature&&Lr()&&(t=this.getCellToRestoreFocusToAfterRefresh()||null);for(const n of this.getRowCtrls(e)){if(!n.isFullWidth())continue;n.refreshFullWidth()||this.redrawRow(n.getRowNode(),!0)}this.dispatchDisplayedRowsChanged(!1),t&&this.restoreFocusedCell(t)}getCellRendererInstances(e){const t=this.getCellCtrls(e.rowNodes,e.columns).map((e=>e.getCellRenderer())).filter((e=>null!=e));if(e.columns?.length)return t;const n=[],i=this.mapRowNodes(e.rowNodes);return this.getAllRowCtrls().forEach((e=>{if(i&&!this.isRowInMap(e.getRowNode(),i))return;if(!e.isFullWidth())return;const t=e.getFullWidthCellRenderers();for(let i=0;i<t.length;i++){const e=t[i];null!=e&&n.push(e)}})),[...n,...t]}getCellEditorInstances(e){const t=[];return this.getCellCtrls(e.rowNodes,e.columns).forEach((e=>{const n=e.getCellEditor();n&&t.push(n)})),t}getEditingCells(){const e=[];return this.getAllCellCtrls().forEach((t=>{if(t.isEditing()){const n=t.getCellPosition();e.push(n)}})),e}mapRowNodes(e){if(!e)return;const t={top:{},bottom:{},normal:{}};return e.forEach((e=>{const n=e.id;switch(e.rowPinned){case"top":t.top[n]=e;break;case"bottom":t.bottom[n]=e;break;default:t.normal[n]=e}})),t}isRowInMap(e,t){const n=e.id;switch(e.rowPinned){case"top":return null!=t.top[n];case"bottom":return null!=t.bottom[n];default:return null!=t.normal[n]}}getRowCtrls(e){const t=this.mapRowNodes(e),n=this.getAllRowCtrls();return e&&t?n.filter((e=>{const n=e.getRowNode();return this.isRowInMap(n,t)})):n}getCellCtrls(e,t){let n;Dt(t)&&(n={},t.forEach((e=>{const t=this.columnModel.getCol(e);Dt(t)&&(n[t.getId()]=!0)})));const i=[];return this.getRowCtrls(e).forEach((e=>{e.getAllCellCtrls().forEach((e=>{const t=e.getColumn().getId();n&&!n[t]||i.push(e)}))})),i}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),this.stickyRowFeature&&this.stickyRowFeature.destroyStickyCtrls()}getRowsToRecycle(){const e=[];ii(this.rowCtrlsByRowIndex,((t,n)=>{null==n.getRowNode().id&&e.push(t)})),this.removeRowCtrls(e);const t={};return ii(this.rowCtrlsByRowIndex,((e,n)=>{const i=n.getRowNode();t[i.id]=n})),this.rowCtrlsByRowIndex={},t}removeRowCtrls(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.forEach((e=>{const n=this.rowCtrlsByRowIndex[e];n&&(n.destroyFirstPass(t),n.destroySecondPass()),delete this.rowCtrlsByRowIndex[e]}))}onBodyScroll(e){"vertical"===e.direction&&this.redraw({afterScroll:!0})}redraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{afterScroll:t}=e;let n;this.stickyRowFeature&&Lr()&&(n=this.getCellToRestoreFocusToAfterRefresh()||void 0);const i=this.firstRenderedRow,r=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let s=!1;if(this.stickyRowFeature){s=this.stickyRowFeature.checkStickyRows();const e=this.stickyRowFeature.getExtraTopHeight()+this.stickyRowFeature.getExtraBottomHeight();e&&this.updateContainerHeights(e)}const o=this.firstRenderedRow!==i||this.lastRenderedRow!==r;if((!t||s||o)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,t),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(t&&!s),null!=n)){const e=this.getCellToRestoreFocusToAfterRefresh();null!=n&&null==e&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(n))}}removeRowCompsNotToDraw(e,t){const n={};e.forEach((e=>n[e]=!0));const i=Object.keys(this.rowCtrlsByRowIndex).filter((e=>!n[e]));this.removeRowCtrls(i,t)}calculateIndexesToDraw(e){const t=function(e,t){const n=[];for(let i=e;i<=t;i++)n.push(i);return n}(this.firstRenderedRow,this.lastRenderedRow),n=(e,n)=>{const i=n.getRowNode().rowIndex;null!=i&&(i<this.firstRenderedRow||i>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(n)&&t.push(i)};ii(this.rowCtrlsByRowIndex,n),ii(e,n),t.sort(((e,t)=>e-t));const i=[];for(let r=0;r<t.length;r++){const e=t[r],n=this.rowModel.getRow(e);n&&!n.sticky&&i.push(e)}return i}recycleRows(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.calculateIndexesToDraw(e);(this.printLayout||n)&&(t=!1),this.removeRowCompsNotToDraw(i,!t);const r=[];if(i.forEach((i=>{const s=this.createOrUpdateRowCtrl(i,e,t,n);Dt(s)&&r.push(s)})),e){n&&!this.gos.get("suppressAnimationFrame")&&!this.printLayout?this.beans.animationFrameService.addDestroyTask((()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()})):this.destroyRowCtrls(e,t)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.eventService.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){const e=this.visibleColsService.isPinningLeft(),t=this.visibleColsService.isPinningRight();(this.pinningLeft!==e||t!==this.pinningRight)&&(this.pinningLeft=e,this.pinningRight=t,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const e=[];this.getFullWidthRowCtrls().forEach((t=>{const n=t.getRowNode().rowIndex;e.push(n.toString())})),this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){const t=this.mapRowNodes(e);return this.getAllRowCtrls().filter((e=>{if(!e.isFullWidth())return!1;const n=e.getRowNode();return!(null!=t&&!this.isRowInMap(n,t))}))}createOrUpdateRowCtrl(e,t,n,i){let r,s=this.rowCtrlsByRowIndex[e];s||(r=this.rowModel.getRow(e),Dt(r)&&Dt(t)&&t[r.id]&&r.alreadyRendered&&(s=t[r.id],t[r.id]=null));if(!s){if(r||(r=this.rowModel.getRow(e)),!Dt(r))return;s=this.createRowCon(r,n,i)}return r&&(r.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=s,s}destroyRowCtrls(e,t){const n=[];ii(e,((e,i)=>{if(i)if(this.cachedRowCtrls&&i.isCacheable())this.cachedRowCtrls.addRow(i);else if(i.destroyFirstPass(!t),t){const e=i.instanceId;this.zombieRowCtrls[e]=i,n.push((()=>{i.destroySecondPass(),delete this.zombieRowCtrls[e]}))}else i.destroySecondPass()})),t&&(n.push((()=>{this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()})),Mt(n))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){return this.getRowBuffer()*Zt(this.gos)}workOutFirstAndLastRowsToRender(){let e,t;if(this.rowContainerHeightService.updateOffset(),this.rowModel.isRowsToRender())if(this.printLayout)this.environment.refreshRowHeightVariable(),e=this.pageBoundsService.getFirstRow(),t=this.pageBoundsService.getLastRow();else{const n=this.getRowBufferInPixels(),i=this.ctrlsService.getGridBodyCtrl(),r=this.gos.get("suppressRowVirtualisation");let s,o,a=!1;do{const e=this.pageBoundsService.getPixelOffset(),{pageFirstPixel:t,pageLastPixel:l}=this.pageBoundsService.getCurrentPagePixelRange(),c=this.rowContainerHeightService.getDivStretchOffset(),u=i.getScrollFeature().getVScrollPosition(),h=u.top,d=u.bottom;r?(s=t+c,o=l+c):(s=Math.max(h+e-n,t)+c,o=Math.min(d+e+n,l)+c),this.firstVisibleVPixel=Math.max(h+e,t)+c,this.lastVisibleVPixel=Math.min(d+e,l)+c,a=this.ensureAllRowsInRangeHaveHeightsCalculated(s,o)}while(a);let l=this.rowModel.getRowIndexAtPixel(s),c=this.rowModel.getRowIndexAtPixel(o);const u=this.pageBoundsService.getFirstRow(),h=this.pageBoundsService.getLastRow();l<u&&(l=u),c>h&&(c=h),e=l,t=c}else e=0,t=-1;const n=jt(this.gos,"normal"),i=this.gos.get("suppressMaxRenderedRowRestriction"),r=Math.max(this.getRowBuffer(),500);n&&!i&&t-e>r&&(t=e+r);const s=e!==this.firstRenderedRow,o=t!==this.lastRenderedRow;(s||o)&&(this.firstRenderedRow=e,this.lastRenderedRow=t,this.eventService.dispatchEvent({type:"viewportChanged",firstRow:e,lastRow:t}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,window.requestAnimationFrame((()=>{this.beans.eventService.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})})))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){const n=this.pinnedRowModel?.ensureRowHeightsValid(),i=this.stickyRowFeature?.ensureRowHeightsValid(),r=this.rowModel.ensureRowHeightsValid(e,t,this.pageBoundsService.getFirstRow(),this.pageBoundsService.getLastRow());return(r||i)&&this.eventService.dispatchEvent({type:"recalculateRowBounds"}),!!(i||r||n)&&(this.updateContainerHeights(),!0)}getFirstVisibleVerticalPixel(){return this.firstVisibleVPixel}getLastVisibleVerticalPixel(){return this.lastVisibleVPixel}getFirstVirtualRenderedRow(){return this.firstRenderedRow}getLastVirtualRenderedRow(){return this.lastRenderedRow}doNotUnVirtualiseRow(e){const t=!1,n=e.getRowNode(),i=this.focusService.isRowNodeFocused(n),r=e.isEditing(),s=n.detail;if(!(i||r||s))return t;return!!this.isRowPresent(n)||t}isRowPresent(e){return!!this.rowModel.isRowPresent(e)&&(!this.paginationService||this.paginationService.isRowPresent(e))}createRowCon(e,t,n){const i=this.cachedRowCtrls?this.cachedRowCtrls.getRow(e):null;if(i)return i;const r=this.gos.get("suppressAnimationFrame"),s=n&&!r&&!this.printLayout;return new zl(e,this.beans,t,s,this.printLayout)}getRenderedNodes(){const e=this.rowCtrlsByRowIndex;return Object.values(e).map((e=>e.getRowNode()))}getRowByPosition(e){let t;const{rowIndex:n}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[n];break;case"bottom":t=this.bottomRowCtrls[n];break;default:t=this.rowCtrlsByRowIndex[n],t||(t=this.getStickyTopRowCtrls().find((e=>e.getRowNode().rowIndex===n))||null,t||(t=this.getStickyBottomRowCtrls().find((e=>e.getRowNode().rowIndex===n))||null))}return t}isRangeInRenderedViewport(e,t){if(null==e||null==t)return!1;const n=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!n}},Hc=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.getRowNode().id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const e=this.entriesList[0];e.destroyFirstPass(),e.destroySecondPass(),this.removeFromCache(e)}}getRow(e){if(null==e||null==e.id)return null;const t=this.entriesMap[e.id];if(!t)return null;this.removeFromCache(t),t.setCached(!1);return t.getRowNode()!=e?null:t}has(e){return null!=this.entriesMap[e.id]}removeRow(e){const t=e.id,n=this.entriesMap[t];delete this.entriesMap[t],An(this.entriesList,n)}removeFromCache(e){const t=e.getRowNode().id;delete this.entriesMap[t],An(this.entriesList,e)}getEntries(){return this.entriesList}},Gc=class extends Vn{constructor(){super(...arguments),this.beanName="pinnedRowModel",this.nextId=0,this.pinnedTopRows=new Uc,this.pinnedBottomRows=new Uc}wireBeans(e){this.beans=e}postConstruct(){this.setPinnedRowData(this.gos.get("pinnedTopRowData"),"top"),this.setPinnedRowData(this.gos.get("pinnedBottomRowData"),"bottom"),this.addManagedPropertyListener("pinnedTopRowData",(e=>this.setPinnedRowData(e.currentValue,"top"))),this.addManagedPropertyListener("pinnedBottomRowData",(e=>this.setPinnedRowData(e.currentValue,"bottom"))),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this)})}isEmpty(e){return("top"===e?this.pinnedTopRows:this.pinnedBottomRows).isEmpty()}isRowsToRender(e){return!this.isEmpty(e)}onGridStylesChanges(e){if(e.rowHeightChanged){const e=e=>{e.setRowHeight(e.rowHeight,!0)};this.pinnedBottomRows.forEach(e),this.pinnedTopRows.forEach(e)}}ensureRowHeightsValid(){let e=!1,t=0;const n=n=>{if(n.rowHeightEstimated){const i=$t(this.gos,n);n.setRowTop(t),n.setRowHeight(i.height),t+=i.height,e=!0}};return this.pinnedBottomRows?.forEach(n),t=0,this.pinnedTopRows?.forEach(n),this.eventService.dispatchEvent({type:"pinnedHeightChanged"}),e}setPinnedRowData(e,t){this.updateNodesFromRowData(e,t),this.eventService.dispatchEvent({type:"pinnedRowDataChanged"})}updateNodesFromRowData(e,t){const n="top"===t?this.pinnedTopRows:this.pinnedBottomRows;if(void 0===e)return void n.clear();const i=gn(this.gos),r="top"===t?Lo.ID_PREFIX_TOP_PINNED:Lo.ID_PREFIX_BOTTOM_PINNED,s=n.getIds(),o=[],a=new Set;let l=0,c=-1;for(const u of e){const e=i?.({data:u,level:0,rowPinned:t})??r+this.nextId++;if(a.has(e)){bt("Duplicate ID",e,"found for pinned row with data",u,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter.");continue}c++,a.add(e),o.push(e);const h=n.getById(e);if(void 0!==h)h.data!==u&&h.setData(u),l+=this.setRowTopAndRowIndex(h,l,c),s.delete(e);else{const i=new Lo(this.beans);i.id=e,i.data=u,i.rowPinned=t,l+=this.setRowTopAndRowIndex(i,l,c),n.push(i)}}s.forEach((e=>{n.getById(e)?.clearRowTopAndRowIndex()})),n.removeAllById(s),n.setOrder(o)}setRowTopAndRowIndex(e,t,n){return e.setRowTop(t),e.setRowHeight($t(this.gos,e).height),e.setRowIndex(n),e.rowHeight}getPinnedTopTotalHeight(){return this.getTotalHeight(this.pinnedTopRows)}getPinnedBottomTotalHeight(){return this.getTotalHeight(this.pinnedBottomRows)}getPinnedTopRowCount(){return this.pinnedTopRows.getSize()}getPinnedBottomRowCount(){return this.pinnedBottomRows.getSize()}getPinnedTopRow(e){return this.pinnedTopRows.getByIndex(e)}getPinnedBottomRow(e){return this.pinnedBottomRows.getByIndex(e)}getPinnedRowById(e,t){return"top"===t?this.pinnedTopRows.getById(e):this.pinnedBottomRows.getById(e)}forEachPinnedRow(e,t){return"top"===e?this.pinnedTopRows.forEach(t):this.pinnedBottomRows.forEach(t)}getTotalHeight(e){const t=e.getSize();if(0===t)return 0;const n=e.getByIndex(t-1);return void 0===n?0:n.rowTop+n.rowHeight}},Uc=class{constructor(){this.cache={},this.ordering=[]}getById(e){return this.cache[e]}getByIndex(e){const t=this.ordering[e];return this.cache[t]}push(e){this.cache[e.id]=e,this.ordering.push(e.id)}removeAllById(e){for(const t of e)delete this.cache[t];this.ordering=this.ordering.filter((t=>!e.has(t)))}setOrder(e){this.ordering=e}forEach(e){this.ordering.forEach(((t,n)=>{const i=this.cache[t];i&&e(i,n)}))}clear(){this.ordering.length=0,this.cache={}}isEmpty(){return 0===this.ordering.length}getSize(){return this.ordering.length}getIds(){return new Set(this.ordering)}},Vc=class extends Vn{constructor(e){super(),this.state="needsLoading",this.version=0,this.id=e}getId(){return this.id}load(){this.state="loading",this.loadFromDatasource()}getVersion(){return this.version}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}getState(){return this.state}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state="failed",this.processServerFail()),this.dispatchLoadCompleted(!1)}success(e,t){this.successCommon(e,t)}pageLoaded(e,t,n){this.successCommon(e,{rowData:t,rowCount:n})}isRequestMostRecentAndLive(e){const t=e===this.version,n=this.isAlive();return t&&n}successCommon(e,t){this.dispatchLoadCompleted();this.isRequestMostRecentAndLive(e)&&(this.state="loaded",this.processServerResult(t))}dispatchLoadCompleted(){const e={type:"loadComplete",success:!(arguments.length>0&&void 0!==arguments[0])||arguments[0],block:this};this.dispatchLocalEvent(e)}},Wc={version:Da,moduleName:"@ag-grid-community/row-node-block",beans:[class extends Vn{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();const e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=Pt(this.performCheckBlocksToLoad.bind(this),e))}getMaxConcurrentDatasourceRequests(){const e=this.gos.get("maxConcurrentDatasourceRequests");return null==e?2:e<=0?void 0:e}addBlock(e){this.blocks.push(e),e.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){An(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchLocalEvent({type:"blockLoaded"}),0==this.activeBlockLoadsCount&&this.dispatchLocalEvent({type:"blockLoaderFinished"})}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),null!=this.maxConcurrentRequests&&this.activeBlockLoadsCount>=this.maxConcurrentRequests)return void(this.gos.get("debug")&&St("RowNodeBlockLoader - checkBlockToLoad: max loads exceeded"));const e=this.getAvailableLoadingCount(),t=this.blocks.filter((e=>"needsLoading"===e.getState())).slice(0,e);this.registerLoads(t.length),t.forEach((e=>e.load())),this.printCacheStatus()}getBlockState(){if(Wt(this.gos)){return this.rowModel.getBlockStates()}const e={};return this.blocks.forEach((t=>{const{id:n,state:i}=t.getBlockStateJson();e[n]=i})),e}printCacheStatus(){this.gos.get("debug")&&St(`RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}isLoading(){return this.activeBlockLoadsCount>0}registerLoads(e){this.activeBlockLoadsCount+=e}getAvailableLoadingCount(){return void 0!==this.maxConcurrentRequests?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0}}]},jc=class{constructor(){this.root=null,this.end=null,this.cachedRange=[]}init(e){this.rowModel=e}reset(){this.root=null,this.end=null,this.cachedRange.length=0}setRoot(e){this.root=e,this.end=null,this.cachedRange.length=0}setEndRange(e){this.end=e,this.cachedRange.length=0}getRange(){if(0===this.cachedRange.length){const e=this.getRoot(),t=this.getEnd();if(null==e||null==t)return this.cachedRange;this.cachedRange=this.rowModel.getNodesInRangeForSelection(e,t)}return this.cachedRange}isInRange(e){return null!==this.root&&this.getRange().some((t=>t.id===e.id))}getRoot(){return this.root&&null===this.root?.key&&(this.root=this.rowModel.getRowNode(this.root.id)??null),this.root}getEnd(){return this.end&&null===this.end?.key&&(this.end=this.rowModel.getRowNode(this.end.id)??null),this.end}truncate(e){const t=this.getRange();if(0===t.length)return{keep:[],discard:[]};const n=t[0].id===this.root.id,i=t.findIndex((t=>t.id===e.id));if(i>-1){const r=t.slice(0,i),s=t.slice(i+1);return this.setEndRange(e),n?{keep:r,discard:s}:{keep:s,discard:r}}return{keep:t,discard:[]}}extend(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.getRoot();if(null==n){const n=this.getRange().slice();return t&&e.depthFirstSearch((e=>!e.group&&n.push(e))),n.push(e),this.setRoot(e),{keep:n,discard:[]}}if(this.rowModel.getNodesInRangeForSelection(n,e).find((e=>e.id===this.end?.id)))return this.setEndRange(e),{keep:this.getRange(),discard:[]};{const t=this.getRange().slice();return this.setEndRange(e),{keep:this.getRange(),discard:t}}}},qc=class extends Vn{constructor(){super(...arguments),this.beanName="stylingService"}wireBeans(e){this.expressionService=e.expressionService}processAllCellClasses(e,t,n,i){this.processClassRules(void 0,e.cellClassRules,t,n,i),this.processStaticCellClasses(e,t,n)}processClassRules(e,t,n,i,r){if(null==t&&null==e)return;const s={},o={},a=(e,t)=>{e.split(" ").forEach((e=>{""!=e.trim()&&t(e)}))};if(t){const e=Object.keys(t);for(let i=0;i<e.length;i++){const r=e[i],l=t[r];let c;"string"===typeof l?c=this.expressionService.evaluate(l,n):"function"===typeof l&&(c=l(n)),a(r,(e=>{c?s[e]=!0:o[e]=!0}))}}e&&r&&Object.keys(e).forEach((e=>a(e,(e=>{s[e]||(o[e]=!0)})))),r&&Object.keys(o).forEach(r),Object.keys(s).forEach(i)}getStaticCellClasses(e,t){const{cellClass:n}=e;if(!n)return[];let i;if("function"===typeof n){i=n(t)}else i=n;return"string"===typeof i&&(i=[i]),i||[]}processStaticCellClasses(e,t,n){this.getStaticCellClasses(e,t).forEach((e=>{n(e)}))}},Xc=(e=>(e.TAB_GUARD="ag-tab-guard",e.TAB_GUARD_TOP="ag-tab-guard-top",e.TAB_GUARD_BOTTOM="ag-tab-guard-bottom",e))(Xc||{}),Kc=class extends Vn{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;const{comp:t,eTopGuard:n,eBottomGuard:i,focusTrapActive:r,forceFocusOutWhenTabGuardsAreEmpty:s,isFocusableContainer:o,focusInnerElement:a,onFocusIn:l,onFocusOut:c,shouldStopEventPropagation:u,onTabKeyDown:h,handleKeyDown:d,eFocusableElement:p}=e;this.comp=t,this.eTopGuard=n,this.eBottomGuard=i,this.providedFocusInnerElement=a,this.eFocusableElement=p,this.focusTrapActive=!!r,this.forceFocusOutWhenTabGuardsAreEmpty=!!s,this.isFocusableContainer=!!o,this.providedFocusIn=l,this.providedFocusOut=c,this.providedShouldStopEventPropagation=u,this.providedOnTabKeyDown=h,this.providedHandleKeyDown=d}wireBeans(e){this.focusService=e.focusService}postConstruct(){this.createManagedBean(new Ho(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach((e=>this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)})))}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return!!this.providedShouldStopEventPropagation&&this.providedShouldStopEventPropagation()}activateTabGuards(){if(this.forcingFocusOut)return;const e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus)return void this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);if(this.skipTabGuardFocus)return void(this.skipTabGuardFocus=!1);if(this.forceFocusOutWhenTabGuardsAreEmpty){if(0===this.focusService.findFocusableElements(this.eFocusableElement,".ag-tab-guard").length)return void this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;const t=e.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t)}findNextElementOutsideAndFocus(e){const t=en(this.gos),n=this.focusService.findFocusableElements(t.body,null,!0),i=n.indexOf(e?this.eTopGuard:this.eBottomGuard);if(-1===i)return;let r,s;e?(r=0,s=i):(r=i+1,s=n.length);const o=n.slice(r,s),a=this.gos.get("tabIndex");o.sort(((e,t)=>{const n=parseInt(e.getAttribute("tabindex")||"0"),i=parseInt(t.getAttribute("tabindex")||"0");return i===a?1:n===a?-1:0===n?1:0===i?-1:n-i})),o[e?o.length-1:0]?.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown)return void this.providedOnTabKeyDown(e);if(this.focusTrapActive)return;if(e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const n=this.getNextFocusableElement(e.shiftKey);t&&setTimeout((()=>this.activateTabGuards()),0),n&&(n.focus(),e.preventDefault())}focusInnerElement(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length&&t[e?t.length-1:0].focus({preventScroll:!0})}getNextFocusableElement(e){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e)}forceFocusOutOfContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.forcingFocusOut)return;const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout((()=>{this.forcingFocusOut=!1,this.activateTabGuards()}))}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t??!0)}setAllowFocus(e){this.allowFocus=e}},$c=class extends Vn{constructor(e){super(),this.comp=e}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();const{eTopGuard:t,eBottomGuard:n,eFocusableElement:i}=this,r=[t,n],s={setTabIndex:e=>{r.forEach((t=>null!=e?t.setAttribute("tabindex",e):t.removeAttribute("tabindex")))}};this.addTabGuards(t,n);const{focusTrapActive:o=!1,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:u,onTabKeyDown:h,shouldStopEventPropagation:d,forceFocusOutWhenTabGuardsAreEmpty:p,isFocusableContainer:g}=e;this.tabGuardCtrl=this.createManagedBean(new Kc({comp:s,focusTrapActive:o,eTopGuard:t,eBottomGuard:n,eFocusableElement:i,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:u,onTabKeyDown:h,shouldStopEventPropagation:d,forceFocusOutWhenTabGuardsAreEmpty:p,isFocusableContainer:g}))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){const t=en(this.gos).createElement("div"),n="top"===e?"ag-tab-guard-top":"ag-tab-guard-bottom";return t.classList.add("ag-tab-guard",n),pr(t,"presentation"),t}addTabGuards(e,t){this.eFocusableElement.insertAdjacentElement("afterbegin",e),this.eFocusableElement.insertAdjacentElement("beforeend",t)}removeAllChildrenExceptTabGuards(){const e=[this.eTopGuard,this.eBottomGuard];Yr(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,n){os(t)||(t=t.getGui());const{eBottomGuard:i}=this;i?i.insertAdjacentElement("beforebegin",t):e(t,n)}},Zc=class extends fs{initialiseTabGuard(e){this.tabGuardFeature=this.createManagedBean(new $c(this)),this.tabGuardFeature.initialiseTabGuard(e)}forceFocusOutOfContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.tabGuardFeature.forceFocusOutOfContainer(e)}appendChild(e,t){this.tabGuardFeature.appendChild(super.appendChild.bind(this),e,t)}},Yc=0,Jc=class extends Vn{constructor(){super(...arguments),this.beanName="popupService",this.popupList=[]}wireBeans(e){this.ctrlsService=e.ctrlsService,this.resizeObserverService=e.resizeObserverService,this.environment=e.environment}postConstruct(){this.ctrlsService.whenReady(this,(e=>{this.gridCtrl=e.gridCtrl})),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)})}getPopupParent(){const e=this.gos.get("popupParent");return e||this.gridCtrl.getGui()}positionPopupForMenu(e){const{eventSource:t,ePopup:n}=e,i=this.getPopupIndex(n);if(-1!==i){this.popupList[i].alignedToElement=t}const r=t.getBoundingClientRect(),s=this.getParentRect(),o=this.keepXYWithinBounds(n,r.top-s.top,0),a=n.clientWidth>0?n.clientWidth:200;n.style.minWidth=`${a}px`;const l=s.right-s.left-a;let c;function u(){return r.right-s.left-2}function h(){return r.left-s.left-a}this.gos.get("enableRtl")?(c=h(),c<0&&(c=u(),this.setAlignedStyles(n,"left")),c>l&&(c=0,this.setAlignedStyles(n,"right"))):(c=u(),c>l&&(c=h(),this.setAlignedStyles(n,"right")),c<0&&(c=0,this.setAlignedStyles(n,"left"))),n.style.left=`${c}px`,n.style.top=`${o}px`}positionPopupUnderMouseEvent(e){const{ePopup:t,nudgeX:n,nudgeY:i,skipObserver:r}=e;this.positionPopup({ePopup:t,nudgeX:n,nudgeY:i,keepWithinBounds:!0,skipObserver:r,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e.type,e.ePopup,null,e.mouseEvent,e.column,e.rowNode)})}calculatePointerAlign(e){const t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){const{ePopup:t,nudgeX:n,nudgeY:i,keepWithinBounds:r,eventSource:s,alignSide:o="left",position:a="over",column:l,rowNode:c,type:u}=e,h=s.getBoundingClientRect(),d=this.getParentRect(),p=this.getPopupIndex(t);if(-1!==p){this.popupList[p].alignedToElement=s}this.positionPopup({ePopup:t,nudgeX:n,nudgeY:i,keepWithinBounds:r,updatePosition:()=>{let n,r=h.left-d.left;if("right"===o&&(r-=t.offsetWidth-h.width),"over"===a)n=h.top-d.top,this.setAlignedStyles(t,"over");else{this.setAlignedStyles(t,"under");n="under"===this.shouldRenderUnderOrAbove(t,h,d,e.nudgeY||0)?h.top-d.top+h.height:h.top-t.offsetHeight-2*(i||0)-d.top}return{x:r,y:n}},postProcessCallback:()=>this.callPostProcessPopup(u,t,s,null,l,c)})}shouldRenderUnderOrAbove(e,t,n,i){const r=n.bottom-t.bottom,s=t.top-n.top,o=e.offsetHeight+i;return r>o?"under":s>o||s>r?"above":"under"}setAlignedStyles(e,t){const n=this.getPopupIndex(e);if(-1===n)return;const i=this.popupList[n],{alignedToElement:r}=i;if(!r)return;["right","left","over","above","under"].forEach((t=>{r.classList.remove(`ag-has-popup-positioned-${t}`),e.classList.remove(`ag-popup-positioned-${t}`)})),t&&(r.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}callPostProcessPopup(e,t,n,i,r,s){const o=this.gos.getCallback("postProcessPopup");if(o){o({column:r,rowNode:s,ePopup:t,type:e,eventSource:n,mouseEvent:i})}}positionPopup(e){var t=this;const{ePopup:n,keepWithinBounds:i,nudgeX:r,nudgeY:s,skipObserver:o,updatePosition:a}=e,l={width:0,height:0},c=function(){let o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{x:c,y:u}=a();o&&n.clientWidth===l.width&&n.clientHeight===l.height||(l.width=n.clientWidth,l.height=n.clientHeight,r&&(c+=r),s&&(u+=s),i&&(c=t.keepXYWithinBounds(n,c,1),u=t.keepXYWithinBounds(n,u,0)),n.style.left=`${c}px`,n.style.top=`${u}px`,e.postProcessCallback&&e.postProcessCallback())};if(c(),!o){const e=this.resizeObserverService.observeResize(n,(()=>c(!0)));setTimeout((()=>e()),200)}}getActivePopups(){return this.popupList.map((e=>e.element))}getPopupList(){return this.popupList}getParentRect(){const e=en(this.gos);let t=this.getPopupParent();return t===e.body?t=e.documentElement:"static"===getComputedStyle(t).position&&(t=t.offsetParent),Xr(t)}keepXYWithinBounds(e,t,n){const i=0===n,r=i?"clientHeight":"clientWidth",s=i?"top":"left",o=i?"height":"width",a=i?"scrollTop":"scrollLeft",l=en(this.gos),c=l.documentElement,u=this.getPopupParent(),h=e.getBoundingClientRect(),d=u.getBoundingClientRect(),p=l.documentElement.getBoundingClientRect(),g=u===l.body,f=Math.ceil(h[o]);let m=g?(i?jr:qr)(c)+c[a]:u[r];g&&(m-=Math.abs(p[s]-d[s]));const v=m-f;return Math.min(Math.max(t,0),Math.abs(v))}addPopup(e){const t=en(this.gos),{eChild:n,ariaLabel:i,alwaysOnTop:r,positionCallback:s,anchorToElement:o}=e;if(!t)return bt("could not find the document, document is empty"),{hideFunc:()=>{}};const a=this.getPopupIndex(n);if(-1!==a){return{hideFunc:this.popupList[a].hideFunc}}this.initialisePopupPosition(n);const l=this.createPopupWrapper(n,i,!!r),c=this.addEventListenersToPopup({...e,wrapperEl:l});return s&&s(),this.addPopupToPopupList(n,l,c,o),{hideFunc:c}}initialisePopupPosition(e){const t=this.getPopupParent().getBoundingClientRect();Dt(e.style.top)||(e.style.top=-1*t.top+"px"),Dt(e.style.left)||(e.style.left=-1*t.left+"px")}createPopupWrapper(e,t,n){const i=this.getPopupParent(),r=document.createElement("div");return this.environment.applyThemeClasses(r),r.classList.add("ag-popup"),e.classList.add(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||pr(e,"dialog"),gr(e,t),r.appendChild(e),i.appendChild(r),n?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),r}handleThemeChange(e){if(e.themeChanged)for(const t of this.popupList)this.environment.applyThemeClasses(t.wrapper)}addEventListenersToPopup(e){var t=this;const n=en(this.gos),i=this.getPopupParent(),{wrapperEl:r,eChild:s,closedCallback:o,afterGuiAttached:a,closeOnEsc:l,modal:c}=e;let u=!1;const h=e=>{if(!r.contains(rn(this.gos)))return;e.key!==As.ESCAPE||zn(e)||g({keyboardEvent:e})},d=e=>g({mouseEvent:e}),p=e=>g({touchEvent:e}),g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mouseEvent:a,touchEvent:l,keyboardEvent:c,forceHide:g}=e;(g||!t.isEventFromCurrentPopup({mouseEvent:a,touchEvent:l},s)&&!u)&&(u=!0,i.removeChild(r),n.removeEventListener("keydown",h),n.removeEventListener("mousedown",d),n.removeEventListener("touchstart",p),n.removeEventListener("contextmenu",d),t.eventService.removeEventListener("dragStarted",d),o&&o(a||l||c),t.removePopupFromPopupList(s))};return a&&a({hidePopup:g}),window.setTimeout((()=>{l&&n.addEventListener("keydown",h),c&&(n.addEventListener("mousedown",d),this.eventService.addEventListener("dragStarted",d),n.addEventListener("touchstart",p),n.addEventListener("contextmenu",d))}),0),g}addPopupToPopupList(e,t,n,i){this.popupList.push({element:e,wrapper:t,hideFunc:n,instanceId:Yc++,isAnchored:!!i}),i&&this.setPopupPositionRelatedToElement(e,i)}getPopupIndex(e){return this.popupList.findIndex((t=>t.element===e))}setPopupPositionRelatedToElement(e,t){const n=this.getPopupIndex(e);if(-1===n)return;const i=this.popupList[n];if(i.stopAnchoringPromise&&i.stopAnchoringPromise.then((e=>e&&e())),i.stopAnchoringPromise=void 0,i.isAnchored=!1,!t)return;const r=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:i.hideFunc});return i.stopAnchoringPromise=r,i.isAnchored=!0,r}removePopupFromPopupList(e){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),this.popupList=this.popupList.filter((t=>t.element!==e))}keepPopupPositionedRelativeTo(e){const t=this.getPopupParent(),n=t.getBoundingClientRect(),{element:i,ePopup:r}=e,s=i.getBoundingClientRect(),o=e=>parseInt(e.substring(0,e.length-1),10),a=(e,t)=>{const i=n[e]-s[e],a=o(r.style[e]);return{initialDiff:i,lastDiff:i,initial:a,last:a,direction:t}},l=a("top",0),c=a("left",1),u=this.getFrameworkOverrides();return new Xs((n=>{u.wrapIncoming((()=>{u.setInterval((()=>{const n=t.getBoundingClientRect(),s=i.getBoundingClientRect();if(0==s.top&&0==s.left&&0==s.height&&0==s.width)return void e.hidePopup();const a=(e,t)=>{const i=o(r.style[t]);e.last!==i&&(e.initial=i,e.last=i);const a=n[t]-s[t];if(a!=e.lastDiff){const n=this.keepXYWithinBounds(r,e.initial+e.initialDiff-a,e.direction);r.style[t]=`${n}px`,e.last=n}e.lastDiff=a};a(l,"top"),a(c,"left")}),200).then((e=>{n((()=>{null!=e&&window.clearInterval(e)}))}))}),"popupPositioning")}))}hasAnchoredPopup(){return this.popupList.some((e=>e.isAnchored))}isEventFromCurrentPopup(e,t){const{mouseEvent:n,touchEvent:i}=e,r=n||i;if(!r)return!1;const s=this.getPopupIndex(t);if(-1===s)return!1;for(let o=s;o<this.popupList.length;o++){if(Un(this.popupList[o].element,r))return!0}return this.isElementWithinCustomPopup(r.target)}isElementWithinCustomPopup(e){const t=en(this.gos);for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||null===e.parentElement)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){const n=this.getWrapper(e);n&&(n.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(n))}bringPopupToFront(e){const t=this.getPopupParent(),n=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),i=n.length,r=this.getWrapper(e);if(!r||i<=1||!t.contains(e))return;const s=[],o=[];for(const u of n)u!==r&&(u.classList.contains("ag-always-on-top")?o.push(u):s.push(u));const a=[],l=o.length,c=r.classList.contains("ag-always-on-top")||!l?[...s,...o,r]:[...s,r,...o];for(let u=0;u<=i;u++){const e=c[u];if(n[u]===c[u]||e===r)continue;e.querySelectorAll("div").forEach((e=>{0!==e.scrollTop&&a.push([e,e.scrollTop])})),0===u?t.insertAdjacentElement("afterbegin",e):c[u-1].insertAdjacentElement("afterend",e)}for(;a.length;){const e=a.pop();e[0].scrollTop=e[1]}}},Qc=["touchstart","touchend","touchmove","touchcancel"],eu=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"javascript";this.frameworkName=e,this.renderingEngine="vanilla",this.wrapIncoming=e=>e(),this.wrapOutgoing=e=>e()}setInterval(e,t){return new Xs((n=>{n(window.setInterval(e,t))}))}addEventListener(e,t,n,i){const r=Ln(Qc,t);e.addEventListener(t,n,{capture:!!i,passive:r})}get shouldWrapOutgoing(){return!1}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return`https://www.ag-grid.com/${"solid"===this.frameworkName?"react":this.frameworkName}-data-grid${e?`/${e}`:""}`}},tu=class extends Vn{constructor(){super(...arguments),this.beanName="cellNavigationService"}wireBeans(e){this.visibleColsService=e.visibleColsService,this.rowModel=e.rowModel,this.rowRenderer=e.rowRenderer,this.pinnedRowModel=e.pinnedRowModel,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService}getNextCellToFocus(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const n=e===As.UP,i=e===As.DOWN,r=e===As.LEFT;let s,o;if(n||i)o=n?this.pageBoundsService.getFirstRow():this.pageBoundsService.getLastRow(),s=t.column;else{const e=this.visibleColsService.getAllCols(),n=this.gos.get("enableRtl");o=t.rowIndex,s=r!==n?e[0]:Rn(e)}return{rowIndex:o,rowPinned:null,column:s}}getNextCellToFocusWithoutCtrlPressed(e,t){let n=t,i=!1;for(;!i;){switch(e){case As.UP:n=this.getCellAbove(n);break;case As.DOWN:n=this.getCellBelow(n);break;case As.RIGHT:n=this.gos.get("enableRtl")?this.getCellToLeft(n):this.getCellToRight(n);break;case As.LEFT:n=this.gos.get("enableRtl")?this.getCellToRight(n):this.getCellToLeft(n);break;default:n=null,bt("unknown key for navigation ",e)}i=!n||this.isCellGoodToFocusOn(n)}return n}isCellGoodToFocusOn(e){const t=e.column;let n;switch(e.rowPinned){case"top":n=this.pinnedRowModel.getPinnedTopRow(e.rowIndex);break;case"bottom":n=this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);break;default:n=this.rowModel.getRow(e.rowIndex)}if(!n)return!1;return!t.isSuppressNavigable(n)}getCellToLeft(e){if(!e)return null;const t=this.visibleColsService.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.visibleColsService.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getRowBelow(e){const t=e.rowIndex,n=e.rowPinned;let i=!1;if(this.isLastRowInContainer(e))switch(n){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.pageBoundsService.getFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}else n&&(i=!0);const r=this.rowModel.getRow(e.rowIndex),s=i?void 0:this.getNextStickyPosition(r);return s||{rowIndex:t+1,rowPinned:n}}getNextStickyPosition(e,t){if(!an(this.gos)||!e||!e.sticky)return;let n=[];n=this.rowRenderer.getStickyTopRowCtrls().some((t=>t.getRowNode().rowIndex===e.rowIndex))?[...this.rowRenderer.getStickyTopRowCtrls()].sort(((e,t)=>e.getRowNode().rowIndex-t.getRowNode().rowIndex)):[...this.rowRenderer.getStickyBottomRowCtrls()].sort(((e,t)=>t.getRowNode().rowIndex-e.getRowNode().rowIndex));const i=t?-1:1,r=n.findIndex((t=>t.getRowNode().rowIndex===e.rowIndex)),s=n[r+i];return s?{rowIndex:s.getRowNode().rowIndex,rowPinned:null}:void 0}getCellBelow(e){if(!e)return null;const t=this.getRowBelow(e);return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}isLastRowInContainer(e){const t=e.rowPinned,n=e.rowIndex;if("top"===t){return this.pinnedRowModel.getPinnedTopRowCount()-1<=n}if("bottom"===t){return this.pinnedRowModel.getPinnedBottomRowCount()-1<=n}return this.pageBoundsService.getLastRow()<=n}getRowAbove(e){const t=e.rowIndex,n=e.rowPinned;let i=!1;if(n?0===t:t===this.pageBoundsService.getFirstRow())return"top"===n?null:n&&this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;n&&(i=!0);const r=this.rowModel.getRow(e.rowIndex),s=i?void 0:this.getNextStickyPosition(r,!0);return s||{rowIndex:t-1,rowPinned:n}}getCellAbove(e){if(!e)return null;const t=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}getLastBodyCell(){return{rowIndex:this.pageBoundsService.getLastRow(),rowPinned:null}}getLastFloatingTopRow(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowCount()-1,rowPinned:"top"}}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){const t=this.visibleColsService.getAllCols();let n=e.rowIndex,i=e.rowPinned,r=this.visibleColsService.getColAfter(e.column);if(!r){r=t[0];const s=this.getRowBelow(e);if(Lt(s))return null;if(!s.rowPinned&&!(this.paginationService?.isRowInPage(s)??1))return null;n=s?s.rowIndex:null,i=s?s.rowPinned:null}return{rowIndex:n,column:r,rowPinned:i}}getNextTabbedCellBackwards(e){const t=this.visibleColsService.getAllCols();let n=e.rowIndex,i=e.rowPinned,r=this.visibleColsService.getColBefore(e.column);if(!r){r=Rn(t);const s=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});if(Lt(s))return null;if(!s.rowPinned&&!(this.paginationService?.isRowInPage(s)??1))return null;n=s?s.rowIndex:null,i=s?s.rowPinned:null}return{rowIndex:n,column:r,rowPinned:i}}},nu=(e,t)=>{for(const n in t)t[n]=e;return t},iu={...nu("@ag-grid-community/core",{dispatchEvent:0,destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0,getState:0,setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0,redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRow:0,getFirstDisplayedRowIndex:0,getLastDisplayedRow:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0,getModel:0,getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0,getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0,addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0,expireValueCache:0,getValue:0,getCellValue:0,showColumnMenuAfterButtonClick:0,showColumnMenuAfterMouseClick:0,showColumnMenu:0,hidePopupMenu:0,onSortChanged:0,getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0,showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0,setGridAriaProperty:0,refreshCells:0,flashCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0,addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0,getColumnDef:0,getColumnDefs:0,sizeColumnsToFit:0,setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumn:0,getDisplayNameForColumnGroup:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnVisible:0,setColumnsVisible:0,setColumnPinned:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0,moveColumn:0,moveColumnByIndex:0,moveColumns:0,setColumnWidth:0,setColumnWidths:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0,autoSizeColumn:0,autoSizeColumns:0,autoSizeAllColumns:0,undoCellEditing:0,redoCellEditing:0,getCellEditorInstances:0,getEditingCells:0,stopEditing:0,startEditingCell:0,getCurrentUndoSize:0,getCurrentRedoSize:0,isAnyFilterPresent:0,onFilterChanged:0,isColumnFilterPresent:0,getFilterInstance:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0,isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0,paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0,expandAll:0,collapseAll:0,onRowHeightChanged:0,setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0}),...nu("@ag-grid-community/client-side-row-model",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,resetRowHeights:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0}),...nu("@ag-grid-community/csv-export",{getDataAsCsv:0,exportDataAsCsv:0}),...nu("@ag-grid-community/infinite-row-model",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0}),...nu("@ag-grid-enterprise/advanced-filter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0}),...nu("@ag-grid-enterprise/charts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0}),...nu("@ag-grid-enterprise/clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0}),...nu("@ag-grid-enterprise/excel-export",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0}),...nu("@ag-grid-enterprise/master-detail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0}),...nu("@ag-grid-enterprise/menu",{showContextMenu:0,showColumnChooser:0,hideColumnChooser:0}),...nu("@ag-grid-enterprise/range-selection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0}),...nu("@ag-grid-enterprise/row-grouping",{addAggFunc:0,addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0,isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumn:0,removeValueColumns:0,addValueColumn:0,addValueColumns:0,setRowGroupColumns:0,removeRowGroupColumn:0,removeRowGroupColumns:0,addRowGroupColumn:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0,setPivotColumns:0,removePivotColumn:0,removePivotColumns:0,addPivotColumn:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0}),...nu("@ag-grid-enterprise/server-side-row-model",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0}),...nu("@ag-grid-enterprise/side-bar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0}),...nu("@ag-grid-enterprise/status-bar",{getStatusPanel:0})},ru={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},su=(e,t)=>e.eventService.dispatchEvent(t),ou=class{};Reflect.defineProperty(ou,"name",{value:"GridApi"});var au=class extends Vn{constructor(){super(),this.beanName="apiFunctionService",this.api=new ou,this.fns={...ru,dispatchEvent:su},this.beans=null,this.preDestroyLink="";const{api:e}=this;for(const t in iu)e[t]=this.makeApi(t)[t]}wireBeans(e){this.beans=e}postConstruct(){this.preDestroyLink=this.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){const{fns:n,beans:i}=this;n!==ru&&(n[e]=i?.validationService?.validateApiFunction(e,t)??t)}makeApi(e){var t=this;return{[e]:function(){const{beans:n,fns:{[e]:i}}=t;for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i?i(n,...s):t.apiNotFound(e)}}}apiNotFound(e){const{beans:t,gos:n,preDestroyLink:i}=this;if(t){const t=iu[e];n.assertModuleRegistered(t,`api.${e}`)&&bt(`API function '${e}' not registered to module '${t}'`)}else bt(`Grid API function ${e}() cannot be called as the grid has been destroyed.\nEither clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.\nTo run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${i}`)}destroy(){super.destroy(),this.fns=ru,this.beans=null}};function lu(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionService").api}}var cu=class extends Vn{constructor(){super(...arguments),this.beanName="columnDefFactory"}buildColumnDefs(e,t,n){const i=[],r={};return e.forEach((e=>{let s=!0,o=this.createDefFromColumn(e,t,n),a=e.getOriginalParent(),l=null;for(;a;){let e=null;if(a.isPadding()){a=a.getOriginalParent();continue}const t=r[a.getGroupId()];if(t){t.children.push(o),s=!1;break}if(e=this.createDefFromGroup(a),e&&(e.children=[o],r[e.groupId]=e,o=e,a=a.getOriginalParent()),null!=a&&l===a){s=!1;break}l=a}s&&i.push(o)})),i}createDefFromGroup(e){const t=si(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,n){const i=si(e.getColDef());return i.colId=e.getColId(),i.width=e.getActualWidth(),i.rowGroup=e.isRowGroupActive(),i.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,i.pivot=e.isPivotActive(),i.pivotIndex=e.isPivotActive()?n.indexOf(e):null,i.aggFunc=e.isValueActive()?e.getAggFunc():null,i.hide=!e.isVisible()||void 0,i.pinned=e.isPinned()?e.getPinned():null,i.sort=e.getSort()?e.getSort():null,i.sortIndex=null!=e.getSortIndex()?e.getSortIndex():null,i}},uu=class extends Vn{constructor(){super(...arguments),this.beanName="columnEventDispatcher"}visibleCols(e){this.eventService.dispatchEvent({type:"displayedColumnsChanged",source:e})}gridColumns(){this.eventService.dispatchEvent({type:"gridColumnsChanged"})}headerHeight(e){this.eventService.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"})}groupHeaderHeight(e){this.eventService.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}groupOpened(e){this.eventService.dispatchEvent({type:"columnGroupOpened",columnGroup:1===e.length?e[0]:void 0,columnGroups:e})}rowGroupChanged(e,t){this.eventService.dispatchEvent({type:"columnRowGroupChanged",columns:e,column:1===e.length?e[0]:null,source:t})}genericColumnEvent(e,t,n){this.eventService.dispatchEvent({type:e,columns:t,column:1===t.length?t[0]:null,source:n})}pivotModeChanged(){this.eventService.dispatchEvent({type:"columnPivotModeChanged"})}virtualColumnsChanged(e){this.eventService.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}newColumnsLoaded(e){this.eventService.dispatchEvent({type:"newColumnsLoaded",source:e})}everythingChanged(e){this.eventService.dispatchEvent({type:"columnEverythingChanged",source:e})}columnMoved(e){const{movedColumns:t,source:n,toIndex:i,finished:r}=e;this.eventService.dispatchEvent({type:"columnMoved",columns:t,column:t&&1===t.length?t[0]:null,toIndex:i,finished:r,source:n})}columnPinned(e,t){if(!e.length)return;const n=1===e.length?e[0]:null,i=this.getCommonValue(e,(e=>e.getPinned()));this.eventService.dispatchEvent({type:"columnPinned",pinned:null!=i?i:null,columns:e,column:n,source:t})}columnVisible(e,t){if(!e.length)return;const n=1===e.length?e[0]:null,i=this.getCommonValue(e,(e=>e.isVisible()));this.eventService.dispatchEvent({type:"columnVisible",visible:i,columns:e,column:n,source:t})}getCommonValue(e,t){if(!e||0==e.length)return;const n=t(e[0]);for(let i=1;i<e.length;i++)if(n!==t(e[i]))return;return n}columnChanged(e,t,n){this.eventService.dispatchEvent({type:e,columns:t,column:t&&1==t.length?t[0]:null,source:n})}columnResized(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e&&e.length&&this.eventService.dispatchEvent({type:"columnResized",columns:e,column:1===e.length?e[0]:null,flexColumns:i,finished:t,source:n})}},hu=class extends Vn{constructor(){super(...arguments),this.beanName="columnGetStateService"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService}getColumnState(){if(Lt(this.columnModel.getColDefCols())||!this.columnModel.isAlive())return[];const e=this.columnModel.getAllCols().map((e=>this.createStateItemFromColumn(e)));return this.orderColumnStateList(e),e}createStateItemFromColumn(e){const t=this.funcColsService.getRowGroupColumns(),n=this.funcColsService.getPivotColumns(),i=e.isRowGroupActive()?t.indexOf(e):null,r=e.isPivotActive()?n.indexOf(e):null,s=e.isValueActive()?e.getAggFunc():null,o=null!=e.getSort()?e.getSort():null,a=null!=e.getSortIndex()?e.getSortIndex():null,l=null!=e.getFlex()&&e.getFlex()>0?e.getFlex():null;return{colId:e.getColId(),width:e.getActualWidth(),hide:!e.isVisible(),pinned:e.getPinned(),sort:o,sortIndex:a,aggFunc:s,rowGroup:e.isRowGroupActive(),rowGroupIndex:i,pivot:e.isPivotActive(),pivotIndex:r,flex:l}}orderColumnStateList(e){const t=this.columnModel.getCols(),n=new Map(t.map(((e,t)=>[e.getColId(),t])));e.sort(((e,t)=>(n.has(e.colId)?n.get(e.colId):-1)-(n.has(t.colId)?n.get(t.colId):-1)))}},du=class extends Vn{constructor(){super(...arguments),this.beanName="columnGroupStateService"}wireBeans(e){this.columnModel=e.columnModel,this.columnAnimationService=e.columnAnimationService,this.eventDispatcher=e.columnEventDispatcher,this.visibleColsService=e.visibleColsService}getColumnGroupState(){const e=[];return yi(null,this.columnModel.getColTree(),(t=>{Wn(t)&&e.push({groupId:t.getGroupId(),open:t.isExpanded()})})),e}resetColumnGroupState(e){const t=this.columnModel.getColDefColTree();if(!t)return;const n=[];yi(null,t,(e=>{if(Wn(e)){const t=e.getColGroupDef(),i={groupId:e.getGroupId(),open:t?t.openByDefault:void 0};n.push(i)}})),this.setColumnGroupState(n,e)}setColumnGroupState(e,t){if(!this.columnModel.getColTree())return;this.columnAnimationService.start();const n=[];e.forEach((e=>{const t=e.groupId,i=e.open,r=this.columnModel.getProvidedColGroup(t);r&&r.isExpanded()!==i&&(r.setExpanded(i),n.push(r))})),this.visibleColsService.refresh(t,!0),n.length&&this.eventDispatcher.groupOpened(n),this.columnAnimationService.finish()}},pu=class extends Vn{constructor(){super(...arguments),this.beanName="columnViewportService",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={}}wireBeans(e){this.visibleColsService=e.visibleColsService,this.columnModel=e.columnModel,this.eventDispatcher=e.columnEventDispatcher}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.visibleColsService.isBodyWidthDirty();if(!(e===this.scrollWidth&&t===this.scrollPosition&&!i)){if(this.scrollWidth=e,this.scrollPosition=t,this.visibleColsService.setBodyWidthDirty(),this.gos.get("enableRtl")){const e=this.visibleColsService.getBodyContainerWidth();this.viewportLeft=e-this.scrollPosition-this.scrollWidth,this.viewportRight=e-this.scrollPosition}else this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition;this.columnModel.isReady()&&this.checkViewportColumns(n)}}getHeadersToRender(e,t){let n;switch(e){case"left":n=this.rowsOfHeadersToRenderLeft[t];break;case"right":n=this.rowsOfHeadersToRenderRight[t];break;default:n=this.rowsOfHeadersToRenderCenter[t]}return n||[]}extractViewportColumns(){const e=this.visibleColsService.getCenterCols();this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||0===this.viewportRight}clear(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.colsWithinViewportHash=""}isColumnInHeaderViewport(e){return!(!e.isAutoHeaderHeight()&&!this.isAnyParentAutoHeaderHeight(e))||this.isColumnInRowViewport(e)}isAnyParentAutoHeaderHeight(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,n=t+e.getActualWidth(),i=this.viewportLeft-200,r=this.viewportRight+200;return!(t<i&&n<i)&&!(t>r&&n>r)}getViewportColumns(){const e=this.visibleColsService.getLeftCols(),t=this.visibleColsService.getRightCols();return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.columnModel.isColSpanActive())return this.colsWithinViewport;const t=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),n=this.visibleColsService.getColsCenter();return this.visibleColsService.getColsForRow(e,n,t,(e=>{const t=e.getLeft();return Dt(t)&&t>this.viewportLeft}))}checkViewportColumns(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.extractViewport()&&this.eventDispatcher.virtualColumnsChanged(e)}calculateHeaderRows(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={};const e={},t=this.visibleColsService.getLeftCols(),n=this.visibleColsService.getRightCols();this.headerColsWithinViewport.concat(t).concat(n).forEach((t=>e[t.getId()]=!0));const i=(t,n,r)=>{let s=!1;for(let o=0;o<t.length;o++){const a=t[o];let l=!1;if(pi(a))l=!0===e[a.getId()];else{const e=a.getDisplayedChildren();e&&(l=i(e,n,r+1))}l&&(s=!0,n[r]||(n[r]=[]),n[r].push(a))}return s};i(this.visibleColsService.getTreeLeft(),this.rowsOfHeadersToRenderLeft,0),i(this.visibleColsService.getTreeRight(),this.rowsOfHeadersToRenderRight,0),i(this.visibleColsService.getTreeCenter(),this.rowsOfHeadersToRenderCenter,0)}extractViewport(){this.extractViewportColumns();const e=this.getViewportColumns().map((e=>`${e.getId()}-${e.getPinned()||"normal"}`)).join("#"),t=this.colsWithinViewportHash!==e;return t&&(this.colsWithinViewportHash=e,this.calculateHeaderRows()),t}},gu=class extends Vn{constructor(){super(...arguments),this.beanName="agComponentUtils"}wireBeans(e){this.componentMetadataProvider=e.componentMetadataProvider}adaptFunction(e,t){const n=this.componentMetadataProvider.retrieve(e);return n&&n.functionAdapter?n.functionAdapter(t):null}adaptCellRendererFunction(e){return class{refresh(){return!1}getGui(){return this.eGui}init(t){const n=e(t),i=typeof n;this.eGui="string"!==i&&"number"!==i&&"boolean"!==i?null!=n?n:ts("<span></span>"):ts("<span>"+n+"</span>")}}}doesImplementIComponent(e){return!!e&&(e.prototype&&"getGui"in e.prototype)}},fu=class extends Vn{constructor(){super(...arguments),this.beanName="componentMetadataProvider"}wireBeans(e){this.agComponentUtils=e.agComponentUtils}postConstruct(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","onParamsUpdated","refresh"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},dragAndDropImageComponent:{mandatoryMethodList:["setIcon","setLabel"],optionalMethodList:[]},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached","onParamsUpdated","refresh"]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["refresh"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","getState"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]},menuItem:{mandatoryMethodList:[],optionalMethodList:["setActive","select","setExpanded","configureDefaults"]}}}retrieve(e){return this.componentMetaData[e]}},mu=Object.fromEntries(["rowPositionUtils","cellPositionUtils","headerPositionUtils","paginationAutoPageSizeService","apiFunctionService","gridApi","userComponentRegistry","agComponentUtils","componentMetadataProvider","resizeObserverService","userComponentFactory","rowContainerHeightService","horizontalResizeService","localeService","validationService","pinnedRowModel","dragService","visibleColsService","eventService","gos","popupService","selectionService","columnFilterService","quickFilterService","filterManager","columnModel","headerNavigationService","pageBoundsService","paginationService","pageBoundsListener","rowRenderer","expressionService","columnFactory","alignedGridsService","navigationService","valueCache","valueService","loggerFactory","autoWidthCalculator","filterMenuFactory","dragAndDropService","focusService","mouseEventService","environment","cellNavigationService","stylingService","scrollVisibleService","sortController","columnHoverService","columnAnimationService","selectableService","autoColService","controlsColService","changeDetectionService","animationFrameService","undoRedoService","columnDefFactory","rowCssClassCalculator","rowNodeBlockLoader","rowNodeSorter","ctrlsService","pinnedWidthService","rowNodeEventThrottle","ctrlsFactory","dataTypeService","syncService","overlayService","stateService","expansionService","apiEventService","ariaAnnouncementService","menuService","columnApplyStateService","columnEventDispatcher","columnMoveService","columnAutosizeService","columnGetStateService","columnGroupStateService","columnSizeService","funcColsService","columnNameService","columnViewportService","pivotResultColsService","showRowGroupColsService"].map(((e,t)=>[e,t])));function vu(e,t){return((e.beanName?mu[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER)-((t.beanName?mu[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER)}function yu(e,t){return"gridDestroyService"===e?.beanName?-1:0}var Cu=class extends Vn{constructor(){super(...arguments),this.beanName="ctrlsFactory",this.registry={}}register(e){this.registry[e.name]=e.classImp}getInstance(e){const t=this.registry[e];if(null!=t){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return new t(...i)}}},wu=class extends Vn{constructor(){super(...arguments),this.beanName="ctrlsService",this.params={gridCtrl:void 0,gridBodyCtrl:void 0,center:void 0,left:void 0,right:void 0,bottomCenter:void 0,bottomLeft:void 0,bottomRight:void 0,topCenter:void 0,topLeft:void 0,topRight:void 0,stickyTopCenter:void 0,stickyTopLeft:void 0,stickyTopRight:void 0,stickyBottomCenter:void 0,stickyBottomLeft:void 0,stickyBottomRight:void 0,fakeHScrollComp:void 0,fakeVScrollComp:void 0,gridHeaderCtrl:void 0,centerHeader:void 0,leftHeader:void 0,rightHeader:void 0},this.ready=!1,this.readyCallbacks=[],this.runReadyCallbacksAsync=!1}wireBeans(e){this.runReadyCallbacksAsync=e.frameworkOverrides.runWhenReadyAsync?.()??!1}postConstruct(){this.addEventListener("ready",(()=>{this.updateReady(),this.ready&&(this.readyCallbacks.forEach((e=>e(this.params))),this.readyCallbacks.length=0)}),this.runReadyCallbacksAsync)}updateReady(){this.ready=Object.values(this.params).every((e=>e?.isAlive()??!1))}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc((()=>{const e=this.readyCallbacks.indexOf(t);e>=0&&this.readyCallbacks.splice(e,1)}))}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc((()=>{this.updateReady()}))}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){const{leftHeader:e,centerHeader:t,rightHeader:n}=this.params;return[e,n,t]}getHeaderRowContainerCtrl(e){const t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}},Su=class extends Vn{constructor(){super(...arguments),this.beanName="cellPositionUtils"}createId(e){const{rowIndex:t,rowPinned:n,column:i}=e;return this.createIdFromValues({rowIndex:t,column:i,rowPinned:n})}createIdFromValues(e){const{rowIndex:t,rowPinned:n,column:i}=e;return`${t}.${null==n?"null":n}.${i.getId()}`}equals(e,t){const n=e.column===t.column,i=e.rowPinned===t.rowPinned,r=e.rowIndex===t.rowIndex;return n&&i&&r}},bu=class extends Vn{constructor(){super(...arguments),this.beanName="rowNodeEventThrottle",this.events=[]}wireBeans(e){this.animationFrameService=e.animationFrameService,this.rowModel=e.rowModel}postConstruct(){Vt(this.gos)&&(this.clientSideRowModel=this.rowModel)}dispatchExpanded(e,t){if(null==this.clientSideRowModel)return void this.eventService.dispatchEvent(e);this.events.push(e);const n=()=>{this.clientSideRowModel&&this.clientSideRowModel.onRowGroupOpened(),this.events.forEach((e=>this.eventService.dispatchEvent(e))),this.events=[]};t?n():(null==this.dispatchExpandedDebounced&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce(n)),this.dispatchExpandedDebounced())}},xu=class extends Vn{constructor(){super(...arguments),this.beanName="rowPositionUtils"}wireBeans(e){this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel,this.pageBoundsService=e.pageBoundsService}getFirstRow(){let e,t=0;return this.pinnedRowModel.getPinnedTopRowCount()?e="top":this.rowModel.getRowCount()?(e=null,t=this.pageBoundsService.getFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(e="bottom"),void 0===e?null:{rowIndex:t,rowPinned:e}}getLastRow(){let e,t=null;const n=this.pinnedRowModel.getPinnedBottomRowCount(),i=this.pinnedRowModel.getPinnedTopRowCount();return n?(t="bottom",e=n-1):this.rowModel.getRowCount()?(t=null,e=this.pageBoundsService.getLastRow()):i&&(t="top",e=i-1),void 0===e?null:{rowIndex:e,rowPinned:t}}getRowNode(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRow(e.rowIndex);case"bottom":return this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);default:return this.rowModel.getRow(e.rowIndex)}}sameRow(e,t){return!e&&!t||!(e&&!t||!e&&t)&&(e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned)}before(e,t){switch(e.rowPinned){case"top":if("top"!==t.rowPinned)return!0;break;case"bottom":if("bottom"!==t.rowPinned)return!1;break;default:if(Dt(t.rowPinned))return"top"!==t.rowPinned}return e.rowIndex<t.rowIndex}},_u={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},Mu={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},Eu={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},Ru=class extends Vn{constructor(){super(...arguments),this.beanName="environment",this.sizeEls=new Map,this.lastKnownValues=new Map,this.ancestorThemeClasses=[],this.sizesMeasured=!1,this.gridTheme=null}wireBeans(e){this.resizeObserverService=e.resizeObserverService,this.eGridDiv=e.eGridDiv}postConstruct(){this.addManagedPropertyListener("theme",(()=>this.handleThemeGridOptionChange())),this.handleThemeGridOptionChange(),this.addDestroyFunc((()=>this.stopUsingTheme())),this.addManagedPropertyListener("rowHeight",(()=>this.refreshRowHeightVariable())),this.ancestorThemeClasses=this.readAncestorThemeClasses(),this.setUpThemeClassObservers(),this.getSizeEl(_u),this.getSizeEl(Mu),this.getSizeEl(Eu)}getDefaultRowHeight(){return this.getCSSVariablePixelValue(_u)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(Mu)}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(Eu)}hasMeasuredSizes(){return this.sizesMeasured}getGridThemeClass(){return this.gridTheme?.getCssClass()||null}getThemeClasses(){return this.gridTheme?[this.gridTheme.getCssClass()]:this.ancestorThemeClasses}applyThemeClasses(e){const t=this.getThemeClasses();for(const n of Array.from(e.classList))n.startsWith("ag-theme-")&&!t.includes(n)&&e.classList.remove(n);e.classList.add(...t)}refreshRowHeightVariable(){const e=this.eGridDiv.style.getPropertyValue("--ag-line-height").trim(),t=this.gos.get("rowHeight");if(null==t||isNaN(t)||!isFinite(t))return null!==e&&this.eGridDiv.style.setProperty("--ag-line-height",null),-1;const n=`${t}px`;return e!=n?(this.eGridDiv.style.setProperty("--ag-line-height",n),t):""!=e?parseFloat(e):-1}getCSSVariablePixelValue(e){const t=this.lastKnownValues.get(e);if(null!=t)return t;const n=this.measureSizeEl(e);return"detached"===n||"no-styles"===n?e.defaultValue:(this.lastKnownValues.set(e,n),n)}measureSizeEl(e){const t=this.getSizeEl(e);if(null==t.offsetParent)return"detached";const n=t.offsetWidth;return n===Pu?"no-styles":(this.sizesMeasured=!0,n)}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;let n=this.eMeasurementContainer;n||(n=this.eMeasurementContainer=document.createElement("div"),n.className="ag-measurement-container",this.gos.get("theme")&&this.applyThemeClasses(n),this.eGridDiv.appendChild(n)),t=document.createElement("div"),t.style.width=`var(${e.cssName}, ${Pu}px)`,n.appendChild(t),this.sizeEls.set(e,t);let i=this.measureSizeEl(e);"no-styles"===i&&bt(`no value for ${e.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${e.defaultValue} will be used and updated when styles load.`);const r=this.resizeObserverService.observeResize(t,(()=>{const t=this.measureSizeEl(e);"detached"!==t&&"no-styles"!==t&&(this.lastKnownValues.set(e,t),t!==i&&(i=t,this.fireGridStylesChangedEvent(e.changeKey)))}));return this.addDestroyFunc((()=>r())),t}fireGridStylesChangedEvent(e){this.eventService.dispatchEvent({type:"gridStylesChanged",[e]:!0})}setUpThemeClassObservers(){const e=new MutationObserver((()=>{const e=this.readAncestorThemeClasses();Tu(e,this.ancestorThemeClasses)||(this.ancestorThemeClasses=e,this.fireGridStylesChangedEvent("themeChanged"))}));let t=this.eGridDiv;for(;t;)e.observe(t||this.eGridDiv,{attributes:!0,attributeFilter:["class"]}),t=t.parentElement;this.addDestroyFunc((()=>e.disconnect()))}readAncestorThemeClasses(){let e=this.eGridDiv;const t=[];for(;e;){const n=Array.from(e.classList).filter((e=>e.startsWith("ag-theme-")));for(const e of n)t.includes(e)||t.unshift(e);e=e.parentElement}return Object.freeze(t)}handleThemeGridOptionChange(){const{gos:e,eMeasurementContainer:t,gridTheme:n}=this,i=e.get("theme")||null;i!==n&&(n?.stopUse(),this.gridTheme=i,i?.startUse({loadThemeGoogleFonts:e.get("loadThemeGoogleFonts"),container:this.eGridDiv}),t&&this.applyThemeClasses(t),this.fireGridStylesChangedEvent("themeChanged"))}stopUsingTheme(){this.gridTheme?.stopUse(),this.gridTheme=null}},Tu=(e,t)=>e.length===t.length&&-1===e.findIndex(((n,i)=>e[i]!==t[i])),Pu=15538,Au=class extends Vn{constructor(){super(...arguments),this.beanName="eventService",this.globalEventService=new vt}wireBeans(e){this.globalEventListener=e.globalEventListener,this.globalSyncEventListener=e.globalSyncEventListener}postConstruct(){if(this.globalEventListener){const e=Xt(this.gos);this.addGlobalListener(this.globalEventListener,e)}this.globalSyncEventListener&&this.addGlobalListener(this.globalSyncEventListener,!1)}addEventListener(e,t,n){this.globalEventService.addEventListener(e,t,n)}removeEventListener(e,t,n){this.globalEventService.removeEventListener(e,t,n)}addGlobalListener(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.globalEventService.addGlobalListener(e,t)}removeGlobalListener(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.globalEventService.removeGlobalListener(e,t)}dispatchLocalEvent(){}dispatchEvent(e){this.globalEventService.dispatchEvent(this.gos.addGridCommonParams(e))}dispatchEventOnce(e){this.globalEventService.dispatchEventOnce(this.gos.addGridCommonParams(e))}},Fu=class e extends Vn{constructor(){super(...arguments),this.beanName="focusService"}wireBeans(e){this.eGridDiv=e.eGridDiv,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.headerNavigationService=e.headerNavigationService,this.headerPositionUtils=e.headerPositionUtils,this.rowRenderer=e.rowRenderer,this.rowPositionUtils=e.rowPositionUtils,this.cellPositionUtils=e.cellPositionUtils,this.navigationService=e.navigationService,this.ctrlsService=e.ctrlsService,this.filterManager=e.filterManager,this.rangeService=e.rangeService,this.advancedFilterService=e.advancedFilterService,this.overlayService=e.overlayService}static addKeyboardModeEvents(t){this.instanceCount>0||(t.addEventListener("keydown",e.toggleKeyboardMode),t.addEventListener("mousedown",e.toggleKeyboardMode))}static removeKeyboardModeEvents(t){this.instanceCount>0||(t.removeEventListener("keydown",e.toggleKeyboardMode),t.removeEventListener("mousedown",e.toggleKeyboardMode))}static toggleKeyboardMode(t){const n=e.keyboardModeActive,i="keydown"===t.type;i&&(t.ctrlKey||t.metaKey||t.altKey)||n!==i&&(e.keyboardModeActive=i)}postConstruct(){const e=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:e,columnRowGroupChanged:e}),this.registerKeyboardFocusEvents(),this.ctrlsService.whenReady(this,(e=>{this.gridCtrl=e.gridCtrl}))}registerKeyboardFocusEvents(){const t=en(this.gos);e.addKeyboardModeEvents(t),e.instanceCount++,this.addDestroyFunc((()=>{e.instanceCount--,e.removeKeyboardModeEvents(t)}))}onColumnEverythingChanged(){if(!this.focusedCellPosition)return;const e=this.focusedCellPosition.column,t=this.columnModel.getCol(e.getId());e!==t&&this.clearFocusedCell()}isKeyboardMode(){return e.keyboardModeActive}getFocusCellToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(rn(this.gos),zl.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(rn(this.gos),Aa.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition}isDomDataMissingInHierarchy(e,t){let n=e;for(;n;){if(Jt(this.gos,n,t))return!1;n=n.parentNode}return!0}getFocusedCell(){return this.focusedCellPosition}shouldRestoreFocus(e){return!!this.isCellRestoreFocused(e)&&(setTimeout((()=>{this.restoredFocusedCellPosition=null}),0),!0)}clearRestoreFocus(){this.restoredFocusedCellPosition=null,this.awaitRestoreFocusedCell=!1}restoreFocusedCell(e,t){this.awaitRestoreFocusedCell=!0,setTimeout((()=>{this.awaitRestoreFocusedCell&&(this.setRestoreFocusedCell(e),t())}))}isCellRestoreFocused(e){return null!=this.restoredFocusedCellPosition&&this.cellPositionUtils.equals(e,this.restoredFocusedCellPosition)}setRestoreFocusedCell(e){"react"===this.getFrameworkOverrides().renderingEngine&&(this.restoredFocusedCellPosition=e)}getFocusEventParams(e){const{rowIndex:t,rowPinned:n,column:i}=e,r={rowIndex:t,rowPinned:n,column:i,isFullWidthCell:!1},s=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:n});return s&&(r.isFullWidthCell=s.isFullWidth()),r}clearFocusedCell(){if(this.restoredFocusedCellPosition=null,null==this.focusedCellPosition)return;const e=this.getFocusEventParams(this.focusedCellPosition);this.focusedCellPosition=null,this.eventService.dispatchEvent({type:"cellFocusCleared",...e})}setFocusedCell(e){const{column:t,rowIndex:n,rowPinned:i,forceBrowserFocus:r=!1,preventScrollOnBrowserFocus:s=!1}=e,o=this.columnModel.getCol(t);o?(this.focusedCellPosition={rowIndex:n,rowPinned:Ft(i),column:o},this.eventService.dispatchEvent({type:"cellFocused",...this.getFocusEventParams(this.focusedCellPosition),forceBrowserFocus:r,preventScrollOnBrowserFocus:s})):this.focusedCellPosition=null}isCellFocused(e){return null!=this.focusedCellPosition&&this.cellPositionUtils.equals(e,this.focusedCellPosition)}isRowNodeFocused(e){return this.isRowFocused(e.rowIndex,e.rowPinned)}isHeaderWrapperFocused(e){if(null==this.focusedHeaderPosition)return!1;const t=e.getColumnGroupChild(),n=e.getRowIndex(),i=e.getPinned(),{column:r,headerRowIndex:s}=this.focusedHeaderPosition;return t===r&&n===s&&i==r.getPinned()}clearFocusedHeader(){this.focusedHeaderPosition=null}getFocusedHeader(){return this.focusedHeaderPosition}setFocusedHeader(e,t){this.focusedHeaderPosition={headerRowIndex:e,column:t}}isHeaderFocusSuppressed(){return this.gos.get("suppressHeaderFocus")||this.overlayService.isExclusive()}isCellFocusSuppressed(){return this.gos.get("suppressCellFocus")||this.overlayService.isExclusive()}focusHeaderPosition(e){if(this.isHeaderFocusSuppressed())return!1;const{direction:t,fromTab:n,allowUserOverride:i,event:r,fromCell:s,rowWithoutSpanValue:o}=e;let{headerPosition:a}=e;if(s&&this.filterManager?.isAdvancedFilterHeaderActive())return this.focusAdvancedFilter(a);if(i){const e=this.getFocusedHeader(),i=this.headerNavigationService.getHeaderRowCount();if(n){const n=this.gos.getCallback("tabToNextHeader");n&&(a=this.getHeaderPositionFromUserFunc({userFunc:n,direction:t,currentPosition:e,headerPosition:a,headerRowCount:i}))}else{const t=this.gos.getCallback("navigateToNextHeader");if(t&&r){a=t({key:r.key,previousHeaderPosition:e,nextHeaderPosition:a,headerRowCount:i,event:r})}}}return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:t,event:r,fromCell:s,rowWithoutSpanValue:o})}focusHeaderPositionFromUserFunc(e){if(this.isHeaderFocusSuppressed())return!1;const{userFunc:t,headerPosition:n,direction:i,event:r}=e,s=this.getFocusedHeader(),o=this.headerNavigationService.getHeaderRowCount(),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:i,currentPosition:s,headerPosition:n,headerRowCount:o});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:i,event:r})}getHeaderPositionFromUserFunc(e){const{userFunc:t,direction:n,currentPosition:i,headerPosition:r,headerRowCount:s}=e,o=t({backwards:"Before"===n,previousHeaderPosition:i,nextHeaderPosition:r,headerRowCount:s});return!0===o||null===o?(null===o&&bt("Since v31.3 Returning `null` from tabToNextHeader is deprecated. Return `true` to stay on the current header, or `false` to let the browser handle the tab behaviour."),i):!1===o?null:o}focusProvidedHeaderPosition(e){const{headerPosition:t,direction:n,fromCell:i,rowWithoutSpanValue:r,event:s}=e,{column:o,headerRowIndex:a}=t;if(-1===a)return this.filterManager?.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView(o);this.headerNavigationService.scrollToColumn(o,n);const l=this.ctrlsService.getHeaderRowContainerCtrl(o.getPinned()),c=l?.focusHeader(t.headerRowIndex,o,s)||!1;return c&&(null!=r||i)&&this.headerNavigationService.setCurrentHeaderRowWithoutSpan(r??-1),c}focusFirstHeader(){if(this.overlayService.isExclusive()&&this.focusOverlay())return!0;let e=this.visibleColsService.getAllCols()[0];if(!e)return!1;e.getParent()&&(e=this.visibleColsService.getColGroupAtLevel(e,0));const t=this.headerPositionUtils.getHeaderIndexToFocus(e,0);return this.focusHeaderPosition({headerPosition:t,rowWithoutSpanValue:0})}focusLastHeader(e){if(this.overlayService.isExclusive()&&this.focusOverlay(!0))return!0;const t=this.headerNavigationService.getHeaderRowCount()-1,n=Rn(this.visibleColsService.getAllCols());return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:n},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){return this.filterManager?.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCellPosition}isRowFocused(e,t){return null!=this.focusedCellPosition&&(this.focusedCellPosition.rowIndex===e&&this.focusedCellPosition.rowPinned===Ft(t))}findFocusableElements(e,t){let n=Nr;t&&(n+=", "+t),arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(n+=', [tabindex="-1"]');const i=Array.prototype.slice.apply(e.querySelectorAll("[tabindex], input, select, button, textarea, [href]")).filter((e=>es(e))),r=Array.prototype.slice.apply(e.querySelectorAll(n));if(!r.length)return i;return s=r,i.filter((e=>-1===s.indexOf(e)));var s}focusInto(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.findFocusableElements(e,null,n),r=t?Rn(i):i[0];return!!r&&(r.focus({preventScroll:!0}),!0)}findFocusableElementBeforeTabGuard(e,t){if(!t)return null;const n=this.findFocusableElements(e),i=n.indexOf(t);if(-1===i)return null;let r=-1;for(let s=i-1;s>=0;s--)if(n[s].classList.contains("ag-tab-guard-top")){r=s;break}return r<=0?null:n[r-1]}findNextFocusableElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.eGridDiv,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;const i=this.findFocusableElements(e,t?':not([tabindex="-1"])':null),r=rn(this.gos);let s;s=t?i.findIndex((e=>e.contains(r))):i.indexOf(r);const o=s+(n?-1:1);return o<0||o>=i.length?null:i[o]}isTargetUnderManagedComponent(e,t){if(!t)return!1;const n=e.querySelectorAll(`.${Ho.FOCUS_MANAGED_CLASS}`);if(!n.length)return!1;for(let i=0;i<n.length;i++)if(n[i].contains(t))return!0;return!1}findTabbableParent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=0;for(;e&&null===Ir(e)&&++n<=t;)e=e.parentElement;return null===Ir(e)?null:e}focusOverlay(e){const t=this.overlayService.isVisible()&&this.overlayService.getOverlayWrapper()?.getGui();return!!t&&this.focusInto(t,e)}focusGridViewFailed(e,t){return t&&this.focusOverlay(e)||e&&this.focusLastHeader()}focusGridView(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.overlayService.isExclusive())return n&&this.focusOverlay(t);if(this.isCellFocusSuppressed())return t&&!this.isHeaderFocusSuppressed()?this.focusLastHeader():!(!n||!this.focusOverlay(t))||this.focusNextGridCoreContainer(!1);const i=t?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(i){const{rowIndex:n,rowPinned:r}=i;if(e??(e=this.getFocusedHeader()?.column),e&&void 0!==n&&null!==n){if(this.navigationService.ensureCellVisible({rowIndex:n,column:e,rowPinned:r}),t){const e=this.rowRenderer.getRowByPosition(i);if(e?.isFullWidth()&&this.navigationService.tryToFocusFullWidthRow(i,t))return!0}return this.setFocusedCell({rowIndex:n,column:e,rowPinned:Ft(r),forceBrowserFocus:!0}),this.rangeService?.setRangeToCell({rowIndex:n,rowPinned:r,column:e}),!0}}return!(!n||!this.focusOverlay(t))||!(!t||!this.focusLastHeader())}isGridFocused(){const e=rn(this.gos);return!!e&&this.eGridDiv.contains(e)}focusNextGridCoreContainer(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!(t||!this.gridCtrl.focusNextInnerContainer(e))||((t||!e&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(e),!1)}focusAdvancedFilter(e){return this.advancedFilterFocusColumn=e?.column,this.advancedFilterService?.getCtrl().focusHeaderComp()??!1}focusNextFromAdvancedFilter(e,t){const n=(t?void 0:this.advancedFilterFocusColumn)??this.visibleColsService.getAllCols()?.[0];return e?this.focusHeaderPosition({headerPosition:{column:n,headerRowIndex:this.headerNavigationService.getHeaderRowCount()-1}}):this.focusGridView(n)}clearAdvancedFilterColumn(){this.advancedFilterFocusColumn=void 0}addFocusableContainer(e){this.gridCtrl.addFocusableContainer(e)}removeFocusableContainer(e){this.gridCtrl.removeFocusableContainer(e)}focusGridInnerElement(e){return this.gridCtrl.focusInnerElement(e)}allowFocusForNextGridCoreContainer(e){this.gridCtrl.allowFocusForNextCoreContainer(e)}};Fu.keyboardModeActive=!1,Fu.instanceCount=0;var Du=Fu,Lu=class extends Vn{constructor(){super(...arguments),this.beanName="pinnedWidthService"}wireBeans(e){this.visibleColsService=e.visibleColsService}postConstruct(){const e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const e=jt(this.gos,"print"),t=e?0:this.visibleColsService.getColsLeftWidth(),n=e?0:this.visibleColsService.getDisplayedColumnsRightWidth();t!=this.leftWidth&&(this.leftWidth=t,this.eventService.dispatchEvent({type:"leftPinnedWidthChanged"})),n!=this.rightWidth&&(this.rightWidth=n,this.eventService.dispatchEvent({type:"rightPinnedWidthChanged"}))}getPinnedRightWidth(){return this.rightWidth}getPinnedLeftWidth(){return this.leftWidth}},Iu=class extends Vn{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}wireBeans(e){this.beans=e,this.focusService=e.focusService,this.visibleColsService=e.visibleColsService}setComp(e,t,n){this.view=e,this.eGridHostDiv=t,this.eGui=n,this.eGui.setAttribute("grid-id",this.beans.context.getGridId());const{dragAndDropService:i,mouseEventService:r,ctrlsService:s,resizeObserverService:o}=this.beans,a={getContainer:()=>this.eGui,isInterestedIn:e=>1===e||0===e,getIconName:()=>"notAllowed"};i.addDropTarget(a),this.addDestroyFunc((()=>i.removeDropTarget(a))),r.stampTopLevelGridCompWithGridInstance(t),this.createManagedBean(new ml(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr"),this.updateGridThemeClass(),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)});const l=o.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc((()=>l())),s.register("gridCtrl",this)}isDetailGrid(){const e=this.focusService.findTabbableParent(this.getGui());return e?.getAttribute("row-id")?.startsWith("detail")||!1}getOptionalSelectors(){const e=this.beans;return{paginationSelector:e.paginationService?.getPaginationSelector(),gridHeaderDropZonesSelector:e.columnDropZonesService?.getDropZoneSelector(),sideBarSelector:e.sideBarService?.getSideBarSelector(),statusBarSelector:e.statusBarService?.getStatusPanelSelector(),watermarkSelector:e.licenseManager?.getWatermarkSelector()}}onGridSizeChanged(){this.eventService.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){this.view.setCursor(e?"ew-resize":null)}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.getFocusableContainers(),{indexWithFocus:n,nextIndex:i}=this.getNextFocusableIndex(t,e);if(i<0||i>=t.length)return!1;if(0===i){if(n>0){const e=Rn(this.visibleColsService.getAllCols());if(this.focusService.focusGridView(e,!0))return!0}return!1}return this.focusContainer(t[i],e)}focusInnerElement(e){const t=this.gos.getCallback("focusGridInnerElement");if(t&&t({fromBottom:!!e}))return!0;const n=this.getFocusableContainers(),i=this.visibleColsService.getAllCols();if(e){if(n.length>1)return this.focusContainer(Rn(n),!0);const e=Rn(i);if(this.focusService.focusGridView(e,!0))return!0}if(0===this.gos.get("headerHeight")||this.focusService.isHeaderFocusSuppressed()){if(this.focusService.focusGridView(i[0]))return!0;for(let e=1;e<n.length;e++)if(this.focusService.focusInto(n[e].getGui()))return!0;return!1}return this.focusService.focusFirstHeader()}forceFocusOutOfContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){const t=this.view.getFocusableContainers(),{nextIndex:n,indexWithFocus:i}=this.getNextFocusableIndex(t,e);if(-1===i||n<0||n>=t.length)return;const r=t[n];r.setAllowFocus?.(!0),setTimeout((()=>{r.setAllowFocus?.(!1)}))}getNextFocusableIndex(e,t){const n=rn(this.gos),i=e.findIndex((e=>e.getGui().contains(n)));return{indexWithFocus:i,nextIndex:i+(t?-1:1)}}focusContainer(e,t){e.setAllowFocus?.(!0);const n=this.focusService.focusInto(e.getGui(),t);return e.setAllowFocus?.(!1),n}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}updateGridThemeClass(){const e=this.beans.environment.getGridThemeClass();e&&this.view.setGridThemeClass(e)}handleThemeChange(e){e.themeChanged&&this.updateGridThemeClass()}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},ku={version:Da,moduleName:"@ag-grid-community/aligned-grid",beans:[class extends Vn{constructor(){super(...arguments),this.beanName="alignedGridsService",this.consuming=!1}wireBeans(e){this.columnModel=e.columnModel,this.columnSizeService=e.columnSizeService,this.ctrlsService=e.ctrlsService,this.columnApplyStateService=e.columnApplyStateService}getAlignedGridApis(){let e=this.gos.get("alignedGrids")??[];const t="function"===typeof e;"function"===typeof e&&(e=e());const n=()=>`See ${this.getFrameworkOverrides().getDocLink("aligned-grids")}`;return e.map((e=>{if(!e)return xt("alignedGrids contains an undefined option."),t||xt('You may want to configure via a callback to avoid setup race conditions:\n                     "alignedGrids: () => [linkedGrid]"'),void xt(n());if(this.isGridApi(e))return e;const i=e;return"current"in i?i.current?.api:(i.api||xt(`alignedGrids - No api found on the linked grid. If you are passing gridOptions to alignedGrids since v31 this is no longer valid. ${n()}`),i.api)})).filter((e=>!!e&&!e.isDestroyed()))}isGridApi(e){return!!e&&!!e.dispatchEvent}postConstruct(){const e=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:e,columnVisible:e,columnPinned:e,columnGroupOpened:e,columnResized:e,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:e=>{let{event:t}=e;return this.onColumnEvent(t)},alignedGridScroll:e=>{let{event:t}=e;return this.onScrollEvent(t)}})}fireEvent(e){this.consuming||this.getAlignedGridApis().forEach((t=>{t.isDestroyed()||t.dispatchEvent(e)}))}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent({type:"alignedGridColumn",event:e})}fireScrollEvent(e){"horizontal"===e.direction&&this.fireEvent({type:"alignedGridScroll",event:e})}onScrollEvent(e){this.onEvent((()=>{this.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(e.left,!0)}))}extractDataFromEvent(e,t){const n=[];return e.columns?e.columns.forEach((e=>{n.push(t(e))})):e.column&&n.push(t(e.column)),n}getMasterColumns(e){return this.extractDataFromEvent(e,(e=>e))}getColumnIds(e){return this.extractDataFromEvent(e,(e=>e.getColId()))}onColumnEvent(e){this.onEvent((()=>{switch(e.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":this.processColumnEvent(e);break;case"columnGroupOpened":this.processGroupOpenedEvent(e);break;case"columnPivotChanged":bt("pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.")}}))}processGroupOpenedEvent(e){const{columnModel:t}=this;e.columnGroups.forEach((e=>{let n=null;e&&(n=t.getProvidedColGroup(e.getGroupId())),e&&!n||t.setColumnGroupOpened(n,e.isExpanded(),"alignedGridChanged")}))}processColumnEvent(e){const t=e.column;let n=null;if(t&&(n=this.columnModel.getColDefCol(t.getColId())),t&&!n)return;const i=this.getMasterColumns(e),{columnApplyStateService:r,columnSizeService:s,ctrlsService:o}=this;switch(e.type){case"columnMoved":{const t=e.api.getColumnState().map((e=>({colId:e.colId})));r.applyColumnState({state:t,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{const t=e.api.getColumnState().map((e=>({colId:e.colId,hide:e.hide})));r.applyColumnState({state:t},"alignedGridChanged")}break;case"columnPinned":{const t=e.api.getColumnState().map((e=>({colId:e.colId,pinned:e.pinned})));r.applyColumnState({state:t},"alignedGridChanged")}break;case"columnResized":{const t=e,n={};i.forEach((e=>{n[e.getId()]={key:e.getColId(),newWidth:e.getActualWidth()}})),t.flexColumns?.forEach((e=>{n[e.getId()]&&delete n[e.getId()]})),s.setColumnWidths(Object.values(n),!1,t.finished,"alignedGridChanged");break}}const a=o.getGridBodyCtrl().isVerticalScrollShowing();this.getAlignedGridApis().forEach((e=>{e.setGridOption("alwaysShowVerticalScroll",a)}))}}]};var Ou={version:Da,moduleName:"@ag-grid-community/data-type",beans:[class extends Vn{constructor(){super(...arguments),this.beanName="dataTypeService",this.dataTypeDefinitions={},this.isWaitingForRowData=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[]}wireBeans(e){this.rowModel=e.rowModel,this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.valueService=e.valueService,this.columnApplyStateService=e.columnApplyStateService,this.filterManager=e.filterManager}postConstruct(){this.groupHideOpenParents=this.gos.get("groupHideOpenParents"),this.addManagedPropertyListener("groupHideOpenParents",(()=>{this.groupHideOpenParents=this.gos.get("groupHideOpenParents")})),this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",(e=>{this.processDataTypeDefinitions(),this.columnModel.recreateColumnDefs(wi(e.source))}))}processDataTypeDefinitions(){const e=this.getDefaultDataTypes();this.dataTypeDefinitions={},this.formatValueFuncs={};const t=e=>t=>{const{column:n,node:i,value:r}=t;let s=n.getColDef().valueFormatter;return s===e.groupSafeValueFormatter&&(s=e.valueFormatter),this.valueService.formatValue(n,i,r,s)};Object.entries(e).forEach((e=>{let[n,i]=e;const r={...i,groupSafeValueFormatter:this.createGroupSafeValueFormatter(i)};this.dataTypeDefinitions[n]=r,this.formatValueFuncs[n]=t(r)}));const n=this.gos.get("dataTypeDefinitions")??{};this.dataTypeMatchers={},Object.entries(n).forEach((i=>{let[r,s]=i;const o=this.processDataTypeDefinition(s,n,[r],e);o&&(this.dataTypeDefinitions[r]=o,s.dataTypeMatcher&&(this.dataTypeMatchers[r]=s.dataTypeMatcher),this.formatValueFuncs[r]=t(o))})),this.checkObjectValueHandlers(e),["dateString","text","number","boolean","date"].forEach((t=>{const n=this.dataTypeMatchers[t];n&&delete this.dataTypeMatchers[t],this.dataTypeMatchers[t]=n??e[t].dataTypeMatcher}))}mergeDataTypeDefinitions(e,t){const n={...e,...t};return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(n.columnTypes=[...ei(e.columnTypes),...ei(t.columnTypes)]),n}processDataTypeDefinition(e,t,n,i){let r;const s=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let n=i[s];const o=t[s];if(n&&o&&(n=o),!this.validateDataTypeDefinition(e,n,s))return;r=this.mergeDataTypeDefinitions(n,e)}else{if(n.includes(s))return void bt('Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.');const o=t[s];if(!this.validateDataTypeDefinition(e,o,s))return;const a=this.processDataTypeDefinition(o,t,[...n,s],i);if(!a)return;r=this.mergeDataTypeDefinitions(a,e)}return{...r,groupSafeValueFormatter:this.createGroupSafeValueFormatter(r)}}validateDataTypeDefinition(e,t,n){return t?t.baseDataType===e.baseDataType||(bt('The "baseDataType" property of a data type definition must match that of its parent.'),!1):(bt(`The data type definition ${n} does not exist.`),!1)}createGroupSafeValueFormatter(e){if(e.valueFormatter)return t=>{if(t.node?.group){const n=(t.colDef.pivotValueColumn??t.column).getAggFunc();if(n){if("first"===n||"last"===n)return e.valueFormatter(t);if("number"===e.baseDataType&&"count"!==n){if("number"===typeof t.value)return e.valueFormatter(t);if("object"===typeof t.value){if(!t.value)return;if("toNumber"in t.value)return e.valueFormatter({...t,value:t.value.toNumber()});if("value"in t.value)return e.valueFormatter({...t,value:t.value.value})}}return}if((this.gos.get("suppressGroupMaintainValueType")||"groupRows"===this.gos.get("groupDisplayType"))&&!this.gos.get("treeData"))return}else if(this.groupHideOpenParents&&t.column.isRowGroupActive()&&"string"===typeof t.value&&!e.dataTypeMatcher?.(t.value))return;return e.valueFormatter(t)}}updateColDefAndGetColumnType(e,t,n){let{cellDataType:i}=t;const{field:r}=t;if(void 0===i&&(i=e.cellDataType),null!=i&&!0!==i||(i=!!this.canInferCellDataType(e,t)&&this.inferCellDataType(r,n)),!i)return void(e.cellDataType=!1);const s=this.dataTypeDefinitions[i];if(s)return e.cellDataType=i,s.groupSafeValueFormatter&&(e.valueFormatter=s.groupSafeValueFormatter),s.valueParser&&(e.valueParser=s.valueParser),s.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,i,s,n),s.columnTypes;bt(`Missing data type definition - "${i}"`)}addColumnListeners(e){if(!this.isWaitingForRowData)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const n=e=>{t.add(e.key)};e.addEventListener("columnStateUpdated",n),this.columnStateUpdateListenerDestroyFuncs.push((()=>e.removeEventListener("columnStateUpdated",n)))}canInferCellDataType(e,t){if(!Vt(this.gos))return!1;const n={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(this.doColDefPropsPreventInference(t,n))return!1;const i=null===t.type?e.type:t.type;if(i){const e=this.gos.get("columnTypes")??{};if(ei(i).some((t=>{const i=e[t.trim()];return i&&this.doColDefPropsPreventInference(i,n)})))return!1}return!this.doColDefPropsPreventInference(e,n)}doColDefPropsPreventInference(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some((n=>{let[i,r]=n;return this.doesColDefPropPreventInference(e,t,i,r)}))}doesColDefPropPreventInference(e,t,n,i){if(!t[n])return!1;const r=e[n];return null===r?(t[n]=!1,!1):void 0===i?!!r:r===i}inferCellDataType(e,t){if(!e)return;let n;const i=this.getInitialData();if(i){const t=e.indexOf(".")>=0&&!this.gos.get("suppressFieldDotNotation");n=li(i,e,t)}else this.initWaitForRowData(t);if(null==n)return;const[r]=Object.entries(this.dataTypeMatchers).find((e=>{let[t,i]=e;return i(n)}))??["object"];return r}getInitialData(){const e=this.gos.get("rowData");if(e?.length)return e[0];if(this.initialData)return this.initialData;{const e=this.rowModel.getRootNode().allLeafChildren;if(e?.length)return e[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isWaitingForRowData)return;this.isWaitingForRowData=!0;const t=this.isColumnTypeOverrideInDataTypeDefinitions;t&&this.columnModel.queueResizeOperations();const[n]=this.addManagedEventListeners({rowDataUpdateStarted:e=>{const{firstRowData:i}=e;i&&(n?.(),this.isWaitingForRowData=!1,this.processColumnsPendingInference(i,t),this.columnStateUpdatesPendingInference={},t&&this.columnModel.processResizeOperations(),this.eventService.dispatchEvent({type:"dataTypesInferred"}))}})}isPendingInference(){return this.isWaitingForRowData}processColumnsPendingInference(e,t){this.initialData=e;const n=[];this.destroyColumnStateUpdateListeners();const i={},r={};Object.entries(this.columnStateUpdatesPendingInference).forEach((e=>{let[s,o]=e;const a=this.columnModel.getCol(s);if(!a)return;const l=a.getColDef();if(!this.columnModel.resetColDefIntoCol(a,"cellDataTypeInferred"))return;const c=a.getColDef();if(t&&c.type&&c.type!==l.type){const e=this.getUpdatedColumnState(a,o);e.rowGroup&&null==e.rowGroupIndex&&(i[s]=e),e.pivot&&null==e.pivotIndex&&(r[s]=e),n.push(e)}})),t&&n.push(...this.funcColsService.generateColumnStateForRowGroupAndPivotIndexes(i,r)),n.length&&this.columnApplyStateService.applyColumnState({state:n},"cellDataTypeInferred"),this.initialData=null}getUpdatedColumnState(e,t){const n=this.columnApplyStateService.getColumnStateFromColDef(e);return t.forEach((e=>{delete n[e],"rowGroup"===e?delete n.rowGroupIndex:"pivot"===e&&delete n.pivotIndex})),n}checkObjectValueHandlers(e){const t=this.dataTypeDefinitions.object,n=e.object;this.hasObjectValueParser=t.valueParser!==n.valueParser,this.hasObjectValueFormatter=t.valueFormatter!==n.valueFormatter}getDateStringTypeDefinition(e){return e?this.getDataTypeDefinition(e)??this.dataTypeDefinitions.dateString:this.dataTypeDefinitions.dateString}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDataTypeDefinition(e){const t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){return this.getDataTypeDefinition(e)?.baseDataType}checkType(e,t){if(null==t)return!0;const n=this.getDataTypeDefinition(e)?.dataTypeMatcher;return!n||n(t)}validateColDef(e){const t=e=>bt(`Cell data type is "object" but no Value ${e} has been provided. Please either provide an object data type definition with a Value ${e}, or set "colDef.value${e}"`);"object"===e.cellDataType&&(e.valueFormatter!==this.dataTypeDefinitions.object.groupSafeValueFormatter||this.hasObjectValueFormatter||t("Formatter"),e.editable&&e.valueParser===this.dataTypeDefinitions.object.valueParser&&!this.hasObjectValueParser&&t("Parser"))}getFormatValue(e){return this.formatValueFuncs[e]}setColDefPropertiesForBaseDataType(e,t,n,i){const r=this.formatValueFuncs[t];switch(n.baseDataType){case"number":e.cellEditor="agNumberCellEditor";break;case"boolean":e.cellEditor="agCheckboxCellEditor",e.cellRenderer="agCheckboxCellRenderer",e.suppressKeyboardEvent=e=>!!e.colDef.editable&&e.event.key===As.SPACE;break;case"date":e.cellEditor="agDateCellEditor",e.keyCreator=r;break;case"dateString":e.cellEditor="agDateStringCellEditor",e.keyCreator=r;break;case"object":e.cellEditorParams={useFormatter:!0},e.comparator=(e,t)=>{const n=this.columnModel.getColDefCol(i),s=n?.getColDef();if(!n||!s)return 0;const o=null==e?"":r({column:n,node:null,value:e}),a=null==t?"":r({column:n,node:null,value:t});return o===a?0:o>a?1:-1},e.keyCreator=r}this.filterManager?.setColDefPropertiesForDataType(e,n,r)}getDefaultDataTypes(){const e=e=>!!e.match("^\\d{4}-\\d{2}-\\d{2}$"),t=this.localeService.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:e=>""===e.newValue?.trim?.()?null:Number(e.newValue),valueFormatter:e=>null==e.value?"":"number"!==typeof e.value||isNaN(e.value)?t("invalidNumber","Invalid Number"):String(e.value),dataTypeMatcher:e=>"number"===typeof e},text:{baseDataType:"text",valueParser:e=>""===e.newValue?null:kt(e.newValue),dataTypeMatcher:e=>"string"===typeof e},boolean:{baseDataType:"boolean",valueParser:e=>null==e.newValue?e.newValue:""===e.newValue?.trim?.()?null:"true"===String(e.newValue).toLowerCase(),valueFormatter:e=>null==e.value?"":String(e.value),dataTypeMatcher:e=>"boolean"===typeof e},date:{baseDataType:"date",valueParser:e=>Ca(null==e.newValue?null:String(e.newValue)),valueFormatter:e=>null==e.value?"":e.value instanceof Date&&!isNaN(e.value.getTime())?ma(e.value,!1)??"":t("invalidDate","Invalid Date"),dataTypeMatcher:e=>e instanceof Date},dateString:{baseDataType:"dateString",dateParser:e=>Ca(e)??void 0,dateFormatter:e=>ma(e??null,!1)??void 0,valueParser:t=>e(String(t.newValue))?t.newValue:null,valueFormatter:t=>e(String(t.value))?t.value:"",dataTypeMatcher:t=>"string"===typeof t&&e(t)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:e=>kt(e.value)??""}}}destroyColumnStateUpdateListeners(){this.columnStateUpdateListenerDestroyFuncs.forEach((e=>e())),this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}}]};var Nu={version:Da,moduleName:"@ag-grid-community/render-api",apiFunctions:{setGridAriaProperty:function(e,t,n){if(!t)return;const i=e.ctrlsService.getGridBodyCtrl().getGui(),r=`aria-${t}`;null===n?i.removeAttribute(r):i.setAttribute(r,n)},refreshCells:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.frameworkOverrides.wrapIncoming((()=>e.rowRenderer.refreshCells(t)))},flashCells:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e=>bt(`Since v31.1 api.flashCells parameter '${e}Delay' is deprecated. Please use '${e}Duration' instead.`);Dt(t.fadeDelay)&&n("fade"),Dt(t.flashDelay)&&n("flash"),e.frameworkOverrides.wrapIncoming((()=>e.rowRenderer.flashCells(t)))},refreshHeader:function(e){e.frameworkOverrides.wrapIncoming((()=>e.ctrlsService.getHeaderRowContainerCtrls().forEach((e=>e.refresh()))))},isAnimationFrameQueueEmpty:function(e){return e.animationFrameService.isQueueEmpty()},flushAllAnimationFrames:function(e){e.animationFrameService.flushAllFrames()},getSizesForCurrentTheme:function(e){return{rowHeight:Zt(e.gos),headerHeight:e.columnModel.getHeaderHeight()}},getCellRendererInstances:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.rowRenderer.getCellRendererInstances(t).map(vo)}}};function Bu(e,t){const{colKey:n,rowNode:i,useFormatter:r}=t,s=e.columnModel.getColDefCol(n)??e.columnModel.getCol(n);if(Lt(s))return null;const o=e.valueService.getValueForDisplay(s,i);if(r){return e.valueService.formatValue(s,i,o)??Di(o,!0)}return o}function zu(e,t){e.gos.updateGridOptions({options:t})}function Hu(e){return e.rowRenderer.getFirstVirtualRenderedRow()}function Gu(e){return e.rowRenderer.getLastVirtualRenderedRow()}var Uu={version:Da,moduleName:"@ag-grid-community/api",dependantModules:[{version:Da,moduleName:"@ag-grid-community/core-api",apiFunctions:{getGridId:function(e){return e.context.getGridId()},destroy:function(e){e.gridDestroyService.destroy()},isDestroyed:function(e){return e.gridDestroyService.isDestroyCalled()},getGridOption:function(e,t){return e.gos.get(t)},setGridOption:function(e,t,n){zu(e,{[t]:n})},updateGridOptions:zu}},{version:Da,moduleName:"@ag-grid-community/pinned-row-api",apiFunctions:{getPinnedTopRowCount:function(e){return e.pinnedRowModel.getPinnedTopRowCount()},getPinnedBottomRowCount:function(e){return e.pinnedRowModel.getPinnedBottomRowCount()},getPinnedTopRow:function(e,t){return e.pinnedRowModel.getPinnedTopRow(t)},getPinnedBottomRow:function(e,t){return e.pinnedRowModel.getPinnedBottomRow(t)}}},{version:Da,moduleName:"@ag-grid-community/row-selection-api",apiFunctions:{setNodesSelected:function(e,t){if(!t.nodes.every((e=>e.rowPinned?(bt("cannot select pinned rows"),!1):void 0!==e.id||(bt("cannot select node until id for node is known"),!1))))return;const{nodes:n,source:i,newValue:r}=t,s=n;e.selectionService.setNodesSelected({nodes:s,source:i??"api",newValue:r})},selectAll:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAll";e.selectionService.selectAllRowNodes({source:t})},deselectAll:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAll";e.selectionService.deselectAllRowNodes({source:t})},selectAllFiltered:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAllFiltered";e.selectionService.selectAllRowNodes({source:t,justFiltered:!0})},deselectAllFiltered:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAllFiltered";e.selectionService.deselectAllRowNodes({source:t,justFiltered:!0})},selectAllOnCurrentPage:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAllCurrentPage";e.selectionService.selectAllRowNodes({source:t,justCurrentPage:!0})},deselectAllOnCurrentPage:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAllCurrentPage";e.selectionService.deselectAllRowNodes({source:t,justCurrentPage:!0})},getSelectedNodes:function(e){return e.selectionService.getSelectedNodes()},getSelectedRows:function(e){return e.selectionService.getSelectedRows()}}},{version:Da,moduleName:"@ag-grid-community/column-api",apiFunctions:{getColumnDef:function(e,t){const n=e.columnModel.getColDefCol(t);return n?n.getColDef():null},getColumnDefs:function(e){return e.columnModel.getColumnDefs()},sizeColumnsToFit:function(e,t){"number"===typeof t?e.columnSizeService.sizeColumnsToFit(t,"api"):e.ctrlsService.getGridBodyCtrl().sizeColumnsToFit(t)},setColumnGroupOpened:function(e,t,n){e.columnModel.setColumnGroupOpened(t,n,"api")},getColumnGroup:function(e,t,n){return e.visibleColsService.getColumnGroup(t,n)},getProvidedColumnGroup:function(e,t){return e.columnModel.getProvidedColGroup(t)},getDisplayNameForColumn:function(e,t,n){return e.columnNameService.getDisplayNameForColumn(t,n)||""},getDisplayNameForColumnGroup:function(e,t,n){return e.columnNameService.getDisplayNameForColumnGroup(t,n)||""},getColumn:function(e,t){return e.columnModel.getColDefCol(t)},getColumns:function(e){return e.columnModel.getColDefCols()},applyColumnState:function(e,t){return e.columnApplyStateService.applyColumnState(t,"api")},getColumnState:function(e){return e.columnGetStateService.getColumnState()},resetColumnState:function(e){e.columnApplyStateService.resetColumnState("api")},getColumnGroupState:function(e){return e.columnGroupStateService.getColumnGroupState()},setColumnGroupState:function(e,t){e.columnGroupStateService.setColumnGroupState(t,"api")},resetColumnGroupState:function(e){e.columnGroupStateService.resetColumnGroupState("api")},isPinning:function(e){return e.visibleColsService.isPinningLeft()||e.visibleColsService.isPinningRight()},isPinningLeft:function(e){return e.visibleColsService.isPinningLeft()},isPinningRight:function(e){return e.visibleColsService.isPinningRight()},getDisplayedColAfter:function(e,t){return e.visibleColsService.getColAfter(t)},getDisplayedColBefore:function(e,t){return e.visibleColsService.getColBefore(t)},setColumnVisible:function(e,t,n){e.columnModel.setColsVisible([t],n,"api")},setColumnsVisible:function(e,t,n){e.columnModel.setColsVisible(t,n,"api")},setColumnPinned:function(e,t,n){e.columnModel.setColsPinned([t],n,"api")},setColumnsPinned:function(e,t,n){e.columnModel.setColsPinned(t,n,"api")},getAllGridColumns:function(e){return e.columnModel.getCols()},getDisplayedLeftColumns:function(e){return e.visibleColsService.getLeftCols()},getDisplayedCenterColumns:function(e){return e.visibleColsService.getCenterCols()},getDisplayedRightColumns:function(e){return e.visibleColsService.getRightCols()},getAllDisplayedColumns:function(e){return e.visibleColsService.getAllCols()},getAllDisplayedVirtualColumns:function(e){return e.columnViewportService.getViewportColumns()},moveColumn:function(e,t,n){e.columnMoveService.moveColumns([t],n,"api")},moveColumnByIndex:function(e,t,n){e.columnMoveService.moveColumnByIndex(t,n,"api")},moveColumns:function(e,t,n){e.columnMoveService.moveColumns(t,n,"api")},setColumnWidth:function(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"api";e.columnSizeService.setColumnWidths([{key:t,newWidth:n}],!1,i,r)},setColumnWidths:function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"api";e.columnSizeService.setColumnWidths(t,!1,n,i)},getLeftDisplayedColumnGroups:function(e){return e.visibleColsService.getTreeLeft()},getCenterDisplayedColumnGroups:function(e){return e.visibleColsService.getTreeCenter()},getRightDisplayedColumnGroups:function(e){return e.visibleColsService.getTreeRight()},getAllDisplayedColumnGroups:function(e){return e.visibleColsService.getAllTrees()},autoSizeColumn:function(e,t,n){return e.columnAutosizeService.autoSizeCols({colKeys:[t],skipHeader:n,source:"api"})},autoSizeColumns:function(e,t,n){e.columnAutosizeService.autoSizeCols({colKeys:t,skipHeader:n,source:"api"})},autoSizeAllColumns:function(e,t){e.columnAutosizeService.autoSizeAllColumns("api",t)}}},{version:Da,moduleName:"@ag-grid-community/row-api",apiFunctions:{redrawRows:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming((()=>e.rowRenderer.redrawRows(n)))},setRowNodeExpanded:function(e,t,n,i,r){e.expansionService.setRowNodeExpanded(t,n,i,r)},getRowNode:function(e,t){return e.rowModel.getRowNode(t)},addRenderedRowListener:function(e,t,n,i){e.rowRenderer.addRenderedRowListener(t,n,i)},getRenderedNodes:function(e){return e.rowRenderer.getRenderedNodes()},forEachNode:function(e,t,n){e.rowModel.forEachNode(t,n)},getFirstDisplayedRow:function(e){return Hu(e)},getFirstDisplayedRowIndex:Hu,getLastDisplayedRow:function(e){return Gu(e)},getLastDisplayedRowIndex:Gu,getDisplayedRowAtIndex:function(e,t){return e.rowModel.getRow(t)},getDisplayedRowCount:function(e){return e.rowModel.getRowCount()},getModel:function(e){return e.rowModel}}},{version:Da,moduleName:"@ag-grid-community/drag-api",apiFunctions:{addRowDropZone:function(e,t){e.ctrlsService.getGridBodyCtrl().getRowDragFeature().addRowDropZone(t)},removeRowDropZone:function(e,t){const n=e.dragAndDropService.findExternalZone(t);n&&e.dragAndDropService.removeDropTarget(n)},getRowDropZoneParams:function(e,t){return e.ctrlsService.getGridBodyCtrl().getRowDragFeature().getRowDropZone(t)}}},{version:Da,moduleName:"@ag-grid-community/scroll-api",apiFunctions:{getVerticalPixelRange:function(e){return e.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition()},getHorizontalPixelRange:function(e){return e.ctrlsService.getGridBodyCtrl().getScrollFeature().getHScrollPosition()},ensureColumnVisible:Fc,ensureIndexVisible:Dc,ensureNodeVisible:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.frameworkOverrides.wrapIncoming((()=>e.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureNodeVisible(t,n)),"ensureVisible")}}},{version:Da,moduleName:"@ag-grid-community/overlay-api",apiFunctions:{showLoadingOverlay:function(e){e.overlayService.showLoadingOverlay()},showNoRowsOverlay:function(e){e.overlayService.showNoRowsOverlay()},hideOverlay:function(e){e.overlayService.hideOverlay()}}},{version:Da,moduleName:"@ag-grid-community/keyboard-navigation-api",apiFunctions:{getFocusedCell:function(e){return e.focusService.getFocusedCell()},clearFocusedCell:function(e){return e.focusService.clearFocusedCell()},setFocusedCell:function(e,t,n,i){e.focusService.setFocusedCell({rowIndex:t,column:n,rowPinned:i,forceBrowserFocus:!0})},setFocusedHeader:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=e.headerNavigationService.getHeaderPositionForColumn(t,n);i&&e.focusService.focusHeaderPosition({headerPosition:i})},tabToNextCell:function(e,t){return e.navigationService.tabToNextCell(!1,t)},tabToPreviousCell:function(e,t){return e.navigationService.tabToNextCell(!0,t)}}},{version:Da,moduleName:"@ag-grid-community/event-api",apiFunctions:{addEventListener:function(e,t,n){e.apiEventService.addEventListener(t,n)},addGlobalListener:function(e,t){e.apiEventService.addGlobalListener(t)},removeEventListener:function(e,t,n){e.apiEventService.removeEventListener(t,n)},removeGlobalListener:function(e,t){e.apiEventService.removeGlobalListener(t)}}},Nu,{version:Da,moduleName:"@ag-grid-community/cell-api",apiFunctions:{expireValueCache:function(e){e.valueCache.expire()},getValue:function(e,t,n){return Bu(e,{colKey:t,rowNode:n})},getCellValue:Bu}},{version:Da,moduleName:"@ag-grid-community/menu-api",apiFunctions:{showColumnMenuAfterButtonClick:function(e,t,n){const i=e.columnModel.getCol(t);e.menuService.showColumnMenu({column:i,buttonElement:n,positionBy:"button"})},showColumnMenuAfterMouseClick:function(e,t,n){let i=e.columnModel.getCol(t);i||(i=e.columnModel.getColDefCol(t)),i?e.menuService.showColumnMenu({column:i,mouseEvent:n,positionBy:"mouse"}):xt(`column '${t}' not found`)},showColumnMenu:function(e,t){const n=e.columnModel.getCol(t);n?e.menuService.showColumnMenu({column:n,positionBy:"auto"}):xt(`column '${t}' not found`)},hidePopupMenu:function(e){e.menuService.hidePopupMenu()}}},{version:Da,moduleName:"@ag-grid-community/sort-api",apiFunctions:{onSortChanged:function(e){e.sortController.onSortChanged("api")}}}]};function Vu(e){if((e={...e}).version||(e.version="32.1.0"),"32.1.0"===e.version)e=function(e){return e.cellSelection=function(e,t){if(e&&"object"===typeof e)return e[t]}(e,"rangeSelection"),e}(e);return e}var Wu={version:Da,moduleName:"@ag-grid-community/state-core",beans:[class extends Vn{constructor(){super(...arguments),this.beanName="stateService",this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=Pt((()=>this.dispatchQueuedStateUpdateEvents()),0),this.onRowGroupOpenedDebounced=Pt((()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState())),0),this.onRowSelectedDebounced=Pt((()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())}),0),this.staleStateKeys=new Set}wireBeans(e){this.filterManager=e.filterManager,this.ctrlsService=e.ctrlsService,this.pivotResultColsService=e.pivotResultColsService,this.focusService=e.focusService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.columnGroupStateService=e.columnGroupStateService,this.columnGetStateService=e.columnGetStateService,this.paginationService=e.paginationService,this.selectionService=e.selectionService,this.expansionService=e.expansionService,this.columnAnimationService=e.columnAnimationService,this.columnApplyStateService=e.columnApplyStateService,this.sideBarService=e.sideBarService,this.rangeService=e.rangeService}postConstruct(){this.isClientSideRowModel=Vt(this.gos),this.cachedState=this.getInitialState(),this.setCachedStateValue("version",Da),this.ctrlsService.whenReady(this,(()=>this.suppressEventsAndDispatchInitEvent((()=>this.setupStateOnGridReady()))));const[e,t,n]=this.addManagedEventListeners({newColumnsLoaded:t=>{let{source:n}=t;"gridInitializing"===n&&(e(),this.suppressEventsAndDispatchInitEvent((()=>this.setupStateOnColumnsInitialised())))},rowCountReady:()=>{t?.(),this.suppressEventsAndDispatchInitEvent((()=>this.setupStateOnRowCountReady()))},firstDataRendered:()=>{n?.(),this.suppressEventsAndDispatchInitEvent((()=>this.setupStateOnFirstDataRendered()))}})}getInitialState(){return Vu(this.gos.get("initialState")??{})}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setupStateOnGridReady(){this.updateCachedState("sideBar",this.getSideBarState());const e=()=>this.updateCachedState("sideBar",this.getSideBarState());this.addManagedEventListeners({toolPanelVisibleChanged:e,sideBarUpdated:e})}setupStateOnColumnsInitialised(){const e=this.getInitialState();this.setColumnState(e),this.setColumnGroupState(e),this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState());const t=e=>()=>this.updateColumnState([e]);this.addManagedEventListeners({columnValueChanged:t("aggregation"),columnMoved:t("columnOrder"),columnPinned:t("columnPinning"),columnResized:t("columnSizing"),columnVisible:t("columnVisibility"),columnPivotChanged:t("pivot"),columnPivotModeChanged:t("pivot"),columnRowGroupChanged:t("rowGroup"),sortChanged:t("sort"),newColumnsLoaded:()=>this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setupStateOnRowCountReady(){const{filter:e,rowGroupExpansion:t,rowSelection:n,pagination:i}=this.getInitialState(),r=this.gos.get("advancedFilterModel");(e||r)&&this.setFilterState(e,r),t&&this.setRowGroupExpansionState(t),n&&this.setRowSelectionState(n),i&&this.setPaginationState(i),this.updateCachedState("filter",this.getFilterState()),this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowSelection",this.getRowSelectionState()),this.updateCachedState("pagination",this.getPaginationState());const s=()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState());this.addManagedEventListeners({filterChanged:()=>this.updateCachedState("filter",this.getFilterState()),rowGroupOpened:()=>this.onRowGroupOpenedDebounced(),expandOrCollapseAll:s,columnRowGroupChanged:s,rowDataUpdated:()=>{0!==this.gos.get("groupDefaultExpanded")&&setTimeout((()=>{s()}))},selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:e=>{(e.newPage||e.newPageSize)&&this.updateCachedState("pagination",this.getPaginationState())}})}setupStateOnFirstDataRendered(){const{scroll:e,cellSelection:t,focusedCell:n,columnOrder:i}=this.getInitialState();n&&this.setFocusedCellState(n),t&&this.setCellSelectionState(t),e&&this.setScrollState(e),this.setColumnPivotState(!!i?.orderedColIds),this.updateCachedState("sideBar",this.getSideBarState()),this.updateCachedState("focusedCell",this.getFocusedCellState());const r=this.getRangeSelectionState();this.updateCachedState("rangeSelection",r),this.updateCachedState("cellSelection",r),this.updateCachedState("scroll",this.getScrollState()),this.addManagedEventListeners({cellFocused:()=>this.updateCachedState("focusedCell",this.getFocusedCellState()),cellSelectionChanged:e=>{if(e.finished){const e=this.getRangeSelectionState();this.updateCachedState("rangeSelection",e),this.updateCachedState("cellSelection",e)}},bodyScrollEnd:()=>this.updateCachedState("scroll",this.getScrollState())})}getColumnState(){const e=this.columnModel.isPivotMode(),t=[],n=[],i=[],r=[],s=[],o=[],a=[],l=[],c=[];let u=0;const h=this.columnGetStateService.getColumnState();for(let d=0;d<h.length;d++){const{colId:e,sort:p,sortIndex:g,rowGroup:f,rowGroupIndex:m,aggFunc:v,pivot:y,pivotIndex:C,pinned:w,hide:S,width:b,flex:x}=h[d];c.push(e),p&&(t[g??u++]={colId:e,sort:p}),f&&(n[m??0]=e),"string"===typeof v&&i.push({colId:e,aggFunc:v}),y&&(r[C??0]=e),w&&("right"===w?o:s).push(e),S&&a.push(e),(x||b)&&l.push({colId:e,flex:x??void 0,width:b})}return{sort:t.length?{sortModel:t}:void 0,rowGroup:n.length?{groupColIds:n}:void 0,aggregation:i.length?{aggregationModel:i}:void 0,pivot:r.length||e?{pivotMode:e,pivotColIds:r}:void 0,columnPinning:s.length||o.length?{leftColIds:s,rightColIds:o}:void 0,columnVisibility:a.length?{hiddenColIds:a}:void 0,columnSizing:l.length?{columnSizingModel:l}:void 0,columnOrder:c.length?{orderedColIds:c}:void 0}}setColumnState(e){const{sort:t,rowGroup:n,aggregation:i,pivot:r,columnPinning:s,columnVisibility:o,columnSizing:a,columnOrder:l,partialColumnState:c}=e,u={},h=e=>{let t=u[e];return t||(t={colId:e},u[e]=t,t)},d=c?{}:{sort:null,sortIndex:null,rowGroup:null,rowGroupIndex:null,aggFunc:null,pivot:null,pivotIndex:null,pinned:null,hide:null,flex:null};t&&(t.sortModel.forEach(((e,t)=>{let{colId:n,sort:i}=e;const r=h(n);r.sort=i,r.sortIndex=t})),d.sort=null,d.sortIndex=null),n&&(n.groupColIds.forEach(((e,t)=>{const n=h(e);n.rowGroup=!0,n.rowGroupIndex=t})),d.rowGroup=null,d.rowGroupIndex=null),i&&(i.aggregationModel.forEach((e=>{let{colId:t,aggFunc:n}=e;h(t).aggFunc=n})),d.aggFunc=null),r&&(r.pivotColIds.forEach(((e,t)=>{const n=h(e);n.pivot=!0,n.pivotIndex=t})),this.gos.updateGridOptions({options:{pivotMode:r.pivotMode},source:"gridInitializing"}),d.pivot=null,d.pivotIndex=null),s&&(s.leftColIds.forEach((e=>{h(e).pinned="left"})),s.rightColIds.forEach((e=>{h(e).pinned="right"})),d.pinned=null),o&&(o.hiddenColIds.forEach((e=>{h(e).hide=!0})),d.hide=null),a&&(a.columnSizingModel.forEach((e=>{let{colId:t,flex:n,width:i}=e;const r=h(t);r.flex=n??null,r.width=i})),d.flex=null);const p=l?.orderedColIds,g=!!p?.length,f=g?p.map((e=>h(e))):Object.values(u);f.length&&(this.columnStates=f,this.columnApplyStateService.applyColumnState({state:f,applyOrder:g,defaultState:d},"gridInitializing"))}setColumnPivotState(e){const t=this.columnStates;this.columnStates=void 0;const n=this.columnGroupStates;if(this.columnGroupStates=void 0,this.pivotResultColsService.isPivotResultColsPresent()){if(t){const n=[];for(const e of t)this.pivotResultColsService.getPivotResultCol(e.colId)&&n.push(e);this.columnApplyStateService.applyColumnState({state:n,applyOrder:e},"gridInitializing")}n&&this.columnGroupStateService.setColumnGroupState(n,"gridInitializing")}}getColumnGroupState(){const e=this.columnGroupStateService.getColumnGroupState(),t=[];return e.forEach((e=>{let{groupId:n,open:i}=e;i&&t.push(n)})),t.length?{openColumnGroupIds:t}:void 0}setColumnGroupState(e){if(!Object.prototype.hasOwnProperty.call(e,"columnGroup"))return;const t=new Set(e.columnGroup?.openColumnGroupIds),n=this.columnGroupStateService.getColumnGroupState().map((e=>{let{groupId:n}=e;const i=t.has(n);return i&&t.delete(n),{groupId:n,open:i}}));t.forEach((e=>{n.push({groupId:e,open:!0})})),n.length&&(this.columnGroupStates=n),this.columnGroupStateService.setColumnGroupState(n,"gridInitializing")}getFilterState(){let e=this.filterManager?.getFilterModel();e&&0===Object.keys(e).length&&(e=void 0);const t=this.filterManager?.getAdvancedFilterModel()??void 0;return e||t?{filterModel:e,advancedFilterModel:t}:void 0}setFilterState(e,t){const{filterModel:n,advancedFilterModel:i}=e??{advancedFilterModel:t};n&&this.filterManager?.setFilterModel(n,"columnFilter"),i&&this.filterManager?.setAdvancedFilterModel(i)}getRangeSelectionState(){const e=this.rangeService?.getCellRanges().map((e=>{const{id:t,type:n,startRow:i,endRow:r,columns:s,startColumn:o}=e;return{id:t,type:n,startRow:i,endRow:r,colIds:s.map((e=>e.getColId())),startColId:o.getColId()}}));return e?.length?{cellRanges:e}:void 0}setCellSelectionState(e){const{gos:t,rangeService:n,columnModel:i,visibleColsService:r}=this;if(!vn(t)||!n)return;const s=[];if(e.cellRanges.forEach((e=>{const t=[];if(e.colIds.forEach((e=>{const n=i.getCol(e);n&&t.push(n)})),!t.length)return;let n=i.getCol(e.startColId);if(!n){const e=r.getAllCols(),i=new Set(t);n=e.find((e=>i.has(e)))}s.push({...e,columns:t,startColumn:n})})),function(e){return void 0!==e.get("cellSelection")}(t)&&function(e){const t=e.get("cellSelection");return void 0!==t?"boolean"!==typeof t&&(t?.suppressMultiRanges??!1):e.get("suppressMultiRangeSelection")}(t)&&s.length>1)return bt("cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`");n.setCellRanges(s)}getScrollState(){if(!this.isClientSideRowModel)return;const e=this.ctrlsService.getGridBodyCtrl()?.getScrollFeature(),{left:t}=e?.getHScrollPosition()??{left:0},{top:n}=e?.getVScrollPosition()??{top:0};return n||t?{top:n,left:t}:void 0}setScrollState(e){if(!this.isClientSideRowModel)return;const{top:t,left:n}=e;this.ctrlsService.getGridBodyCtrl()?.getScrollFeature().setScrollPosition(t,n)}getSideBarState(){return this.sideBarService?.getSideBarComp()?.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;const e=this.focusService.getFocusedCell();if(e){const{column:t,rowIndex:n,rowPinned:i}=e;return{colId:t.getColId(),rowIndex:n,rowPinned:i}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;const{colId:t,rowIndex:n,rowPinned:i}=e;this.focusService.setFocusedCell({column:this.columnModel.getCol(t),rowIndex:n,rowPinned:i,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){if(!this.paginationService)return;const e=this.paginationService.getCurrentPage(),t=this.gos.get("paginationAutoPageSize")?void 0:this.paginationService.getPageSize();return e||t?{page:e,pageSize:t}:void 0}setPaginationState(e){this.paginationService&&(e.pageSize&&!this.gos.get("paginationAutoPageSize")&&this.paginationService.setPageSize(e.pageSize,"initialState"),"number"===typeof e.page&&this.paginationService.setPage(e.page))}getRowSelectionState(){const e=this.selectionService.getSelectionState();return!e||!Array.isArray(e)&&(!1===e.selectAll||!1===e.selectAllChildren)&&!e?.toggledNodes?.length?void 0:e}setRowSelectionState(e){this.selectionService.setSelectionState(e,"gridInitializing")}getRowGroupExpansionState(){const e=this.expansionService.getExpandedRows();return e.length?{expandedRowGroupIds:e}:void 0}setRowGroupExpansionState(e){this.expansionService.expandRows(e.expandedRowGroupIds)}updateColumnState(e){const t=this.getColumnState();let n=!1;Object.entries(t).forEach((e=>{let[t,i]=e;zt(i,this.cachedState[t])||(n=!0)})),this.cachedState={...this.cachedState,...t},n&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){const n=this.cachedState[e];this.setCachedStateValue(e,t),zt(t,n)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState={...this.cachedState,[e]:t}}refreshStaleState(){this.staleStateKeys.forEach((e=>{if("rowSelection"===e)this.setCachedStateValue(e,this.getRowSelectionState())})),this.staleStateKeys.clear()}dispatchStateUpdateEvent(e){this.suppressEvents||(e.forEach((e=>this.queuedUpdateSources.add(e))),this.dispatchStateUpdateEventDebounced())}dispatchQueuedStateUpdateEvents(){const e=Array.from(this.queuedUpdateSources);this.queuedUpdateSources.clear(),this.eventService.dispatchEvent({type:"stateUpdated",sources:e,state:this.cachedState})}suppressEventsAndDispatchInitEvent(e){this.suppressEvents=!0,this.columnAnimationService.setSuppressAnimation(!0),e(),setTimeout((()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.columnAnimationService.setSuppressAnimation(!1),this.dispatchStateUpdateEvent(["gridInitializing"]))}))}}]},ju={version:Da,moduleName:"@ag-grid-community/state",dependantModules:[Wu,{version:Da,moduleName:"@ag-grid-community/state-api",apiFunctions:{getState:function(e){return e.stateService?.getState()??{}}},dependantModules:[Wu]}]};var qu="paginationPageSizeSelector",Xu={selector:"AG-PAGE-SIZE-SELECTOR",component:class extends fs{constructor(){super('<span class="ag-paging-page-size"></span>'),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const e=this.selectPageSizeComp.getValue();if(!e)return;const t=Number(e);isNaN(t)||t<1||t===this.paginationService.getPageSize()||(this.paginationService.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.paginationService=e.paginationService}postConstruct(){this.addManagedPropertyListener(qu,(()=>{this.onPageSizeSelectorValuesChange()})),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||!e?.newPageSize)return;const t=this.paginationService.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&!e&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp)}reset(){Yr(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&!1!==this.gos.get(qu)}reloadPageSizesSelector(){const e=this.getPageSizeSelectorValues(),t=this.paginationService.getPageSize(),n=!t||!e.includes(t);if(n){const n=this.gos.exists("paginationPageSize"),i=!0!==this.gos.get(qu);bt(`'paginationPageSize=${t}'${n?"":" (default value)"}, but ${t} is not included in${i?"":" the default"} paginationPageSizeSelector=[${e.join(", ")}].`),i||bt(`Either set '${qu}' to an array that includes ${t} or to 'false' to disable the page size selector.`),e.unshift("")}const i=String(n?"":t);this.selectPageSizeComp?(Tn(this.pageSizeOptions,e)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(e)),this.pageSizeOptions=e),this.selectPageSizeComp.setValue(i,!0)):this.createPageSizeSelectorComp(e,i),this.hasEmptyOption=n}createPageSizeSelectOptions(e){return e.map((e=>({value:String(e)})))}createPageSizeSelectorComp(e,t){const n=this.localeService.getLocaleTextFunc(),i=n("pageSizeSelectorLabel","Page Size:"),r=n("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new Ko).addOptions(this.createPageSizeSelectOptions(e)).setValue(t).setAriaLabel(r).setLabel(i).onValueChange((()=>this.handlePageSizeItemSelected())),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){const e=[20,50,100],t=this.gos.get(qu);return!Array.isArray(t)||It(t)?e:[...t].sort(((e,t)=>e-t))}destroy(){this.toggleSelectDisplay(!1),super.destroy()}}},Ku={selector:"AG-PAGINATION",component:class extends Zc{constructor(){super(),this.btFirst=gs,this.btPrevious=gs,this.btNext=gs,this.btLast=gs,this.lbRecordCount=gs,this.lbFirstRowOnPage=gs,this.lbLastRowOnPage=gs,this.lbCurrent=gs,this.lbTotal=gs,this.pageSizeComp=gs,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1}wireBeans(e){this.rowModel=e.rowModel,this.paginationService=e.paginationService,this.focusService=e.focusService,this.ariaAnnouncementService=e.ariaAnnouncementService}postConstruct(){const e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[Xu]);const{btFirst:t,btPrevious:n,btNext:i,btLast:r}=this;this.activateTabIndex([t,n,i,r]),t.insertAdjacentElement("afterbegin",ys(e?"last":"first",this.gos)),n.insertAdjacentElement("afterbegin",ys(e?"next":"previous",this.gos)),i.insertAdjacentElement("afterbegin",ys(e?"previous":"next",this.gos)),r.insertAdjacentElement("afterbegin",ys(e?"first":"last",this.gos)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],(()=>this.onPageSizeRelatedOptionsChange())),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:e=>{this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(e):this.focusService.focusGridInnerElement(e)},forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){const e=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(e),e&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){var e,t,n;this.areListenersSetup||(this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)}),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach((e=>{const{el:t,fn:n}=e;this.addManagedListeners(t,{click:n,keydown:e=>{e.key!==As.ENTER&&e.key!==As.SPACE||(e.preventDefault(),n())}})})),e=this,t=this.getGui(),n=this.focusService,e.addManagedElementListeners(t,{keydown:e=>{if(!e.defaultPrevented&&e.key===As.TAB){const i=e.shiftKey;n.findNextFocusableElement(t,!1,i)||n.focusNextGridCoreContainer(i)&&e.preventDefault()}}}),this.areListenersSetup=!0)}onBtFirst(){this.previousAndFirstButtonsDisabled||this.paginationService.goToFirstPage()}formatNumber(e){const t=this.gos.getCallback("paginationNumberFormatter");if(t){return t({value:e})}const n=this.localeService.getLocaleTextFunc();return fa(e,n("thousandSeparator",","),n("decimalSeparator","."))}getTemplate(){const e=this.localeService.getLocaleTextFunc(),t=e("page","Page"),n=e("to","to"),i=e("of","of"),r=e("firstPage","First Page"),s=e("previousPage","Previous Page"),o=e("nextPage","Next Page"),a=e("lastPage","Last Page"),l=this.getCompId();return`<div class="ag-paging-panel ag-unselectable" id="ag-${l}">\n                <ag-page-size-selector data-ref="pageSizeComp"></ag-page-size-selector>\n                <span class="ag-paging-row-summary-panel">\n                    <span id="ag-${l}-first-row" data-ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-${l}-to">${n}</span>\n                    <span id="ag-${l}-last-row" data-ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-${l}-of">${i}</span>\n                    <span id="ag-${l}-row-count" data-ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>\n                </span>\n                <span class="ag-paging-page-summary-panel" role="presentation">\n                    <div data-ref="btFirst" class="ag-button ag-paging-button" role="button" aria-label="${r}"></div>\n                    <div data-ref="btPrevious" class="ag-button ag-paging-button" role="button" aria-label="${s}"></div>\n                    <span class="ag-paging-description">\n                        <span id="ag-${l}-start-page">${t}</span>\n                        <span id="ag-${l}-start-page-number" data-ref="lbCurrent" class="ag-paging-number"></span>\n                        <span id="ag-${l}-of-page">${i}</span>\n                        <span id="ag-${l}-of-page-number" data-ref="lbTotal" class="ag-paging-number"></span>\n                    </span>\n                    <div data-ref="btNext" class="ag-button ag-paging-button" role="button" aria-label="${o}"></div>\n                    <div data-ref="btLast" class="ag-button ag-paging-button" role="button" aria-label="${a}"></div>\n                </span>\n            </div>`}onBtNext(){this.nextButtonDisabled||this.paginationService.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.paginationService.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.paginationService.goToLastPage()}enableOrDisableButtons(){const e=this.paginationService.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),n=this.paginationService.getTotalPages();this.previousAndFirstButtonsDisabled=0===e,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const i=this.isZeroPagesToDisplay(),r=e===n-1;this.nextButtonDisabled=r||i,this.lastButtonDisabled=!t||i||e===n-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){!function(e,t){cr(e,"disabled",t)}(e,t),e.classList.toggle("ag-disabled",t)}isZeroPagesToDisplay(){const e=this.rowModel.isLastRowIndexKnown(),t=this.paginationService.getTotalPages();return e&&0===t}updateLabels(){const e=this.rowModel.isLastRowIndexKnown(),t=this.paginationService.getTotalPages(),n=this.paginationService.getMasterRowCount(),i=e?n:null;if(1===i){const e=this.rowModel.getRow(0);if(e&&e.group&&!(e.groupData||e.aggData))return void this.setTotalLabelsToZero()}const r=this.paginationService.getCurrentPage(),s=this.paginationService.getPageSize();let o,a;this.isZeroPagesToDisplay()?o=a=0:(o=s*r+1,a=o+s-1,e&&a>i&&(a=i));const l=!e&&n<o+s-1,c=this.formatNumber(o);let u;this.lbFirstRowOnPage.textContent=c;const h=this.localeService.getLocaleTextFunc();u=l?h("pageLastRowUnknown","?"):this.formatNumber(a),this.lbLastRowOnPage.textContent=u;const d=t>0?r+1:0,p=this.formatNumber(d);let g,f;if(this.lbCurrent.textContent=p,e)g=this.formatNumber(t),f=this.formatNumber(i);else{const e=h("more","more");g=e,f=e}this.lbTotal.textContent=g,this.lbRecordCount.textContent=f,this.announceAriaStatus(c,u,f,p,g)}announceAriaStatus(e,t,n,i,r){const s=this.localeService.getLocaleTextFunc(),o=s("page","Page"),a=s("to","to"),l=s("of","of"),c=`${e} ${a} ${t} ${l} ${n}`,u=`${o} ${i} ${l} ${r}`;c!==this.ariaRowStatus&&(this.ariaRowStatus=c,this.ariaAnnouncementService.announceValue(c,"paginationRow")),u!==this.ariaPageStatus&&(this.ariaPageStatus=u,this.ariaAnnouncementService.announceValue(u,"paginationPage"))}setTotalLabelsToZero(){const e=this.formatNumber(0);this.lbFirstRowOnPage.textContent=e,this.lbCurrent.textContent=e,this.lbLastRowOnPage.textContent=e,this.lbTotal.textContent=e,this.lbRecordCount.textContent=e,this.announceAriaStatus(e,e,e,e,e)}}},$u={version:Da,moduleName:"@ag-grid-community/pagination-core",beans:[class extends Vn{constructor(){super(...arguments),this.beanName="paginationService",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}wireBeans(e){this.rowModel=e.rowModel,this.pageBoundsService=e.pageBoundsService}postConstruct(){this.active=this.gos.get("pagination"),this.pageSizeFromGridOptions=this.gos.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return Ku}isPaginateChildRows(){return!(!this.gos.get("groupRemoveSingleChildren")&&!this.gos.get("groupRemoveLowestSingleChildren"))||this.gos.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){this.active&&this.currentPage!==e&&"number"===typeof this.currentPage&&(this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0}))}isRowPresent(e){return e.rowIndex>=this.topDisplayedRowIndex&&e.rowIndex<=this.bottomDisplayedRowIndex}getPageForIndex(e){return Math.floor(e/this.pageSize)}goToPageWithIndex(e){if(!this.active)return;const t=this.getPageForIndex(e);this.goToPage(t)}isRowInPage(e){if(!this.active)return!0;return this.getPageForIndex(e.rowIndex)===this.currentPage}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const e=this.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return Dt(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:Dt(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:Dt(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:Dt(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.pageBoundsService.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(void 0===this.pageSizeAutoCalculated)return;const e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){const n=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,0!==this.currentPage&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,0!==this.currentPage&&this.goToFirstPage()}n!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0)return void this.setZeroRows();const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid();const t=this.pageSize*this.currentPage;let n=this.pageSize*(this.currentPage+1)-1;if(n>e&&(n=e),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(t),n===e)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{const e=this.rowModel.getTopLevelRowDisplayedIndex(n+1);this.bottomDisplayedRowIndex=e-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){if(this.masterRowCount=this.rowModel.getRowCount(),0===this.masterRowCount)return void this.setZeroRows();const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>e&&(this.bottomDisplayedRowIndex=e)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){const{keepRenderedRows:t=!1,newPage:n=!1,newPageSize:i=!1}=e;this.eventService.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:n,newPageSize:i,keepRenderedRows:t})}},class extends Vn{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeService"}wireBeans(e){this.ctrlsService=e.ctrlsService,this.paginationService=e.paginationService}postConstruct(){this.ctrlsService.whenReady(this,(e=>{this.centerRowsCtrl=e.center;const t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()}))}notActive(){return!this.gos.get("paginationAutoPageSize")||null==this.centerRowsCtrl}onPaginationAutoSizeChanged(){this.notActive()?this.paginationService.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const e=this.centerRowsCtrl.getViewportSizeFeature().getBodyHeight();if(e>0){const t=()=>{const t=Math.max(Zt(this.gos),1),n=Math.floor(e/t);this.paginationService.setPageSize(n,"autoCalculated")};this.isBodyRendered?Pt((()=>t()),50)():(t(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}}]},Zu={version:Da,moduleName:"@ag-grid-community/pagination",dependantModules:[$u,{version:Da,moduleName:"@ag-grid-community/pagination-api",dependantModules:[$u],apiFunctions:{paginationIsLastPageFound:function(e){return e.rowModel.isLastRowIndexKnown()},paginationGetPageSize:function(e){return e.paginationService?.getPageSize()??100},paginationGetCurrentPage:function(e){return e.paginationService?.getCurrentPage()??0},paginationGetTotalPages:function(e){return e.paginationService?.getTotalPages()??1},paginationGetRowCount:function(e){return e.paginationService?e.paginationService.getMasterRowCount():e.rowModel.getRowCount()},paginationGoToNextPage:function(e){e.paginationService?.goToNextPage()},paginationGoToPreviousPage:function(e){e.paginationService?.goToPreviousPage()},paginationGoToFirstPage:function(e){e.paginationService?.goToFirstPage()},paginationGoToLastPage:function(e){e.paginationService?.goToLastPage()},paginationGoToPage:function(e,t){e.paginationService?.goToPage(t)}}}]},Yu="clientSide",Ju="serverSide",Qu="infinite",eh={onGroupExpandedOrCollapsed:[Yu],refreshClientSideRowModel:[Yu],isRowDataEmpty:[Yu],forEachLeafNode:[Yu],forEachNodeAfterFilter:[Yu],forEachNodeAfterFilterAndSort:[Yu],resetRowHeights:[Yu],applyTransaction:[Yu],applyTransactionAsync:[Yu],flushAsyncTransactions:[Yu],getBestCostNodeSelection:[Yu],getServerSideSelectionState:[Ju],setServerSideSelectionState:[Ju],applyServerSideTransaction:[Ju],applyServerSideTransactionAsync:[Ju],applyServerSideRowData:[Ju],retryServerSideLoads:[Ju],flushServerSideAsyncTransactions:[Ju],refreshServerSide:[Ju],getServerSideGroupLevelState:[Ju],refreshInfiniteCache:[Qu],purgeInfiniteCache:[Qu],getInfiniteRowCount:[Qu],isLastRowIndexKnown:[Qu,Ju],expandAll:[Yu,Ju],collapseAll:[Yu,Ju],onRowHeightChanged:[Yu,Ju],setRowCount:[Qu,Ju],getCacheBlockState:[Qu,Ju]},th={getValue:{version:"v31.3",new:"getCellValue"},getFirstDisplayedRow:{version:"v31.1",new:"getFirstDisplayedRowIndex"},getLastDisplayedRow:{version:"v31.1",new:"getLastDisplayedRowIndex"},getModel:{version:"v31.1",message:"Please use the appropriate grid API methods instead."},setColumnVisible:{version:"v31.1",old:"setColumnVisible(key,visible)",new:"setColumnsVisible([key],visible)"},setColumnPinned:{version:"v31.1",old:"setColumnPinned(key,pinned)",new:"setColumnsPinned([key],pinned)"},moveColumn:{version:"v31.1",old:"moveColumn(key, toIndex)",new:"moveColumns([key], toIndex)"},setColumnWidth:{version:"v31.1",old:"setColumnWidth(col, width)",new:"setColumnWidths([{key: col, newWidth: width}])"},autoSizeColumn:{version:"v31.1",old:"autoSizeColumn(key, skipHeader)",new:"autoSizeColumns([key], skipHeader)"},addAggFunc:{version:"v31.1",old:"addAggFunc(key, func)",new:"addAggFuncs({ key: func })"},removeValueColumn:{version:"v31.1",old:"removeValueColumn(colKey)",new:"removeValueColumns([colKey])"},addValueColumn:{version:"v31.1",old:"addValueColumn(colKey)",new:"addValueColumns([colKey])"},removeRowGroupColumn:{version:"v31.1",old:"removeRowGroupColumn(colKey)",new:"removeRowGroupColumns([colKey])"},addRowGroupColumn:{version:"v31.1",old:"addRowGroupColumn(colKey)",new:"addRowGroupColumns([colKey])"},removePivotColumn:{version:"v31.1",old:"removePivotColumn(colKey)",new:"removePivotColumns([colKey])"},addPivotColumn:{version:"v31.1",old:"addPivotColumn(colKey)",new:"addPivotColumns([colKey])"},showColumnMenuAfterButtonClick:{version:"v31.1",message:"Use 'IHeaderParams.showColumnMenu' within a header component, or 'api.showColumnMenu' elsewhere."},showColumnMenuAfterMouseClick:{version:"v31.1",message:"Use 'IHeaderParams.showColumnMenuAfterMouseClick' within a header component, or 'api.showColumnMenu' elsewhere."},getFilterInstance:{version:"v31.1",message:"'getFilterInstance' is deprecated. To get/set individual filter models, use 'getColumnFilterModel' or 'setColumnFilterModel' instead. To get hold of the filter instance, use 'getColumnFilterInstance' which returns the instance asynchronously."},showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"}};var nh=(e,t)=>{const n=t.rowModelType??"clientSide";return"clientSide"===n||"serverSide"===n?{module:"@ag-grid-enterprise/row-grouping"}:null},ih={enableRowGroup:nh,rowGroup:nh,rowGroupIndex:nh,enablePivot:nh,enableValue:nh,pivot:nh,pivotIndex:nh,aggFunc:nh,cellEditor:e=>"agRichSelect"===e.cellEditor||"agRichSelectCellEditor"===e.cellEditor?{module:"@ag-grid-enterprise/rich-select"}:null,menuTabs:e=>{const t=["columnsMenuTab","generalMenuTab"];return e.menuTabs?.some((e=>t.includes(e)))?{module:"@ag-grid-enterprise/menu"}:null},columnsMenuParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},columnChooserParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(e,t)=>{let{rowSelection:n}=t;return"multiple"===n?null:"headerCheckboxSelection is only supported with rowSelection=multiple"}},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(e,t)=>{let{rowSelection:n}=t;return"multiple"===n?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"}},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(e,t)=>{let{rowSelection:n}=t;return"multiple"===n?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"}},children:()=>rh},rh={objectName:"colDef",allProperties:Object.keys({headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnsMenuParams:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0}),docsUrl:"column-properties/",deprecations:{columnsMenuParams:{version:"31.1",message:"Use `columnChooserParams` instead."},suppressMenu:{version:"31.1",message:"Use `suppressHeaderMenuButton` instead."},suppressCellFlash:{version:"31.2",message:"Use `enableCellChangeFlash={false}` in the ColDef"},checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."}},validations:ih},sh={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"\t",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressAsyncEvents:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,enableCellChangeFlash:!1,cellFlashDelay:500,cellFlashDuration:500,cellFadeDelay:1e3,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupIncludeTotalFooter:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,suppressServerSideInfiniteScroll:!1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSideSortOnServer:!1,serverSideFilterOnServer:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,suppressGroupMaintainValueType:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1};var oh={version:Da,moduleName:"@ag-grid-community/core"},ah={version:Da,moduleName:"@ag-grid-community/core-validations",beans:[class extends Vn{constructor(){super(...arguments),this.beanName="validationService"}wireBeans(e){this.beans=e,this.gridOptions=e.gridOptions}postConstruct(){this.processGridOptions(this.gridOptions)}processGridOptions(e){this.processOptions(e,{objectName:"gridOptions",allProperties:[...Xi.ALL_PROPERTIES,...$i.EVENT_CALLBACKS],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:{advancedFilterModel:{version:"31",message:"Use `initialState.filter.advancedFilterModel` instead."},suppressAsyncEvents:{version:"31",message:"Events should be handled asynchronously."},cellFadeDelay:{version:"31.1",renamed:"cellFadeDuration"},cellFlashDelay:{version:"31.1",renamed:"cellFlashDuration"},suppressServerSideInfiniteScroll:{version:"31.1"},serverSideSortOnServer:{version:"31.1"},serverSideFilterOnServer:{version:"31.1"},enableCellChangeFlash:{version:"31.2",message:"Use `enableCellChangeFlash` in the `ColDef` or `defaultColDef` for all columns."},groupIncludeFooter:{version:"31.3",message:"Use `groupTotalRow` instead."},groupIncludeTotalFooter:{version:"31.3",message:"Use `grandTotalRow` instead."},suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."}},validations:{sideBar:{module:"@ag-grid-enterprise/side-bar"},statusBar:{module:"@ag-grid-enterprise/status-bar"},enableCharts:{module:"@ag-grid-enterprise/charts"},getMainMenuItems:{module:"@ag-grid-enterprise/menu"},getContextMenuItems:{module:"@ag-grid-enterprise/menu"},allowContextMenuWithControlKey:{module:"@ag-grid-enterprise/menu"},enableAdvancedFilter:{module:"@ag-grid-enterprise/advanced-filter"},treeData:{supportedRowModels:["clientSide","serverSide"],module:"@ag-grid-enterprise/row-grouping",validate:e=>{const t=e.rowModelType??"clientSide";switch(t){case"clientSide":{const n=`treeData requires 'getDataPath' in the ${t} row model.`;return e.getDataPath?null:n}case"serverSide":{const n=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${t} row model.`;return e.isServerSideGroup&&e.getServerSideGroupKey?null:n}}return null}},masterDetail:{module:"@ag-grid-enterprise/master-detail"},enableRangeSelection:{module:"@ag-grid-enterprise/range-selection"},enableRangeHandle:{dependencies:{enableRangeSelection:[!0]}},enableFillHandle:{dependencies:{enableRangeSelection:[!0]}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupIncludeFooter:{supportedRowModels:["clientSide","serverSide"],validate:e=>{switch(e.rowModelType??"clientSide"){case"clientSide":return null;case"serverSide":{const t="groupIncludeFooter is not supported alongside suppressServerSideInfiniteScroll";return e.suppressServerSideInfiniteScroll?t:null}}return null}},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:[void 0,"bottom"]}},groupIncludeTotalFooter:{supportedRowModels:["clientSide"]},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveLowestSingleChildren:[void 0,!1]}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveSingleChildren:[void 0,!1]}},groupSelectsChildren:{dependencies:{rowSelection:["multiple"]}},viewportDatasource:{supportedRowModels:["viewport"],module:"@ag-grid-enterprise/viewport-row-model"},serverSideDatasource:{supportedRowModels:["serverSide"],module:"@ag-grid-enterprise/server-side-row-model"},cacheBlockSize:{supportedRowModels:["serverSide","infinite"]},datasource:{supportedRowModels:["infinite"],module:"@ag-grid-community/infinite-row-model"},rowData:{supportedRowModels:["clientSide"],module:"@ag-grid-community/client-side-row-model"},paginationPageSizeSelector:{validate:e=>{const t=e.paginationPageSizeSelector;return"boolean"===typeof t||null==t||t.length?null:"'paginationPageSizeSelector' cannot be an empty array.\n                    If you want to hide the page size selector, set paginationPageSizeSelector to false."}},rowSelection:{validate(e){let{rowSelection:t}=e;return t&&"string"===typeof t?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':t&&"object"!==typeof t?"Expected `RowSelectionOptions` object for the `rowSelection` property.":null}},cellSelection:{module:"@ag-grid-enterprise/range-selection"},columnDefs:()=>rh,defaultColDef:()=>rh,defaultColGroupDef:()=>rh,autoGroupColumnDef:()=>rh,selectionColumnDef:()=>rh}})}validateApiFunction(e,t){return function(e,t,n){const i=th[e];if(i){const{version:n,new:r,old:s,message:o}=i,a=s??e;return function(){bt(`Since ${n} api.${a} is deprecated. ${r?`Please use ${r} instead. `:""}${o??""}`);for(var e=arguments.length,i=new Array(e),s=0;s<e;s++)i[s]=arguments[s];return t.apply(t,i)}}const r=eh[e];return r?function(){const i=n.rowModel.getType();if(r.includes(i)){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t.apply(t,o)}xt(`api.${e} can only be called when gridOptions.rowModelType is ${r.join(" or ")}`)}:t}(e,t,this.beans)}processOptions(e,t){const{validations:n,deprecations:i,allProperties:r,propertyExceptions:s,objectName:o,docsUrl:a}=t;r&&!0!==this.gridOptions.suppressPropertyNamesCheck&&this.checkProperties(e,[...s??[],...Object.keys(i)],r,o,a);const l=new Set;Object.keys(e).forEach((t=>{const r=i[t];if(r)if("renamed"in r){const{renamed:n,version:i}=r;l.add(`As of v${i}, ${String(t)} is deprecated. Please use ${String(n)} instead.`),e[n]=e[t]}else{const{message:e,version:n}=r;l.add(`As of v${n}, ${String(t)} is deprecated. ${e??""}`)}const s=e[t];if(null==s||!1===s)return;const o=n[t];let a;if(!o)return;if("function"===typeof o){const n=o(e,this.gridOptions);if(!n)return;if("objectName"in n){const i=e[t];return Array.isArray(i)?void i.forEach((e=>{this.processOptions(e,n)})):void this.processOptions(e[t],n)}a=n}else a=o;const{module:c,dependencies:u,validate:h,supportedRowModels:d}=a;if(d){const e=this.gridOptions.rowModelType??"clientSide";if(!d.includes(e))return void l.add(`${String(t)} is not supported with the '${e}' row model.`)}if(c){const e=Array.isArray(c)?c:[c];let n=!0;if(e.forEach((e=>{this.gos.assertModuleRegistered(e,String(t))||(n=!1,l.add(`${String(t)} is only available when ${e} is loaded.`))})),!n)return}if(u){const n=this.checkForRequiredDependencies(t,u,e);if(n)return void l.add(n)}if(h){const t=h(e,this.gridOptions);if(t)return void l.add(t)}})),l.size>0&&l.forEach((e=>{bt(e)}))}checkForRequiredDependencies(e,t,n){const i=Object.entries(t).find((e=>{let[t,i]=e;const r=n[t];return!i.includes(r)}));if(!i)return null;const[r,s]=i;return s.length>1?`'${String(e)}' requires '${r}' to be one of [${s.join(", ")}].`:`'${String(e)}' requires '${r}' to be ${s[0]}.`}checkProperties(e,t,n,i,r){const s=function(e,t,n){const i={},r=e.filter((e=>!t.some((t=>t===e))));r.length>0&&r.forEach((e=>i[e]=Ws({inputValue:e,allSuggestions:n}).values));return i}(Object.getOwnPropertyNames(e),["__ob__","__v_skip","__metadata__",...t,...n],n);if(ii(s,((e,t)=>{let r=`invalid ${i} property '${e}' did you mean any of these: ${t.slice(0,8).join(", ")}.`;n.includes("context")&&(r+=`\nIf you are trying to annotate ${i} with application data, use the '${i}.context' property instead.`),bt(r)})),Object.keys(s).length>0&&r){const e=this.getFrameworkOverrides().getDocLink(r);bt(`to see all the valid ${i} properties please check: ${e}`)}}}]},lh={version:Da,moduleName:"@ag-grid-community/core-community-features",dependantModules:[oh,ah,Oc,Ka,ju,Ou,ku,Zu,Uu]},ch=class extends Vn{constructor(){super(...arguments),this.beanName="gridDestroyService",this.destroyCalled=!1}wireBeans(e){this.beans=e}destroy(){this.destroyCalled||(this.eventService.dispatchEvent({type:"gridPreDestroyed",state:this.beans.stateService?.getState()??{}}),this.destroyCalled=!0,this.beans.ctrlsService.get("gridCtrl")?.destroyGridUi(),this.beans.context.destroy(),super.destroy())}isDestroyCalled(){return this.destroyCalled}},uh=new Set(["gridPreDestroyed","fillStart","pasteStart"]),hh=new Map([...Xi.BOOLEAN_PROPERTIES.map((e=>[e,Bt])),...Xi.NUMBER_PROPERTIES.map((e=>[e,da])),["groupAggFiltering",e=>"function"===typeof e?e:Bt(e)],["pageSize",pa(1)],["autoSizePadding",pa(0)],["keepDetailRowsCount",pa(1)],["rowBuffer",pa(0)],["infiniteInitialRowCount",pa(1)],["cacheOverflowSize",pa(1)],["cacheBlockSize",pa(1)],["serverSideInitialRowCount",pa(1)],["viewportRowModelPageSize",pa(1)],["viewportRowModelBufferSize",pa(0)]]);function dh(e,t){const n=hh.get(e);return n?n(t):t}var ph=class e extends Vn{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new vt,this.globalEventHandlerFactory=e=>(t,n)=>{if(!this.isAlive())return;const i=uh.has(t);if(i&&!e||!i&&e)return;const r=$i.getCallbackForEvent(t),s=this.gridOptions[r];"function"===typeof s&&this.frameworkOverrides.wrapOutgoing((()=>{s(n)}))}}wireBeans(e){this.gridOptions=e.gridOptions,this.eGridDiv=e.eGridDiv,this.validationService=e.validationService,this.environment=e.environment,this.api=e.gridApi,this.gridId=e.context.getGridId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){const e=!this.get("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandlerFactory().bind(this),e),this.eventService.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propertyEventService.setFrameworkOverrides(this.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:e=>{let{options:t}=e;this.updateGridOptions({options:t,force:!0,source:"gridOptionsUpdated"})}})}get(e){return this.gridOptions[e]??sh[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return Dt(this.gridOptions[e])}mergeGridCommonParams(e){if(e){return t=>{const n=t;return n.api=this.api,n.context=this.gridOptionsContext,e(n)}}return e}updateGridOptions(t){let{options:n,force:i,source:r="api"}=t;const s={id:e.changeSetId++,properties:[]},o=[];Object.entries(n).forEach((e=>{let[t,n]=e;"api"===r&&ji[t]&&bt(`${t} is an initial property and cannot be updated.`);const a=dh(t,n),l=i||"object"===typeof a&&"api"===r,c=this.gridOptions[t];if(l||c!==a){this.gridOptions[t]=a;const e={type:t,currentValue:a,previousValue:c,changeSet:s,source:r};o.push(e)}})),this.validationService?.processGridOptions(this.gridOptions),s.properties=o.map((e=>e.type)),o.forEach((e=>{this.gridOptions.debug&&St(`Updated property ${e.type} from`,e.previousValue," to ",e.currentValue),this.propertyEventService.dispatchEvent(e)}))}addPropertyEventListener(e,t){this.propertyEventService.addEventListener(e,t)}removePropertyEventListener(e,t){this.propertyEventService.removeEventListener(e,t)}getDomDataKey(){return this.domDataKey}getGridCommonParams(){return{api:this.api,context:this.gridOptionsContext}}addGridCommonParams(e){const t=e;return t.api=this.api,t.context=this.gridOptionsContext,t}assertModuleRegistered(e,t){return Co.__assertRegistered(e,t,this.gridId)}isModuleRegistered(e){return Co.__isRegistered(e,this.gridId)}};ph.changeSetId=0;var gh=ph,fh=class extends Vn{constructor(){super(...arguments),this.beanName="headerPositionUtils"}wireBeans(e){this.visibleColsService=e.visibleColsService,this.ctrlsService=e.ctrlsService}findHeader(e,t){let n,i;if(Ni(e.column)?n=this.visibleColsService.getGroupAtDirection(e.column,t):(i=`getCol${t}`,n=this.visibleColsService[i](e.column)),!n)return;const{headerRowIndex:r}=e;if("filter"!==this.getHeaderRowType(r)){const e=[n];for(;n.getParent();)n=n.getParent(),e.push(n);n=e[e.length-1-r]}const{column:s,headerRowIndex:o}=this.getHeaderIndexToFocus(n,r);return{column:s,headerRowIndex:o}}getHeaderIndexToFocus(e,t){let n;if(Ni(e)&&this.isAnyChildSpanningHeaderHeight(e)&&e.isPadding()){const i=e;n=i.getLeafColumns()[0];let r=n;for(;r!==i;)t++,r=r.getParent()}return{column:n||e,headerRowIndex:t}}isAnyChildSpanningHeaderHeight(e){return!!e&&e.getLeafColumns().some((e=>e.isSpanHeaderHeight()))}getColumnVisibleParent(e,t){const n=this.getHeaderRowType(t),i="column"===n;let r="filter"===n?e:e.getParent(),s=t-1,o=s;if(i&&this.isAnyChildSpanningHeaderHeight(e.getParent())){for(;r&&r.isPadding();)r=r.getParent(),s--;o=s,s<0&&(r=e,s=t,o=void 0)}return{column:r,headerRowIndex:s,headerRowIndexWithoutSpan:o}}getColumnVisibleChild(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"After";let i=e,r=t+1;const s=r;if("group"===this.getHeaderRowType(t)){const t=e.getDisplayedLeafColumns(),s="After"===n?t[0]:Rn(t),o=[];let a=s;for(;a.getParent()!==e;)a=a.getParent(),o.push(a);if(i=s,s.isSpanHeaderHeight())for(let e=o.length-1;e>=0;e--){const t=o[e];if(!t.isPadding()){i=t;break}r++}else i=Rn(o),i||(i=s)}return{column:i,headerRowIndex:r,headerRowIndexWithoutSpan:s}}getHeaderRowType(e){const t=this.ctrlsService.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}findColAtEdgeForHeaderRow(e,t){const n=this.visibleColsService.getAllCols(),i=n["start"===t?0:n.length-1];if(!i)return;const r=this.ctrlsService.getHeaderRowContainerCtrl(i.getPinned()),s=r?.getRowType(e);if("group"==s){return{headerRowIndex:e,column:this.visibleColsService.getColGroupAtLevel(i,e)}}return{headerRowIndex:null==s?-1:e,column:i}}},mh=class extends Vn{constructor(){super(...arguments),this.beanName="localeService"}getLocaleTextFunc(){const e=this.gos.getCallback("getLocaleText");if(e)return(t,n,i)=>e({key:t,defaultValue:n,variableValues:i});const t=this.gos.get("localeText");return(e,n,i)=>{let r=t&&t[e];if(r&&i&&i.length){let e=0;for(;!(e>=i.length);){if(-1===r.indexOf("${variable}"))break;r=r.replace("${variable}",i[e++])}}return r??n}}},vh=class extends Vn{constructor(){super(...arguments),this.beanName="apiEventService",this.syncEventListeners=new Map,this.asyncEventListeners=new Map,this.syncGlobalEventListeners=new Set,this.globalEventListenerPairs=new Map}postConstruct(){this.frameworkEventWrappingService=new ti(this.getFrameworkOverrides())}addEventListener(e,t){const n=this.frameworkEventWrappingService.wrap(t),i=Xt(this.gos)&&!uh.has(e),r=i?this.asyncEventListeners:this.syncEventListeners;r.has(e)||r.set(e,new Set),r.get(e).add(n),this.eventService.addEventListener(e,n,i)}removeEventListener(e,t){const n=this.frameworkEventWrappingService.unwrap(t),i=this.asyncEventListeners.get(e),r=!!i?.delete(n);r||this.syncEventListeners.get(e)?.delete(n),this.eventService.removeEventListener(e,n,r)}addGlobalListener(e){const t=this.frameworkEventWrappingService.wrapGlobal(e);if(Xt(this.gos)){const n=(e,n)=>{uh.has(e)&&t(e,n)},i=(e,n)=>{uh.has(e)||t(e,n)};this.globalEventListenerPairs.set(e,{syncListener:n,asyncListener:i}),this.eventService.addGlobalListener(n,!1),this.eventService.addGlobalListener(i,!0)}else this.syncGlobalEventListeners.add(t),this.eventService.addGlobalListener(t,!1)}removeGlobalListener(e){const t=this.frameworkEventWrappingService.unwrapGlobal(e);if(this.globalEventListenerPairs.has(t)){const{syncListener:n,asyncListener:i}=this.globalEventListenerPairs.get(t);this.eventService.removeGlobalListener(n,!1),this.eventService.removeGlobalListener(i,!0),this.globalEventListenerPairs.delete(e)}else this.syncGlobalEventListeners.delete(t),this.eventService.removeGlobalListener(t,!1)}destroyEventListeners(e,t){e.forEach(((e,n)=>{e.forEach((e=>this.eventService.removeEventListener(n,e,t))),e.clear()})),e.clear()}destroyGlobalListeners(e,t){e.forEach((e=>this.eventService.removeGlobalListener(e,t))),e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncEventListeners,!1),this.destroyEventListeners(this.asyncEventListeners,!0),this.destroyGlobalListeners(this.syncGlobalEventListeners,!1),this.globalEventListenerPairs.forEach((e=>{let{syncListener:t,asyncListener:n}=e;this.eventService.removeGlobalListener(t,!1),this.eventService.removeGlobalListener(n,!0)})),this.globalEventListenerPairs.clear()}},yh=class extends Vn{constructor(){super(...arguments),this.beanName="pageBoundsListener"}wireBeans(e){this.rowModel=e.rowModel,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){this.calculatePages(),this.eventService.dispatchEvent({type:"paginationChanged",animate:e?.animate??!1,newData:e?.newData??!1,newPage:e?.newPage??!1,newPageSize:e?.newPageSize??!1,keepRenderedRows:e?.keepRenderedRows??!1})}calculatePages(){this.paginationService?this.paginationService.calculatePages():this.pageBoundsService.calculateBounds(0,this.rowModel.getRowCount()-1)}},Ch=class extends Vn{constructor(){super(...arguments),this.beanName="pageBoundsService",this.pixelOffset=0}wireBeans(e){this.rowModel=e.rowModel}getFirstRow(){return this.topRowBounds?this.topRowBounds.rowIndex:-1}getLastRow(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1}getCurrentPageHeight(){return Lt(this.topRowBounds)||Lt(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)}getCurrentPagePixelRange(){return{pageFirstPixel:this.topRowBounds?this.topRowBounds.rowTop:0,pageLastPixel:this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0}}calculateBounds(e,t){this.topRowBounds=this.rowModel.getRowBounds(e),this.topRowBounds&&(this.topRowBounds.rowIndex=e),this.bottomRowBounds=this.rowModel.getRowBounds(t),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=t),this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){const e=Dt(this.topRowBounds)?this.topRowBounds.rowTop:0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventService.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},wh=class extends Vn{constructor(){super(),this.beanName="ariaAnnouncementService",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.updateAnnouncement=Pt(this.updateAnnouncement.bind(this),200)}wireBeans(e){this.eGridDiv=e.eGridDiv}postConstruct(){const e=en(this.gos),t=this.descriptionContainer=e.createElement("div");t.classList.add("ag-aria-description-container"),mr(t,"polite"),cr(t,"relevant","additions text"),function(e,t){cr(e,"atomic",t)}(t,!0),this.eGridDiv.appendChild(t)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;const e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout((()=>{this.isAlive()&&this.descriptionContainer&&(this.descriptionContainer.textContent=e)}),50)}destroy(){super.destroy();const{descriptionContainer:e}=this;e&&(Yr(e),e.parentElement&&e.parentElement.removeChild(e)),this.descriptionContainer=null,this.eGridDiv=null,this.pendingAnnouncements.clear()}},Sh=class extends Vn{constructor(){super(...arguments),this.beanName="columnAnimationService",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}wireBeans(e){this.ctrlsService=e.ctrlsService}postConstruct(){this.ctrlsService.whenReady(this,(e=>this.gridBodyCtrl=e.gridBodyCtrl))}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){this.active||this.gos.get("suppressColumnMoveAnimation")||this.gos.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush((()=>this.activeNext=!1),(()=>this.active=!1))}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push((()=>{this.animationThreadCount===e&&this.gridBodyCtrl.setColumnMovingCss(!1)}))}flush(e,t){if(0===this.executeNextFuncs.length&&0===this.executeLaterFuncs.length)return e(),void t();const n=e=>{for(;e.length;){const t=e.pop();t&&t()}};this.getFrameworkOverrides().wrapIncoming((()=>{window.setTimeout((()=>{e(),n(this.executeNextFuncs)}),0),window.setTimeout((()=>{t(),n(this.executeLaterFuncs)}),200)}))}},bh=class extends Vn{constructor(){super(...arguments),this.beanName="columnHoverService"}setMouseOver(e){this.updateState(e)}clearMouseOver(){this.updateState(null)}isHovered(e){return!!this.selectedColumns&&this.selectedColumns.indexOf(e)>=0}updateState(e){this.selectedColumns=e,this.eventService.dispatchEvent({type:"columnHoverChanged"})}},xh=class extends Vn{constructor(){super(...arguments),this.beanName="overlayService",this.state=0,this.showInitialOverlay=!0,this.wrapperPadding=0}wireBeans(e){this.userComponentFactory=e.userComponentFactory,this.rowModel=e.rowModel,this.columnModel=e.columnModel,this.ctrlsService=e.ctrlsService}postConstruct(){this.isClientSide=Vt(this.gos);const e=()=>this.updateOverlayVisibility();this.addManagedEventListeners({newColumnsLoaded:e,rowDataUpdated:e,gridSizeChanged:this.onGridSizeChanged.bind(this),rowCountReady:()=>{this.showInitialOverlay=!1,this.updateOverlayVisibility()}}),this.addManagedPropertyListener("loading",e)}setOverlayWrapperComp(e){this.overlayWrapperComp=e,this.updateOverlayVisibility()}isVisible(){return 0!==this.state&&!!this.overlayWrapperComp}isExclusive(){return 1===this.state&&!!this.overlayWrapperComp}getOverlayWrapper(){return this.overlayWrapperComp}showLoadingOverlay(){this.showInitialOverlay=!1;const e=this.gos.get("loading");(e||void 0===e&&!this.gos.get("suppressLoadingOverlay"))&&this.doShowLoadingOverlay()}showNoRowsOverlay(){this.showInitialOverlay=!1,this.gos.get("loading")||this.gos.get("suppressNoRowsOverlay")||this.doShowNoRowsOverlay()}hideOverlay(){this.showInitialOverlay=!1,this.gos.get("loading")?bt("Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead."):this.doHideOverlay()}updateOverlayVisibility(){if(!this.overlayWrapperComp)return void(this.state=0);let e=this.gos.get("loading");this.showInitialOverlay&&void 0===e&&!this.gos.get("suppressLoadingOverlay")&&(e=!this.gos.get("columnDefs")||!this.columnModel.isReady()||!this.gos.get("rowData")&&this.isClientSide),e?1!==this.state&&this.doShowLoadingOverlay():(this.showInitialOverlay=!1,this.rowModel.isEmpty()&&!this.gos.get("suppressNoRowsOverlay")&&this.isClientSide?2!==this.state&&this.doShowNoRowsOverlay():0!==this.state&&this.doHideOverlay())}doShowLoadingOverlay(){this.overlayWrapperComp&&(this.state=1,this.showOverlay(this.userComponentFactory.getLoadingOverlayCompDetails({}),"ag-overlay-loading-wrapper","loadingOverlayComponentParams"),this.updateExclusive())}doShowNoRowsOverlay(){this.overlayWrapperComp&&(this.state=2,this.showOverlay(this.userComponentFactory.getNoRowsOverlayCompDetails({}),"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams"),this.updateExclusive())}doHideOverlay(){this.overlayWrapperComp&&(this.state=0,this.overlayWrapperComp.hideOverlay(),this.updateExclusive())}showOverlay(e,t,n){const i=e.newAgStackInstance();this.overlayWrapperComp?.showOverlay(i,t,this.isExclusive(),n),this.refreshWrapperPadding()}updateExclusive(){const e=this.exclusive;this.exclusive=this.isExclusive(),this.exclusive!==e&&this.eventService.dispatchEvent({type:"overlayExclusiveChanged"})}onGridSizeChanged(){this.refreshWrapperPadding()}refreshWrapperPadding(){if(!this.overlayWrapperComp)return;let e=0;if(2===this.state){const t=this.ctrlsService.get("gridHeaderCtrl");e=t?.getHeaderHeight()||0}else 0!==this.wrapperPadding&&(e=0);this.wrapperPadding!==e&&(this.wrapperPadding=e,this.overlayWrapperComp.updateOverlayWrapperPaddingTop(e))}},_h=class extends Vn{constructor(){super(...arguments),this.beanName="rowCssClassCalculator"}wireBeans(e){this.stylingService=e.stylingService}getInitialRowClasses(e){const t=[];return Dt(e.extraCssClass)&&t.push(e.extraCssClass),t.push("ag-row"),t.push(e.rowFocused?"ag-row-focus":"ag-row-no-focus"),e.fadeRowIn&&t.push("ag-opacity-zero"),t.push(e.rowIsEven?"ag-row-even":"ag-row-odd"),e.rowNode.isRowPinned()&&t.push("ag-row-pinned"),e.rowNode.isSelected()&&t.push("ag-row-selected"),e.rowNode.footer&&t.push("ag-row-footer"),t.push("ag-row-level-"+e.rowLevel),e.rowNode.stub&&t.push("ag-row-loading"),e.fullWidthRow&&t.push("ag-full-width-row"),e.expandable&&(t.push("ag-row-group"),t.push(e.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),e.rowNode.dragging&&t.push("ag-row-dragging"),In(t,this.processClassesFromGridOptions(e.rowNode)),In(t,this.preProcessRowClassRules(e.rowNode)),t.push(e.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),e.firstRowOnPage&&t.push("ag-row-first"),e.lastRowOnPage&&t.push("ag-row-last"),e.fullWidthRow&&("left"===e.pinned&&t.push("ag-cell-last-left-pinned"),"right"===e.pinned&&t.push("ag-cell-first-right-pinned")),t}processClassesFromGridOptions(e){const t=[],n=e=>{"string"===typeof e?t.push(e):Array.isArray(e)&&e.forEach((e=>t.push(e)))},i=this.gos.get("rowClass");if(i){if("function"===typeof i)return bt("rowClass should not be a function, please use getRowClass instead"),[];n(i)}const r=this.gos.getCallback("getRowClass");if(r){n(r({data:e.data,node:e,rowIndex:e.rowIndex}))}return t}preProcessRowClassRules(e){const t=[];return this.processRowClassRules(e,(e=>{t.push(e)}),(()=>{})),t}processRowClassRules(e,t,n){const i=this.gos.addGridCommonParams({data:e.data,node:e,rowIndex:e.rowIndex});this.stylingService.processClassRules(void 0,this.gos.get("rowClassRules"),i,t,n)}calculateRowLevel(e){return e.group?e.level:e.parent?e.parent.level+1:0}},Mh=class extends Vn{constructor(){super(...arguments),this.beanName="rowContainerHeightService",this.scrollY=0,this.uiBodyHeight=0}wireBeans(e){this.ctrlsService=e.ctrlsService}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=function(){if(void 0!==or)return or;if(!document.body)return-1;let e=1e6;const t=Ar()?6e6:1e9,n=document.createElement("div");for(document.body.appendChild(n);;){const i=2*e;if(n.style.height=i+"px",i>t||n.clientHeight!==i)break;e=i}return document.body.removeChild(n),or=e,e}(),this.gos.get("debug")&&St("RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}isStretching(){return this.stretching}getDivStretchOffset(){return this.divStretchOffset}updateOffset(){if(!this.stretching)return;const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;this.gos.get("debug")&&St(`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventService.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t="number"===typeof e?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventService.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=null!=e&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getUiContainerHeight(){return this.uiContainerHeight}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=e/(this.modelHeight-this.getUiBodyHeight());return this.maxScrollY*t}},Eh=class extends Vn{constructor(){super(...arguments),this.beanName="rowNodeSorter"}wireBeans(e){this.valueService=e.valueService,this.columnModel=e.columnModel,this.showRowGroupColsService=e.showRowGroupColsService}postConstruct(){this.isAccentedSort=this.gos.get("accentedSort"),this.primaryColumnsSortGroups=ln(this.gos),this.addManagedPropertyListener("accentedSort",(e=>this.isAccentedSort=e.currentValue)),this.addManagedPropertyListener("autoGroupColumnDef",(()=>this.primaryColumnsSortGroups=ln(this.gos)))}doFullSort(e,t){const n=e.map(((e,t)=>({currentPos:t,rowNode:e})));return n.sort(this.compareRowNodes.bind(this,t)),n.map((e=>e.rowNode))}compareRowNodes(e,t,n){const i=t.rowNode,r=n.rowNode;for(let s=0,o=e.length;s<o;s++){const t=e[s],n="desc"===t.sort,o=this.getValue(i,t.column),a=this.getValue(r,t.column);let l;const c=this.getComparator(t,i);l=c?c(o,a,i,r,n):Ht(o,a,this.isAccentedSort);if(!isNaN(l)&&0!==l)return"asc"===t.sort?l:-1*l}return t.currentPos-n.currentPos}getComparator(e,t){const n=e.column,i=n.getColDef().comparator;if(null!=i)return i;if(!n.getColDef().showRowGroup)return;const r=!t.group&&n.getColDef().field;if(!r)return;const s=this.columnModel.getColDefCol(r);return s?s.getColDef().comparator:void 0}getValue(e,t){if(!this.primaryColumnsSortGroups)return this.valueService.getValue(t,e,!1,!1);if(e.rowGroupColumn===t){if(pn(this.gos,this.columnModel.isPivotActive())){const n=e.allLeafChildren?.[0];return n?this.valueService.getValue(t,n,!1,!1):void 0}const n=this.showRowGroupColsService?.getShowRowGroupCol(t.getId());if(!n)return;return e.groupData?.[n.getId()]}return e.group&&t.getColDef().showRowGroup?void 0:this.valueService.getValue(t,e,!1,!1)}},Rh=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}setInactive(){this.active=!1}isActive(){return this.active}depthFirstSearchChangedPath(e,t){if(e.children)for(let n=0;n<e.children.length;n++)this.depthFirstSearchChangedPath(e.children[n],t);t(e.rowNode)}depthFirstSearchEverything(e,t,n){if(e.childrenAfterGroup)for(let i=0;i<e.childrenAfterGroup.length;i++){const r=e.childrenAfterGroup[i];r.childrenAfterGroup?this.depthFirstSearchEverything(e.childrenAfterGroup[i],t,n):n&&t(r)}t(e)}forEachChangedNodeDepthFirst(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.active&&!n?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,n=0;for(;!this.mapToItems[t.id];){const e={rowNode:t,children:null};this.mapToItems[t.id]=e,n++,t=t.parent}return n}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let n=e;for(;n;)this.nodeIdsToColumns[n.id]||(this.nodeIdsToColumns[n.id]={}),t.forEach((e=>this.nodeIdsToColumns[n.id][e.getId()]=!0)),n=n.parent}linkPathItems(e,t){let n=e;for(let i=0;i<t;i++){const e=this.mapToItems[n.id],t=this.mapToItems[n.parent.id];t.children||(t.children=[]),t.children.push(e),n=n.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const n=this.createPathItems(e);this.linkPathItems(e,n),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const n=this.nodeIdsToColumns[e.id];return t.filter((e=>n[e.getId()]))}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const n=this.nodeIdsToColumns[e.id];return t.filter((e=>!n[e.getId()]))}},Th=class extends Vn{constructor(){super(...arguments),this.beanName="selectionService",this.selectedNodes=new Map,this.selectionCtx=new jc,this.rowSelectionMode=void 0}wireBeans(e){this.rowModel=e.rowModel,this.pageBoundsService=e.pageBoundsService}postConstruct(){const{gos:e,rowModel:t,onRowSelected:n}=this;this.selectionCtx.init(t),this.rowSelectionMode=bn(e),this.groupSelectsChildren=Mn(e),this.addManagedPropertyListeners(["groupSelectsChildren","rowSelection"],(()=>{const t=Mn(e),n=bn(e);t===this.groupSelectsChildren&&n===this.rowSelectionMode||(this.groupSelectsChildren=t,this.rowSelectionMode=n,this.deselectAllRowNodes({source:"api"}))})),this.addManagedEventListeners({rowSelected:n.bind(this)})}destroy(){super.destroy(),this.resetNodes(),this.selectionCtx.reset()}isMultiSelect(){return"multiRow"===this.rowSelectionMode}overrideSelectionValue(e,t){if(!(e=>"checkboxSelected"===e||"rowClicked"===e||"spaceKey"===e||"uiSelectAll"===e||"uiSelectAllCurrentPage"===e||"uiSelectAllFiltered"===e)(t))return e;const n=this.selectionCtx.getRoot();return!n||(n.isSelected()??!1)}setNodesSelected(e){const{newValue:t,clearSelection:n,suppressFinishActions:i,rangeSelect:r,nodes:s,event:o,source:a}=e;if(0===s.length)return 0;if(s.length>1&&!this.isMultiSelect())return bt("cannot multi select unless selection mode is 'multiRow'"),0;const l=this.groupSelectsChildren&&!0===e.groupSelectsFiltered,c=s.map((e=>e.footer?e.sibling:e));if(r){if(c.length>1)return bt("cannot range select while selecting multiple rows"),0;const e=c[0],n=this.overrideSelectionValue(t,a);if(this.isMultiSelect()){if(this.selectionCtx.isInRange(e)){const t=this.selectionCtx.truncate(e);return n&&this.selectRange(t.discard,!1,a),this.selectRange(t.keep,n,a)}if(this.selectionCtx.getRoot()!==e){const t=this.selectionCtx.extend(e,this.groupSelectsChildren);return n&&this.selectRange(t.discard,!1,a),this.selectRange(t.keep,n,a)}}else;}i||this.selectionCtx.setRoot(c[0]);let u=0;for(let h=0;h<c.length;h++){const e=c[h];if(!(l&&e.group)){e.selectThisNode(t,o,a)&&u++}this.groupSelectsChildren&&e.childrenAfterGroup?.length&&(u+=this.selectChildren(e,t,l,a))}if(!i){t&&(n||!this.isMultiSelect())&&(u+=this.clearOtherNodes(c[0],a)),u>0&&(this.updateGroupsFromChildrenSelections(a),this.dispatchSelectionChanged(a))}return u}selectRange(e,t,n){let i=0;return e.forEach((e=>{if(e.group&&this.groupSelectsChildren)return;e.selectThisNode(t,void 0,n)&&i++})),i>0&&(this.updateGroupsFromChildrenSelections(n),this.dispatchSelectionChanged(n)),i}selectChildren(e,t,n,i){const r=n?e.childrenAfterAggFilter:e.childrenAfterGroup;return Lt(r)?0:this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered:n,source:i,nodes:r})}getSelectedNodes(){const e=[];return this.selectedNodes.forEach((t=>{t&&e.push(t)})),e}getSelectedRows(){const e=[];return this.selectedNodes.forEach((t=>{t&&t.data&&e.push(t.data)})),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){const t=new Map;this.selectedNodes.forEach(((n,i)=>{n&&e(n)&&t.set(i,n)})),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsChildren)return!1;if(!Vt(this.gos))return!1;const n=this.rowModel.getRootNode();t||(t=new Rh(!0,n)).setInactive();let i=!1;return t.forEachChangedNodeDepthFirst((t=>{if(t!==n){const n=t.calculateSelectedFromChildren();i=t.selectThisNode(null!==n&&n,void 0,e)||i}})),i}clearOtherNodes(e,t){const n=new Map;let i=0;return this.selectedNodes.forEach((r=>{if(r&&r.id!==e.id){const e=this.selectedNodes.get(r.id);i+=e.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:t}),this.groupSelectsChildren&&r.parent&&n.set(r.parent.id,r.parent)}})),n.forEach((e=>{const n=e.calculateSelectedFromChildren();e.selectThisNode(null!==n&&n,void 0,t)})),i}onRowSelected(e){const t=e.node;this.groupSelectsChildren&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}syncInOldRowNode(e,t){if(Dt(t)&&e.id!==t.id&&t){const n=t.id;this.selectedNodes.get(n)==e&&this.selectedNodes.set(t.id,t)}}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.setSelectedInitialValue(!0),this.selectedNodes.set(e.id,e)):e.setSelectedInitialValue(!1)}reset(e){const t=this.getSelectionCount();this.resetNodes(),t&&this.dispatchSelectionChanged(e)}resetNodes(){this.selectedNodes?.clear()}getBestCostNodeSelection(){if(!Vt(this.gos))return;const e=this.rowModel.getTopLevelNodes();if(null===e)return;const t=[];return function e(n){for(let i=0,r=n.length;i<r;i++){const r=n[i];if(r.isSelected())t.push(r);else{const t=r;t.group&&t.children&&e(t.children)}}}(e),t}isEmpty(){let e=0;return this.selectedNodes.forEach((t=>{t&&e++})),0===e}deselectAllRowNodes(e){const t=e=>e.selectThisNode(!1,void 0,i),n=Vt(this.gos),{source:i,justFiltered:r,justCurrentPage:s}=e;if(s||r){if(!n)return void xt("selecting just filtered only works when gridOptions.rowModelType='clientSide'");this.getNodesToSelect(r,s).forEach(t)}else this.selectedNodes.forEach((e=>{e&&t(e)})),this.reset(i);this.selectionCtx.reset(),n&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(i),this.dispatchSelectionChanged(i)}getSelectedCounts(e,t){let n=0,i=0;return this.getNodesToSelect(e,t).forEach((e=>{this.groupSelectsChildren&&e.group||(e.isSelected()?n++:e.selectable&&i++)})),{selectedCount:n,notSelectedCount:i}}getSelectAllState(e,t){const{selectedCount:n,notSelectedCount:i}=this.getSelectedCounts(e,t);return(0!==n||0!==i)&&(n>0&&i>0?null:n>0)}hasNodesToSelect(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getNodesToSelect(e,t).filter((e=>e.selectable)).length>0}getNodesToSelect(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.validateSelectAllType();const n=[];if(t)return this.forEachNodeOnPage((e=>{if(e.group)if(e.expanded)this.groupSelectsChildren||n.push(e);else{const t=e=>{n.push(e),e.childrenAfterFilter?.length&&e.childrenAfterFilter.forEach(t)};t(e)}else n.push(e)})),n;const i=this.rowModel;return e?(i.forEachNodeAfterFilter((e=>{n.push(e)})),n):(i.forEachNode((e=>{n.push(e)})),n)}forEachNodeOnPage(e){const t=this.pageBoundsService.getFirstRow(),n=this.pageBoundsService.getLastRow();for(let i=t;i<=n;i++){const t=this.rowModel.getRow(i);t&&e(t)}}selectAllRowNodes(e){if("string"!==typeof this.gos.get("rowSelection")&&!xn(this.gos))return bt("cannot multi select unless selection mode is 'multiRow'");this.validateSelectAllType();const{source:t,justFiltered:n,justCurrentPage:i}=e,r=this.getNodesToSelect(n,i);r.forEach((e=>e.selectThisNode(!0,void 0,t))),this.selectionCtx.setRoot(r[0]??null),this.selectionCtx.setEndRange(Rn(r)??null),Vt(this.gos)&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(t),this.dispatchSelectionChanged(t)}getSelectionState(){const e=[];return this.selectedNodes.forEach((t=>{t?.id&&e.push(t.id)})),e.length?e:null}setSelectionState(e,t){if(!Array.isArray(e))return xt("Invalid selection state. When using client-side row model, the state must conform to `string[]`.");const n=new Set(e),i=[];this.rowModel.forEachNode((e=>{n.has(e.id)&&i.push(e)})),this.setNodesSelected({newValue:!0,nodes:i,source:t})}dispatchSelectionChanged(e){this.eventService.dispatchEvent({type:"selectionChanged",source:e})}validateSelectAllType(){if(!Vt(this.gos))throw new Error(`selectAll only available when rowModelType='clientSide', ie not ${this.rowModel.getType()}`)}},Ph=class extends Vn{constructor(){super(...arguments),this.beanName="selectableService"}wireBeans(e){this.rowModel=e.rowModel,this.selectionService=e.selectionService}postConstruct(){this.addManagedPropertyListeners(["isRowSelectable","rowSelection"],(()=>this.updateSelectable()))}updateSelectableAfterGrouping(){this.updateSelectable(!0)}updateSelectable(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{gos:t}=this,n=qt(t),i=Sn(t);if(!n||!i)return;const r=Mn(t),s=Vt(t)&&r,o=[],a=t=>{if(e&&!t.group)return;if(s&&t.group){const e=t.childrenAfterGroup.some((e=>!0===e.selectable));return void t.setRowSelectable(e,!0)}const n=i?.(t)??!0;t.setRowSelectable(n,!0),!n&&t.isSelected()&&o.push(t)};if(s){const e=this.rowModel;new Rh(!1,e.getRootNode()).forEachChangedNodeDepthFirst(a,!0,!0)}else this.rowModel.forEachNode(a);o.length&&this.selectionService.setNodesSelected({nodes:o,newValue:!1,source:"selectableChanged"}),s&&this.selectionService instanceof Th&&this.selectionService.updateGroupsFromChildrenSelections("selectableChanged")}},Ah=["asc","desc",null],Fh=class extends Vn{constructor(){super(...arguments),this.beanName="sortController"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.showRowGroupColsService=e.showRowGroupColsService}progressSort(e,t,n){const i=this.getNextSortDirection(e);this.setSortForColumn(e,i,t,n)}setSortForColumn(e,t,n,i){"asc"!==t&&"desc"!==t&&(t=null);let r=[e];if(ln(this.gos)&&e.getColDef().showRowGroup){const t=this.funcColsService.getSourceColumnsForGroupColumn(e),n=t?.filter((e=>e.isSortable()));n&&(r=[e,...n])}r.forEach((e=>e.setSort(t,i)));const s=[];if(!((n||this.gos.get("alwaysMultiSort"))&&!this.gos.get("suppressMultiSort"))){const e=this.clearSortBarTheseColumns(r,i);s.push(...e)}this.updateSortIndex(e),s.push(...r),this.dispatchSortChangedEvents(i,s)}updateSortIndex(e){const t=ln(this.gos),n=this.showRowGroupColsService?.getShowRowGroupCol(e.getId()),i=t&&n||e,r=this.getColumnsWithSortingOrdered();this.columnModel.getAllCols().forEach((e=>e.setSortIndex(null)));const s=r.filter((e=>(!t||!e.getColDef().showRowGroup)&&e!==i));(i.getSort()?[...s,i]:s).forEach(((e,t)=>{e.setSortIndex(t)}))}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){const e=this.columnModel.getAllCols().filter((e=>!!e.getSort()));return e&&e.length>0}dispatchSortChangedEvents(e,t){const n={type:"sortChanged",source:e};t&&(n.columns=t),this.eventService.dispatchEvent(n)}clearSortBarTheseColumns(e,t){const n=[];return this.columnModel.getAllCols().forEach((i=>{e.includes(i)||(i.getSort()&&n.push(i),i.setSort(void 0,t))})),n}getNextSortDirection(e){let t;if(t=e.getColDef().sortingOrder?e.getColDef().sortingOrder:this.gos.get("sortingOrder")?this.gos.get("sortingOrder"):Ah,!Array.isArray(t)||t.length<=0)return bt(`sortingOrder must be an array with at least one element, currently it's ${t}`),null;const n=t.indexOf(e.getSort()),i=n<0,r=n==t.length-1;let s;return s=i||r?t[0]:t[n+1],Ah.indexOf(s)<0?(bt("invalid sort type ",s),null):s}getIndexedSortMap(){let e=this.columnModel.getAllCols().filter((e=>!!e.getSort()));if(this.columnModel.isPivotMode()){const t=ln(this.gos);e=e.filter((e=>{const n=!!e.getAggFunc(),i=!e.isPrimary(),r=t?this.showRowGroupColsService?.getShowRowGroupCol(e.getId()):e.getColDef().showRowGroup;return n||i||r}))}const t=this.funcColsService.getRowGroupColumns().filter((e=>!!e.getSort())),n={};e.forEach(((e,t)=>n[e.getId()]=t)),e.sort(((e,t)=>{const i=e.getSortIndex(),r=t.getSortIndex();if(null!=i&&null!=r)return i-r;if(null==i&&null==r){return n[e.getId()]>n[t.getId()]?1:-1}return null==r?-1:1}));const i=ln(this.gos)&&!!t.length;i&&(e=[...new Set(e.map((e=>this.showRowGroupColsService?.getShowRowGroupCol(e.getId())??e)))]);const r=new Map;return e.forEach(((e,t)=>r.set(e,t))),i&&t.forEach((e=>{const t=this.showRowGroupColsService.getShowRowGroupCol(e.getId());r.set(e,r.get(t))})),r}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(((e,t)=>{let[n,i]=e,[r,s]=t;return i-s})).map((e=>{let[t]=e;return t}))}getSortModel(){return this.getColumnsWithSortingOrdered().filter((e=>e.getSort())).map((e=>({sort:e.getSort(),colId:e.getId()})))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter((e=>e.getSort())).map((e=>({sort:e.getSort(),column:e})))}canColumnDisplayMixedSort(e){const t=ln(this.gos),n=!!e.getColDef().showRowGroup;return t&&n}getDisplaySortForColumn(e){const t=this.funcColsService.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!t?.length)return e.getSort();const n=null!=e.getColDef().field||!!e.getColDef().valueGetter?[e,...t]:t,i=n[0].getSort();return n.every((e=>e.getSort()==i))?i:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}},Dh=class extends Vn{constructor(){super(...arguments),this.beanName="syncService",this.waitingForColumns=!1}wireBeans(e){this.ctrlsService=e.ctrlsService,this.columnModel=e.columnModel,this.rowModel=e.rowModel}postConstruct(){this.addManagedPropertyListener("columnDefs",(e=>this.setColumnDefs(e)))}start(){this.ctrlsService.whenReady(this,(()=>{const e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()}))}setColumnsAndData(e){this.columnModel.setColumnDefs(e??[],"gridInitializing"),this.rowModel.start()}gridReady(){this.eventService.dispatchEvent({type:"gridReady"});const e=this.gos.isModuleRegistered("@ag-grid-enterprise/core");this.gos.get("debug")&&St(`initialised successfully, enterprise = ${e}`)}setColumnDefs(e){const t=this.gos.get("columnDefs");if(t)return this.waitingForColumns?(this.waitingForColumns=!1,void this.setColumnsAndData(t)):void this.columnModel.setColumnDefs(t,wi(e.source))}},Lh=class extends Vn{constructor(){super(...arguments),this.beanName="changeDetectionService"}wireBeans(e){this.rowModel=e.rowModel,this.rowRenderer=e.rowRenderer}postConstruct(){Vt(this.gos)&&(this.clientSideRowModel=this.rowModel),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){"paste"!==e.source&&this.doChangeDetection(e.node,e.column)}doChangeDetection(e,t){if(this.gos.get("suppressChangeDetection"))return;const n=[e];if(this.clientSideRowModel&&!e.isRowPinned()){const i=this.gos.get("aggregateOnlyChangedColumns"),r=new Rh(i,this.clientSideRowModel.getRootNode());r.addParentNode(e.parent,[t]),this.clientSideRowModel.doAggregate(r),r.forEachChangedNodeDepthFirst((e=>{n.push(e)}))}this.rowRenderer.refreshCells({rowNodes:n})}},Ih=class extends Vn{constructor(){super(...arguments),this.beanName="expressionService",this.expressionToFunctionCache={}}evaluate(e,t){if("string"===typeof e)return this.evaluateExpression(e,t);xt("value should be either a string or a function",e)}evaluateExpression(e,t){try{const n=this.createExpressionFunction(e);return n(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(zD){return St("Processing of the expression failed"),St("Expression = ",e),St("Params = ",t),St("Exception = ",zD),null}}createExpressionFunction(e){if(this.expressionToFunctionCache[e])return this.expressionToFunctionCache[e];const t=this.createFunctionBody(e),n=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",t);return this.expressionToFunctionCache[e]=n,n}createFunctionBody(e){return e.indexOf("return")>=0?e:"return "+e+";"}},kh=class extends Vn{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){this.active=this.gos.get("valueCache"),this.neverExpires=this.gos.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,n){this.active&&(e.__cacheVersion!==this.cacheVersion&&(e.__cacheVersion=this.cacheVersion,e.__cacheData={}),e.__cacheData[t]=n)}getValue(e,t){if(this.active&&e.__cacheVersion===this.cacheVersion)return e.__cacheData[t]}},Oh=class extends Vn{constructor(){super(...arguments),this.beanName="valueService",this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionService=e.expressionService,this.columnModel=e.columnModel,this.valueCache=e.valueCache,this.dataTypeService=e.dataTypeService}postConstruct(){this.initialised||this.init()}init(){this.isSsrm=Wt(this.gos),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;const e=e=>this.callColumnCellValueChangedHandler(e),t=Xt(this.gos);this.eventService.addEventListener("cellValueChanged",e,t),this.addDestroyFunc((()=>this.eventService.removeEventListener("cellValueChanged",e,t))),this.addManagedPropertyListener("treeData",(e=>this.isTreeData=e.currentValue))}getValueForDisplay(e,t){const n=t.leafGroup&&this.columnModel.isPivotMode(),i=t.group&&t.expanded&&!t.footer&&!n,r=this.gos.get("groupSuppressBlankHeader");if(!i||r)return this.getValue(e,t);let s=!1;const o=this.gos.get("groupTotalRow")??this.gos.get("groupIncludeFooter");if("function"!==typeof o)s=!!o;else{s=!!(this.gos.getCallback("groupTotalRow")??this.gos.getCallback("groupIncludeFooter"))({node:this})}const a=i&&s;return this.getValue(e,t,!1,a)}getValue(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.initialised||this.init(),!t)return;const r=e.getColDef(),s=r.field,o=e.getColId(),a=t.data;let l;const c=t.groupData&&void 0!==t.groupData[o],u=!i&&t.aggData&&void 0!==t.aggData[o],h=this.isSsrm&&i&&!!e.getColDef().aggFunc,d=this.isSsrm&&t.footer&&t.field&&(!0===e.getColDef().showRowGroup||e.getColDef().showRowGroup===t.field);if(n&&r.filterValueGetter?l=this.executeFilterValueGetter(r.filterValueGetter,a,e,t):this.isTreeData&&u?l=t.aggData[o]:this.isTreeData&&r.valueGetter?l=this.executeValueGetter(r.valueGetter,a,e,t):this.isTreeData&&s&&a?l=li(a,s,e.isFieldContainsDots()):c?l=t.groupData[o]:u?l=t.aggData[o]:r.valueGetter?l=this.executeValueGetter(r.valueGetter,a,e,t):d?l=li(a,t.field,e.isFieldContainsDots()):s&&a&&!h&&(l=li(a,s,e.isFieldContainsDots())),this.cellExpressions&&"string"===typeof l&&0===l.indexOf("=")){const n=l.substring(1);l=this.executeValueGetter(n,a,e,t)}if(null==l){const n=this.getOpenedGroup(t,e);if(null!=n)return n}return l}parseValue(e,t,n,i){const r=e.getColDef(),s=r.valueParser;if(Dt(s)){const o=this.gos.addGridCommonParams({node:t,data:t?.data,oldValue:i,newValue:n,colDef:r,column:e});return"function"===typeof s?s(o):this.expressionService.evaluate(s,o)}return n}getDeleteValue(e,t){return Dt(e.getColDef().valueParser)?this.parseValue(e,t,"",this.getValueForDisplay(e,t))??null:null}formatValue(e,t,n,i){let r,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=null;const a=e.getColDef();if(i?r=i:s&&(r=a.valueFormatter),r){const i=this.gos.addGridCommonParams({value:n,node:t,data:t?t.data:null,colDef:a,column:e});o="function"===typeof r?r(i):this.expressionService.evaluate(r,i)}else if(a.refData)return a.refData[n]||"";return null==o&&Array.isArray(n)&&(o=n.join(", ")),o}getOpenedGroup(e,t){if(!this.gos.get("showOpenedGroup"))return;if(!t.getColDef().showRowGroup)return;const n=t.getColDef().showRowGroup;let i=e.parent;for(;null!=i;){if(i.rowGroupColumn&&(!0===n||n===i.rowGroupColumn.getColId()))return i.key;i=i.parent}}setValue(e,t,n,i){const r=this.columnModel.getColDefCol(t);if(!e||!r)return!1;Lt(e.data)&&(e.data={});const{field:s,valueSetter:o}=r.getColDef();if(Lt(s)&&Lt(o))return bt("you need either field or valueSetter set on colDef for editing to work"),!1;if(this.dataTypeService&&!this.dataTypeService.checkType(r,n))return bt("Data type of the new value does not match the cell data type of the column"),!1;const a=this.gos.addGridCommonParams({node:e,data:e.data,oldValue:this.getValue(r,e),newValue:n,colDef:r.getColDef(),column:r});let l;if(a.newValue=n,l=Dt(o)?"function"===typeof o?o(a):this.expressionService.evaluate(o,a):this.setValueUsingField(e.data,s,n,r.isFieldContainsDots()),void 0===l&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),this.valueCache.onDataChanged();const c=this.getValue(r,e);return this.eventService.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:a.column,colDef:a.colDef,data:e.data,node:e,oldValue:a.oldValue,newValue:c,value:c,source:i}),!0}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;"function"===typeof t&&this.getFrameworkOverrides().wrapOutgoing((()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})}))}setValueUsingField(e,t,n,i){if(!t)return!1;let r=!1;if(i){const i=t.split(".");let s=e;for(;i.length>0&&s;){const e=i.shift();0===i.length?(r=s[e]===n,r||(s[e]=n)):s=s[e]}}else r=e[t]===n,r||(e[t]=n);return!r}executeFilterValueGetter(e,t,n,i){const r=this.gos.addGridCommonParams({data:t,node:i,column:n,colDef:n.getColDef(),getValue:this.getValueCallback.bind(this,i)});return"function"===typeof e?e(r):this.expressionService.evaluate(e,r)}executeValueGetter(e,t,n,i){const r=n.getColId(),s=this.valueCache.getValue(i,r);if(void 0!==s)return s;const o=this.gos.addGridCommonParams({data:t,node:i,column:n,colDef:n.getColDef(),getValue:this.getValueCallback.bind(this,i)});let a;return a="function"===typeof e?e(o):this.expressionService.evaluate(e,o),this.valueCache.setValue(i,r,a),a}getValueCallback(e,t){const n=this.columnModel.getColDefCol(t);return n?this.getValue(n,e):null}getKeyForNode(e,t){const n=this.getValue(e,t),i=e.getColDef().keyCreator;let r=n;if(i){r=i(this.gos.addGridCommonParams({value:n,colDef:e.getColDef(),column:e,node:t,data:t.data}))}return"string"===typeof r||null==r||(r=String(r),"[object Object]"===r&&bt("a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")),r}},Nh=class e{static applyGlobalGridOptions(t){if(!e.gridOptions)return t;let n={};return ai(n,e.gridOptions,!0,!0),"deep"===e.mergeStrategy?ai(n,t,!0,!0):n={...n,...t},e.gridOptions.context&&(n.context=e.gridOptions.context),t.context&&("deep"===e.mergeStrategy&&n.context&&ai(t.context,n.context,!0,!0),n.context=t.context),n}};Nh.gridOptions=void 0,Nh.mergeStrategy="shallow";var Bh=Nh;var zh=1,Hh=class{create(e,t,n,i,r){const s=function(e){const t={};return Object.entries(e).forEach((e=>{let[n,i]=e;const r=dh(n,i);t[n]=r})),t}(Bh.applyGlobalGridOptions(t)),o=s.gridId??String(zh++),a=this.getRegisteredModules(r,o),l=this.createBeansList(s.rowModelType,a,o),c=this.createProvidedBeans(e,s,r);if(!l)return void xt("Failed to create grid.");const u=new So({providedBeanInstances:c,beanClasses:l,gridId:o,beanInitComparator:vu,beanDestroyComparator:yu,derivedBeans:[lu]});return this.registerModuleUserComponents(u,a),this.registerControllers(u,a),this.registerModuleApiFunctions(u,a),n(u),u.getBean("syncService").start(),i&&i(u),u.getBean("gridApi")}registerControllers(e,t){const n=e.getBean("ctrlsFactory");t.forEach((e=>{e.controllers&&e.controllers.forEach((e=>n.register(e)))}))}getRegisteredModules(e,t){const n=e?e.modules:null,i=Co.__getRegisteredModules(t),r=[],s={},o=(e,t,n)=>{var i;s[(i=t).moduleName]||(s[i.moduleName]=!0,r.push(i),Co.__register(i,e,n)),t.dependantModules&&t.dependantModules.forEach((t=>o(e,t,n)))};return o(!!n?.length||!Co.__isPackageBased(),lh,void 0),n&&n.forEach((e=>o(!0,e,t))),i&&i.forEach((e=>o(!Co.__isPackageBased(),e,void 0))),r}registerModuleUserComponents(e,t){const n=this.extractModuleEntity(t,(e=>e.userComponents?e.userComponents:[])),i=e.getBean("userComponentRegistry");n.forEach((e=>{let{name:t,classImp:n,params:r}=e;i.registerDefaultComponent(t,n,r)}))}registerModuleApiFunctions(e,t){const n=e.getBean("apiFunctionService");t.forEach((e=>{const t=e.apiFunctions;if(t){Object.keys(t).forEach((e=>{n?.addFunction(e,t[e])}))}}))}createProvidedBeans(e,t,n){let i=n?n.frameworkOverrides:null;Lt(i)&&(i=new eu);const r={gridOptions:t,eGridDiv:e,globalEventListener:n?n.globalEventListener:null,globalSyncEventListener:n?n.globalSyncEventListener:null,frameworkOverrides:i};return n&&n.providedBeanInstances&&Object.assign(r,n.providedBeanInstances),r}createBeansList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"clientSide",t=arguments.length>2?arguments[2]:void 0;const n=(arguments.length>1?arguments[1]:void 0).filter((t=>!t.rowModel||t.rowModel===e)),i={clientSide:"@ag-grid-community/client-side-row-model",infinite:"@ag-grid-community/infinite-row-model",serverSide:"@ag-grid-enterprise/server-side-row-model",viewport:"@ag-grid-enterprise/viewport-row-model"};if(!i[e])return void xt("Could not find row model for rowModelType = ",e);if(!Co.__assertRegistered(i[e],`rowModelType = '${e}'`,t))return;const r=[xu,Su,fh,ch,au,qs,gu,fu,fc,mo,Mh,pc,mh,Gc,Eo,Hi,Au,gh,Jc,Th,Ci,Za,Ch,yh,zc,Ih,vi,dc,kh,Oh,Nc,gc,xo,Du,hc,Ru,tu,qc,lc,Fh,bh,Sh,Ph,Lh,mc,cu,_h,Eh,wu,Lu,bu,Cu,Dh,xh,vc,vh,wh,yc,Ei,uu,Ti,_i,hu,du,ki,Mi,Li,pu,Ii,Xn],s=this.extractModuleEntity(n,(e=>e.beans?e.beans:[]));r.push(...s);const o=[];return r.forEach((e=>{o.indexOf(e)<0&&o.push(e)})),o}extractModuleEntity(e,t){return[].concat(...e.map(t))}},Gh=class extends Vn{constructor(){super(...arguments),this.beanName="rowModelHelperService"}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){const e=this.rowModel;switch(e.getType()){case"clientSide":this.clientSideRowModel=e;break;case"infinite":this.infiniteRowModel=e;break;case"serverSide":this.serverSideRowModel=e}}getClientSideRowModel(){return this.clientSideRowModel}getInfiniteRowModel(){return this.infiniteRowModel}getServerSideRowModel(){return this.serverSideRowModel}};var Uh={version:Da,moduleName:"@ag-grid-community/csrm-ssrm-shared-api",apiFunctions:{expandAll:function(e){e.expansionService.expandAll(!0)},collapseAll:function(e){e.expansionService.expandAll(!1)},onRowHeightChanged:function(e){const t=e.rowModelHelperService?.getClientSideRowModel(),n=e.rowModelHelperService?.getServerSideRowModel();t?t.onRowHeightChanged():n&&n.onRowHeightChanged()}}},Vh={version:Da,moduleName:"@ag-grid-community/ssrm-infinite-shared-api",apiFunctions:{setRowCount:function(e,t,n){const i=e.rowModelHelperService?.getServerSideRowModel();if(i)return e.funcColsService.isRowGroupEmpty()?void i.setRowCount(t,n):void xt("setRowCount cannot be used while using row grouping.");const r=e.rowModelHelperService?.getInfiniteRowModel();r&&r.setRowCount(t,n)},getCacheBlockState:function(e){return e.rowNodeBlockLoader?.getBlockState()??{}},isLastRowIndexKnown:function(e){return e.rowModel.isLastRowIndexKnown()}}},Wh=class{wrap(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0;const r=this.createWrapper(e,i);return t.forEach((e=>{this.createMethod(r,e,!0)})),n.forEach((e=>{this.createMethod(r,e,!1)})),r}createMethod(e,t,n){e.addMethod(t,this.createMethodProxy(e,t,n))}createMethodProxy(e,t,n){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(n&&bt("Framework component is missing the method "+t+"()"),null)}}},jh=class{};jh.CHART_TYPE_TO_SERIES_TYPE={column:"bar",groupedColumn:"bar",stackedColumn:"bar",normalizedColumn:"bar",bar:"bar",groupedBar:"bar",stackedBar:"bar",normalizedBar:"bar",line:"line",scatter:"scatter",bubble:"bubble",pie:"pie",donut:"donut",doughnut:"donut",area:"area",stackedArea:"area",normalizedArea:"area",histogram:"histogram",radarLine:"radar-line",radarArea:"radar-area",nightingale:"nightingale",radialColumn:"radial-column",radialBar:"radial-bar",sunburst:"sunburst",rangeBar:"range-bar",rangeArea:"range-area",boxPlot:"box-plot",treemap:"treemap",heatmap:"heatmap",waterfall:"waterfall"},jh.COMBO_CHART_TYPES=["columnLineCombo","areaColumnCombo","customCombo"],jh.SERIES_GROUP_TYPES=["grouped","stacked","normalized"];var qh="undefined"===typeof global?{}:global;qh.HTMLElement="undefined"===typeof HTMLElement?{}:HTMLElement,qh.HTMLButtonElement="undefined"===typeof HTMLButtonElement?{}:HTMLButtonElement,qh.HTMLSelectElement="undefined"===typeof HTMLSelectElement?{}:HTMLSelectElement,qh.HTMLInputElement="undefined"===typeof HTMLInputElement?{}:HTMLInputElement,qh.Node="undefined"===typeof Node?{}:Node,qh.MouseEvent="undefined"===typeof MouseEvent?{}:MouseEvent;var Xh=class{constructor(e,t,n,i,r,s){this.nextId=0,this.rowCountReady=!1,this.allNodesMap={},this.rootNode=e,this.gos=t,this.eventService=n,this.funcColsService=i,this.beans=s,this.selectionService=r,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id="ROOT_NODE_ID",this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[]}getCopyOfNodesMap(){return ri(this.allNodesMap)}getRowNode(e){return this.allNodesMap[e]}setRowData(e){if("string"===typeof e)return void bt("rowData must be an array.");this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(e);const t=this.rootNode,n=this.rootNode.sibling;t.childrenAfterFilter=null,t.childrenAfterGroup=null,t.childrenAfterAggFilter=null,t.childrenAfterSort=null,t.childrenMapped=null,t.updateHasChildren(),this.nextId=0,this.allNodesMap={},e?t.allLeafChildren=e.map(((e,t)=>this.createNode(e,this.rootNode,0,t))):(t.allLeafChildren=[],t.childrenAfterGroup=[]),n&&(n.childrenAfterFilter=t.childrenAfterFilter,n.childrenAfterGroup=t.childrenAfterGroup,n.childrenAfterAggFilter=t.childrenAfterAggFilter,n.childrenAfterSort=t.childrenAfterSort,n.childrenMapped=t.childrenMapped,n.allLeafChildren=t.allLeafChildren)}updateRowData(e){this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(e.add);const t={rowNodeTransaction:{remove:[],update:[],add:[]},rowsInserted:!1},n=[];return this.executeRemove(e,t,n),this.executeUpdate(e,t,n),this.executeAdd(e,t),this.updateSelection(n,"rowDataChanged"),t}updateRowOrderFromRowData(e){const t=this.rootNode.allLeafChildren,n=t?.length??0,i=new Map;let r=-1,s=-1;for(let o=0;o<n;++o){const n=t[o],a=n.data;a!==e[o]&&(s<0&&(r=o),s=o,i.set(a,n))}if(r<0)return!1;for(let o=r;o<=s;++o){const n=i.get(e[o]);void 0!==n&&(t[o]=n,n.sourceRowIndex=o)}return!0}isRowCountReady(){return this.rowCountReady}dispatchRowDataUpdateStartedEvent(e){this.eventService.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:e?.length?e[0]:null})}updateSelection(e,t){const n=e.length>0;n&&this.selectionService.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),this.selectionService.updateGroupsFromChildrenSelections(t),n&&this.eventService.dispatchEvent({type:"selectionChanged",source:t})}executeAdd(e,t){const n=e.add;if(It(n))return;const i=this.rootNode.allLeafChildren;let r=i.length;if("number"===typeof e.addIndex&&(r=this.sanitizeAddIndex(e.addIndex),r>0)){if(this.gos.get("treeData"))for(let e=0;e<i.length;e++){const t=i[e];if(t?.rowIndex==r-1){r=e+1;break}}}const s=n.map(((e,t)=>this.createNode(e,this.rootNode,0,r+t)));if(r<i.length){const e=i.slice(0,r),n=i.slice(r,i.length),o=e.length+s.length;for(let t=0,i=n.length;t<i;++t)n[t].sourceRowIndex=o+t;this.rootNode.allLeafChildren=[...e,...s,...n],t.rowsInserted=!0}else this.rootNode.allLeafChildren=i.concat(s);const o=this.rootNode.sibling;o&&(o.allLeafChildren=i),t.rowNodeTransaction.add=s}sanitizeAddIndex(e){const t=this.rootNode.allLeafChildren?.length??0;return e<0||e>=t||Number.isNaN(e)?t:Math.ceil(e)}executeRemove(e,t,n){let{rowNodeTransaction:i}=t;const{remove:r}=e;if(It(r))return;const s={};r.forEach((e=>{const t=this.lookupRowNode(e);t&&(t.isSelected()&&n.push(t),t.clearRowTopAndRowIndex(),s[t.id]=!0,delete this.allNodesMap[t.id],i.remove.push(t))})),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren?.filter((e=>!s[e.id]))??null,this.rootNode.allLeafChildren?.forEach(((e,t)=>{e.sourceRowIndex=t}));const o=this.rootNode.sibling;o&&(o.allLeafChildren=this.rootNode.allLeafChildren)}executeUpdate(e,t,n){let{rowNodeTransaction:i}=t;const{update:r}=e;It(r)||r.forEach((e=>{const t=this.lookupRowNode(e);t&&(t.updateData(e),!t.selectable&&t.isSelected()&&n.push(t),this.setMasterForRow(t,e,0,!1),i.update.push(t))}))}lookupRowNode(e){const t=gn(this.gos);let n;if(t){const i=t({data:e,level:0});if(n=this.allNodesMap[i],!n)return xt(`could not find row id=${i}, data item was not found for this id`),null}else if(n=this.rootNode.allLeafChildren?.find((t=>t.data===e)),!n)return xt("could not find data item as object was not found",e),xt("Consider using getRowId to help the Grid find matching row data"),null;return n||null}createNode(e,t,n,i){const r=new Lo(this.beans);return r.sourceRowIndex=i,r.group=!1,this.setMasterForRow(r,e,n,!0),t&&(r.parent=t),r.level=n,r.setDataAndId(e,this.nextId.toString()),this.allNodesMap[r.id]&&bt(`duplicate node id '${r.id}' detected from getRowId callback, this could cause issues in your grid.`),this.allNodesMap[r.id]=r,this.nextId++,r}setMasterForRow(e,t,n,i){if(this.gos.get("treeData"))e.setMaster(!1),i&&(e.expanded=!1);else{if(this.gos.get("masterDetail")){const n=this.gos.get("isRowMaster");n?e.setMaster(n(t)):e.setMaster(!0)}else e.setMaster(!1);if(i){const t=this.funcColsService.getRowGroupColumns(),i=n+(t?t.length:0);e.expanded=!!e.master&&this.isExpanded(i)}}}isExpanded(e){const t=this.gos.get("groupDefaultExpanded");return-1===t||e<t}};var Kh="32.3.3",$h={version:Kh,moduleName:"@ag-grid-community/client-side-row-model-core",rowModel:"clientSide",beans:[class extends Vn{constructor(){super(...arguments),this.beanName="rowModel",this.onRowHeightChanged_debounced=Pt(this.onRowHeightChanged.bind(this),100),this.rowsToDisplay=[],this.hasStarted=!1,this.shouldSkipSettingDataOnStart=!1,this.isRefreshingModel=!1,this.rowCountReady=!1}wireBeans(e){this.beans=e,this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.selectionService=e.selectionService,this.valueCache=e.valueCache,this.environment=e.environment,this.filterStage=e.filterStage,this.sortStage=e.sortStage,this.flattenStage=e.flattenStage,this.groupStage=e.groupStage,this.aggregationStage=e.aggregationStage,this.pivotStage=e.pivotStage,this.filterAggregatesStage=e.filterAggregatesStage}postConstruct(){const e=this.refreshModel.bind(this,{step:"group"}),t=!this.gos.get("suppressAnimationFrame"),n=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:t});this.addManagedEventListeners({newColumnsLoaded:n,columnRowGroupChanged:e,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:this.refreshModel.bind(this,{step:"pivot"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),columnPivotModeChanged:e,gridStylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this)}),this.addPropertyListeners(),this.rootNode=new Lo(this.beans),this.nodeManager=new Xh(this.rootNode,this.gos,this.eventService,this.funcColsService,this.selectionService,this.beans)}addPropertyListeners(){const e=new Set(["treeData","masterDetail"]),t=new Set(["groupDefaultExpanded","groupAllowUnbalanced","initialGroupOrderComparator","groupHideOpenParents","groupDisplayType"]),n=new Set(["excludeChildrenWhenTreeDataFiltering"]),i=new Set(["removePivotHeaderRowWhenSingleValueColumn","pivotRowTotals","pivotColumnGroupTotals","suppressExpandablePivotGroups"]),r=new Set(["getGroupRowAgg","alwaysAggregateAtRootLevel","groupIncludeTotalFooter","suppressAggFilteredOnly","grandTotalRow"]),s=new Set(["postSortRows","groupDisplayType","accentedSort"]),o=new Set([]),a=new Set(["groupRemoveSingleChildren","groupRemoveLowestSingleChildren","groupIncludeFooter","groupTotalRow"]),l=[...e,...t,...n,...i,...i,...r,...s,...o,...a];this.addManagedPropertyListeners(l,(l=>{const c=l.changeSet?.properties;if(!c)return;const u=e=>c.some((t=>e.has(t)));u(e)?this.setRowData(this.rootNode.allLeafChildren.map((e=>e.data))):u(t)?this.refreshModel({step:"group"}):u(n)?this.refreshModel({step:"filter"}):u(i)?this.refreshModel({step:"pivot"}):u(r)?this.refreshModel({step:"aggregate"}):u(s)?this.refreshModel({step:"sort"}):u(o)?this.refreshModel({step:"filter_aggregates"}):u(a)&&this.refreshModel({step:"map"})})),this.addManagedPropertyListener("rowHeight",(()=>this.resetRowHeights()))}start(){this.hasStarted=!0,this.shouldSkipSettingDataOnStart?this.dispatchUpdateEventsAndRefresh():this.setInitialData()}setInitialData(){const e=this.gos.get("rowData");e&&(this.shouldSkipSettingDataOnStart=!0,this.setRowData(e))}ensureRowHeightsValid(e,t,n,i){let r,s=!1;do{r=!1;const o=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(o,n),c=Math.min(a,i);for(let e=l;e<=c;e++){const t=this.getRow(e);if(t.rowHeightEstimated){const e=$t(this.gos,t);t.setRowHeight(e.height),r=!0,s=!0}}r&&this.setRowTopAndRowIndex()}while(r);return s}setRowTopAndRowIndex(){const e=this.environment.getDefaultRowHeight();let t=0;const n=new Set,i=jt(this.gos,"normal");for(let r=0;r<this.rowsToDisplay.length;r++){const s=this.rowsToDisplay[r];if(null!=s.id&&n.add(s.id),null==s.rowHeight){const t=$t(this.gos,s,i,e);s.setRowHeight(t.height,t.estimated)}s.setRowTop(t),s.setRowIndex(r),t+=s.rowHeight}return n}clearRowTopAndRowIndex(e,t){const n=e.isActive(),i=e=>{e&&null!=e.id&&!t.has(e.id)&&e.clearRowTopAndRowIndex()},r=e=>{if(i(e),i(e.detailNode),i(e.sibling),e.hasChildren()&&e.childrenAfterGroup){const t=-1==e.level;n&&!t&&!e.expanded||e.childrenAfterGroup.forEach(r)}};r(this.rootNode)}ensureRowsAtPixel(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=this.getRowIndexAtPixel(t),r=this.getRow(i),s=!this.gos.get("suppressAnimationFrame");if(r===e[0])return!1;const o=this.rootNode.allLeafChildren;return e.forEach((e=>{An(o,e)})),e.forEach(((e,t)=>{Fn(o,e,Math.max(i+n,0)+t)})),e.forEach(((e,t)=>{e.sourceRowIndex=t})),this.refreshModel({step:"group",keepRenderedRows:!0,keepEditingRows:!0,animate:s,rowNodesOrderChanged:!0}),!0}highlightRowAtPixel(e,t){const n=null!=t?this.getRowIndexAtPixel(t):null,i=null!=n?this.getRow(n):null;if(!i||!e||null==t)return void this.clearHighlightedRow();const r=this.getHighlightPosition(t,i),s=this.isHighlightingCurrentPosition(e,i,r),o=null!=this.lastHighlightedRow&&this.lastHighlightedRow!==i;(s||o)&&(this.clearHighlightedRow(),s)||(i.setHighlighted(r),this.lastHighlightedRow=i)}getHighlightPosition(e,t){if(!t){const n=this.getRowIndexAtPixel(e);if(!(t=this.getRow(n||0)))return 1}const{rowTop:n,rowHeight:i}=t;return e-n<i/2?0:1}getLastHighlightedRowNode(){return this.lastHighlightedRow}isHighlightingCurrentPosition(e,t,n){if(e===t)return!0;const i=0===n?-1:1;return this.getRow(t.rowIndex+i)===e}clearHighlightedRow(){this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){if(0===this.rowsToDisplay.length)return 0;if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;const e=this.rootNode.childrenAfterAggFilter,t=this.rootNode.sibling?1:0;return(e?e.length:0)+t}getTopLevelRowDisplayedIndex(e){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return e;let t=e;if(this.rowsToDisplay[0].footer){if(0===e)return 0;t-=1}const n=this.rowsToDisplay[this.rowsToDisplay.length-1],i=t>=this.rootNode.childrenAfterSort.length;if(n.footer&&i)return n.rowIndex;let r=this.rootNode.childrenAfterSort[t];if(this.gos.get("groupHideOpenParents"))for(;r.expanded&&r.childrenAfterSort&&r.childrenAfterSort.length>0;)r=r.childrenAfterSort[0];return r.rowIndex}getRowBounds(e){if(Lt(this.rowsToDisplay))return null;const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){const e=on(this.gos);this.refreshModel({step:"map",keepRenderedRows:!0,animate:e})}onFilterChanged(e){if(e.afterDataChange)return;const t=on(this.gos),n=0===e.columns.length||e.columns.some((e=>e.isPrimary()))?"filter":"filter_aggregates";this.refreshModel({step:n,keepRenderedRows:!0,animate:t})}onSortChanged(){const e=on(this.gos);this.refreshModel({step:"sort",keepRenderedRows:!0,animate:e,keepEditingRows:!0})}getType(){return"clientSide"}onValueChanged(){this.columnModel.isPivotActive()?this.refreshModel({step:"pivot"}):this.refreshModel({step:"aggregate"})}createChangePath(e){const t=It(e),n=new Rh(!1,this.rootNode);return t&&n.setInactive(),n}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;if(null==e.rowNodeTransactions)return!1;const t=e.rowNodeTransactions.filter((e=>null!=e.add&&e.add.length>0||null!=e.remove&&e.remove.length>0));return null==t||0==t.length}buildRefreshModelParams(e){let t="group";const n={everything:"group",group:"group",filter:"filter",map:"map",aggregate:"aggregate",filter_aggregates:"filter_aggregates",sort:"sort",pivot:"pivot",nothing:"nothing"};if(Dt(e)&&(t=n[e]),Lt(t))return void xt(`invalid step ${e}, available steps are ${Object.keys(n).join(", ")}`);return{step:t,keepRenderedRows:!0,keepEditingRows:!0,animate:!this.gos.get("suppressAnimationFrame")}}refreshModel(e){if(!this.hasStarted||this.isRefreshingModel||this.columnModel.isChangeEventsDispatching())return;const t="object"===typeof e&&"step"in e?e:this.buildRefreshModelParams(e);if(!t)return;if(this.isSuppressModelUpdateAfterUpdateTransaction(t))return;const n=this.createChangePath(t.rowNodeTransactions);switch(this.isRefreshingModel=!0,t.step){case"group":this.doRowGrouping(t.rowNodeTransactions,n,!!t.rowNodesOrderChanged,!!t.afterColumnsChanged);case"filter":this.doFilter(n);case"pivot":this.doPivot(n);case"aggregate":this.doAggregate(n);case"filter_aggregates":this.doFilterAggregates(n);case"sort":this.doSort(t.rowNodeTransactions,n);case"map":this.doRowsToDisplay()}const i=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(n,i),this.isRefreshingModel=!1,this.eventService.dispatchEvent({type:"modelUpdated",animate:t.animate,keepRenderedRows:t.keepRenderedRows,newData:t.newData,newPage:!1,keepUndoRedoStack:t.keepUndoRedoStack})}isEmpty(){const e=Lt(this.rootNode.allLeafChildren)||0===this.rootNode.allLeafChildren.length;return Lt(this.rootNode)||e||!this.columnModel.isReady()}isRowsToRender(){return Dt(this.rowsToDisplay)&&this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let n=!1,i=!1;const r=[],s=Mn(this.gos);return this.forEachNodeAfterFilterAndSort((o=>{if(i)return;if(n&&(o===t||o===e)&&(i=!0,o.group&&s))return void r.push(...o.allLeafChildren);if(!n){if(o!==t&&o!==e)return;n=!0}(!o.group||!s)&&r.push(o)})),r}setDatasource(e){xt("should never call setDatasource on clientSideRowController")}getTopLevelNodes(){return this.rootNode?this.rootNode.childrenAfterGroup:null}getRootNode(){return this.rootNode}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){if(this.isEmpty()||0===this.rowsToDisplay.length)return-1;let t=0,n=this.rowsToDisplay.length-1;if(e<=0)return 0;if(Rn(this.rowsToDisplay).rowTop<=e)return this.rowsToDisplay.length-1;let i=-1,r=-1;for(;;){const s=Math.floor((t+n)/2),o=this.rowsToDisplay[s];if(this.isRowInPixel(o,e))return s;o.rowTop<e?t=s+1:o.rowTop>e&&(n=s-1);if(i===t&&r===n)return s;i=t,r=n}}isRowInPixel(e,t){const n=e.rowTop,i=e.rowTop+e.rowHeight;return n<=t&&i>t}forEachLeafNode(e){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach(((t,n)=>e(t,n)))}forEachNode(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterGroup||[]],callback:e,recursionType:0,index:0,includeFooterNodes:t})}forEachNodeAfterFilter(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterAggFilter||[]],callback:e,recursionType:1,index:0,includeFooterNodes:t})}forEachNodeAfterFilterAndSort(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterSort||[]],callback:e,recursionType:2,index:0,includeFooterNodes:t})}forEachPivotNode(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback:e,recursionType:3,index:0,includeFooterNodes:t})}recursivelyWalkNodesAndCallback(e){const{nodes:t,callback:n,recursionType:i,includeFooterNodes:r}=e;let{index:s}=e;const o=e=>{const i=t[0]?.parent;if(!i)return;const o=r&&un(this.gos),a=hn(this.gos),l=r&&a({node:i});i===this.rootNode?o===e&&(i.createFooter(),n(i.sibling,s++)):l===e&&(i.createFooter(),n(i.sibling,s++))};o("top");for(let a=0;a<t.length;a++){const e=t[a];if(n(e,s++),e.hasChildren()&&!e.footer){let t=null;switch(i){case 0:t=e.childrenAfterGroup;break;case 1:t=e.childrenAfterAggFilter;break;case 2:t=e.childrenAfterSort;break;case 3:t=e.leafGroup?null:e.childrenAfterSort}t&&(s=this.recursivelyWalkNodesAndCallback({nodes:[...t],callback:n,recursionType:i,index:s,includeFooterNodes:r}))}}return o("bottom"),s}doAggregate(e){this.aggregationStage?.execute({rowNode:this.rootNode,changedPath:e})}doFilterAggregates(e){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:e}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter}expandOrCollapseAll(e){const t=this.gos.get("treeData"),n=this.columnModel.isPivotActive(),i=r=>{r&&r.forEach((r=>{const s=()=>{r.expanded=e,i(r.childrenAfterGroup)};if(t){return void(Dt(r.childrenAfterGroup)&&s())}if(n){return void(!r.leafGroup&&s())}r.group&&s()}))};this.rootNode&&i(this.rootNode.childrenAfterGroup),this.refreshModel({step:"map"}),this.eventService.dispatchEvent({type:"expandOrCollapseAll",source:e?"expandAll":"collapseAll"})}doSort(e,t){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,changedPath:t})}doRowGrouping(e,t,n,i){if(this.groupStage){if(e?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,rowNodesOrderChanged:n,changedPath:t}):this.groupStage.execute({rowNode:this.rootNode,changedPath:t,afterColumnsChanged:i}),Mn(this.gos)){this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",t)&&this.eventService.dispatchEvent({type:"selectionChanged",source:"rowGroupChanged"})}}else{const e=this.rootNode,t=e.sibling;e.childrenAfterGroup=e.allLeafChildren,t&&(t.childrenAfterGroup=e.childrenAfterGroup),this.rootNode.updateHasChildren()}this.nodeManager.isRowCountReady()&&(this.rowCountReady=!0,this.eventService.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){this.filterStage.execute({rowNode:this.rootNode,changedPath:e})}doPivot(e){this.pivotStage?.execute({rowNode:this.rootNode,changedPath:e})}getNodeManager(){return this.nodeManager}getRowNode(e){if("string"==typeof e&&0==e.indexOf(Lo.ID_PREFIX_ROW_GROUP)){let t;return this.forEachNode((n=>{n.id===e&&(t=n)})),t}return this.nodeManager.getRowNode(e)}setRowData(e){this.selectionService.reset("rowDataChanged"),this.nodeManager.setRowData(e),this.hasStarted&&this.dispatchUpdateEventsAndRefresh()}dispatchUpdateEventsAndRefresh(){this.eventService.dispatchEvent({type:"rowDataUpdated"}),this.refreshModel({step:"group",newData:!0})}batchUpdateRowData(e,t){if(null==this.applyAsyncTransactionsTimeout){this.rowDataTransactionBatch=[];const e=this.gos.get("asyncTransactionWaitMillis");this.applyAsyncTransactionsTimeout=window.setTimeout((()=>{this.isAlive()&&this.executeBatchUpdateRowData()}),e)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){null!=this.applyAsyncTransactionsTimeout&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){this.valueCache.onDataChanged();const e=[],t=[];let n=!1;this.rowDataTransactionBatch?.forEach((i=>{const{rowNodeTransaction:r,rowsInserted:s}=this.nodeManager.updateRowData(i.rowDataTransaction);s&&(n=!0),t.push(r),i.callback&&e.push(i.callback.bind(null,r))})),this.commonUpdateRowData(t,n),e.length>0&&window.setTimeout((()=>{e.forEach((e=>e()))}),0),t.length>0&&this.eventService.dispatchEvent({type:"asyncTransactionsFlushed",results:t}),this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(e){this.valueCache.onDataChanged();const{rowNodeTransaction:t,rowsInserted:n}=this.nodeManager.updateRowData(e);return this.commonUpdateRowData([t],n),t}afterImmutableDataChange(e,t){this.commonUpdateRowData([e],t)}commonUpdateRowData(e,t){if(!this.hasStarted)return;const n=!this.gos.get("suppressAnimationFrame");this.eventService.dispatchEvent({type:"rowDataUpdated"}),this.refreshModel({step:"group",rowNodeTransactions:e,rowNodesOrderChanged:t,keepRenderedRows:!0,keepEditingRows:!0,animate:n})}doRowsToDisplay(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}resetRowHeights(){const e=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),this.rootNode.sibling&&this.rootNode.sibling.setRowHeight(this.rootNode.sibling.rowHeight,!0),e&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode((t=>{t.setRowHeight(t.rowHeight,!0);const n=t.detailNode;n&&n.setRowHeight(n.rowHeight,!0),t.sibling&&t.sibling.setRowHeight(t.sibling.rowHeight,!0),e=!0})),e}onGridStylesChanges(e){if(e.rowHeightChanged){if(this.columnModel.isAutoRowHeightActive())return;this.resetRowHeights()}}onGridReady(){this.hasStarted||this.setInitialData()}isRowDataLoaded(){return this.rowCountReady}destroy(){super.destroy(),this.clearHighlightedRow()}},class extends Vn{constructor(){super(...arguments),this.beanName="filterStage"}wireBeans(e){this.filterManager=e.filterManager}execute(e){const{changedPath:t}=e;this.filter(t)}filter(e){const t=!!this.filterManager?.isChildFilterPresent();this.filterNodes(t,e)}filterNodes(e,t){const n=(t,n)=>{t.hasChildren()?t.childrenAfterFilter=e&&!n?t.childrenAfterGroup.filter((e=>{const t=e.childrenAfterFilter&&e.childrenAfterFilter.length>0,n=e.data&&this.filterManager.doesRowPassFilter({rowNode:e});return t||n})):t.childrenAfterGroup:t.childrenAfterFilter=t.childrenAfterGroup,t.sibling&&(t.sibling.childrenAfterFilter=t.childrenAfterFilter)};if(this.doingTreeDataFiltering()){const e=(t,i)=>{if(t.childrenAfterGroup)for(let r=0;r<t.childrenAfterGroup.length;r++){const s=t.childrenAfterGroup[r],o=i||this.filterManager.doesRowPassFilter({rowNode:s});s.childrenAfterGroup?e(t.childrenAfterGroup[r],o):n(s,o)}n(t,i)},i=t=>e(t,!1);t.executeFromRootNode(i)}else{const e=e=>n(e,!1);t.forEachChangedNodeDepthFirst(e,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}},class extends Vn{constructor(){super(...arguments),this.beanName="sortStage"}wireBeans(e){this.sortService=e.sortService,this.sortController=e.sortController}execute(e){const t=this.sortController.getSortOptions(),n=Dt(t)&&t.length>0,i=n&&Dt(e.rowNodeTransactions)&&this.gos.get("deltaSort"),r=t.some((e=>ln(this.gos)?e.column.isPrimary()&&e.column.isRowGroupActive():!!e.column.getColDef().showRowGroup));this.sortService.sort(t,n,i,e.rowNodeTransactions,e.changedPath,r)}},class extends Vn{constructor(){super(...arguments),this.beanName="flattenStage"}wireBeans(e){this.beans=e,this.columnModel=e.columnModel}execute(e){const t=e.rowNode,n=[],i=this.columnModel.isPivotMode(),r=i&&t.leafGroup,s=r?[t]:t.childrenAfterSort,o=this.getFlattenDetails();this.recursivelyAddToRowsToDisplay(o,s,n,i,0);if(!r&&n.length>0&&o.grandTotalRow){t.createFooter();const e="top"===o.grandTotalRow;this.addRowNodeToRowsToDisplay(o,t.sibling,n,0,e)}return n}getFlattenDetails(){const e=this.gos.get("groupRemoveSingleChildren");return{groupRemoveLowestSingleChildren:!e&&this.gos.get("groupRemoveLowestSingleChildren"),groupRemoveSingleChildren:e,isGroupMultiAutoColumn:dn(this.gos),hideOpenParents:this.gos.get("groupHideOpenParents"),grandTotalRow:un(this.gos),groupTotalRow:hn(this.gos)}}recursivelyAddToRowsToDisplay(e,t,n,i,r){if(!It(t))for(let s=0;s<t.length;s++){const o=t[s],a=o.hasChildren(),l=i&&!a,c=e.groupRemoveSingleChildren&&a&&1===o.childrenAfterGroup.length,u=e.groupRemoveLowestSingleChildren&&a&&o.leafGroup&&1===o.childrenAfterGroup.length,h=i&&o.leafGroup,d=e.hideOpenParents&&o.expanded&&!o.master&&!h;if(!l&&!d&&!c&&!u&&this.addRowNodeToRowsToDisplay(e,o,n,r),!i||!o.leafGroup)if(a){const t=c||u;if(o.expanded||t){const s=e.groupTotalRow({node:o});s||o.destroyFooter();const a=t?r:r+1;"top"===s&&(o.createFooter(),this.addRowNodeToRowsToDisplay(e,o.sibling,n,a)),this.recursivelyAddToRowsToDisplay(e,o.childrenAfterSort,n,i,a),"bottom"===s&&(o.createFooter(),this.addRowNodeToRowsToDisplay(e,o.sibling,n,a))}}else if(o.master&&o.expanded){const t=this.createDetailNode(o);this.addRowNodeToRowsToDisplay(e,t,n,r)}}}addRowNodeToRowsToDisplay(e,t,n,i,r){r?n.unshift(t):n.push(t),t.setUiLevel(e.isGroupMultiAutoColumn?0:i)}createDetailNode(e){if(Dt(e.detailNode))return e.detailNode;const t=new Lo(this.beans);return t.detail=!0,t.selectable=!1,t.parent=e,Dt(e.id)&&(t.id="detail_"+e.id),t.data=e.data,t.level=e.level+1,e.detailNode=t,t}},class extends Vn{constructor(){super(...arguments),this.beanName="sortService"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.rowNodeSorter=e.rowNodeSorter,this.showRowGroupColsService=e.showRowGroupColsService}sort(e,t,n,i,r,s){const o=this.gos.get("groupMaintainOrder"),a=this.columnModel.getCols().some((e=>e.isRowGroupActive()));let l={};n&&i&&(l=this.calculateDirtyNodes(i));const c=this.columnModel.isPivotMode(),u=this.gos.getCallback("postSortRows"),h=i=>{this.pullDownGroupDataForHideOpenParents(i.childrenAfterAggFilter,!0);const h=c&&i.leafGroup;if(o&&a&&!i.leafGroup&&!s){const e=this.funcColsService.getRowGroupColumns()?.[i.level+1],t=null===e?.getSort(),n=i.childrenAfterAggFilter.slice(0);if(i.childrenAfterSort&&!t){const e={};i.childrenAfterSort.forEach(((t,n)=>{e[t.id]=n})),n.sort(((t,n)=>(e[t.id]??0)-(e[n.id]??0)))}i.childrenAfterSort=n}else i.childrenAfterSort=!t||h?i.childrenAfterAggFilter.slice(0):n?this.doDeltaSort(i,l,r,e):this.rowNodeSorter.doFullSort(i.childrenAfterAggFilter,e);if(i.sibling&&(i.sibling.childrenAfterSort=i.childrenAfterSort),this.updateChildIndexes(i),u){const e={nodes:i.childrenAfterSort};u(e)}};r&&r.forEachChangedNodeDepthFirst(h),this.updateGroupDataForHideOpenParents(r)}calculateDirtyNodes(e){const t={},n=e=>{e&&e.forEach((e=>t[e.id]=!0))};return e&&e.forEach((e=>{n(e.add),n(e.update),n(e.remove)})),t}doDeltaSort(e,t,n,i){const r=e.childrenAfterAggFilter,s=e.childrenAfterSort;if(!s)return this.rowNodeSorter.doFullSort(r,i);const o={},a=[];r.forEach((e=>{t[e.id]||!n.canSkip(e)?a.push(e):o[e.id]=!0}));const l=s.filter((e=>o[e.id])),c=(e,t)=>({currentPos:t,rowNode:e}),u=a.map(c).sort(((e,t)=>this.rowNodeSorter.compareRowNodes(i,e,t)));return this.mergeSortedArrays(i,u,l.map(c)).map((e=>{let{rowNode:t}=e;return t}))}mergeSortedArrays(e,t,n){const i=[];let r=0,s=0;for(;r<t.length&&s<n.length;){this.rowNodeSorter.compareRowNodes(e,t[r],n[s])<0?i.push(t[r++]):i.push(n[s++])}for(;r<t.length;)i.push(t[r++]);for(;s<n.length;)i.push(n[s++]);return i}updateChildIndexes(e){if(Lt(e.childrenAfterSort))return;const t=e.childrenAfterSort;for(let n=0;n<t.length;n++){const i=t[n],r=0===n,s=n===e.childrenAfterSort.length-1;i.setFirstChild(r),i.setLastChild(s),i.setChildIndex(n)}}updateGroupDataForHideOpenParents(e){if(!this.gos.get("groupHideOpenParents"))return;if(this.gos.get("treeData"))return bt("The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them."),!1;const t=e=>{this.pullDownGroupDataForHideOpenParents(e.childrenAfterSort,!1),e.childrenAfterSort.forEach((e=>{e.hasChildren()&&t(e)}))};e&&e.executeFromRootNode((e=>t(e)))}pullDownGroupDataForHideOpenParents(e,t){this.gos.get("groupHideOpenParents")&&!Lt(e)&&e.forEach((e=>{(this.showRowGroupColsService?.getShowRowGroupCols()??[]).forEach((n=>{const i=n.getColDef().showRowGroup;if("string"!==typeof i)return void xt("groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup");const r=i,s=this.columnModel.getColDefCol(r);if(!(s===e.rowGroupColumn))if(t)e.setGroupValue(n.getId(),void 0);else{const t=this.getFirstChildOfFirstChild(e,s);t&&e.setGroupValue(n.getId(),t.key)}}))}))}getFirstChildOfFirstChild(e,t){let n=e;for(;n;){const e=n.parent;if(!e||!n.firstChild)return null;if(e.rowGroupColumn===t)return e;n=e}return null}},class extends Vn{constructor(){super(...arguments),this.beanName="immutableService"}wireBeans(e){this.rowModel=e.rowModel,this.selectionService=e.selectionService}postConstruct(){Vt(this.gos)&&(this.clientSideRowModel=this.rowModel,this.addManagedPropertyListener("rowData",(()=>this.onRowDataUpdated())))}isActive(){const e=this.gos.exists("getRowId");return!this.gos.get("resetRowDataOnUpdate")&&e}setRowData(e){const t=this.createTransactionForRowData(e);if(!t)return;const n=this.clientSideRowModel.getNodeManager(),{rowNodeTransaction:i,rowsInserted:r}=n.updateRowData(t);let s=!1;this.gos.get("suppressMaintainUnsortedOrder")||(s=n.updateRowOrderFromRowData(e)),this.clientSideRowModel.afterImmutableDataChange(i,s||r)}createTransactionForRowData(e){if(!Vt(this.gos))return xt("ImmutableService only works with ClientSideRowModel"),null;const t=gn(this.gos);if(null==t)return xt("ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!"),null;const n=this.clientSideRowModel.getNodeManager().getCopyOfNodesMap(),i=[],r=[],s=[];return Dt(e)&&e.forEach((e=>{const i=t({data:e,level:0}),o=n[i];if(o){o.data!==e&&r.push(e),n[i]=void 0}else s.push(e)})),ii(n,((e,t)=>{t&&i.push(t.data)})),{remove:i,update:r,add:s}}onRowDataUpdated(){const e=this.gos.get("rowData");e&&(this.isActive()?this.setRowData(e):(this.selectionService.reset("rowDataChanged"),this.clientSideRowModel.setRowData(e)))}}]},Zh={version:Kh,moduleName:"@ag-grid-community/client-side-row-model",dependantModules:[$h,{version:Kh,moduleName:"@ag-grid-community/client-side-row-model-api",beans:[Gh],apiFunctions:{onGroupExpandedOrCollapsed:function(e){e.expansionService.onGroupExpandedOrCollapsed()},refreshClientSideRowModel:function(e,t){e.rowModelHelperService?.getClientSideRowModel()?.refreshModel(t)},isRowDataEmpty:function(e){return e.rowModelHelperService?.getClientSideRowModel()?.isEmpty()??!0},forEachLeafNode:function(e,t){e.rowModelHelperService?.getClientSideRowModel()?.forEachLeafNode(t)},forEachNodeAfterFilter:function(e,t){e.rowModelHelperService?.getClientSideRowModel()?.forEachNodeAfterFilter(t)},forEachNodeAfterFilterAndSort:function(e,t){e.rowModelHelperService?.getClientSideRowModel()?.forEachNodeAfterFilterAndSort(t)},resetRowHeights:function(e){e.columnModel.isAutoRowHeightActive()?bt("calling gridApi.resetRowHeights() makes no sense when using Auto Row Height."):e.rowModelHelperService?.getClientSideRowModel()?.resetRowHeights()},applyTransaction:function(e,t){return e.frameworkOverrides.wrapIncoming((()=>e.rowModelHelperService?.getClientSideRowModel()?.updateRowData(t)))},applyTransactionAsync:function(e,t,n){e.frameworkOverrides.wrapIncoming((()=>e.rowModelHelperService?.getClientSideRowModel()?.batchUpdateRowData(t,n)))},flushAsyncTransactions:function(e){e.frameworkOverrides.wrapIncoming((()=>e.rowModelHelperService?.getClientSideRowModel()?.flushAsyncTransactions()))},getBestCostNodeSelection:function(e){return e.selectionService.getBestCostNodeSelection()}},dependantModules:[$h,Uh]}]},Yh=class extends Vn{setBeans(e){this.beans=e}getFileName(e){const t=this.getDefaultFileExtension();return null!=e&&e.length||(e=this.getDefaultFileName()),-1===e.indexOf(".")?`${e}.${t}`:e}getData(e){const t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},Jh=class{constructor(e){this.groupColumns=[];const{columnModel:t,funcColsService:n,columnNameService:i,valueService:r,gos:s,processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c}=e;this.columnModel=t,this.funcColsService=n,this.columnNameService=i,this.valueService=r,this.gos=s,this.processCellCallback=o,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=c}prepare(e){this.groupColumns=e.filter((e=>!!e.getColDef().showRowGroup))}extractHeaderValue(e){return this.getHeaderName(this.processHeaderCallback,e)??""}extractRowCellValue(e,t,n,i,r){const s=this.gos.get("groupHideOpenParents")&&!r.footer||!this.shouldRenderGroupSummaryCell(r,e,t)?this.valueService.getValue(e,r):this.createValueForGroupNode(e,r);return this.processCell({accumulatedRowIndex:n,rowNode:r,column:e,value:s,processCellCallback:this.processCellCallback,type:i})}shouldRenderGroupSummaryCell(e,t,n){if(!(e&&e.group))return!1;if(-1!==this.groupColumns.indexOf(t)){const n=e.groupData?.[t.getId()],i=this.gos.get("suppressGroupMaintainValueType");if(i&&null!=n||!i&&void 0!==n)return!0;if(Wt(this.gos)&&e.group)return!0;if(e.footer&&-1===e.level){const e=t.getColDef();return null==e||!0===e.showRowGroup||e.showRowGroup===this.funcColsService.getRowGroupColumns()[0].getId()}}const i=pn(this.gos,this.columnModel.isPivotMode());return 0===n&&i}getHeaderName(e,t){return e?e(this.gos.addGridCommonParams({column:t})):this.columnNameService.getDisplayNameForColumn(t,"csv",!0)}createValueForGroupNode(e,t){if(this.processRowGroupCallback)return this.processRowGroupCallback(this.gos.addGridCommonParams({column:e,node:t}));const n=this.gos.get("treeData"),i=this.gos.get("suppressGroupMaintainValueType"),r=t=>{if(n||i)return t.key;const r=t.groupData?.[e.getId()];return r&&t.rowGroupColumn&&!1!==t.rowGroupColumn.getColDef().useValueFormatterForExport?this.valueService.formatValue(t.rowGroupColumn,t,r)??r:r},s=t.footer,o=[r(t)];if(!dn(this.gos))for(;t.parent;)t=t.parent,o.push(r(t));const a=o.reverse().join(" -> ");return s?`Total ${a}`:a}processCell(e){const{accumulatedRowIndex:t,rowNode:n,column:i,value:r,processCellCallback:s,type:o}=e;return s?{value:s(this.gos.addGridCommonParams({accumulatedRowIndex:t,column:i,node:n,value:r,type:o,parseValue:e=>this.valueService.parseValue(i,n,e,this.valueService.getValue(i,n)),formatValue:e=>this.valueService.formatValue(i,n,e)??e}))??""}:!1!==i.getColDef().useValueFormatterForExport?{value:r??"",valueFormatted:this.valueService.formatValue(i,n,r)}:{value:r??""}}},Qh=class{static download(e,t){const n=document.defaultView||window;if(!n)return void bt("There is no `window` associated with the current `document`");const i=document.createElement("a"),r=n.URL.createObjectURL(t);i.setAttribute("href",r),i.setAttribute("download",e),i.style.display="none",document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:n})),document.body.removeChild(i),n.setTimeout((()=>{n.URL.revokeObjectURL(r)}),0)}},ed=class extends Jh{constructor(e){super(e),this.isFirstLine=!0,this.result="";const{suppressQuotes:t,columnSeparator:n}=e;this.suppressQuotes=t,this.columnSeparator=n}addCustomContent(e){e&&("string"===typeof e?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,"\r\n"),this.result+=e):e.forEach((e=>{this.beginNewLine(),e.forEach(((e,t)=>{0!==t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(e.data.value||""),e.mergeAcross&&this.appendEmptyCells(e.mergeAcross)}))})))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,n,i){0!=n&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(i)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){0!=t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,n){0!=t&&(this.result+=this.columnSeparator);const i=this.extractRowCellValue(e,t,t,"csv",n);this.result+=this.putInQuotes(i.valueFormatted??i.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(null===e||void 0===e)return'""';let t;"string"===typeof e?t=e:"function"===typeof e.toString?t=e.toString():(bt("unknown value type during csv conversion"),t="");return'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+="\r\n"),this.isFirstLine=!1}};var td="32.3.3",nd={version:td,moduleName:"@ag-grid-community/csv-export-core",beans:[class extends Yh{constructor(){super(...arguments),this.beanName="csvCreator"}wireBeans(e){this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.funcColsService=e.funcColsService,this.valueService=e.valueService,this.gridSerializer=e.gridSerializer}postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gos:this.gos})}getMergedParams(e){const t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed())return void bt("Export cancelled. Export is not allowed as per your configuration.");const t=this.getMergedParams(e),n=this.getData(t),i=new Blob(["\ufeff",n],{type:"text/plain"}),r="function"===typeof t.fileName?t.fileName(this.gos.getGridCommonParams()):t.fileName;Qh.download(this.getFileName(r),i)}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?Object.assign({},e):this.getMergedParams(e);return this.getData(t)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){const{columnModel:t,columnNameService:n,funcColsService:i,valueService:r,gos:s}=this,{processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c,suppressQuotes:u,columnSeparator:h}=e;return new ed({columnModel:t,columnNameService:n,funcColsService:i,valueService:r,gos:s,processCellCallback:o||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:c||void 0,suppressQuotes:u||!1,columnSeparator:h||","})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}},class extends Vn{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleColsService=e.visibleColsService,this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel,this.selectionService=e.selectionService,this.rowNodeSorter=e.rowNodeSorter,this.sortController=e.sortController}serialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{allColumns:n,columnKeys:i,skipRowGroups:r}=t,s=this.getColumnsToExport(n,r,i),o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>t.reduce(((e,t)=>t(e)),e)}(this.prepareSession(s),this.prependContent(t),this.exportColumnGroups(t,s),this.exportHeaders(t,s),this.processPinnedTopRows(t,s),this.processRows(t,s),this.processPinnedBottomRows(t,s),this.appendContent(t));return o(e).parse()}processRow(e,t,n,i){const r=t.shouldRowBeSkipped||(()=>!1),s=this.gos.get("groupRemoveSingleChildren"),o=this.gos.get("groupRemoveLowestSingleChildren"),a=null!=t.rowPositions||!!t.onlySelected,l=this.gos.get("groupHideOpenParents")&&!a,c=this.columnModel.isPivotMode()?i.leafGroup:!i.group,u=!!i.footer,h=o&&i.leafGroup,d=1===i.allChildrenCount&&1===i.childrenAfterGroup?.length&&(s||h);if(!c&&!u&&(t.skipRowGroups||d||l)||t.onlySelected&&!i.isSelected()||t.skipPinnedTop&&"top"===i.rowPinned||t.skipPinnedBottom&&"bottom"===i.rowPinned)return;if(-1===i.level&&!c&&!u)return;if(r(this.gos.addGridCommonParams({node:i})))return;const p=e.onNewBodyRow(i);if(n.forEach(((e,t)=>{p.onColumn(e,t,i)})),t.getCustomContentBelowRow){const n=t.getCustomContentBelowRow(this.gos.addGridCommonParams({node:i}));n&&e.addCustomContent(n)}}appendContent(e){return t=>{const n=e.appendContent;return n&&t.addCustomContent(n),t}}prependContent(e){return t=>{const n=e.prependContent;return n&&t.addCustomContent(n),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return n=>{if(!e.skipColumnGroupHeaders){const i=new zi,r=this.visibleColsService.createGroups({columns:t,idCreator:i,pinned:null,isStandaloneStructure:!0});this.recursivelyAddHeaderGroups(r,n,e.processGroupHeaderCallback)}return n}}exportHeaders(e,t){return n=>{if(!e.skipColumnHeaders){const e=n.onNewHeaderRow();t.forEach(((t,n)=>{e.onColumn(t,n,void 0)}))}return n}}processPinnedTopRows(e,t){return n=>{const i=this.processRow.bind(this,n,e,t);return e.rowPositions?e.rowPositions.filter((e=>"top"===e.rowPinned)).sort(((e,t)=>e.rowIndex-t.rowIndex)).map((e=>this.pinnedRowModel.getPinnedTopRow(e.rowIndex))).forEach(i):this.pinnedRowModel.forEachPinnedRow("top",i),n}}processRows(e,t){return n=>{const i=this.rowModel,r=Vt(this.gos),s=Wt(this.gos),o=!r&&e.onlySelected,a=this.processRow.bind(this,n,e,t),{exportedRows:l="filteredAndSorted"}=e;if(e.rowPositions)e.rowPositions.filter((e=>null==e.rowPinned)).sort(((e,t)=>e.rowIndex-t.rowIndex)).map((e=>i.getRow(e.rowIndex))).forEach(a);else if(this.columnModel.isPivotMode())r?i.forEachPivotNode(a,!0):s?i.forEachNodeAfterFilterAndSort(a,!0):i.forEachNode(a);else if(e.onlySelectedAllPages||o){const e=this.selectionService.getSelectedNodes();this.replicateSortedOrder(e),e.forEach(a)}else"all"===l?i.forEachNode(a):r||s?i.forEachNodeAfterFilterAndSort(a,!0):i.forEachNode(a);return n}}replicateSortedOrder(e){const t=this.sortController.getSortOptions(),n=(e,i)=>null!=e.rowIndex&&null!=i.rowIndex?e.rowIndex-i.rowIndex:e.level===i.level?e.parent?.id===i.parent?.id?this.rowNodeSorter.compareRowNodes(t,{rowNode:e,currentPos:e.rowIndex??-1},{rowNode:i,currentPos:i.rowIndex??-1}):n(e.parent,i.parent):e.level>i.level?n(e.parent,i):n(e,i.parent);e.sort(n)}processPinnedBottomRows(e,t){return n=>{const i=this.processRow.bind(this,n,e,t);return e.rowPositions?e.rowPositions.filter((e=>"bottom"===e.rowPinned)).sort(((e,t)=>e.rowIndex-t.rowIndex)).map((e=>this.pinnedRowModel.getPinnedBottomRow(e.rowIndex))).forEach(i):this.pinnedRowModel.forEachPinnedRow("bottom",i),n}}getColumnsToExport(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const i=this.columnModel.isPivotMode();if(n&&n.length)return this.columnModel.getColsForKeys(n);const r=this.gos.get("treeData");let s=[];return s=e&&!i?this.columnModel.getCols():this.visibleColsService.getAllCols(),t&&!r&&(s=s.filter((e=>Jn(e)||Qn(e)))),s}recursivelyAddHeaderGroups(e,t,n){const i=[];e.forEach((e=>{const t=e;t.getChildren&&t.getChildren().forEach((e=>i.push(e)))})),e.length>0&&Ni(e[0])&&this.doAddHeaderHeader(t,e,n),i&&i.length>0&&this.recursivelyAddHeaderGroups(i,t,n)}doAddHeaderHeader(e,t,n){const i=e.onNewHeaderGroupingRow();let r=0;t.forEach((e=>{const t=e;let s;s=n?n(this.gos.addGridCommonParams({columnGroup:t})):this.columnNameService.getDisplayNameForColumnGroup(t,"header");const o=t.getLeafColumns().reduce(((e,t,n,i)=>{let r=Rn(e);return"open"===t.getColumnGroupShow()?r&&null==r[1]||(r=[n],e.push(r)):r&&null==r[1]&&(r[1]=n-1),n===i.length-1&&r&&null==r[1]&&(r[1]=n),e}),[]);i.onColumn(t,s||"",r++,t.getLeafColumns().length-1,o)}))}}]},id={version:td,moduleName:"@ag-grid-community/csv-export",dependantModules:[nd,{version:td,moduleName:"@ag-grid-community/csv-export-api",apiFunctions:{getDataAsCsv:function(e,t){return e.csvCreator?.getDataAsCsv(t)},exportDataAsCsv:function(e,t){e.csvCreator?.exportDataAsCsv(t)}},dependantModules:[nd]}]};var rd=async e=>{const t=new Blob([e]),{size:n,content:i}=await(async e=>{let t=0;const n=[],i=new WritableStream({write:e=>{n.push(e),t+=e.length}}),r=new ReadableStream({start:t=>{const n=new FileReader;n.onload=e=>{e.target?.result&&t.enqueue(e.target.result),t.close()},n.readAsArrayBuffer(e)}}),s=new window.CompressionStream("deflate-raw");return await r.pipeThrough(s).pipeTo(i),{size:t,content:new Blob(n)}})(t);return{size:n,content:new Uint8Array(await i.arrayBuffer())}};function sd(e,t){let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(255&e),e>>>=8;return n}var od=e=>{if(!e.length)return 0;let t=~0,n=0,i=0,r=0;for(let s=0;s<e.length;s++)n=e[s],i=255&(t^n),r=ld[i],t=t>>>8^r;return~t},ad=e=>e.length?od("string"===typeof e?(new TextEncoder).encode(e):e):0,ld=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]),cd=(e,t,n,i,r,s)=>{const{content:o,path:a,created:l}=e,c=(e=>{let t=e.getHours();return t<<=6,t|=e.getMinutes(),t<<=5,t|=e.getSeconds()/2,t})(l),u=(e=>{let t=e.getFullYear()-1980;return t<<=4,t|=e.getMonth()+1,t<<=5,t|=e.getDate(),t})(l),h=ad(r),d=void 0!==s?s:i,p=Fi(a),g=p!==a;let f="";if(g){const e=sd(1,1)+sd(ad(p),4)+p;f="up"+sd(e.length,2)+e}const m="\x14\0"+(g?"\0\b":"\0\0")+sd(t?8:0,2)+sd(c,2)+sd(u,2)+sd(d?h:0,4)+sd(s??i,4)+sd(i,4)+sd(p.length,2)+sd(f.length,2),v="PK\x03\x04"+m+p+f,y="PK\x01\x02\x14\0"+m+"\0\0\0\0\0\0"+(o?"\0\0\0\0":"\x10\0\0\0")+sd(n,4)+p+f;return{localFileHeader:Uint8Array.from(v,(e=>e.charCodeAt(0))),centralDirectoryHeader:Uint8Array.from(y,(e=>e.charCodeAt(0)))}},ud=e=>{let t;if("string"===typeof e){const n=atob(e.split(";base64,")[1]);t=Uint8Array.from(n,(e=>e.charCodeAt(0)))}else t=e;return{size:t.length,content:t}},hd=async(e,t)=>{const{content:n}=e,{size:i,content:r}=n?ud(n):{size:0,content:Uint8Array.from([])};let s,o,a=!1;if("file"===e.type&&r&&i>0){const e=await rd(r);s=e.content,o=e.size,a=!0}return{...cd(e,a,t,i,r,o),content:s||r,isCompressed:a}},dd=(e,t)=>{const{content:n}=e,{content:i}=n?ud(n):{content:Uint8Array.from([])};return{...cd(e,!1,t,i.length,i,void 0),content:i,isCompressed:!1}},pd=class{static addFolders(e){e.forEach(this.addFolder.bind(this))}static addFolder(e){this.folders.push({path:e,created:new Date,isBase64:!1,type:"folder"})}static addFile(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.files.push({path:e,created:new Date,content:n?t:(new TextEncoder).encode(t),isBase64:n,type:"file"})}static async getZipFile(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"application/zip";const t=await this.buildCompressedFileStream();return this.clearStream(),new Blob([t],{type:e})}static getUncompressedZipFile(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"application/zip";const t=this.buildFileStream();return this.clearStream(),new Blob([t],{type:e})}static clearStream(){this.folders=[],this.files=[]}static packageFiles(e){let t=0,n=0;for(const c of e){const{localFileHeader:e,centralDirectoryHeader:i,content:r}=c;t+=e.length+r.length,n+=i.length}const i=new Uint8Array(t),r=new Uint8Array(n);let s=0,o=0;for(const c of e){const{localFileHeader:e,centralDirectoryHeader:t,content:n}=c;i.set(e,s),s+=e.length,i.set(n,s),s+=n.length,r.set(t,o),o+=t.length}const a=((e,t,n)=>{const i="PK\x05\x06\0\0\0\0"+sd(e,2)+sd(e,2)+sd(t,4)+sd(n,4)+"\0\0";return Uint8Array.from(i,(e=>e.charCodeAt(0)))})(e.length,n,t),l=new Uint8Array(i.length+r.length+a.length);return l.set(i),l.set(r,i.length),l.set(a,i.length+r.length),l}static async buildCompressedFileStream(){const e=[...this.folders,...this.files],t=[];let n=0;for(const i of e){const e=await hd(i,n),{localFileHeader:r,content:s}=e;t.push(e),n+=r.length+s.length}return this.packageFiles(t)}static buildFileStream(){const e=[...this.folders,...this.files],t=[];let n=0;for(const i of e){const e=dd(i,n),{localFileHeader:r,content:s}=e;t.push(e),n+=r.length+s.length}return this.packageFiles(t)}};pd.folders=[],pd.files=[];var gd=class extends Vc{wireBeans(e){this.beans=e}constructor(e,t,n){super(e),this.parentCache=t,this.params=n,this.startRow=e*n.blockSize,this.endRow=this.startRow+n.blockSize}postConstruct(){this.createRowNodes()}getBlockStateJson(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}}setDataAndId(e,t,n){Dt(t)?e.setDataAndId(t,n.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){const e=this.createLoadParams();Lt(this.params.datasource.getRows)?bt("datasource is missing getRows method"):window.setTimeout((()=>{this.params.datasource.getRows(e)}),0)}processServerFail(){}createLoadParams(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gos.getGridCommonParams().context}}forEachNode(e,t,n){this.rowNodes.forEach(((i,r)=>{this.startRow+r<n&&e(i,t.next())}))}getLastAccessed(){return this.lastAccessed}getRow(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||(this.lastAccessed=this.params.lastAccessedSequence.next());const t=e-this.startRow;return this.rowNodes[t]}getStartRow(){return this.startRow}getEndRow(){return this.endRow}createRowNodes(){this.rowNodes=[];for(let e=0;e<this.params.blockSize;e++){const t=this.startRow+e,n=new Lo(this.beans);n.setRowHeight(this.params.rowHeight),n.uiLevel=0,n.setRowIndex(t),n.setRowTop(this.params.rowHeight*t),this.rowNodes.push(n)}}processServerResult(e){this.rowNodes.forEach(((t,n)=>{const i=e.rowData?e.rowData[n]:void 0;!t.id&&t.alreadyRendered&&i&&(this.rowNodes[n]=new Lo(this.beans),this.rowNodes[n].setRowIndex(t.rowIndex),this.rowNodes[n].setRowTop(t.rowTop),this.rowNodes[n].setRowHeight(t.rowHeight),t.clearRowTopAndRowIndex()),this.setDataAndId(this.rowNodes[n],i,this.startRow+n)}));const t=null!=e.rowCount&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,t)}destroy(){this.rowNodes.forEach((e=>{e.clearRowTopAndRowIndex()})),super.destroy()}},fd=class extends Vn{constructor(e){super(),this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount,this.params=e}wireBeans(e){this.rowRenderer=e.rowRenderer,this.focusService=e.focusService}getRow(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Math.floor(e/this.params.blockSize);let i=this.blocks[n];if(!i){if(t)return;i=this.createBlock(n)}return i.getRow(e)}createBlock(e){const t=this.createBean(new gd(e,this,this.params));return this.blocks[t.getId()]=t,this.blockCount++,this.purgeBlocksIfNeeded(t),this.params.rowNodeBlockLoader.addBlock(t),t}refreshCache(){0==this.blockCount?this.purgeCache():(this.getBlocksInOrder().forEach((e=>e.setStateWaitingToLoad())),this.params.rowNodeBlockLoader.checkBlockToLoad())}destroy(){this.getBlocksInOrder().forEach((e=>this.destroyBlock(e))),super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(this.gos.get("debug")&&St(`InfiniteCache - onPageLoaded: page = ${e.getId()}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(e){const t=this.getBlocksInOrder().filter((t=>t!=e));t.sort(((e,t)=>t.getLastAccessed()-e.getLastAccessed()));const n=this.params.maxBlocksInCache>0,i=n?this.params.maxBlocksInCache-1:null;t.forEach(((e,t)=>{if("needsLoading"===e.getState()&&t>=1||!!n&&t>=i){if(this.isBlockCurrentlyDisplayed(e))return;if(this.isBlockFocused(e))return;this.removeBlockFromCache(e)}}))}isBlockFocused(e){const t=this.focusService.getFocusCellToUseAfterRefresh();if(!t)return!1;if(null!=t.rowPinned)return!1;const n=e.getStartRow(),i=e.getEndRow();return t.rowIndex>=n&&t.rowIndex<i}isBlockCurrentlyDisplayed(e){const t=e.getStartRow(),n=e.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(t,n)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if("number"===typeof t&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const t=(e.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<t&&(this.rowCount=t)}}setRowCount(e,t){this.rowCount=e,Dt(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){const t=new cs;this.getBlocksInOrder().forEach((n=>n.forEachNode(e,t,this.rowCount)))}getBlocksInOrder(){return oi(this.blocks).sort(((e,t)=>e.getId()-t.getId()))}destroyBlock(e){delete this.blocks[e.getId()],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventService.dispatchEvent({type:"storeUpdated"}))}destroyAllBlocksPastVirtualRowCount(){const e=[];this.getBlocksInOrder().forEach((t=>{t.getId()*this.params.blockSize>=this.rowCount&&e.push(t)})),e.length>0&&e.forEach((e=>this.destroyBlock(e)))}purgeCache(){this.getBlocksInOrder().forEach((e=>this.removeBlockFromCache(e))),this.lastRowIndexKnown=!1,0===this.rowCount&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,t){const n=[];let i=-1,r=!1;const s=new cs;let o=!1;this.getBlocksInOrder().forEach((a=>{o||(r&&i+1!==a.getId()?o=!0:(i=a.getId(),a.forEachNode((i=>{const s=i===e||i===t;(r||s)&&n.push(i),s&&(r=!r)}),s,this.rowCount)))}));return o||r?[]:n}};var md="32.3.3",vd={version:md,moduleName:"@ag-grid-community/infinite-row-model-core",rowModel:"infinite",beans:[class extends Vn{constructor(){super(...arguments),this.beanName="rowModel"}wireBeans(e){this.filterManager=e.filterManager,this.sortController=e.sortController,this.selectionService=e.selectionService,this.rowRenderer=e.rowRenderer,this.rowNodeBlockLoader=e.rowNodeBlockLoader}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(){return!1}postConstruct(){"infinite"===this.gos.get("rowModelType")&&(this.rowHeight=Zt(this.gos),this.addEventListeners(),this.addDestroyFunc((()=>this.destroyCache())),this.verifyProps())}verifyProps(){this.gos.exists("initialGroupOrderComparator")&&bt("initialGroupOrderComparator cannot be used with Infinite Row Model as sorting is done on the server side")}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy()}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.onCacheUpdated.bind(this)}),this.addManagedPropertyListener("datasource",(()=>this.setDatasource(this.gos.get("datasource")))),this.addManagedPropertyListener("cacheBlockSize",(()=>this.resetCache())),this.addManagedPropertyListener("rowHeight",(()=>{this.rowHeight=Zt(this.gos),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()}))}onFilterChanged(){this.reset()}onSortChanged(){this.reset()}onColumnEverything(){let e;e=!this.cacheParams||this.isSortModelDifferent(),e&&this.reset()}isSortModelDifferent(){return!zt(this.cacheParams.sortModel,this.sortController.getSortModel())}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(e,t):[]}reset(){if(!this.datasource)return;null!=gn(this.gos)||this.selectionService.reset("rowDataChanged"),this.resetCache()}dispatchModelUpdatedEvent(){this.eventService.dispatchEvent({type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1})}resetCache(){this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:this.filterManager?.getFilterModel()??{},sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.gos.get("infiniteInitialRowCount"),maxBlocksInCache:this.gos.get("maxBlocksInCache"),rowHeight:Zt(this.gos),overflowSize:this.gos.get("cacheOverflowSize"),blockSize:this.gos.get("cacheBlockSize"),lastAccessedSequence:new cs},this.infiniteCache=this.createBean(new fd(this.cacheParams)),this.eventService.dispatchEventOnce({type:"rowCountReady"}),this.dispatchModelUpdatedEvent()}updateRowHeights(){this.forEachNode((e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)})),this.dispatchModelUpdatedEvent()}destroyCache(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))}onCacheUpdated(){this.dispatchModelUpdatedEvent()}getRow(e){if(this.infiniteCache&&!(e>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(e)}getRowNode(e){let t;return this.forEachNode((n=>{n.id===e&&(t=n)})),t}forEachNode(e){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(0!==this.rowHeight){const t=Math.floor(e/this.rowHeight),n=this.getRowCount()-1;return t>n?n:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache&&this.infiniteCache.refreshCache()}purgeCache(){this.infiniteCache&&this.infiniteCache.purgeCache()}isLastRowIndexKnown(){return!!this.infiniteCache&&this.infiniteCache.isLastRowIndexKnown()}setRowCount(e,t){this.infiniteCache&&this.infiniteCache.setRowCount(e,t)}}],dependantModules:[Wc]},yd={version:md,moduleName:"@ag-grid-community/infinite-row-model",dependantModules:[vd,{version:md,moduleName:"@ag-grid-community/infinite-row-model-api",beans:[Gh],apiFunctions:{refreshInfiniteCache:function(e){e.rowModelHelperService?.getInfiniteRowModel()?.refreshCache()},purgeInfiniteCache:function(e){e.rowModelHelperService?.getInfiniteRowModel()?.purgeCache()},getInfiniteRowCount:function(e){return e.rowModelHelperService?.getInfiniteRowModel()?.getRowCount()}},dependantModules:[vd,Vh]}]};(e=>{const t=new Map})((e=>{if(/Color$/.test(e))return"color";if(/Scale?$/.test(e))return"scale";if("spacing"===e||/(Padding|Spacing|Size|Width|Height|Radius|Indent|Start|End|Top|Bottom|Horizontal|Vertical)$/.test(e))return"length";if(/Border$/.test(e))return"border";if(/BorderStyle$/.test(e))return"borderStyle";if(/Shadow$/.test(e))return"shadow";if(/Image$/.test(e))return"image";if(/Family$/.test(e))return"fontFamily";if(/Weight$/.test(e))return"fontWeight";if(/Duration$/.test(e))return"duration";if(/ColorScheme$/.test(e))return"colorScheme";throw new Error(`"${e}" is not a valid theme parameter.`)})),"object"!==typeof window||!window||"object"!==typeof document||(window.document,document);Co.__registerModules([lh,Zh,yd,id],!1,void 0);var Cd=n(950),wd=t.createContext({}),Sd=(e,t,n,i)=>{if(!e||e.componentFromFramework||t.isDestroyed())return;const r=e.newAgStackInstance();if(null==r)return;let s,o,a=!1;return r.then((e=>{a?t.destroyBean(e):(s=e,o=s.getGui(),n.appendChild(o),bd(i,s))})),()=>{a=!0,s&&(o?.parentElement?.removeChild(o),t.destroyBean(s),i&&bd(i,void 0))}},bd=(e,t)=>{if(e)if(e instanceof Function){e(t)}else{e.current=t}},xd=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e=>null!=e&&""!==e)).join(" ")},_d=class e{constructor(){this.classesMap={};for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((e=>{this.classesMap[e]=!0}))}setClass(t,n){if(!!this.classesMap[t]==n)return this;const i=new e;return i.classesMap={...this.classesMap},i.classesMap[t]=n,i}toString(){return Object.keys(this.classesMap).filter((e=>this.classesMap[e])).join(" ")}},Md=e=>"function"===typeof e&&!(e.prototype&&e.prototype.isReactComponent)||"object"===typeof e&&e.$$typeof===("function"===typeof Symbol&&Symbol.for?Symbol.for("react.memo"):60115),Ed=t.version?.split(".")[0],Rd="16"===Ed||"17"===Ed;var Td=!1;var Pd=(e,t)=>{Rd||!e||Td?t():Cd.flushSync(t)};function Ad(e,t,n){if(null==t||null==e)return t;if(e===t||0===t.length&&0===e.length)return e;if(n||0===e.length&&t.length>0||e.length>0&&0===t.length)return t;const i=[],r=[],s=new Map,o=new Map;for(let a=0;a<t.length;a++){const e=t[a];o.set(e.instanceId,e)}for(let a=0;a<e.length;a++){const t=e[a];s.set(t.instanceId,t),o.has(t.instanceId)&&i.push(t)}for(let a=0;a<t.length;a++){const e=t[a],n=e.instanceId;s.has(n)||r.push(e)}return i.length===e.length&&0===r.length?e:0===i.length&&r.length===t.length?t:0===i.length?r:0===r.length?i:[...i,...r]}var Fd=(0,t.forwardRef)(((e,n)=>{const{ctrlsFactory:i,context:r}=(0,t.useContext)(wd),s=(0,t.useRef)(null),o=(0,t.useRef)(null),a=(0,t.useRef)(null),l=(0,t.useRef)(null),c=(0,t.useRef)(null),u=(0,t.useRef)(),[h,d]=(0,t.useState)(),[p,g]=(0,t.useState)(),[f,m]=(0,t.useState)(),[v,y]=(0,t.useState)((()=>new _d)),[C,w]=(0,t.useState)((()=>new _d("ag-hidden"))),[S,b]=(0,t.useState)((()=>new _d("ag-hidden"))),[x,_]=(0,t.useState)((()=>new _d("ag-invisible")));(0,t.useImperativeHandle)(n,(()=>({refresh:()=>!1}))),(0,t.useLayoutEffect)((()=>Sd(h,r,o.current)),[h]);const M=(0,t.useCallback)((t=>{if(s.current=t,!t)return void(u.current=r.destroyBean(u.current));const n={setInnerRenderer:(e,t)=>{d(e),m(t)},setChildCount:e=>g(e),addOrRemoveCssClass:(e,t)=>y((n=>n.setClass(e,t))),setContractedDisplayed:e=>b((t=>t.setClass("ag-hidden",!e))),setExpandedDisplayed:e=>w((t=>t.setClass("ag-hidden",!e))),setCheckboxVisible:e=>_((t=>t.setClass("ag-invisible",!e)))},o=i.getInstance("groupCellRendererCtrl");o&&(u.current=r.createBean(o),u.current.init(n,t,a.current,l.current,c.current,Fd,e))}),[]),E=(0,t.useMemo)((()=>`ag-cell-wrapper ${v.toString()}`),[v]),R=(0,t.useMemo)((()=>`ag-group-expanded ${C.toString()}`),[C]),T=(0,t.useMemo)((()=>`ag-group-contracted ${S.toString()}`),[S]),P=(0,t.useMemo)((()=>`ag-group-checkbox ${x.toString()}`),[x]),A=h&&h.componentFromFramework,F=A?h.componentClass:void 0,D=null==h&&null!=f,L=Di(f,!0);return t.createElement("span",{className:E,ref:M,...e.colDef?{}:{role:u.current?.getCellAriaRole()}},t.createElement("span",{className:R,ref:l}),t.createElement("span",{className:T,ref:c}),t.createElement("span",{className:P,ref:a}),t.createElement("span",{className:"ag-group-value",ref:o},D&&t.createElement(t.Fragment,null,L),A&&t.createElement(F,{...h.params})),t.createElement("span",{className:"ag-group-child-count"},p))})),Dd=Fd,Ld=(0,t.createContext)({setMethods:()=>{}}),Id=(0,t.memo)((e=>{const{initialProps:n,addUpdateCallback:i,CustomComponentClass:r,setMethods:s}=e,[{key:o,...a},l]=(0,t.useState)(n);return(0,t.useEffect)((()=>{i((e=>l(e)))}),[]),t.createElement(Ld.Provider,{value:{setMethods:s}},t.createElement(r,{key:o,...a}))})),kd=0;function Od(){return"agPortalKey_"+ ++kd}var Nd=class{constructor(e,t,n,i){this.portal=null,this.oldPortal=null,this.reactComponent=e,this.portalManager=t,this.componentType=n,this.suppressFallbackMethods=!!i,this.statelessComponent=this.isStateless(this.reactComponent),this.key=Od(),this.portalKey=Od(),this.instanceCreated=this.isStatelessComponent()?Xs.resolve(!1):new Xs((e=>{this.resolveInstanceCreated=e}))}getGui(){return this.eParentElement}getRootElement(){return this.eParentElement.firstChild}destroy(){this.componentInstance&&"function"==typeof this.componentInstance.destroy&&this.componentInstance.destroy();const e=this.portal;e&&this.portalManager.destroyPortal(e)}createParentElement(e){const t=this.portalManager.getComponentWrappingElement(),n=document.createElement(t||"div");return n.classList.add("ag-react-container"),e.reactContainer=n,n}addParentContainerStyleAndClasses(){if(this.componentInstance&&(this.componentInstance.getReactContainerStyle&&this.componentInstance.getReactContainerStyle()&&(bt('Since v31.1 "getReactContainerStyle" is deprecated. Apply styling directly to ".ag-react-container" if needed.'),Object.assign(this.eParentElement.style,this.componentInstance.getReactContainerStyle())),this.componentInstance.getReactContainerClasses&&this.componentInstance.getReactContainerClasses())){bt('Since v31.1 "getReactContainerClasses" is deprecated. Apply styling directly to ".ag-react-container" if needed.');this.componentInstance.getReactContainerClasses().forEach((e=>this.eParentElement.classList.add(e)))}}statelessComponentRendered(){return this.eParentElement.childElementCount>0||this.eParentElement.childNodes.length>0}getFrameworkComponentInstance(){return this.componentInstance}isStatelessComponent(){return this.statelessComponent}getReactComponentName(){return this.reactComponent.name}getMemoType(){return this.hasSymbol()?Symbol.for("react.memo"):60115}hasSymbol(){return"function"===typeof Symbol&&Symbol.for}isStateless(e){return"function"===typeof e&&!(e.prototype&&e.prototype.isReactComponent)||"object"===typeof e&&e.$$typeof===this.getMemoType()}hasMethod(e){const t=this.getFrameworkComponentInstance();return!!t&&null!=t[e]||this.fallbackMethodAvailable(e)}callMethod(e,t){const n=this.getFrameworkComponentInstance();if(this.isStatelessComponent())return this.fallbackMethod(e,t&&t[0]?t[0]:{});if(!n)return void setTimeout((()=>this.callMethod(e,t)));const i=n[e];return i?i.apply(n,t):this.fallbackMethodAvailable(e)?this.fallbackMethod(e,t&&t[0]?t[0]:{}):void 0}addMethod(e,t){this[e]=t}init(e){return this.eParentElement=this.createParentElement(e),this.createOrUpdatePortal(e),new Xs((e=>this.createReactComponent(e)))}createOrUpdatePortal(e){this.isStatelessComponent()||(this.ref=e=>{this.componentInstance=e,this.addParentContainerStyleAndClasses(),this.resolveInstanceCreated?.(!0),this.resolveInstanceCreated=void 0},e.ref=this.ref),this.reactElement=this.createElement(this.reactComponent,{...e,key:this.key}),this.portal=(0,Cd.createPortal)(this.reactElement,this.eParentElement,this.portalKey)}createElement(e,n){return(0,t.createElement)(e,n)}createReactComponent(e){this.portalManager.mountReactPortal(this.portal,this,e)}rendered(){return this.isStatelessComponent()&&this.statelessComponentRendered()||!(this.isStatelessComponent()||!this.getFrameworkComponentInstance())}refreshComponent(e){this.oldPortal=this.portal,this.createOrUpdatePortal(e),this.portalManager.updateReactPortal(this.oldPortal,this.portal)}fallbackMethod(e,t){const n=this[`${e}Component`];if(!this.suppressFallbackMethods&&n)return n.bind(this)(t)}fallbackMethodAvailable(e){if(this.suppressFallbackMethods)return!1;return!!this[`${e}Component`]}};function Bd(e,t,n){e.forEach((e=>{const i=t[e];i&&(n[e]=i)}))}var zd=class extends Nd{constructor(){super(...arguments),this.awaitUpdateCallback=new Xs((e=>{this.resolveUpdateCallback=e})),this.wrapperComponent=Id}init(e){return this.sourceParams=e,super.init(this.getProps())}addMethod(){}getInstance(){return this.instanceCreated.then((()=>this.componentInstance))}getFrameworkComponentInstance(){return this}createElement(e,t){return super.createElement(this.wrapperComponent,{initialProps:t,CustomComponentClass:e,setMethods:e=>this.setMethods(e),addUpdateCallback:e=>{this.updateCallback=()=>(e(this.getProps()),new Xs((e=>{setTimeout((()=>{e()}))}))),this.resolveUpdateCallback()}})}setMethods(e){this.providedMethods=e,Bd(this.getOptionalMethods(),this.providedMethods,this)}getOptionalMethods(){return[]}getProps(){return{...this.sourceParams,key:this.key,ref:this.ref}}refreshProps(){return this.updateCallback?this.updateCallback():new Xs((e=>this.awaitUpdateCallback.then((()=>{this.updateCallback().then((()=>e()))}))))}},Hd=class extends zd{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},Gd=class extends zd{constructor(){super(...arguments),this.date=null,this.onDateChange=e=>this.updateDate(e)}getDate(){return this.date}setDate(e){this.date=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled"]}updateDate(e){this.setDate(e),this.sourceParams.onDateChanged()}getProps(){const e=super.getProps();return e.date=this.date,e.onDateChange=this.onDateChange,delete e.onDateChanged,e}},Ud=class extends zd{constructor(){super(...arguments),this.label="",this.icon=null,this.shake=!1}setIcon(e,t){this.icon=e,this.shake=t,this.refreshProps()}setLabel(e){this.label=e,this.refreshProps()}getProps(){const e=super.getProps(),{label:t,icon:n,shake:i}=this;return e.label=t,e.icon=n,e.shake=i,e}},Vd=class extends zd{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e),this.onUiChange=()=>this.sourceParams.filterChangedCallback(),this.expectingNewMethods=!0,this.hasBeenActive=!1}isFilterActive(){return null!=this.model}doesFilterPass(e){return this.providedMethods.doesFilterPass(e)}getModel(){return this.model}setModel(e){return this.expectingNewMethods=!0,this.model=e,this.hasBeenActive||(this.hasBeenActive=this.isFilterActive()),this.refreshProps()}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getOptionalMethods(){return["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onAnyFilterChanged"]}setMethods(e){!1===this.expectingNewMethods&&this.hasBeenActive&&this.providedMethods?.doesFilterPass!==e?.doesFilterPass&&setTimeout((()=>{this.sourceParams.filterChangedCallback()})),this.expectingNewMethods=!1,super.setMethods(e)}updateModel(e){this.setModel(e).then((()=>this.sourceParams.filterChangedCallback()))}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e.onUiChange=this.onUiChange,delete e.filterChangedCallback,delete e.filterModifiedCallback,delete e.valueGetter,e}};function Wd(e,t){e.parentFilterInstance((n=>{(n.setModel(t)||Xs.resolve()).then((()=>{e.filterParams.filterChangedCallback()}))}))}var jd=class{constructor(e,t){this.floatingFilterParams=e,this.refreshProps=t,this.model=null,this.onModelChange=e=>this.updateModel(e)}getProps(){return{...this.floatingFilterParams,model:this.model,onModelChange:this.onModelChange}}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){Bd(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),Wd(this.floatingFilterParams,e)}},qd=class extends zd{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e)}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),Wd(this.sourceParams,e)}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e}},Xd=class extends zd{refresh(e){this.sourceParams=e,this.refreshProps()}},Kd=class extends zd{constructor(){super(...arguments),this.active=!1,this.expanded=!1,this.onActiveChange=e=>this.updateActive(e)}setActive(e){this.awaitSetActive(e)}setExpanded(e){this.expanded=e,this.refreshProps()}getOptionalMethods(){return["select","configureDefaults"]}awaitSetActive(e){return this.active=e,this.refreshProps()}updateActive(e){const t=this.awaitSetActive(e);e&&t.then((()=>this.sourceParams.onItemActivated()))}getProps(){const e=super.getProps();return e.active=this.active,e.expanded=this.expanded,e.onActiveChange=this.onActiveChange,delete e.onItemActivated,e}},$d=class extends zd{refresh(e){this.sourceParams=e,this.refreshProps()}},Zd=class extends zd{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},Yd=class extends zd{constructor(){super(...arguments),this.onStateChange=e=>this.updateState(e)}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getState(){return this.state}updateState(e){this.state=e,this.refreshProps(),this.sourceParams.onStateUpdated()}getProps(){const e=super.getProps();return e.state=this.state,e.onStateChange=this.onStateChange,e}};function Jd(){bt("As of v32, using custom components with `reactiveCustomComponents = false` is deprecated.")}var Qd=class{constructor(e,t,n){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=t||"div",this.refresher=e,this.maxComponentCreationTimeMs=n||1e3}getPortals(){return this.portals}destroy(){this.destroyed=!0}destroyPortal(e){this.portals=this.portals.filter((t=>t!==e)),this.batchUpdate()}getComponentWrappingElement(){return this.wrappingElement}mountReactPortal(e,t,n){this.portals=[...this.portals,e],this.waitForInstance(t,n),this.batchUpdate()}updateReactPortal(e,t){this.portals[this.portals.indexOf(e)]=t,this.batchUpdate()}batchUpdate(){this.hasPendingPortalUpdate||(setTimeout((()=>{this.destroyed||(this.refresher(),this.hasPendingPortalUpdate=!1)})),this.hasPendingPortalUpdate=!0)}waitForInstance(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();if(this.destroyed)t(null);else if(e.rendered())t(e);else{if(Date.now()-n>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate)return;window.setTimeout((()=>{this.waitForInstance(e,t,n)}))}}},ep=(0,t.memo)((e=>{let{ctrl:n}=e;const i=n.isAlive(),{context:r}=(0,t.useContext)(wd),s=i?n.getColId():void 0,[o,a]=(0,t.useState)(),l=(0,t.useRef)(),c=(0,t.useRef)(null),u=(0,t.useRef)(null),h=(0,t.useRef)(null),d=(0,t.useRef)(),p=(0,t.useRef)();i&&!p.current&&(p.current=new lr((()=>c.current)));const g=(0,t.useCallback)((e=>{if(c.current=e,l.current=e?r.createBean(new Zi):r.destroyBean(l.current),!e||!i)return;const t={setWidth:e=>{c.current&&(c.current.style.width=e)},addOrRemoveCssClass:(e,t)=>p.current.addOrRemoveCssClass(e,t),setAriaSort:e=>{c.current&&(e?xr(c.current,e):_r(c.current))},setUserCompDetails:e=>a(e),getUserCompInstance:()=>d.current||void 0};n.setComp(t,e,u.current,h.current,l.current);const s=n.getSelectAllGui();u.current?.insertAdjacentElement("afterend",s),l.current.addDestroyFunc((()=>s.remove()))}),[]);(0,t.useLayoutEffect)((()=>Sd(o,r,h.current,d)),[o]),(0,t.useEffect)((()=>{n.setDragSource(c.current)}),[o]);const f=(0,t.useMemo)((()=>!!(o?.componentFromFramework&&Md(o.componentClass))),[o]),m=o&&o.componentFromFramework,v=o&&o.componentClass;return t.createElement("div",{ref:g,className:"ag-header-cell","col-id":s,role:"columnheader"},t.createElement("div",{ref:u,className:"ag-header-cell-resize",role:"presentation"}),t.createElement("div",{ref:h,className:"ag-header-cell-comp-wrapper",role:"presentation"},m&&f&&t.createElement(v,{...o.params}),m&&!f&&t.createElement(v,{...o.params,ref:d})))})),tp=(0,t.memo)((e=>{let{ctrl:n}=e;const{context:i,gos:r}=(0,t.useContext)(wd),[s,o]=(0,t.useState)((()=>new _d("ag-header-cell","ag-floating-filter"))),[a,l]=(0,t.useState)((()=>new _d)),[c,u]=(0,t.useState)((()=>new _d("ag-floating-filter-button","ag-hidden"))),[h,d]=(0,t.useState)("false"),[p,g]=(0,t.useState)(),[,f]=(0,t.useState)(1),m=(0,t.useRef)(),v=(0,t.useRef)(null),y=(0,t.useRef)(null),C=(0,t.useRef)(null),w=(0,t.useRef)(null),S=(0,t.useRef)(),b=(0,t.useRef)(),x=e=>{null!=e&&S.current&&S.current(e)},_=(0,t.useCallback)((e=>{if(v.current=e,m.current=e?i.createBean(new Zi):i.destroyBean(m.current),!e)return;b.current=new Xs((e=>{S.current=e}));const t={addOrRemoveCssClass:(e,t)=>o((n=>n.setClass(e,t))),addOrRemoveBodyCssClass:(e,t)=>l((n=>n.setClass(e,t))),setButtonWrapperDisplayed:e=>{u((t=>t.setClass("ag-hidden",!e))),d(e?"false":"true")},setWidth:e=>{v.current&&(v.current.style.width=e)},setCompDetails:e=>g(e),getFloatingFilterComp:()=>b.current?b.current:null,setMenuIcon:e=>w.current?.appendChild(e)};n.setComp(t,e,w.current,y.current,m.current)}),[]);(0,t.useLayoutEffect)((()=>Sd(p,i,y.current,x)),[p]);const M=(0,t.useMemo)((()=>s.toString()),[s]),E=(0,t.useMemo)((()=>a.toString()),[a]),R=(0,t.useMemo)((()=>c.toString()),[c]),T=(0,t.useMemo)((()=>!!(p&&p.componentFromFramework&&Md(p.componentClass))),[p]),P=(0,t.useMemo)((()=>r.get("reactiveCustomComponents")),[]),A=(0,t.useMemo)((()=>{if(p){if(P){const e=new jd(p.params,(()=>f((e=>e+1))));return x(e),e}p.componentFromFramework&&Jd()}}),[p]),F=A?.getProps(),D=p&&p.componentFromFramework,L=p&&p.componentClass;return t.createElement("div",{ref:_,className:M,role:"gridcell"},t.createElement("div",{ref:y,className:E,role:"presentation"},D&&!P&&t.createElement(L,{...p.params,ref:T?()=>{}:x}),D&&P&&t.createElement(Ld.Provider,{value:{setMethods:e=>A.setMethods(e)}},t.createElement(L,{...F}))),t.createElement("div",{ref:C,"aria-hidden":h,className:R,role:"presentation"},t.createElement("button",{ref:w,type:"button",className:"ag-button ag-floating-filter-button-button",tabIndex:-1})))})),np=(0,t.memo)((e=>{let{ctrl:n}=e;const{context:i}=(0,t.useContext)(wd),[r,s]=(0,t.useState)((()=>new _d)),[o,a]=(0,t.useState)((()=>new _d)),[l,c]=(0,t.useState)("false"),[u,h]=(0,t.useState)(),[d,p]=(0,t.useState)(),g=(0,t.useMemo)((()=>n.getColId()),[]),f=(0,t.useRef)(),m=(0,t.useRef)(null),v=(0,t.useRef)(null),y=(0,t.useRef)(null),C=(0,t.useRef)(),w=(0,t.useCallback)((e=>{if(m.current=e,f.current=e?i.createBean(new Zi):i.destroyBean(f.current),!e)return;const t={setWidth:e=>{m.current&&(m.current.style.width=e)},addOrRemoveCssClass:(e,t)=>s((n=>n.setClass(e,t))),setHeaderWrapperHidden:e=>{const t=y.current;t&&(e?t.style.setProperty("display","none"):t.style.removeProperty("display"))},setHeaderWrapperMaxHeight:e=>{const t=y.current;t&&(null!=e?t.style.setProperty("max-height",`${e}px`):t.style.removeProperty("max-height"),t.classList.toggle("ag-header-cell-comp-wrapper-limited-height",null!=e))},setUserCompDetails:e=>p(e),setResizableDisplayed:e=>{a((t=>t.setClass("ag-hidden",!e))),c(e?"false":"true")},setAriaExpanded:e=>h(e),getUserCompInstance:()=>C.current||void 0};n.setComp(t,e,v.current,y.current,f.current)}),[]);(0,t.useLayoutEffect)((()=>Sd(d,i,y.current)),[d]),(0,t.useEffect)((()=>{m.current&&n.setDragSource(m.current)}),[d]);const S=(0,t.useMemo)((()=>!!(d?.componentFromFramework&&Md(d.componentClass))),[d]),b=(0,t.useMemo)((()=>"ag-header-group-cell "+r.toString()),[r]),x=(0,t.useMemo)((()=>"ag-header-cell-resize "+o.toString()),[o]),_=d&&d.componentFromFramework,M=d&&d.componentClass;return t.createElement("div",{ref:w,className:b,"col-id":g,role:"columnheader","aria-expanded":u},t.createElement("div",{ref:y,className:"ag-header-cell-comp-wrapper",role:"presentation"},_&&S&&t.createElement(M,{...d.params}),_&&!S&&t.createElement(M,{...d.params,ref:C})),t.createElement("div",{ref:v,"aria-hidden":l,className:x}))})),ip=(0,t.memo)((e=>{let{ctrl:n}=e;const{context:i}=(0,t.useContext)(wd),{topOffset:r,rowHeight:s}=(0,t.useMemo)((()=>n.getTopAndHeight()),[]),o=n.getAriaRowIndex(),a=n.getHeaderRowClass(),[l,c]=(0,t.useState)((()=>s+"px")),[u,h]=(0,t.useState)((()=>r+"px")),d=(0,t.useRef)(null),p=(0,t.useRef)(null),[g,f]=(0,t.useState)((()=>n.getHeaderCtrls())),m=(0,t.useRef)(),v=(0,t.useRef)(null),y=(0,t.useCallback)((e=>{if(v.current=e,m.current=e?i.createBean(new Zi):i.destroyBean(m.current),!e)return;const t={setHeight:e=>c(e),setTop:e=>h(e),setHeaderCtrls:(e,t,n)=>{p.current=d.current,d.current=e;const i=Ad(p.current,e,t);i!==p.current&&Pd(n,(()=>f(i)))},setWidth:e=>{v.current&&(v.current.style.width=e)}};n.setComp(t,m.current,!1)}),[]),C=(0,t.useMemo)((()=>({height:l,top:u})),[l,u]),w=(0,t.useCallback)((e=>{switch(n.getType()){case $a.COLUMN_GROUP:return t.createElement(np,{ctrl:e,key:e.instanceId});case $a.FLOATING_FILTER:return t.createElement(tp,{ctrl:e,key:e.instanceId});default:return t.createElement(ep,{ctrl:e,key:e.instanceId})}}),[]);return t.createElement("div",{ref:y,className:a,role:"row",style:C,"aria-rowindex":o},g.map(w))})),rp=(0,t.memo)((e=>{let{pinned:n}=e;const[i,r]=(0,t.useState)(!0),[s,o]=(0,t.useState)([]),{context:a}=(0,t.useContext)(wd),l=(0,t.useRef)(null),c=(0,t.useRef)(null),u=(0,t.useRef)(),h="left"===n,d="right"===n,p=!h&&!d,g=(0,t.useCallback)((e=>{if(l.current=e,u.current=e?a.createBean(new fl(n)):a.destroyBean(u.current),!e)return;const t={setDisplayed:r,setCtrls:e=>o(e),setCenterWidth:e=>{c.current&&(c.current.style.width=e)},setViewportScrollLeft:e=>{l.current&&(l.current.scrollLeft=e)},setPinnedContainerWidth:e=>{l.current&&(l.current.style.width=e,l.current.style.minWidth=e,l.current.style.maxWidth=e)}};u.current.setComp(t,l.current)}),[]),f=i?"":"ag-hidden",m=()=>s.map((e=>t.createElement(ip,{ctrl:e,key:e.instanceId})));return t.createElement(t.Fragment,null,h&&t.createElement("div",{ref:g,className:"ag-pinned-left-header "+f,"aria-hidden":!i,role:"rowgroup"},m()),d&&t.createElement("div",{ref:g,className:"ag-pinned-right-header "+f,"aria-hidden":!i,role:"rowgroup"},m()),p&&t.createElement("div",{ref:g,className:"ag-header-viewport "+f,role:"presentation"},t.createElement("div",{ref:c,className:"ag-header-container",role:"rowgroup"},m())))})),sp=(0,t.memo)((()=>{const[e,n]=(0,t.useState)((()=>new _d)),[i,r]=(0,t.useState)(),{context:s}=(0,t.useContext)(wd),o=(0,t.useRef)(null),a=(0,t.useRef)(),l=(0,t.useCallback)((e=>{if(o.current=e,a.current=e?s.createBean(new Ya):s.destroyBean(a.current),!e)return;const t={addOrRemoveCssClass:(e,t)=>n((n=>n.setClass(e,t))),setHeightAndMinHeight:e=>r(e)};a.current.setComp(t,e,e)}),[]),c=(0,t.useMemo)((()=>"ag-header "+e.toString()),[e]),u=(0,t.useMemo)((()=>({height:i,minHeight:i})),[i]);return t.createElement("div",{ref:l,className:c,style:u,role:"presentation"},t.createElement(rp,{pinned:"left"}),t.createElement(rp,{pinned:null}),t.createElement(rp,{pinned:"right"}))})),op=(e,n)=>{(0,t.useEffect)((()=>{const t=n.current;if(t){const n=t.parentElement;if(n){const i=document.createComment(e);return n.insertBefore(i,t),()=>{n.removeChild(i)}}}}),[e])},ap=class{constructor(e,t){this.cellEditorParams=e,this.refreshProps=t,this.instanceCreated=new Xs((e=>{this.resolveInstanceCreated=e})),this.onValueChange=e=>this.updateValue(e),this.value=e.value}getProps(){return{...this.cellEditorParams,initialValue:this.cellEditorParams.value,value:this.value,onValueChange:this.onValueChange}}getValue(){return this.value}refresh(e){this.cellEditorParams=e,this.refreshProps()}setMethods(e){Bd(this.getOptionalMethods(),e,this)}getInstance(){return this.instanceCreated.then((()=>this.componentInstance))}setRef(e){this.componentInstance=e,this.resolveInstanceCreated?.(),this.resolveInstanceCreated=void 0}getOptionalMethods(){return["isCancelBeforeStart","isCancelAfterEnd","focusIn","focusOut","afterGuiAttached"]}updateValue(e){this.value=e,this.refreshProps()}},lp=(0,t.memo)((e=>{const[n,i]=(0,t.useState)(),{context:r,popupService:s,localeService:o,gos:a,editService:l}=(0,t.useContext)(wd);return(e=>{const n=(0,t.useRef)(e),i=(0,t.useRef)(),r=(0,t.useRef)(!1),s=(0,t.useRef)(!1),[,o]=(0,t.useState)(0);r.current&&(s.current=!0),(0,t.useEffect)((()=>(r.current||(i.current=n.current(),r.current=!0),o((e=>e+1)),()=>{s.current&&i.current?.()})),[])})((()=>{const{editDetails:t,cellCtrl:n,eParentCell:c}=e,{compDetails:u}=t,h=a.get("stopEditingWhenCellsLoseFocus"),d=r.createBean(l.createPopupEditorWrapper(u.params)),p=d.getGui();if(e.jsChildComp){const t=e.jsChildComp.getGui();t&&p.appendChild(t)}const g={column:n.getColumn(),rowNode:n.getRowNode(),type:"popupCellEditor",eventSource:c,ePopup:p,position:t.popupPosition,keepWithinBounds:!0},f=s.positionPopupByComponent.bind(s,g),m=o.getLocaleTextFunc(),v=s.addPopup({modal:h,eChild:p,closeOnEsc:!0,closedCallback:()=>{n.onPopupEditorClosed()},anchorToElement:c,positionCallback:f,ariaLabel:m("ariaLabelCellEditor","Cell Editor")}),y=v?v.hideFunc:void 0;return i(d),e.jsChildComp?.afterGuiAttached?.(),()=>{y?.(),r.destroyBean(d)}})),t.createElement(t.Fragment,null,n&&e.wrappedContent&&(0,Cd.createPortal)(e.wrappedContent,n.getGui()))})),cp=(e,n,i,r,s,o)=>{const{context:a}=(0,t.useContext)(wd),l=(0,t.useCallback)((()=>{const e=s.current;if(!e)return;const t=e.getGui();t&&t.parentElement&&t.parentElement.removeChild(t),a.destroyBean(e),s.current=void 0}),[]);(0,t.useEffect)((()=>{const t=null!=e,r=e?.compDetails&&!e.compDetails.componentFromFramework;if(!(t&&r&&!(n&&null==i)))return void l();const a=e.compDetails;if(s.current){const t=s.current,n=!!(null!=t.refresh&&0==e.force)&&t.refresh(a.params);if(!0===n||void 0===n)return;l()}const c=a.newAgStackInstance();null!=c&&c.then((e=>{if(!e)return;const t=e.getGui();if(!t)return;(n?i:o.current).appendChild(t),s.current=e}))}),[e,n,r]),(0,t.useEffect)((()=>l),[])},up=(e,n,i)=>{const r=e.compProxy;return t.createElement(t.Fragment,null,r?((e,n,i)=>{const{compProxy:r}=e;i(r);const s=r.getProps(),o=Md(n);return t.createElement(Ld.Provider,{value:{setMethods:e=>r.setMethods(e)}},o?t.createElement(n,{...s}):t.createElement(n,{...s,ref:e=>r.setRef(e)}))})(e,n,i):t.createElement(n,{...e.compDetails.params,ref:i}))},hp=(0,t.memo)((e=>{let{cellCtrl:n,printLayout:i,editingRow:r}=e;const{context:s}=(0,t.useContext)(wd),{colIdSanitised:o,instanceId:a}=n,l=(0,t.useRef)(),[c,u]=(0,t.useState)((()=>n.isCellRenderer()?void 0:{compDetails:void 0,value:n.getValueToDisplay(),force:!1})),[h,d]=(0,t.useState)(),[p,g]=(0,t.useState)(1),[f,m]=(0,t.useState)(),[v,y]=(0,t.useState)(!1),[C,w]=(0,t.useState)(!1),[S,b]=(0,t.useState)(!1),[x,_]=(0,t.useState)(),M=(0,t.useMemo)((()=>n.isForceWrapper()),[n]),E=(0,t.useMemo)((()=>n.getCellAriaRole()),[n]),R=(0,t.useRef)(null),T=(0,t.useRef)(null),P=(0,t.useRef)(),A=(0,t.useRef)(),F=(0,t.useRef)(),D=(0,t.useRef)([]),L=(0,t.useRef)(),[I,k]=(0,t.useState)(0),O=(0,t.useCallback)((e=>{L.current=e,k((e=>e+1))}),[]),N=M||null!=c&&(v||S||C),B=(0,t.useCallback)((e=>{if(A.current=e,e){const t=e.isCancelBeforeStart&&e.isCancelBeforeStart();setTimeout((()=>{t?(n.stopEditing(!0),n.focusCell(!0)):n.cellEditorAttached()}))}}),[n]),z=(0,t.useRef)();z.current||(z.current=new lr((()=>R.current))),cp(c,N,L.current,I,P,R);const H=(0,t.useRef)();(0,t.useLayoutEffect)((()=>{const e=H.current,t=c;if(H.current=c,null==e||null==e.compDetails||null==t||null==t.compDetails)return;const n=e.compDetails,i=t.compDetails;if(n.componentClass!=i.componentClass)return;if(null==T.current?.refresh)return;1!=T.current.refresh(i.params)&&g((e=>e+1))}),[c]),(0,t.useLayoutEffect)((()=>{if(!(h&&!h.compDetails.componentFromFramework))return;const e=h.compDetails,t=!0===h.popup,n=e.newAgStackInstance();return n.then((e=>{if(!e)return;const n=e.getGui();if(B(e),!t){const t=(M?F:R).current;t?.appendChild(n),e.afterGuiAttached&&e.afterGuiAttached()}_(e)})),()=>{n.then((e=>{const t=e.getGui();s.destroyBean(e),B(void 0),_(void 0),t?.parentElement?.removeChild(t)}))}}),[h]);const G=(0,t.useCallback)((e=>{if(F.current=e,!e)return D.current.forEach((e=>e())),void(D.current=[]);const t=t=>{if(t){const n=t.getGui();e.insertAdjacentElement("afterbegin",n),D.current.push((()=>{s.destroyBean(t),Jr(n)}))}return t};if(v){t(n.createSelectionCheckbox())}S&&t(n.createDndSource()),C&&t(n.createRowDragComp())}),[n,s,S,C,v]),U=(0,t.useCallback)((e=>{if(R.current=e,l.current=e?s.createBean(new Zi):s.destroyBean(l.current),!e||!n)return;const t={addOrRemoveCssClass:(e,t)=>z.current.addOrRemoveCssClass(e,t),setUserStyles:e=>m(e),getFocusableElement:()=>R.current,setIncludeSelection:e=>y(e),setIncludeRowDrag:e=>w(e),setIncludeDndSource:e=>b(e),getCellEditor:()=>A.current||null,getCellRenderer:()=>T.current??P.current,getParentOfValue:()=>L.current??F.current??R.current,setRenderDetails:(e,t,n)=>{u((i=>i?.compDetails!==e||i?.value!==t||i?.force!==n?{value:t,compDetails:e,force:n}:i))},setEditDetails:(e,t,n,i)=>{if(e){let r;i?r=new ap(e.params,(()=>g((e=>e+1)))):e.componentFromFramework&&Jd(),d({compDetails:e,popup:t,popupPosition:n,compProxy:r}),t||u(void 0)}else d((e=>{e?.compProxy&&(A.current=void 0)}))}},o=F.current||void 0;n.setComp(t,e,o,i,r,l.current)}),[]),V=(0,t.useMemo)((()=>!!(c?.compDetails?.componentFromFramework&&Md(c.compDetails.componentClass))),[c]);(0,t.useLayoutEffect)((()=>{R.current&&(z.current.addOrRemoveCssClass("ag-cell-value",!N),z.current.addOrRemoveCssClass("ag-cell-inline-editing",!!h&&!h.popup),z.current.addOrRemoveCssClass("ag-cell-popup-editing",!!h&&!!h.popup),z.current.addOrRemoveCssClass("ag-cell-not-inline-editing",!h||!!h.popup),n.getRowCtrl()?.setInlineEditingCss(),n.shouldRestoreFocus()&&!n.isEditing()&&R.current.focus({preventScroll:!0}))}));const W=()=>t.createElement(t.Fragment,null,null!=c&&((e,n,i,r,s,o,a)=>{const{compDetails:l,value:c}=e,u=!l,h=l&&l.componentFromFramework,d=l&&l.componentClass,p=c?.toString?c.toString():c,g=()=>t.createElement(t.Fragment,null,u&&t.createElement(t.Fragment,null,p),h&&!o&&t.createElement(d,{...l.params,key:n,ref:r}),h&&o&&t.createElement(d,{...l.params,key:n}));return t.createElement(t.Fragment,null,s?t.createElement("span",{role:"presentation",id:`cell-${i}`,className:"ag-cell-value",ref:a},g()):g())})(c,p,a,T,N,V,O),null!=h&&((e,n,i,r,s)=>{const o=e.compDetails,a=o.componentClass,l=o.componentFromFramework&&!e.popup,c=o.componentFromFramework&&e.popup,u=!o.componentFromFramework&&e.popup;return t.createElement(t.Fragment,null,l&&up(e,a,n),c&&t.createElement(lp,{editDetails:e,cellCtrl:r,eParentCell:i,wrappedContent:up(e,a,n)}),u&&s&&t.createElement(lp,{editDetails:e,cellCtrl:r,eParentCell:i,jsChildComp:s}))})(h,B,R.current,n,x)),j=(0,t.useCallback)((()=>n.onFocusOut()),[]);return t.createElement("div",{ref:U,style:f,role:E,"col-id":o,onBlur:j},N?t.createElement("div",{className:"ag-cell-wrapper",role:"presentation",ref:G},W()):W())})),dp=(0,t.memo)((e=>{let{rowCtrl:n,containerType:i}=e;const{context:r,gos:s}=(0,t.useContext)(wd),o=(0,t.useRef)(),a=(0,t.useRef)(n.getDomOrder()),l=n.isFullWidth(),c=n.getRowNode().displayed,[u,h]=(0,t.useState)((()=>c?n.getRowIndex():null)),[d,p]=(0,t.useState)((()=>n.getRowId())),[g,f]=(0,t.useState)((()=>n.getBusinessKey())),[m,v]=(0,t.useState)((()=>n.getRowStyles())),y=(0,t.useRef)(null),C=(0,t.useRef)(null),[w,S]=(0,t.useState)((()=>null)),[b,x]=(0,t.useState)(),[_,M]=(0,t.useState)((()=>c?n.getInitialRowTop(i):void 0)),[E,R]=(0,t.useState)((()=>c?n.getInitialTransform(i):void 0)),T=(0,t.useRef)(null),P=(0,t.useRef)(),A=(0,t.useRef)(!1),[F,D]=(0,t.useState)(0);(0,t.useEffect)((()=>{if(A.current||!b||F>10)return;const e=T.current?.firstChild;e?(n.setupDetailRowAutoHeight(e),A.current=!0):D((e=>e+1))}),[b,F]);const L=(0,t.useRef)();L.current||(L.current=new lr((()=>T.current)));const I=(0,t.useCallback)((e=>{if(T.current=e,o.current=e?r.createBean(new Zi):r.destroyBean(o.current),!e)return void n.unsetComp(i);if(!n.isAlive())return;const t={setTop:M,setTransform:R,addOrRemoveCssClass:(e,t)=>L.current.addOrRemoveCssClass(e,t),setDomOrder:e=>a.current=e,setRowIndex:h,setRowId:p,setRowBusinessKey:f,setUserStyles:v,setCellCtrls:(e,t)=>{C.current=y.current,y.current=e;const n=Ad(C.current,e,a.current);n!==C.current&&Pd(t,(()=>S(n)))},showFullWidth:e=>x(e),getFullWidthCellRenderer:()=>P.current,refreshFullWidth:e=>z.current?(x((t=>({...t,params:e()}))),!0):!(!P.current||!P.current.refresh)&&P.current.refresh(e())};n.setComp(t,e,i,o.current)}),[]);(0,t.useLayoutEffect)((()=>Sd(b,r,T.current,P)),[b]);const k=(0,t.useMemo)((()=>{const e={top:_,transform:E};return Object.assign(e,m),e}),[_,E,m]),O=l&&b?.componentFromFramework,N=!l&&null!=w,B=(0,t.useMemo)((()=>!!(b?.componentFromFramework&&Md(b.componentClass))),[b]),z=(0,t.useRef)(!1);(0,t.useEffect)((()=>{z.current=B&&!!b&&!!s.get("reactiveCustomComponents")}),[B,b]);return t.createElement("div",{ref:I,role:"row",style:k,"row-index":u,"row-id":d,"row-business-key":g},N&&w?.map((e=>t.createElement(hp,{cellCtrl:e,editingRow:n.isEditing(),printLayout:n.isPrintLayout(),key:e.instanceId}))),O&&(()=>{const e=b.componentClass;return t.createElement(t.Fragment,null,B?t.createElement(e,{...b.params}):t.createElement(e,{...b.params,ref:P}))})())})),pp=(0,t.memo)((e=>{let{name:n}=e;const{context:i}=(0,t.useContext)(wd),r=(0,t.useMemo)((()=>$l(n)),[n]),s=(0,t.useRef)(null),o=(0,t.useRef)(null),a=(0,t.useRef)([]),l=(0,t.useRef)([]),[c,u]=(0,t.useState)((()=>[])),h=(0,t.useRef)(!1),d=(0,t.useRef)(),p=(0,t.useMemo)((()=>xd(r.viewport)),[r]),g=(0,t.useMemo)((()=>xd(r.container)),[r]),f="center"===r.type;op(" AG Row Container "+n+" ",f?s:o);const m=(0,t.useCallback)((()=>f?null!=s.current&&null!=o.current:null!=o.current),[]),v=(0,t.useCallback)((()=>f?null==s.current&&null==o.current:null==o.current),[]),y=(0,t.useCallback)((()=>{if(v()&&(d.current=i.destroyBean(d.current)),m()){const e=e=>{const t=Ad(l.current,a.current,h.current);t!==l.current&&(l.current=t,Pd(e,(()=>u(t))))},t={setHorizontalScroll:e=>{s.current&&(s.current.scrollLeft=e)},setViewportHeight:e=>{s.current&&(s.current.style.height=e)},setRowCtrls:t=>{let{rowCtrls:n,useFlushSync:i}=t;const r=!!i&&a.current.length>0&&n.length>0;a.current=n,e(r)},setDomOrder:t=>{h.current!=t&&(h.current=t,e(!1))},setContainerWidth:e=>{o.current&&(o.current.style.width=e)},setOffsetTop:e=>{o.current&&(o.current.style.transform=`translateY(${e})`)}};d.current=i.createBean(new rc(n)),d.current.setComp(t,o.current,s.current)}}),[m,v]),C=(0,t.useCallback)((e=>{o.current=e,y()}),[y]),w=(0,t.useCallback)((e=>{s.current=e,y()}),[y]),S=()=>t.createElement("div",{className:g,ref:C,role:"rowgroup"},c.map((e=>t.createElement(dp,{rowCtrl:e,containerType:r.type,key:e.instanceId}))));return t.createElement(t.Fragment,null,f?t.createElement("div",{className:p,ref:w,role:"presentation"},S()):S())})),gp=(0,t.memo)((()=>{const{context:e,resizeObserverService:n}=(0,t.useContext)(wd),[i,r]=(0,t.useState)(""),[s,o]=(0,t.useState)(0),[a,l]=(0,t.useState)(0),[c,u]=(0,t.useState)("0px"),[h,d]=(0,t.useState)("0px"),[p,g]=(0,t.useState)("100%"),[f,m]=(0,t.useState)("0px"),[v,y]=(0,t.useState)("0px"),[C,w]=(0,t.useState)("100%"),[S,b]=(0,t.useState)(""),[x,_]=(0,t.useState)(""),[M,E]=(0,t.useState)(null),[R,T]=(0,t.useState)(""),[P,A]=(0,t.useState)(null),[F,D]=(0,t.useState)("ag-layout-normal"),L=(0,t.useRef)();L.current||(L.current=new lr((()=>I.current)));const I=(0,t.useRef)(null),k=(0,t.useRef)(null),O=(0,t.useRef)(null),N=(0,t.useRef)(null),B=(0,t.useRef)(null),z=(0,t.useRef)(null),H=(0,t.useRef)(null),G=(0,t.useRef)([]),U=(0,t.useRef)([]);op(" AG Grid Body ",I),op(" AG Pinned Top ",k),op(" AG Sticky Top ",O),op(" AG Middle ",z),op(" AG Pinned Bottom ",H);const V=(0,t.useCallback)((t=>{if(I.current=t,!t)return G.current=e.destroyBeans(G.current),U.current.forEach((e=>e())),void(U.current=[]);if(!e)return;const i=(e,t)=>{e.appendChild(t),U.current.push((()=>e.removeChild(t)))},s=(t,n,r)=>{i(t,document.createComment(r)),i(t,(t=>{const n=e.createBean(new t);return G.current.push(n),n})(n).getGui())};s(t,Cl," AG Fake Horizontal Scroll "),s(t,vl," AG Overlay Wrapper "),B.current&&s(B.current,Sl," AG Fake Vertical Scroll ");const a={setRowAnimationCssOnBodyViewport:r,setColumnCount:e=>{I.current&&Sr(I.current,e)},setRowCount:e=>{I.current&&Cr(I.current,e)},setTopHeight:o,setBottomHeight:l,setStickyTopHeight:u,setStickyTopTop:d,setStickyTopWidth:g,setTopDisplay:b,setBottomDisplay:_,setColumnMovingCss:(e,t)=>L.current.addOrRemoveCssClass(e,t),updateLayoutClasses:D,setAlwaysVerticalScrollClass:E,setPinnedTopBottomOverflowY:T,setCellSelectableCss:(e,t)=>A(t?e:null),setBodyViewportWidth:e=>{z.current&&(z.current.style.width=e)},registerBodyViewportResizeListener:e=>{if(z.current){const t=n.observeResize(z.current,e);U.current.push((()=>t()))}},setStickyBottomHeight:m,setStickyBottomBottom:y,setStickyBottomWidth:w},c=e.createBean(new oc);G.current.push(c),c.setComp(a,t,z.current,k.current,H.current,O.current,N.current)}),[]),W=(0,t.useMemo)((()=>xd("ag-root","ag-unselectable",F)),[F]),j=(0,t.useMemo)((()=>xd("ag-body-viewport",i,F,M,P)),[i,F,M,P]),q=(0,t.useMemo)((()=>xd("ag-body",F)),[F]),X=(0,t.useMemo)((()=>xd("ag-floating-top",P)),[P]),K=(0,t.useMemo)((()=>xd("ag-sticky-top",P)),[P]),$=(0,t.useMemo)((()=>xd("ag-sticky-bottom","0px"===f?"ag-hidden":null,P)),[P,f]),Z=(0,t.useMemo)((()=>xd("ag-floating-bottom",P)),[P]),Y=(0,t.useMemo)((()=>({height:s,minHeight:s,display:S,overflowY:R})),[s,S,R]),J=(0,t.useMemo)((()=>({height:c,top:h,width:p})),[c,h,p]),Q=(0,t.useMemo)((()=>({height:f,bottom:v,width:C})),[f,v,C]),ee=(0,t.useMemo)((()=>({height:a,minHeight:a,display:x,overflowY:R})),[a,x,R]),te=e=>t.createElement(pp,{name:e,key:`${e}-container`}),ne=e=>{let{section:n,children:i,className:r,style:s}=e;return t.createElement("div",{ref:n,className:r,role:"presentation",style:s},i.map(te))};return t.createElement("div",{ref:V,className:W,role:"treegrid"},t.createElement(sp,null),ne({section:k,className:X,style:Y,children:["topLeft","topCenter","topRight","topFullWidth"]}),t.createElement("div",{className:q,ref:B,role:"presentation"},ne({section:z,className:j,children:["left","center","right","fullWidth"]})),ne({section:O,className:K,style:J,children:["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"]}),ne({section:N,className:$,style:Q,children:["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"]}),ne({section:H,className:Z,style:ee,children:["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"]}))})),fp=(0,t.forwardRef)(((e,n)=>{const{children:i,eFocusableElement:r,onTabKeyDown:s,gridCtrl:o,forceFocusOutWhenTabGuardsAreEmpty:a}=e,{context:l}=(0,t.useContext)(wd),c=(0,t.useRef)(null),u=(0,t.useRef)(null),h=(0,t.useRef)(),d=e=>{const t=null==e?void 0:parseInt(e,10).toString();[c,u].forEach((e=>{void 0===t?e.current?.removeAttribute("tabindex"):e.current?.setAttribute("tabindex",t)}))};(0,t.useImperativeHandle)(n,(()=>({forceFocusOutOfContainer(e){h.current?.forceFocusOutOfContainer(e)}})));const p=(0,t.useCallback)((()=>{const e=c.current,t=u.current;if(e||t){if(e&&t){const n={setTabIndex:d};h.current=l.createBean(new Kc({comp:n,eTopGuard:e,eBottomGuard:t,eFocusableElement:r,onTabKeyDown:s,forceFocusOutWhenTabGuardsAreEmpty:a,focusInnerElement:e=>o.focusInnerElement(e)}))}}else h.current=l.destroyBean(h.current)}),[]),g=(0,t.useCallback)((e=>{c.current=e,p()}),[p]),f=(0,t.useCallback)((e=>{u.current=e,p()}),[p]),m=e=>{const n="top"===e?Xc.TAB_GUARD_TOP:Xc.TAB_GUARD_BOTTOM;return t.createElement("div",{className:`${Xc.TAB_GUARD} ${n}`,role:"presentation",ref:"top"===e?g:f})};return t.createElement(t.Fragment,null,m("top"),i,m("bottom"))})),mp=(0,t.memo)(fp),vp=(0,t.memo)((e=>{let{context:n}=e;const[i,r]=(0,t.useState)(""),[s,o]=(0,t.useState)(""),[a,l]=(0,t.useState)(""),[c,u]=(0,t.useState)(null),[h,d]=(0,t.useState)(null),[p,g]=(0,t.useState)(!1),[f,m]=(0,t.useState)(),v=(0,t.useRef)(),y=(0,t.useRef)(null),C=(0,t.useRef)(),[w,S]=(0,t.useState)(null),b=(0,t.useRef)((()=>{})),x=(0,t.useRef)(),_=(0,t.useRef)([]),M=(0,t.useCallback)((()=>{}),[]),E=(0,t.useMemo)((()=>n.isDestroyed()?null:n.getBeans()),[n]);op(" AG Grid ",y);const R=(0,t.useCallback)((e=>{if(y.current=e,v.current=e?n.createBean(new Iu):n.destroyBean(v.current),!e||n.isDestroyed())return;const t=v.current;b.current=t.focusInnerElement.bind(t);const i={destroyGridUi:()=>{},setRtlClass:r,setGridThemeClass:o,forceFocusOutOfContainer:e=>{e||!x.current?.isDisplayed()?C.current?.forceFocusOutOfContainer(e):x.current.forceFocusOutOfContainer(e)},updateLayoutClasses:l,getFocusableContainers:()=>{const e=[],t=y.current?.querySelector(".ag-root");return t&&e.push({getGui:()=>t}),_.current.forEach((t=>{t.isDisplayed()&&e.push(t)})),e},setCursor:u,setUserSelect:d};t.setComp(i,e,e),g(!0)}),[]);(0,t.useEffect)((()=>{const e=v.current,t=y.current;if(!f||!E||!e||!w||!t)return;const i=[],{watermarkSelector:r,paginationSelector:s,sideBarSelector:o,statusBarSelector:a,gridHeaderDropZonesSelector:l}=e.getOptionalSelectors(),c=[];if(l){const e=n.createBean(new l.component),r=e.getGui();t.insertAdjacentElement("afterbegin",r),c.push(r),i.push(e)}if(o){const e=n.createBean(new o.component),t=e.getGui(),r=w.querySelector(".ag-tab-guard-bottom");r&&(r.insertAdjacentElement("beforebegin",t),c.push(t)),i.push(e),_.current.push(e)}const u=e=>{const r=n.createBean(new e),s=r.getGui();return t.insertAdjacentElement("beforeend",s),c.push(s),i.push(r),r};if(a&&u(a.component),s){const e=u(s.component);x.current=e,_.current.push(e)}return r&&u(r.component),()=>{n.destroyBeans(i),c.forEach((e=>{e.parentElement?.removeChild(e)}))}}),[f,w,E]);const T=(0,t.useMemo)((()=>xd("ag-root-wrapper",i,s,a)),[i,s,a]),P=(0,t.useMemo)((()=>xd("ag-root-wrapper-body","ag-focus-managed",a)),[a]),A=(0,t.useMemo)((()=>({userSelect:null!=h?h:"",WebkitUserSelect:null!=h?h:"",cursor:null!=c?c:""})),[h,c]),F=(0,t.useCallback)((e=>{C.current=e,m(null!==e)}),[]);return t.createElement("div",{ref:R,className:T,style:A,role:"presentation"},t.createElement("div",{className:P,ref:S,role:"presentation"},p&&w&&E&&t.createElement(wd.Provider,{value:E},t.createElement(mp,{ref:F,eFocusableElement:w,onTabKeyDown:M,gridCtrl:v.current,forceFocusOutWhenTabGuardsAreEmpty:!0},t.createElement(gp,null)))))})),yp=class extends Vn{wireBeans(e){this.ctrlsService=e.ctrlsService}areHeaderCellsRendered(){return this.ctrlsService.getHeaderRowContainerCtrls().every((e=>e.getAllCtrls().every((e=>e.areCellsRendered()))))}},Cp=e=>{const n=(0,t.useRef)(),i=(0,t.useRef)(null),r=(0,t.useRef)(null),s=(0,t.useRef)([]),o=(0,t.useRef)([]),a=(0,t.useRef)(e),l=(0,t.useRef)(),c=(0,t.useRef)(),u=(0,t.useRef)(!1),[h,d]=(0,t.useState)(void 0),[,p]=(0,t.useState)(0),g=(0,t.useCallback)((t=>{if(i.current=t,!t)return s.current.forEach((e=>e())),void(s.current.length=0);const a=e.modules||[];r.current||(r.current=new Qd((()=>p((e=>e+1))),e.componentWrappingElement,e.maxComponentCreationTimeMs),s.current.push((()=>{r.current?.destroy(),r.current=null})));const h=function(e,t){"object"!==typeof e&&(e={});const n={...e};return $i.ALL_PROPERTIES_AND_CALLBACKS.forEach((e=>{const i=t[e];"undefined"!==typeof i&&i!==$i.VUE_OMITTED_PROPERTY&&(n[e]=i)})),n}(e.gridOptions,e),g=new bp((()=>{if(u.current){const e=()=>l.current?.shouldQueueUpdates()?void 0:o.current.shift();let t=e();for(;t;)t(),t=e()}}));l.current=g;const f=new yp,m={providedBeanInstances:{frameworkComponentWrapper:new wp(r.current,h.reactiveCustomComponents??(v="reactiveCustomComponents",Bh.gridOptions?.[v])??!0),renderStatusService:f},modules:a,frameworkOverrides:g};var v;const y=new Hh;h.gridId??(h.gridId=c.current),n.current=y.create(t,h,(t=>{d(t),t.createBean(f),s.current.push((()=>{t.destroy()})),t.getBean("ctrlsService").whenReady({addDestroyFunc:e=>{s.current.push(e)}},(()=>{if(t.isDestroyed())return;const i=n.current;i&&e.setGridApi?.(i)}))}),(e=>{e.getBean("ctrlsService").whenReady({addDestroyFunc:e=>{s.current.push(e)}},(()=>{o.current.forEach((e=>e())),o.current.length=0,u.current=!0}))}),m),s.current.push((()=>{n.current=void 0})),n.current&&(c.current=n.current.getGridId())}),[]),f=(0,t.useMemo)((()=>({height:"100%",...e.containerStyle||{}})),[e.containerStyle]),m=(0,t.useCallback)((e=>{u.current&&!l.current?.shouldQueueUpdates()?e():o.current.push(e)}),[]);return(0,t.useEffect)((()=>{const t=function(e,t){const n={};return Object.keys(t).forEach((i=>{const r=t[i];e[i]!==r&&(n[i]=r)})),n}(a.current,e);a.current=e,m((()=>{n.current&&function(e,t){if(!e)return;const n={};let i=!1;if(Object.keys(e).filter((e=>$i.ALL_PROPERTIES_AND_CALLBACKS_SET.has(e))).forEach((t=>{n[t]=e[t],i=!0})),!i)return;const r={type:"gridOptionsChanged",options:n};t.dispatchEvent(r);const s={type:"componentStateChanged"};ii(n,((e,t)=>{s[e]=t})),t.dispatchEvent(s)}(t,n.current)}))}),[e]),t.createElement("div",{style:f,className:e.className,ref:g},h&&!h.isDestroyed()?t.createElement(vp,{context:h}):null,r.current?.getPortals()??null)};var wp=class extends Wh{constructor(e,t){super(),this.parent=e,this.reactiveCustomComponents=t}createWrapper(e,t){if(this.reactiveCustomComponents){const n=(e=>{switch(e){case"filter":return Vd;case"floatingFilterComponent":return qd;case"dateComponent":return Gd;case"dragAndDropImageComponent":return Ud;case"loadingOverlayComponent":return Xd;case"noRowsOverlayComponent":return $d;case"statusPanel":return Zd;case"toolPanel":return Yd;case"menuItem":return Kd;case"cellRenderer":return Hd}})(t.propertyName);if(n)return new n(e,this.parent,t)}else switch(t.propertyName){case"filter":case"floatingFilterComponent":case"dateComponent":case"dragAndDropImageComponent":case"loadingOverlayComponent":case"noRowsOverlayComponent":case"statusPanel":case"toolPanel":case"menuItem":case"cellRenderer":Jd()}const n=!t.cellRenderer&&"toolPanel"!==t.propertyName;return new Nd(e,this.parent,t,n)}},Sp=(0,t.forwardRef)(((e,n)=>{const{ctrlsFactory:i,context:r,gos:s,resizeObserverService:o,rowModel:a}=(0,t.useContext)(wd),[l,c]=(0,t.useState)((()=>new _d)),[u,h]=(0,t.useState)((()=>new _d)),[d,p]=(0,t.useState)(),[g,f]=(0,t.useState)(),m=(0,t.useRef)(),v=(0,t.useRef)(null),y=(0,t.useRef)(),C=(0,t.useMemo)((()=>Co.__getGridRegisteredModules(e.api.getGridId())),[e]),w=(0,t.useMemo)((()=>l.toString()+" ag-details-row"),[l]),S=(0,t.useMemo)((()=>u.toString()+" ag-details-grid"),[u]);n&&(0,t.useImperativeHandle)(n,(()=>({refresh:()=>m.current?.refresh()??!1}))),e.template&&bt("detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://ag-grid.com/react-data-grid/master-detail-custom-detail/");const b=(0,t.useCallback)((t=>{if(v.current=t,!t)return m.current=r.destroyBean(m.current),void y.current?.();const n={addOrRemoveCssClass:(e,t)=>c((n=>n.setClass(e,t))),addOrRemoveDetailGridCssClass:(e,t)=>h((n=>n.setClass(e,t))),setDetailGrid:e=>p(e),setRowData:e=>f(e),getGui:()=>v.current},l=i.getInstance("detailCellRenderer");if(l&&(r.createBean(l),l.init(n,e),m.current=l,s.get("detailRowAutoHeight"))){const n=()=>{if(null==v.current)return;const t=v.current.clientHeight;if(null!=t&&t>0){setTimeout((()=>{e.node.setRowHeight(t),(Vt(s)||Wt(s))&&a.onRowHeightChanged()}),0)}};y.current=o.observeResize(t,n),n()}}),[]),x=(0,t.useCallback)((e=>{m.current?.registerDetailWithMaster(e)}),[]);return t.createElement("div",{className:w,ref:b},d&&t.createElement(Cp,{className:S,...d,modules:C,rowData:g,setGridApi:x}))})),bp=class extends eu{constructor(e){super("react"),this.processQueuedUpdates=e,this.queueUpdates=!1,this.frameworkComponents={agGroupCellRenderer:Dd,agGroupRowRenderer:Dd,agDetailCellRenderer:Sp},this.wrapIncoming=(e,t)=>{return"ensureVisible"===t?(n=e,Td||setTimeout((()=>Td=!1),0),Td=!0,n()):e();var n},this.renderingEngine="react"}frameworkComponent(e){return this.frameworkComponents[e]}isFrameworkComponent(e){if(!e)return!1;const t=e.prototype;return!(t&&"getGui"in t)}getLockOnRefresh(){this.queueUpdates=!0}releaseLockOnRefresh(){this.queueUpdates=!1,this.processQueuedUpdates()}shouldQueueUpdates(){return this.queueUpdates}runWhenReadyAsync(){return"19"===Ed}},xp=class extends t.Component{constructor(){super(...arguments),this.apiListeners=[],this.setGridApi=e=>{this.api=e,this.apiListeners.forEach((t=>t(e)))}}registerApiListener(e){this.apiListeners.push(e)}componentWillUnmount(){this.apiListeners.length=0}render(){return t.createElement(Cp,{...this.props,setGridApi:this.setGridApi})}};const _p=e=>{let{selectedRowData:n,onUpdate:i,onClose:r}=e;const[s,o]=(0,t.useState)(""),[a,l]=(0,t.useState)(""),[c,u]=(0,t.useState)(""),[h,d]=(0,t.useState)(0),[p,g]=(0,t.useState)(""),[f,m]=(0,t.useState)(0),[v,y]=(0,t.useState)(0),[C,w]=(0,t.useState)(n||{}),[S,b]=(0,t.useState)({}),[x,_]=(0,t.useState)(!1),M={S:5e3,M:1e4,L:2e4},E={"\uc0c1\uc628":5e3,"\ub0c9\uc7a5":1e4,"\ub0c9\ub3d9":2e4};(0,t.useEffect)((()=>{w(n||{}),console.log("\uc120\ud0dd\ub41c \ub370\uc774\ud130:",n),b({})}),[n]);const R=e=>{const{name:t,value:n}=e.target;w((e=>({...e,[t]:n})))},T=e=>{const{name:t,checked:n}=e.target;b((e=>({...e,[t]:n})))};(0,t.useEffect)((()=>{if(C.subscription_inbound_date&&C.outbound_date){const e=new Date(C.subscription_inbound_date),t=new Date(C.outbound_date);if(isNaN(e)||isNaN(t))m(0);else{const n=Math.max(0,Math.ceil((t-e)/864e5));m(n)}}}),[C.subscription_inbound_date,C.outbound_date]);const P=e=>{if(!e)return"";const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`};return(0,st.jsxs)("div",{style:{width:"100%",height:"550px",background:"white",borderRadius:"10px",overflow:"hidden",display:"flex",flexDirection:"column"},children:[(0,st.jsxs)("div",{style:{display:"flex",flex:1,gap:"30px",overflow:"hidden"},children:[(0,st.jsxs)("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",height:"400px"},children:[(0,st.jsx)("h4",{style:{color:"#6f47c5",fontWeight:"bold",marginBottom:"10px"},children:"\uacac\uc801\uc11c \uc815\ubcf4"}),(0,st.jsxs)("table",{style:{...Mp.table,height:"50%"},children:[(0,st.jsx)("thead",{children:(0,st.jsxs)("tr",{style:Mp.tableHeaderRow,children:[(0,st.jsx)("th",{style:{...Mp.tableHeader,width:"25%"},children:"\ud56d\ubaa9"}),(0,st.jsx)("th",{style:{...Mp.tableHeader,width:"60%"},children:"\uace0\uac1d \uc785\ub825\uac12"}),(0,st.jsx)("th",{style:{...Mp.tableHeader,width:"15%"},children:"\uc218\uc815"})]})}),(0,st.jsx)("tbody",{children:[{label:"\uc5c5\uccb4\uba85",name:"company_name"},{label:"\uc0c1\ud488\uba85",name:"product_name"},{label:"\uc218\ub7c9",name:"inbound_quantity"},{label:"\ubb34\uac8c",name:"weight"},{label:"\uc0c1\ud0dc",name:"warehouse_type"},{label:"\uc785\uace0\uc77c",name:"subscription_inbound_date",type:"date"},{label:"\ucd9c\uace0\uc77c",name:"outbound_date",type:"date"}].map((e=>{let{label:t,name:n,type:i="text"}=e;return(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:Mp.tableCell,children:t}),(0,st.jsx)("td",{style:Mp.tableCell,children:(0,st.jsx)("input",{type:i,name:n,value:"date"===i?P(C[n]):C[n]||"",onChange:R,disabled:!S[n],style:Mp.input})}),(0,st.jsx)("td",{style:Mp.tableCell,children:(0,st.jsx)("input",{type:"checkbox",name:n,checked:!!S[n],onChange:T})})]},n)}))})]})]}),(0,st.jsxs)("div",{style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",height:"400px"},children:[(0,st.jsx)("h4",{style:{color:"#6f47c5",fontWeight:"bold",marginBottom:"10px"},children:"\uacac\uc801\uc11c \uc815\ubcf4"}),(0,st.jsxs)("table",{style:{...Mp.table,height:"70%"},children:[(0,st.jsx)("thead",{children:(0,st.jsxs)("tr",{style:Mp.tableHeaderRow,children:[(0,st.jsx)("th",{style:{...Mp.tableHeader,width:"40%"},children:"\ud56d\ubaa9"}),(0,st.jsx)("th",{style:{...Mp.tableHeader,width:"60%"},children:"\uac12\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694"})]})}),(0,st.jsx)("tbody",{children:[{label:"\uc81c\ud488 \ubc88\ud638",value:s,onChange:o,type:"text"},{label:"\ucc3d\uace0 \uc704\uce58",value:a,onChange:l,type:"select",options:["\uc120\ud0dd","\ubcf4\uad00\uc18c A","\ubcf4\uad00\uc18c B","\ubcf4\uad00\uc18c C","\ubcf4\uad00\uc18c D","\ubcf4\uad00\uc18c E","\ubcf4\uad00\uc18c F","\ubcf4\uad00\uc18c G","\ubcf4\uad00\uc18c H","\ubcf4\uad00\uc18c I"]},{label:"\ud314\ub808\ud2b8 \uc885\ub958",value:c,onChange:u,type:"select",options:["\uc120\ud0dd","S","M","L"]},{label:"\ud314\ub808\ud2b8 \uac1c\uc218",value:h,onChange:d,type:"number"},{label:"\ubcf4\uad00 \ud0c0\uc785",value:p,onChange:g,type:"select",options:["\uc120\ud0dd","\uc0c1\uc628","\ub0c9\uc7a5","\ub0c9\ub3d9"]}].map(((e,t)=>{let{label:n,value:i,onChange:r,type:s,options:o}=e;return(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:Mp.tableCell,children:n}),(0,st.jsx)("td",{style:Mp.tableCell,children:"select"===s?(0,st.jsx)("select",{value:i,onChange:e=>r(e.target.value),style:Mp.input,children:o.map(((e,t)=>(0,st.jsx)("option",{value:"\uc120\ud0dd\ud574\uc8fc\uc138\uc694"===e?"":e,children:e},t)))}):(0,st.jsx)("input",{type:s,value:"number"===s?Number(i):i,onChange:e=>r("number"===s?Number(e.target.value):e.target.value),style:Mp.input})})]},t)}))})]})]})]}),(0,st.jsxs)("div",{style:Mp.resultBox,children:[(0,st.jsxs)("div",{style:{textAlign:"center"},children:["\ubcf4\uad00 \uc77c\uc218\ub294 ",(0,st.jsxs)("strong",{style:{color:"#6f47c5"},children:[f,"\uc77c"]})," \uc785\ub2c8\ub2e4."]}),(0,st.jsxs)("h4",{style:Mp.resultTitle,children:["\ucd1d \uc608\uc0c1 \ube44\uc6a9\uc740 ",v.toLocaleString()," \uc6d0\uc785\ub2c8\ub2e4."]})]}),(0,st.jsxs)("div",{style:Mp.buttonRow,children:[!x&&(0,st.jsx)("button",{style:Mp.calculateButton,onClick:()=>{y(((M[c]||0)+(E[p]||0))*h*f),_(!0)},children:"\ud83d\udcb0 \ucd1d \ube44\uc6a9 \uacc4\uc0b0\ud558\uae30"}),(0,st.jsx)("button",{style:Mp.sendButton,onClick:()=>{let e=0;if(C.subscription_inbound_date&&C.outbound_date){const t=new Date(C.subscription_inbound_date),n=new Date(C.outbound_date);isNaN(t)||isNaN(n)||(e=Math.max(0,Math.ceil((n-t)/864e5)))}const t=((M[c]||0)+(E[p]||0))*h*e,n={...C,product_number:s,warehouse_location:a,pallet_size:c,pallet_num:h,warehouse_type:p,storage_duration:e,total_cost:Number(t.toFixed(2))};i(n),r()},children:"\ud83d\udce4 \uacac\uc801\uc11c \ubcf4\ub0b4\uae30"})]})]})},Mp={sectionTitle:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"15px",paddingBottom:"10px",borderBottom:"2px solid #6f47c5"},container:{overflowY:"auto",msOverflowStyle:"none",scrollbarWidth:"none"},buttonPurple:{padding:"12px",backgroundColor:"#6f47c5",color:"white",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer"},buttonRow:{display:"flex",gap:"12px",marginBottom:"30px",justifyContent:"space-between"},table:{height:"400px",borderCollapse:"collapse",border:"1px solid #6f47c5",tableLayout:"fixed",width:"100%"},tableHeaderRow:{backgroundColor:"#f5f1fa"},tableHeader:{border:"1px solid #6f47c5",padding:"5px",textAlign:"center",fontWeight:"bold",color:"#6f47c5",fontSize:"14px",lineHeight:"1.0"},tableCell:{border:"1px solid #6f47c5",padding:"6px",fontSize:"13px",lineHeight:"1.2"},input:{width:"100%",padding:"4px 6px",borderRadius:"4px",fontSize:"13px",outline:"none",border:"none",boxSizing:"border-box"},calculateButton:{marginTop:"20px",padding:"8px 12px",background:"linear-gradient(to right,rgb(148, 128, 248), #6f47c5)",color:"white",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",width:"100%",boxShadow:"0 4px 10px rgba(0,0,0,0.1)"},resultBox:{marginTop:"20px",backgroundColor:"#f9f7ff",padding:"10px",borderRadius:"10px",width:"100%",textAlign:"center",boxShadow:"0 4px 12px rgba(0,0,0,0.08)"},resultTitle:{color:"#6f47c5",fontSize:"16px",marginBottom:"10px"},resultAmount:{fontSize:"22px",fontWeight:"bold",color:"#333"},sendButton:{marginTop:"20px",padding:"8px 12px",background:"linear-gradient(to right,rgb(129, 127, 133),rgb(84, 84, 85))",color:"white",border:"none",borderRadius:"10px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",width:"100%",boxShadow:"0 4px 10px rgba(0,0,0,0.12)"},cancelButton:{padding:"10px 20px",background:"#eee",color:"#333",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",width:"100%"}},Ep="176",Rp={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Tp={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Pp=0,Ap=1,Fp=2,Dp=3,Lp=0,Ip=1,kp=2,Op=3,Np=0,Bp=1,zp=2,Hp=0,Gp=1,Up=2,Vp=3,Wp=4,jp=5,qp=100,Xp=101,Kp=102,$p=103,Zp=104,Yp=200,Jp=201,Qp=202,eg=203,tg=204,ng=205,ig=206,rg=207,sg=208,og=209,ag=210,lg=211,cg=212,ug=213,hg=214,dg=0,pg=1,gg=2,fg=3,mg=4,vg=5,yg=6,Cg=7,wg=0,Sg=1,bg=2,xg=0,_g=1,Mg=2,Eg=3,Rg=4,Tg=5,Pg=6,Ag=7,Fg="attached",Dg="detached",Lg=300,Ig=301,kg=302,Og=303,Ng=304,Bg=306,zg=1e3,Hg=1001,Gg=1002,Ug=1003,Vg=1004,Wg=1004,jg=1005,qg=1005,Xg=1006,Kg=1007,$g=1007,Zg=1008,Yg=1008,Jg=1009,Qg=1010,ef=1011,tf=1012,nf=1013,rf=1014,sf=1015,of=1016,af=1017,lf=1018,cf=1020,uf=35902,hf=1021,df=1022,pf=1023,gf=1026,ff=1027,mf=1028,vf=1029,yf=1030,Cf=1031,wf=1032,Sf=1033,bf=33776,xf=33777,_f=33778,Mf=33779,Ef=35840,Rf=35841,Tf=35842,Pf=35843,Af=36196,Ff=37492,Df=37496,Lf=37808,If=37809,kf=37810,Of=37811,Nf=37812,Bf=37813,zf=37814,Hf=37815,Gf=37816,Uf=37817,Vf=37818,Wf=37819,jf=37820,qf=37821,Xf=36492,Kf=36494,$f=36495,Zf=36283,Yf=36284,Jf=36285,Qf=36286,em=2200,tm=2201,nm=2202,im=2300,rm=2301,sm=2302,om=2400,am=2401,lm=2402,cm=2500,um=2501,hm=0,dm=1,pm=2,gm=3200,fm=3201,mm=3202,vm=3203,ym=0,Cm=1,wm="",Sm="srgb",bm="srgb-linear",xm="linear",_m="srgb",Mm=0,Em=7680,Rm=7681,Tm=7682,Pm=7683,Am=34055,Fm=34056,Dm=5386,Lm=512,Im=513,km=514,Om=515,Nm=516,Bm=517,zm=518,Hm=519,Gm=512,Um=513,Vm=514,Wm=515,jm=516,qm=517,Xm=518,Km=519,$m=35044,Zm=35048,Ym=35040,Jm=35045,Qm=35049,ev=35041,tv=35046,nv=35050,iv=35042,rv="100",sv="300 es",ov=2e3,av=2001,lv={COMPUTE:"compute",RENDER:"render"},cv={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},uv={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FLAT_FIRST:"flat first",FLAT_EITHER:"flat either"};class hv{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return void 0!==n&&(void 0!==n[e]&&-1!==n[e].indexOf(t))}removeEventListener(e,t){const n=this._listeners;if(void 0===n)return;const i=n[e];if(void 0!==i){const e=i.indexOf(t);-1!==e&&i.splice(e,1)}}dispatchEvent(e){const t=this._listeners;if(void 0===t)return;const n=t[e.type];if(void 0!==n){e.target=this;const t=n.slice(0);for(let n=0,i=t.length;n<i;n++)t[n].call(this,e);e.target=null}}}const dv=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let pv=1234567;const gv=Math.PI/180,fv=180/Math.PI;function mv(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(dv[255&e]+dv[e>>8&255]+dv[e>>16&255]+dv[e>>24&255]+"-"+dv[255&t]+dv[t>>8&255]+"-"+dv[t>>16&15|64]+dv[t>>24&255]+"-"+dv[63&n|128]+dv[n>>8&255]+"-"+dv[n>>16&255]+dv[n>>24&255]+dv[255&i]+dv[i>>8&255]+dv[i>>16&255]+dv[i>>24&255]).toLowerCase()}function vv(e,t,n){return Math.max(t,Math.min(n,e))}function yv(e,t){return(e%t+t)%t}function Cv(e,t,n){return(1-n)*e+n*t}function wv(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function Sv(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const bv={DEG2RAD:gv,RAD2DEG:fv,generateUUID:mv,clamp:vv,euclideanModulo:yv,mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:Cv,damp:function(e,t,n,i){return Cv(e,t,1-Math.exp(-n*i))},pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(yv(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(pv=e);let t=pv+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*gv},radToDeg:function(e){return e*fv},isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,i,r){const s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),c=s((t+i)/2),u=o((t+i)/2),h=s((t-i)/2),d=o((t-i)/2),p=s((i-t)/2),g=o((i-t)/2);switch(r){case"XYX":e.set(a*u,l*h,l*d,a*c);break;case"YZY":e.set(l*d,a*u,l*h,a*c);break;case"ZXZ":e.set(l*h,l*d,a*u,a*c);break;case"XZX":e.set(a*u,l*g,l*p,a*c);break;case"YXY":e.set(l*p,a*u,l*g,a*c);break;case"ZYZ":e.set(l*g,l*p,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:Sv,denormalize:wv};class xv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;xv.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=vv(this.x,e.x,t.x),this.y=vv(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=vv(this.x,e,t),this.y=vv(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(vv(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(vv(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*n-s*i+e.x,this.y=r*i+s*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class _v{constructor(e,t,n,i,r,s,o,a,l){_v.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,i,r,s,o,a,l)}set(e,t,n,i,r,s,o,a,l){const c=this.elements;return c[0]=e,c[1]=i,c[2]=o,c[3]=t,c[4]=r,c[5]=a,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],o=n[3],a=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],g=i[0],f=i[3],m=i[6],v=i[1],y=i[4],C=i[7],w=i[2],S=i[5],b=i[8];return r[0]=s*g+o*v+a*w,r[3]=s*f+o*y+a*S,r[6]=s*m+o*C+a*b,r[1]=l*g+c*v+u*w,r[4]=l*f+c*y+u*S,r[7]=l*m+c*C+u*b,r[2]=h*g+d*v+p*w,r[5]=h*f+d*y+p*S,r[8]=h*m+d*C+p*b,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8];return t*s*c-t*o*l-n*r*c+n*o*a+i*r*l-i*s*a}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=c*s-o*l,h=o*a-c*r,d=l*r-s*a,p=t*u+n*h+i*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const g=1/p;return e[0]=u*g,e[1]=(i*l-c*n)*g,e[2]=(o*n-i*s)*g,e[3]=h*g,e[4]=(c*t-i*a)*g,e[5]=(i*r-o*t)*g,e[6]=d*g,e[7]=(n*a-l*t)*g,e[8]=(s*t-n*r)*g,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,r,s,o){const a=Math.cos(r),l=Math.sin(r);return this.set(n*a,n*l,-n*(a*s+l*o)+s+e,-i*l,i*a,-i*(-l*s+a*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(Mv.makeScale(e,t)),this}rotate(e){return this.premultiply(Mv.makeRotation(-e)),this}translate(e,t){return this.premultiply(Mv.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const Mv=new _v;function Ev(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}const Rv={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Tv(e,t){return new Rv[e](t)}function Pv(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Av(){const e=Pv("canvas");return e.style.display="block",e}const Fv={};function Dv(e){e in Fv||(Fv[e]=!0,console.warn(e))}const Lv=(new _v).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Iv=(new _v).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function kv(){const e={enabled:!0,workingColorSpace:bm,spaces:{},convert:function(e,t,n){return!1!==this.enabled&&t!==n&&t&&n?(this.spaces[t].transfer===_m&&(e.r=Nv(e.r),e.g=Nv(e.g),e.b=Nv(e.b)),this.spaces[t].primaries!==this.spaces[n].primaries&&(e.applyMatrix3(this.spaces[t].toXYZ),e.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===_m&&(e.r=Bv(e.r),e.g=Bv(e.g),e.b=Bv(e.b)),e):e},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)},getPrimaries:function(e){return this.spaces[e].primaries},getTransfer:function(e){return e===wm?xm:this.spaces[e].transfer},getLuminanceCoefficients:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.workingColorSpace;return e.fromArray(this.spaces[t].luminanceCoefficients)},define:function(e){Object.assign(this.spaces,e)},_getMatrix:function(e,t,n){return e.copy(this.spaces[t].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(e){return this.spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.workingColorSpace;return this.spaces[e].workingColorSpaceConfig.unpackColorSpace}},t=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],i=[.3127,.329];return e.define({[bm]:{primaries:t,whitePoint:i,transfer:xm,toXYZ:Lv,fromXYZ:Iv,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:Sm},outputColorSpaceConfig:{drawingBufferColorSpace:Sm}},[Sm]:{primaries:t,whitePoint:i,transfer:_m,toXYZ:Lv,fromXYZ:Iv,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:Sm}}}),e}const Ov=kv();function Nv(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Bv(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let zv;class Hv{static getDataURL(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png";if(/^data:/i.test(e.src))return e.src;if("undefined"===typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===zv&&(zv=Pv("canvas")),zv.width=e.width,zv.height=e.height;const n=zv.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=zv}return t.toDataURL(n)}static sRGBToLinear(e){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){const t=Pv("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),r=i.data;for(let e=0;e<r.length;e++)r[e]=255*Nv(r[e]/255);return n.putImageData(i,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*Nv(t[e]/255)):t[e]=Nv(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Gv=0;class Uv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,Object.defineProperty(this,"id",{value:Gv++}),this.uuid=mv(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let e;if(Array.isArray(i)){e=[];for(let t=0,n=i.length;t<n;t++)i[t].isDataTexture?e.push(Vv(i[t].image)):e.push(Vv(i[t]))}else e=Vv(i);n.url=e}return t||(e.images[this.uuid]=n),n}}function Vv(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?Hv.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Wv=0;class jv extends hv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jv.DEFAULT_IMAGE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jv.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Hg,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Hg,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Xg,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Zg,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:pf,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Jg,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:jv.DEFAULT_ANISOTROPY,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:wm;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Wv++}),this.uuid=mv(),this.name="",this.source=new Uv(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new xv(0,0),this.repeat=new xv(1,1),this.center=new xv(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new _v,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isTextureArray=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e){void 0===e&&(e=null),this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isTextureArray=e.isTextureArray,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Lg)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case zg:e.x=e.x-Math.floor(e.x);break;case Hg:e.x=e.x<0?0:1;break;case Gg:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case zg:e.y=e.y-Math.floor(e.y);break;case Hg:e.y=e.y<0?0:1;break;case Gg:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}jv.DEFAULT_IMAGE=null,jv.DEFAULT_MAPPING=Lg,jv.DEFAULT_ANISOTROPY=1;class qv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;qv.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=this.w,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*t+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*t+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*t+s[7]*n+s[11]*i+s[15]*r,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,r;const s=.01,o=.1,a=e.elements,l=a[0],c=a[4],u=a[8],h=a[1],d=a[5],p=a[9],g=a[2],f=a[6],m=a[10];if(Math.abs(c-h)<s&&Math.abs(u-g)<s&&Math.abs(p-f)<s){if(Math.abs(c+h)<o&&Math.abs(u+g)<o&&Math.abs(p+f)<o&&Math.abs(l+d+m-3)<o)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,a=(d+1)/2,v=(m+1)/2,y=(c+h)/4,C=(u+g)/4,w=(p+f)/4;return e>a&&e>v?e<s?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(e),i=y/n,r=C/n):a>v?a<s?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(a),n=y/i,r=w/i):v<s?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(v),n=C/r,i=w/r),this.set(n,i,r,t),this}let v=Math.sqrt((f-p)*(f-p)+(u-g)*(u-g)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(f-p)/v,this.y=(u-g)/v,this.z=(h-c)/v,this.w=Math.acos((l+d+m-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=vv(this.x,e.x,t.x),this.y=vv(this.y,e.y,t.y),this.z=vv(this.z,e.z,t.z),this.w=vv(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=vv(this.x,e,t),this.y=vv(this.y,e,t),this.z=vv(this.z,e,t),this.w=vv(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(vv(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Xv extends hv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth?n.depth:1,this.scissor=new qv(0,0,e,t),this.scissorTest=!1,this.viewport=new qv(0,0,e,t);const i={width:e,height:t,depth:this.depth};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Xg,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,multiview:!1},n);const r=new jv(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);r.flipY=!1,r.generateMipmaps=n.generateMipmaps,r.internalFormat=n.internalFormat,this.textures=[];const s=n.count;for(let o=0;o<s;o++)this.textures[o]=r.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==e&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,r=this.textures.length;i<r;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const n=Object.assign({},e.textures[t].image);this.textures[t].source=new Uv(n)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Kv extends Xv{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),this.isWebGLRenderTarget=!0}}class $v extends jv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Ug,this.minFilter=Ug,this.wrapR=Hg,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Zv extends Kv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new $v(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Yv extends jv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Ug,this.minFilter=Ug,this.wrapR=Hg,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Jv extends Kv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Yv(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Qv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,r,s,o){let a=n[i+0],l=n[i+1],c=n[i+2],u=n[i+3];const h=r[s+0],d=r[s+1],p=r[s+2],g=r[s+3];if(0===o)return e[t+0]=a,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===o)return e[t+0]=h,e[t+1]=d,e[t+2]=p,void(e[t+3]=g);if(u!==g||a!==h||l!==d||c!==p){let e=1-o;const t=a*h+l*d+c*p+u*g,n=t>=0?1:-1,i=1-t*t;if(i>Number.EPSILON){const r=Math.sqrt(i),s=Math.atan2(r,t*n);e=Math.sin(e*s)/r,o=Math.sin(o*s)/r}const r=o*n;if(a=a*e+h*r,l=l*e+d*r,c=c*e+p*r,u=u*e+g*r,e===1-o){const e=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=e,l*=e,c*=e,u*=e}}e[t]=a,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,i,r,s){const o=n[i],a=n[i+1],l=n[i+2],c=n[i+3],u=r[s],h=r[s+1],d=r[s+2],p=r[s+3];return e[t]=o*p+c*u+a*d-l*h,e[t+1]=a*p+c*h+l*u-o*d,e[t+2]=l*p+c*d+o*h-a*u,e[t+3]=c*p-o*u-a*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e._x,i=e._y,r=e._z,s=e._order,o=Math.cos,a=Math.sin,l=o(n/2),c=o(i/2),u=o(r/2),h=a(n/2),d=a(i/2),p=a(r/2);switch(s){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],r=t[8],s=t[1],o=t[5],a=t[9],l=t[2],c=t[6],u=t[10],h=n+o+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-a)*e,this._y=(r-l)*e,this._z=(s-i)*e}else if(n>o&&n>u){const e=2*Math.sqrt(1+n-o-u);this._w=(c-a)/e,this._x=.25*e,this._y=(i+s)/e,this._z=(r+l)/e}else if(o>u){const e=2*Math.sqrt(1+o-n-u);this._w=(r-l)/e,this._x=(i+s)/e,this._y=.25*e,this._z=(a+c)/e}else{const e=2*Math.sqrt(1+u-n-o);this._w=(s-i)/e,this._x=(r+l)/e,this._y=(a+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(vv(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,r=e._z,s=e._w,o=t._x,a=t._y,l=t._z,c=t._w;return this._x=n*c+s*o+i*l-r*a,this._y=i*c+s*a+r*o-n*l,this._z=r*c+s*l+n*a-i*o,this._w=s*c-n*o-i*a-r*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,i=this._y,r=this._z,s=this._w;let o=s*e._w+n*e._x+i*e._y+r*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;const a=1-o*o;if(a<=Number.EPSILON){const e=1-t;return this._w=e*s+t*this._w,this._x=e*n+t*this._x,this._y=e*i+t*this._y,this._z=e*r+t*this._z,this.normalize(),this}const l=Math.sqrt(a),c=Math.atan2(l,o),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=s*u+this._w*h,this._x=n*u+this._x*h,this._y=i*u+this._y*h,this._z=r*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(i*Math.sin(e),i*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ey{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;ey.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(ny.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(ny.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,r=e.elements,s=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,r=e.x,s=e.y,o=e.z,a=e.w,l=2*(s*i-o*n),c=2*(o*t-r*i),u=2*(r*n-s*t);return this.x=t+a*l+s*u-o*c,this.y=n+a*c+o*l-r*u,this.z=i+a*u+r*c-s*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=vv(this.x,e.x,t.x),this.y=vv(this.y,e.y,t.y),this.z=vv(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=vv(this.x,e,t),this.y=vv(this.y,e,t),this.z=vv(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(vv(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,r=e.z,s=t.x,o=t.y,a=t.z;return this.x=i*a-r*o,this.y=r*s-n*a,this.z=n*o-i*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return ty.copy(this).projectOnVector(e),this.sub(ty)}reflect(e){return this.sub(ty.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(vv(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const ty=new ey,ny=new Qv;class iy{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ey(1/0,1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(sy.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(sy.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=sy.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const i=n.getAttribute("position");if(!0===t&&void 0!==i&&!0!==e.isInstancedMesh)for(let t=0,n=i.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,sy):sy.fromBufferAttribute(i,t),sy.applyMatrix4(e.matrixWorld),this.expandByPoint(sy);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),oy.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),oy.copy(n.boundingBox)),oy.applyMatrix4(e.matrixWorld),this.union(oy)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,sy),sy.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(py),gy.subVectors(this.max,py),ay.subVectors(e.a,py),ly.subVectors(e.b,py),cy.subVectors(e.c,py),uy.subVectors(ly,ay),hy.subVectors(cy,ly),dy.subVectors(ay,cy);let t=[0,-uy.z,uy.y,0,-hy.z,hy.y,0,-dy.z,dy.y,uy.z,0,-uy.x,hy.z,0,-hy.x,dy.z,0,-dy.x,-uy.y,uy.x,0,-hy.y,hy.x,0,-dy.y,dy.x,0];return!!vy(t,ay,ly,cy,gy)&&(t=[1,0,0,0,1,0,0,0,1],!!vy(t,ay,ly,cy,gy)&&(fy.crossVectors(uy,hy),t=[fy.x,fy.y,fy.z],vy(t,ay,ly,cy,gy)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,sy).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(sy).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(ry[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ry[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ry[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ry[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ry[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ry[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ry[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ry[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ry)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const ry=[new ey,new ey,new ey,new ey,new ey,new ey,new ey,new ey],sy=new ey,oy=new iy,ay=new ey,ly=new ey,cy=new ey,uy=new ey,hy=new ey,dy=new ey,py=new ey,gy=new ey,fy=new ey,my=new ey;function vy(e,t,n,i,r){for(let s=0,o=e.length-3;s<=o;s+=3){my.fromArray(e,s);const o=r.x*Math.abs(my.x)+r.y*Math.abs(my.y)+r.z*Math.abs(my.z),a=t.dot(my),l=n.dot(my),c=i.dot(my);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>o)return!1}return!0}const yy=new iy,Cy=new ey,wy=new ey;class Sy{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ey,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):yy.setFromPoints(e).getCenter(n);let i=0;for(let r=0,s=e.length;r<s;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Cy.subVectors(e,this.center);const t=Cy.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(Cy,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(wy.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Cy.copy(e.center).add(wy)),this.expandByPoint(Cy.copy(e.center).sub(wy))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const by=new ey,xy=new ey,_y=new ey,My=new ey,Ey=new ey,Ry=new ey,Ty=new ey;class Py{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ey,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey(0,0,-1);this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,by)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=by.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(by.copy(this.origin).addScaledVector(this.direction,t),by.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){xy.copy(e).add(t).multiplyScalar(.5),_y.copy(t).sub(e).normalize(),My.copy(this.origin).sub(xy);const r=.5*e.distanceTo(t),s=-this.direction.dot(_y),o=My.dot(this.direction),a=-My.dot(_y),l=My.lengthSq(),c=Math.abs(1-s*s);let u,h,d,p;if(c>0)if(u=s*a-o,h=s*o-a,p=r*c,u>=0)if(h>=-p)if(h<=p){const e=1/c;u*=e,h*=e,d=u*(u+s*h+2*o)+h*(s*u+h+2*a)+l}else h=r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h=-r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h<=-p?(u=Math.max(0,-(-s*r+o)),h=u>0?-r:Math.min(Math.max(-r,-a),r),d=-u*u+h*(h+2*a)+l):h<=p?(u=0,h=Math.min(Math.max(-r,-a),r),d=h*(h+2*a)+l):(u=Math.max(0,-(s*r+o)),h=u>0?r:Math.min(Math.max(-r,-a),r),d=-u*u+h*(h+2*a)+l);else h=s>0?-r:r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,u),i&&i.copy(xy).addScaledVector(_y,h),d}intersectSphere(e,t){by.subVectors(e.center,this.origin);const n=by.dot(this.direction),i=by.dot(by)-n*n,r=e.radius*e.radius;if(i>r)return null;const s=Math.sqrt(r-i),o=n-s,a=n+s;return a<0?null:o<0?this.at(a,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,r,s,o,a;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),c>=0?(r=(e.min.y-h.y)*c,s=(e.max.y-h.y)*c):(r=(e.max.y-h.y)*c,s=(e.min.y-h.y)*c),n>s||r>i?null:((r>n||isNaN(n))&&(n=r),(s<i||isNaN(i))&&(i=s),u>=0?(o=(e.min.z-h.z)*u,a=(e.max.z-h.z)*u):(o=(e.max.z-h.z)*u,a=(e.min.z-h.z)*u),n>a||o>i?null:((o>n||n!==n)&&(n=o),(a<i||i!==i)&&(i=a),i<0?null:this.at(n>=0?n:i,t)))}intersectsBox(e){return null!==this.intersectBox(e,by)}intersectTriangle(e,t,n,i,r){Ey.subVectors(t,e),Ry.subVectors(n,e),Ty.crossVectors(Ey,Ry);let s,o=this.direction.dot(Ty);if(o>0){if(i)return null;s=1}else{if(!(o<0))return null;s=-1,o=-o}My.subVectors(this.origin,e);const a=s*this.direction.dot(Ry.crossVectors(My,Ry));if(a<0)return null;const l=s*this.direction.dot(Ey.cross(My));if(l<0)return null;if(a+l>o)return null;const c=-s*My.dot(Ty);return c<0?null:this.at(c/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Ay{constructor(e,t,n,i,r,s,o,a,l,c,u,h,d,p,g,f){Ay.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,i,r,s,o,a,l,c,u,h,d,p,g,f)}set(e,t,n,i,r,s,o,a,l,c,u,h,d,p,g,f){const m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=i,m[1]=r,m[5]=s,m[9]=o,m[13]=a,m[2]=l,m[6]=c,m[10]=u,m[14]=h,m[3]=d,m[7]=p,m[11]=g,m[15]=f,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Ay).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/Fy.setFromMatrixColumn(e,0).length(),r=1/Fy.setFromMatrixColumn(e,1).length(),s=1/Fy.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*s,t[9]=n[9]*s,t[10]=n[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,r=e.z,s=Math.cos(n),o=Math.sin(n),a=Math.cos(i),l=Math.sin(i),c=Math.cos(r),u=Math.sin(r);if("XYZ"===e.order){const e=s*c,n=s*u,i=o*c,r=o*u;t[0]=a*c,t[4]=-a*u,t[8]=l,t[1]=n+i*l,t[5]=e-r*l,t[9]=-o*a,t[2]=r-e*l,t[6]=i+n*l,t[10]=s*a}else if("YXZ"===e.order){const e=a*c,n=a*u,i=l*c,r=l*u;t[0]=e+r*o,t[4]=i*o-n,t[8]=s*l,t[1]=s*u,t[5]=s*c,t[9]=-o,t[2]=n*o-i,t[6]=r+e*o,t[10]=s*a}else if("ZXY"===e.order){const e=a*c,n=a*u,i=l*c,r=l*u;t[0]=e-r*o,t[4]=-s*u,t[8]=i+n*o,t[1]=n+i*o,t[5]=s*c,t[9]=r-e*o,t[2]=-s*l,t[6]=o,t[10]=s*a}else if("ZYX"===e.order){const e=s*c,n=s*u,i=o*c,r=o*u;t[0]=a*c,t[4]=i*l-n,t[8]=e*l+r,t[1]=a*u,t[5]=r*l+e,t[9]=n*l-i,t[2]=-l,t[6]=o*a,t[10]=s*a}else if("YZX"===e.order){const e=s*a,n=s*l,i=o*a,r=o*l;t[0]=a*c,t[4]=r-e*u,t[8]=i*u+n,t[1]=u,t[5]=s*c,t[9]=-o*c,t[2]=-l*c,t[6]=n*u+i,t[10]=e-r*u}else if("XZY"===e.order){const e=s*a,n=s*l,i=o*a,r=o*l;t[0]=a*c,t[4]=-u,t[8]=l*c,t[1]=e*u+r,t[5]=s*c,t[9]=n*u-i,t[2]=i*u-n,t[6]=o*c,t[10]=r*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Ly,e,Iy)}lookAt(e,t,n){const i=this.elements;return Ny.subVectors(e,t),0===Ny.lengthSq()&&(Ny.z=1),Ny.normalize(),ky.crossVectors(n,Ny),0===ky.lengthSq()&&(1===Math.abs(n.z)?Ny.x+=1e-4:Ny.z+=1e-4,Ny.normalize(),ky.crossVectors(n,Ny)),ky.normalize(),Oy.crossVectors(Ny,ky),i[0]=ky.x,i[4]=Oy.x,i[8]=Ny.x,i[1]=ky.y,i[5]=Oy.y,i[9]=Ny.y,i[2]=ky.z,i[6]=Oy.z,i[10]=Ny.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,r=this.elements,s=n[0],o=n[4],a=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],g=n[6],f=n[10],m=n[14],v=n[3],y=n[7],C=n[11],w=n[15],S=i[0],b=i[4],x=i[8],_=i[12],M=i[1],E=i[5],R=i[9],T=i[13],P=i[2],A=i[6],F=i[10],D=i[14],L=i[3],I=i[7],k=i[11],O=i[15];return r[0]=s*S+o*M+a*P+l*L,r[4]=s*b+o*E+a*A+l*I,r[8]=s*x+o*R+a*F+l*k,r[12]=s*_+o*T+a*D+l*O,r[1]=c*S+u*M+h*P+d*L,r[5]=c*b+u*E+h*A+d*I,r[9]=c*x+u*R+h*F+d*k,r[13]=c*_+u*T+h*D+d*O,r[2]=p*S+g*M+f*P+m*L,r[6]=p*b+g*E+f*A+m*I,r[10]=p*x+g*R+f*F+m*k,r[14]=p*_+g*T+f*D+m*O,r[3]=v*S+y*M+C*P+w*L,r[7]=v*b+y*E+C*A+w*I,r[11]=v*x+y*R+C*F+w*k,r[15]=v*_+y*T+C*D+w*O,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],s=e[1],o=e[5],a=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+r*a*u-i*l*u-r*o*h+n*l*h+i*o*d-n*a*d)+e[7]*(+t*a*d-t*l*h+r*s*h-i*s*d+i*l*c-r*a*c)+e[11]*(+t*l*u-t*o*d-r*s*u+n*s*d+r*o*c-n*l*c)+e[15]*(-i*o*c-t*a*u+t*o*h+i*s*u-n*s*h+n*a*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],g=e[13],f=e[14],m=e[15],v=u*f*l-g*h*l+g*a*d-o*f*d-u*a*m+o*h*m,y=p*h*l-c*f*l-p*a*d+s*f*d+c*a*m-s*h*m,C=c*g*l-p*u*l+p*o*d-s*g*d-c*o*m+s*u*m,w=p*u*a-c*g*a-p*o*h+s*g*h+c*o*f-s*u*f,S=t*v+n*y+i*C+r*w;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const b=1/S;return e[0]=v*b,e[1]=(g*h*r-u*f*r-g*i*d+n*f*d+u*i*m-n*h*m)*b,e[2]=(o*f*r-g*a*r+g*i*l-n*f*l-o*i*m+n*a*m)*b,e[3]=(u*a*r-o*h*r-u*i*l+n*h*l+o*i*d-n*a*d)*b,e[4]=y*b,e[5]=(c*f*r-p*h*r+p*i*d-t*f*d-c*i*m+t*h*m)*b,e[6]=(p*a*r-s*f*r-p*i*l+t*f*l+s*i*m-t*a*m)*b,e[7]=(s*h*r-c*a*r+c*i*l-t*h*l-s*i*d+t*a*d)*b,e[8]=C*b,e[9]=(p*u*r-c*g*r-p*n*d+t*g*d+c*n*m-t*u*m)*b,e[10]=(s*g*r-p*o*r+p*n*l-t*g*l-s*n*m+t*o*m)*b,e[11]=(c*o*r-s*u*r-c*n*l+t*u*l+s*n*d-t*o*d)*b,e[12]=w*b,e[13]=(c*g*i-p*u*i+p*n*h-t*g*h-c*n*f+t*u*f)*b,e[14]=(p*o*i-s*g*i-p*n*a+t*g*a+s*n*f-t*o*f)*b,e[15]=(s*u*i-c*o*i+c*n*a-t*u*a-s*n*h+t*o*h)*b,this}scale(e){const t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),r=1-n,s=e.x,o=e.y,a=e.z,l=r*s,c=r*o;return this.set(l*s+n,l*o-i*a,l*a+i*o,0,l*o+i*a,c*o+n,c*a-i*s,0,l*a-i*o,c*a+i*s,r*a*a+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,r,s){return this.set(1,n,r,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,r=t._x,s=t._y,o=t._z,a=t._w,l=r+r,c=s+s,u=o+o,h=r*l,d=r*c,p=r*u,g=s*c,f=s*u,m=o*u,v=a*l,y=a*c,C=a*u,w=n.x,S=n.y,b=n.z;return i[0]=(1-(g+m))*w,i[1]=(d+C)*w,i[2]=(p-y)*w,i[3]=0,i[4]=(d-C)*S,i[5]=(1-(h+m))*S,i[6]=(f+v)*S,i[7]=0,i[8]=(p+y)*b,i[9]=(f-v)*b,i[10]=(1-(h+g))*b,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let r=Fy.set(i[0],i[1],i[2]).length();const s=Fy.set(i[4],i[5],i[6]).length(),o=Fy.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],Dy.copy(this);const a=1/r,l=1/s,c=1/o;return Dy.elements[0]*=a,Dy.elements[1]*=a,Dy.elements[2]*=a,Dy.elements[4]*=l,Dy.elements[5]*=l,Dy.elements[6]*=l,Dy.elements[8]*=c,Dy.elements[9]*=c,Dy.elements[10]*=c,t.setFromRotationMatrix(Dy),n.x=r,n.y=s,n.z=o,this}makePerspective(e,t,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ov;const a=this.elements,l=2*r/(t-e),c=2*r/(n-i),u=(t+e)/(t-e),h=(n+i)/(n-i);let d,p;if(o===ov)d=-(s+r)/(s-r),p=-2*s*r/(s-r);else{if(o!==av)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);d=-s/(s-r),p=-s*r/(s-r)}return a[0]=l,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=p,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,i,r,s){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ov;const a=this.elements,l=1/(t-e),c=1/(n-i),u=1/(s-r),h=(t+e)*l,d=(n+i)*c;let p,g;if(o===ov)p=(s+r)*u,g=-2*u;else{if(o!==av)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);p=r*u,g=-1*u}return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=g,a[14]=-p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Fy=new ey,Dy=new Ay,Ly=new ey(0,0,0),Iy=new ey(1,1,1),ky=new ey,Oy=new ey,Ny=new ey,By=new Ay,zy=new Qv;class Hy{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Hy.DEFAULT_ORDER;this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=e.elements,r=i[0],s=i[4],o=i[8],a=i[1],l=i[5],c=i[9],u=i[2],h=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin(vv(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-vv(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(vv(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,r));break;case"ZYX":this._y=Math.asin(-vv(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(vv(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-vv(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return By.makeRotationFromQuaternion(e),this.setFromRotationMatrix(By,t,n)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return zy.setFromEuler(this),this.setFromQuaternion(zy,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Hy.DEFAULT_ORDER="XYZ";class Gy{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&1<<e)}}let Uy=0;const Vy=new ey,Wy=new Qv,jy=new Ay,qy=new ey,Xy=new ey,Ky=new ey,$y=new Qv,Zy=new ey(1,0,0),Yy=new ey(0,1,0),Jy=new ey(0,0,1),Qy={type:"added"},eC={type:"removed"},tC={type:"childadded",child:null},nC={type:"childremoved",child:null};class iC extends hv{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Uy++}),this.uuid=mv(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=iC.DEFAULT_UP.clone();const e=new ey,t=new Hy,n=new Qv,i=new ey(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Ay},normalMatrix:{value:new _v}}),this.matrix=new Ay,this.matrixWorld=new Ay,this.matrixAutoUpdate=iC.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=iC.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Gy,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Wy.setFromAxisAngle(e,t),this.quaternion.multiply(Wy),this}rotateOnWorldAxis(e,t){return Wy.setFromAxisAngle(e,t),this.quaternion.premultiply(Wy),this}rotateX(e){return this.rotateOnAxis(Zy,e)}rotateY(e){return this.rotateOnAxis(Yy,e)}rotateZ(e){return this.rotateOnAxis(Jy,e)}translateOnAxis(e,t){return Vy.copy(e).applyQuaternion(this.quaternion),this.position.add(Vy.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Zy,e)}translateY(e){return this.translateOnAxis(Yy,e)}translateZ(e){return this.translateOnAxis(Jy,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(jy.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?qy.copy(e):qy.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Xy.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?jy.lookAt(Xy,qy,this.up):jy.lookAt(qy,Xy,this.up),this.quaternion.setFromRotationMatrix(jy),i&&(jy.extractRotation(i.matrixWorld),Wy.setFromRotationMatrix(jy),this.quaternion.premultiply(Wy.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Qy),tC.child=e,this.dispatchEvent(tC),tC.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(eC),nC.child=e,this.dispatchEvent(nC),nC.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),jy.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),jy.multiply(e.parent.matrixWorld)),e.applyMatrix4(jy),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Qy),tC.child=e,this.dispatchEvent(tC),tC.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}getObjectsByProperty(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[e]===t&&n.push(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Xy,e,Ky),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Xy,$y,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++){t[n].updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++){e[t].updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};function r(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map((e=>({...e,boundingBox:e.boundingBox?{min:e.boundingBox.min.toArray(),max:e.boundingBox.max.toArray()}:void 0,boundingSphere:e.boundingSphere?{radius:e.boundingSphere.radius,center:e.boundingSphere.center.toArray()}:void 0}))),i.instanceInfo=this._instanceInfo.map((e=>({...e}))),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(e),i.indirectTexture=this._indirectTexture.toJSON(e),null!==this._colorsTexture&&(i.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(i.boundingSphere={center:this.boundingSphere.center.toArray(),radius:this.boundingSphere.radius}),null!==this.boundingBox&&(i.boundingBox={min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const i=n[t];r(e.shapes,i)}else r(e.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,i=this.material.length;n<i;n++)t.push(r(e.materials,this.material[n]));i.material=t}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(let t=0;t<this.children.length;t++)i.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];i.animations.push(r(e.animations,n))}}if(t){const t=s(e.geometries),i=s(e.materials),r=s(e.textures),o=s(e.images),a=s(e.shapes),l=s(e.skeletons),c=s(e.animations),u=s(e.nodes);t.length>0&&(n.geometries=t),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),o.length>0&&(n.images=o),a.length>0&&(n.shapes=a),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=i,n;function s(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}iC.DEFAULT_UP=new ey(0,1,0),iC.DEFAULT_MATRIX_AUTO_UPDATE=!0,iC.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const rC=new ey,sC=new ey,oC=new ey,aC=new ey,lC=new ey,cC=new ey,uC=new ey,hC=new ey,dC=new ey,pC=new ey,gC=new qv,fC=new qv,mC=new qv;class vC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ey,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ey;this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),rC.subVectors(e,t),i.cross(rC);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(e,t,n,i,r){rC.subVectors(i,t),sC.subVectors(n,t),oC.subVectors(e,t);const s=rC.dot(rC),o=rC.dot(sC),a=rC.dot(oC),l=sC.dot(sC),c=sC.dot(oC),u=s*l-o*o;if(0===u)return r.set(0,0,0),null;const h=1/u,d=(l*a-o*c)*h,p=(s*c-o*a)*h;return r.set(1-d-p,p,d)}static containsPoint(e,t,n,i){return null!==this.getBarycoord(e,t,n,i,aC)&&(aC.x>=0&&aC.y>=0&&aC.x+aC.y<=1)}static getInterpolation(e,t,n,i,r,s,o,a){return null===this.getBarycoord(e,t,n,i,aC)?(a.x=0,a.y=0,"z"in a&&(a.z=0),"w"in a&&(a.w=0),null):(a.setScalar(0),a.addScaledVector(r,aC.x),a.addScaledVector(s,aC.y),a.addScaledVector(o,aC.z),a)}static getInterpolatedAttribute(e,t,n,i,r,s){return gC.setScalar(0),fC.setScalar(0),mC.setScalar(0),gC.fromBufferAttribute(e,t),fC.fromBufferAttribute(e,n),mC.fromBufferAttribute(e,i),s.setScalar(0),s.addScaledVector(gC,r.x),s.addScaledVector(fC,r.y),s.addScaledVector(mC,r.z),s}static isFrontFacing(e,t,n,i){return rC.subVectors(n,t),sC.subVectors(e,t),rC.cross(sC).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return rC.subVectors(this.c,this.b),sC.subVectors(this.a,this.b),.5*rC.cross(sC).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return vC.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return vC.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,i,r){return vC.getInterpolation(e,this.a,this.b,this.c,t,n,i,r)}containsPoint(e){return vC.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return vC.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,r=this.c;let s,o;lC.subVectors(i,n),cC.subVectors(r,n),hC.subVectors(e,n);const a=lC.dot(hC),l=cC.dot(hC);if(a<=0&&l<=0)return t.copy(n);dC.subVectors(e,i);const c=lC.dot(dC),u=cC.dot(dC);if(c>=0&&u<=c)return t.copy(i);const h=a*u-c*l;if(h<=0&&a>=0&&c<=0)return s=a/(a-c),t.copy(n).addScaledVector(lC,s);pC.subVectors(e,r);const d=lC.dot(pC),p=cC.dot(pC);if(p>=0&&d<=p)return t.copy(r);const g=d*l-a*p;if(g<=0&&l>=0&&p<=0)return o=l/(l-p),t.copy(n).addScaledVector(cC,o);const f=c*p-d*u;if(f<=0&&u-c>=0&&d-p>=0)return uC.subVectors(r,i),o=(u-c)/(u-c+(d-p)),t.copy(i).addScaledVector(uC,o);const m=1/(f+g+h);return s=g*m,o=h*m,t.copy(n).addScaledVector(lC,s).addScaledVector(cC,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const yC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},CC={h:0,s:0,l:0},wC={h:0,s:0,l:0};function SC(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class bC{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Sm;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Ov.toWorkingColorSpace(this,t),this}setRGB(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ov.workingColorSpace;return this.r=e,this.g=t,this.b=n,Ov.toWorkingColorSpace(this,i),this}setHSL(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ov.workingColorSpace;if(e=yv(e,1),t=vv(t,0,1),n=vv(n,0,1),0===t)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i;this.r=SC(r,i,e+1/3),this.g=SC(r,i,e),this.b=SC(r,i,e-1/3)}return Ov.toWorkingColorSpace(this,i),this}setStyle(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Sm;function i(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const s=t[1],o=t[2];switch(s){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,n);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,n);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){const i=t[1],r=i.length;if(3===r)return this.setRGB(parseInt(i.charAt(0),16)/15,parseInt(i.charAt(1),16)/15,parseInt(i.charAt(2),16)/15,n);if(6===r)return this.setHex(parseInt(i,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Sm;const n=yC[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Nv(e.r),this.g=Nv(e.g),this.b=Nv(e.b),this}copyLinearToSRGB(e){return this.r=Bv(e.r),this.g=Bv(e.g),this.b=Bv(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sm;return Ov.fromWorkingColorSpace(xC.copy(this),e),65536*Math.round(vv(255*xC.r,0,255))+256*Math.round(vv(255*xC.g,0,255))+Math.round(vv(255*xC.b,0,255))}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sm;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ov.workingColorSpace;Ov.fromWorkingColorSpace(xC.copy(this),t);const n=xC.r,i=xC.g,r=xC.b,s=Math.max(n,i,r),o=Math.min(n,i,r);let a,l;const c=(o+s)/2;if(o===s)a=0,l=0;else{const e=s-o;switch(l=c<=.5?e/(s+o):e/(2-s-o),s){case n:a=(i-r)/e+(i<r?6:0);break;case i:a=(r-n)/e+2;break;case r:a=(n-i)/e+4}a/=6}return e.h=a,e.s=l,e.l=c,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ov.workingColorSpace;return Ov.fromWorkingColorSpace(xC.copy(this),t),e.r=xC.r,e.g=xC.g,e.b=xC.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sm;Ov.fromWorkingColorSpace(xC.copy(this),e);const t=xC.r,n=xC.g,i=xC.b;return e!==Sm?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*n)},${Math.round(255*i)})`}offsetHSL(e,t,n){return this.getHSL(CC),this.setHSL(CC.h+e,CC.s+t,CC.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(CC),e.getHSL(wC);const n=Cv(CC.h,wC.h,t),i=Cv(CC.s,wC.s,t),r=Cv(CC.l,wC.l,t);return this.setHSL(n,i,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,i=this.b,r=e.elements;return this.r=r[0]*t+r[3]*n+r[6]*i,this.g=r[1]*t+r[4]*n+r[7]*i,this.b=r[2]*t+r[5]*n+r[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const xC=new bC;bC.NAMES=yC;let _C=0;class MC extends hv{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:_C++}),this.uuid=mv(),this.name="",this.type="Material",this.blending=Gp,this.side=Np,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=tg,this.blendDst=ng,this.blendEquation=qp,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new bC(0,0,0),this.blendAlpha=0,this.depthFunc=fg,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Hm,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Em,this.stencilZFail=Em,this.stencilZPass=Em,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!==e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function i(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Gp&&(n.blending=this.blending),this.side!==Np&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),this.blendSrc!==tg&&(n.blendSrc=this.blendSrc),this.blendDst!==ng&&(n.blendDst=this.blendDst),this.blendEquation!==qp&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==fg&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Hm&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Em&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Em&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Em&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=i(e.textures),r=i(e.images);t.length>0&&(n.textures=t),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let i=0;i!==e;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class EC extends MC{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new bC(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Hy,this.combine=wg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const RC=TC();function TC(){const e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const e=l-127;e<-27?(i[l]=0,i[256|l]=32768,r[l]=24,r[256|l]=24):e<-14?(i[l]=1024>>-e-14,i[256|l]=1024>>-e-14|32768,r[l]=-e-1,r[256|l]=-e-1):e<=15?(i[l]=e+15<<10,i[256|l]=e+15<<10|32768,r[l]=13,r[256|l]=13):e<128?(i[l]=31744,i[256|l]=64512,r[l]=24,r[256|l]=24):(i[l]=31744,i[256|l]=64512,r[l]=13,r[256|l]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;0===(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,s[l]=e|t}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(a[l]=1024);return{floatView:t,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function PC(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=vv(e,-65504,65504),RC.floatView[0]=e;const t=RC.uint32View[0],n=t>>23&511;return RC.baseTable[n]+((8388607&t)>>RC.shiftTable[n])}function AC(e){const t=e>>10;return RC.uint32View[0]=RC.mantissaTable[RC.offsetTable[t]+(1023&e)]+RC.exponentTable[t],RC.floatView[0]}class FC{static toHalfFloat(e){return PC(e)}static fromHalfFloat(e){return AC(e)}}const DC=new ey,LC=new xv;let IC=0;class kC{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:IC++}),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=$m,this.updateRanges=[],this.gpuType=sf,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)LC.fromBufferAttribute(this,t),LC.applyMatrix3(e),this.setXY(t,LC.x,LC.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)DC.fromBufferAttribute(this,t),DC.applyMatrix3(e),this.setXYZ(t,DC.x,DC.y,DC.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)DC.fromBufferAttribute(this,t),DC.applyMatrix4(e),this.setXYZ(t,DC.x,DC.y,DC.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)DC.fromBufferAttribute(this,t),DC.applyNormalMatrix(e),this.setXYZ(t,DC.x,DC.y,DC.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)DC.fromBufferAttribute(this,t),DC.transformDirection(e),this.setXYZ(t,DC.x,DC.y,DC.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=wv(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Sv(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=wv(t,this.array)),t}setX(e,t){return this.normalized&&(t=Sv(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=wv(t,this.array)),t}setY(e,t){return this.normalized&&(t=Sv(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=wv(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Sv(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=wv(t,this.array)),t}setW(e,t){return this.normalized&&(t=Sv(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Sv(t,this.array),n=Sv(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=Sv(t,this.array),n=Sv(n,this.array),i=Sv(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=Sv(t,this.array),n=Sv(n,this.array),i=Sv(i,this.array),r=Sv(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==$m&&(e.usage=this.usage),e}}class OC extends kC{constructor(e,t,n){super(new Int8Array(e),t,n)}}class NC extends kC{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class BC extends kC{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class zC extends kC{constructor(e,t,n){super(new Int16Array(e),t,n)}}class HC extends kC{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class GC extends kC{constructor(e,t,n){super(new Int32Array(e),t,n)}}class UC extends kC{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class VC extends kC{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=AC(this.array[e*this.itemSize]);return this.normalized&&(t=wv(t,this.array)),t}setX(e,t){return this.normalized&&(t=Sv(t,this.array)),this.array[e*this.itemSize]=PC(t),this}getY(e){let t=AC(this.array[e*this.itemSize+1]);return this.normalized&&(t=wv(t,this.array)),t}setY(e,t){return this.normalized&&(t=Sv(t,this.array)),this.array[e*this.itemSize+1]=PC(t),this}getZ(e){let t=AC(this.array[e*this.itemSize+2]);return this.normalized&&(t=wv(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Sv(t,this.array)),this.array[e*this.itemSize+2]=PC(t),this}getW(e){let t=AC(this.array[e*this.itemSize+3]);return this.normalized&&(t=wv(t,this.array)),t}setW(e,t){return this.normalized&&(t=Sv(t,this.array)),this.array[e*this.itemSize+3]=PC(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Sv(t,this.array),n=Sv(n,this.array)),this.array[e+0]=PC(t),this.array[e+1]=PC(n),this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=Sv(t,this.array),n=Sv(n,this.array),i=Sv(i,this.array)),this.array[e+0]=PC(t),this.array[e+1]=PC(n),this.array[e+2]=PC(i),this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=Sv(t,this.array),n=Sv(n,this.array),i=Sv(i,this.array),r=Sv(r,this.array)),this.array[e+0]=PC(t),this.array[e+1]=PC(n),this.array[e+2]=PC(i),this.array[e+3]=PC(r),this}}class WC extends kC{constructor(e,t,n){super(new Float32Array(e),t,n)}}let jC=0;const qC=new Ay,XC=new iC,KC=new ey,$C=new iy,ZC=new iy,YC=new ey;class JC extends hv{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:jC++}),this.uuid=mv(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Ev(e)?UC:HC)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new _v).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return qC.makeRotationFromQuaternion(e),this.applyMatrix4(qC),this}rotateX(e){return qC.makeRotationX(e),this.applyMatrix4(qC),this}rotateY(e){return qC.makeRotationY(e),this.applyMatrix4(qC),this}rotateZ(e){return qC.makeRotationZ(e),this.applyMatrix4(qC),this}translate(e,t,n){return qC.makeTranslation(e,t,n),this.applyMatrix4(qC),this}scale(e,t,n){return qC.makeScale(e,t,n),this.applyMatrix4(qC),this}lookAt(e){return XC.lookAt(e),XC.updateMatrix(),this.applyMatrix4(XC.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(KC).negate(),this.translate(KC.x,KC.y,KC.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];t.push(i.x,i.y,i.z||0)}this.setAttribute("position",new WC(t,3))}else{const n=Math.min(e.length,t.count);for(let i=0;i<n;i++){const n=e[i];t.setXYZ(i,n.x,n.y,n.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new iy);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new ey(-1/0,-1/0,-1/0),new ey(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const e=t[n];$C.setFromBufferAttribute(e),this.morphTargetsRelative?(YC.addVectors(this.boundingBox.min,$C.min),this.boundingBox.expandByPoint(YC),YC.addVectors(this.boundingBox.max,$C.max),this.boundingBox.expandByPoint(YC)):(this.boundingBox.expandByPoint($C.min),this.boundingBox.expandByPoint($C.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Sy);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new ey,1/0);if(e){const n=this.boundingSphere.center;if($C.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){const n=t[e];ZC.setFromBufferAttribute(n),this.morphTargetsRelative?(YC.addVectors($C.min,ZC.min),$C.expandByPoint(YC),YC.addVectors($C.max,ZC.max),$C.expandByPoint(YC)):($C.expandByPoint(ZC.min),$C.expandByPoint(ZC.max))}$C.getCenter(n);let i=0;for(let t=0,r=e.count;t<r;t++)YC.fromBufferAttribute(e,t),i=Math.max(i,n.distanceToSquared(YC));if(t)for(let r=0,s=t.length;r<s;r++){const s=t[r],o=this.morphTargetsRelative;for(let t=0,r=s.count;t<r;t++)YC.fromBufferAttribute(s,t),o&&(KC.fromBufferAttribute(e,t),YC.add(KC)),i=Math.max(i,n.distanceToSquared(YC))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.position,i=t.normal,r=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new kC(new Float32Array(4*n.count),4));const s=this.getAttribute("tangent"),o=[],a=[];for(let x=0;x<n.count;x++)o[x]=new ey,a[x]=new ey;const l=new ey,c=new ey,u=new ey,h=new xv,d=new xv,p=new xv,g=new ey,f=new ey;function m(e,t,i){l.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),u.fromBufferAttribute(n,i),h.fromBufferAttribute(r,e),d.fromBufferAttribute(r,t),p.fromBufferAttribute(r,i),c.sub(l),u.sub(l),d.sub(h),p.sub(h);const s=1/(d.x*p.y-p.x*d.y);isFinite(s)&&(g.copy(c).multiplyScalar(p.y).addScaledVector(u,-d.y).multiplyScalar(s),f.copy(u).multiplyScalar(d.x).addScaledVector(c,-p.x).multiplyScalar(s),o[e].add(g),o[t].add(g),o[i].add(g),a[e].add(f),a[t].add(f),a[i].add(f))}let v=this.groups;0===v.length&&(v=[{start:0,count:e.count}]);for(let x=0,_=v.length;x<_;++x){const t=v[x],n=t.start;for(let i=n,r=n+t.count;i<r;i+=3)m(e.getX(i+0),e.getX(i+1),e.getX(i+2))}const y=new ey,C=new ey,w=new ey,S=new ey;function b(e){w.fromBufferAttribute(i,e),S.copy(w);const t=o[e];y.copy(t),y.sub(w.multiplyScalar(w.dot(t))).normalize(),C.crossVectors(S,t);const n=C.dot(a[e])<0?-1:1;s.setXYZW(e,y.x,y.y,y.z,n)}for(let x=0,_=v.length;x<_;++x){const t=v[x],n=t.start;for(let i=n,r=n+t.count;i<r;i+=3)b(e.getX(i+0)),b(e.getX(i+1)),b(e.getX(i+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new kC(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const i=new ey,r=new ey,s=new ey,o=new ey,a=new ey,l=new ey,c=new ey,u=new ey;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),p=e.getX(h+1),g=e.getX(h+2);i.fromBufferAttribute(t,d),r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,g),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),o.fromBufferAttribute(n,d),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,g),o.add(c),a.add(c),l.add(c),n.setXYZ(d,o.x,o.y,o.z),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(g,l.x,l.y,l.z)}else for(let e=0,h=t.count;e<h;e+=3)i.fromBufferAttribute(t,e+0),r.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)YC.fromBufferAttribute(e,t),YC.normalize(),e.setXYZ(t,YC.x,YC.y,YC.z)}toNonIndexed(){function e(e,t){const n=e.array,i=e.itemSize,r=e.normalized,s=new n.constructor(t.length*i);let o=0,a=0;for(let l=0,c=t.length;l<c;l++){o=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*i;for(let e=0;e<i;e++)s[a++]=n[o++]}return new kC(s,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new JC,n=this.index.array,i=this.attributes;for(const o in i){const r=e(i[o],n);t.setAttribute(o,r)}const r=this.morphAttributes;for(const o in r){const i=[],s=r[o];for(let t=0,r=s.length;t<r;t++){const r=e(s[t],n);i.push(r)}t.morphAttributes[o]=i}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let o=0,a=s.length;o<a;o++){const e=s[o];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const a in n){const t=n[a];e.data.attributes[a]=t.toJSON(e.data)}const i={};let r=!1;for(const a in this.morphAttributes){const t=this.morphAttributes[a],n=[];for(let i=0,r=t.length;i<r;i++){const r=t[i];n.push(r.toJSON(e.data))}n.length>0&&(i[a]=n,r=!0)}r&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone());const i=e.attributes;for(const l in i){const e=i[l];this.setAttribute(l,e.clone(t))}const r=e.morphAttributes;for(const l in r){const e=[],n=r[l];for(let i=0,r=n.length;i<r;i++)e.push(n[i].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let l=0,c=s.length;l<c;l++){const e=s[l];this.addGroup(e.start,e.count,e.materialIndex)}const o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());const a=e.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const QC=new Ay,ew=new Py,tw=new Sy,nw=new ey,iw=new ey,rw=new ey,sw=new ey,ow=new ey,aw=new ey,lw=new ey,cw=new ey;class uw extends iC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new JC,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new EC;super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,s=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const o=this.morphTargetInfluences;if(r&&o){aw.set(0,0,0);for(let n=0,i=r.length;n<i;n++){const i=o[n],a=r[n];0!==i&&(ow.fromBufferAttribute(a,e),s?aw.addScaledVector(ow,i):aw.addScaledVector(ow.sub(t),i))}t.add(aw)}return t}raycast(e,t){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0!==i){if(null===n.boundingSphere&&n.computeBoundingSphere(),tw.copy(n.boundingSphere),tw.applyMatrix4(r),ew.copy(e.ray).recast(e.near),!1===tw.containsPoint(ew.origin)){if(null===ew.intersectSphere(tw,nw))return;if(ew.origin.distanceToSquared(nw)>(e.far-e.near)**2)return}QC.copy(r).invert(),ew.copy(e.ray).applyMatrix4(QC),null!==n.boundingBox&&!1===ew.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,ew)}}_computeIntersections(e,t,n){let i;const r=this.geometry,s=this.material,o=r.index,a=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv1,u=r.attributes.normal,h=r.groups,d=r.drawRange;if(null!==o)if(Array.isArray(s))for(let p=0,g=h.length;p<g;p++){const r=h[p],a=s[r.materialIndex];for(let s=Math.max(r.start,d.start),h=Math.min(o.count,Math.min(r.start+r.count,d.start+d.count));s<h;s+=3){i=hw(this,a,e,n,l,c,u,o.getX(s),o.getX(s+1),o.getX(s+2)),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,t.push(i))}}else{for(let r=Math.max(0,d.start),a=Math.min(o.count,d.start+d.count);r<a;r+=3){i=hw(this,s,e,n,l,c,u,o.getX(r),o.getX(r+1),o.getX(r+2)),i&&(i.faceIndex=Math.floor(r/3),t.push(i))}}else if(void 0!==a)if(Array.isArray(s))for(let p=0,g=h.length;p<g;p++){const r=h[p],o=s[r.materialIndex];for(let s=Math.max(r.start,d.start),h=Math.min(a.count,Math.min(r.start+r.count,d.start+d.count));s<h;s+=3){i=hw(this,o,e,n,l,c,u,s,s+1,s+2),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,t.push(i))}}else{for(let r=Math.max(0,d.start),o=Math.min(a.count,d.start+d.count);r<o;r+=3){i=hw(this,s,e,n,l,c,u,r,r+1,r+2),i&&(i.faceIndex=Math.floor(r/3),t.push(i))}}}}function hw(e,t,n,i,r,s,o,a,l,c){e.getVertexPosition(a,iw),e.getVertexPosition(l,rw),e.getVertexPosition(c,sw);const u=function(e,t,n,i,r,s,o,a){let l;if(l=t.side===Bp?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,t.side===Np,a),null===l)return null;cw.copy(a),cw.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(cw);return c<n.near||c>n.far?null:{distance:c,point:cw.clone(),object:e}}(e,t,n,i,iw,rw,sw,lw);if(u){const e=new ey;vC.getBarycoord(lw,iw,rw,sw,e),r&&(u.uv=vC.getInterpolatedAttribute(r,a,l,c,e,new xv)),s&&(u.uv1=vC.getInterpolatedAttribute(s,a,l,c,e,new xv)),o&&(u.normal=vC.getInterpolatedAttribute(o,a,l,c,e,new ey),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const t={a:a,b:l,c:c,normal:new ey,materialIndex:0};vC.getNormal(iw,rw,sw,t.normal),u.face=t,u.barycoord=e}return u}class dw extends JC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};const o=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);const a=[],l=[],c=[],u=[];let h=0,d=0;function p(e,t,n,i,r,s,p,g,f,m,v){const y=s/f,C=p/m,w=s/2,S=p/2,b=g/2,x=f+1,_=m+1;let M=0,E=0;const R=new ey;for(let o=0;o<_;o++){const s=o*C-S;for(let a=0;a<x;a++){const h=a*y-w;R[e]=h*i,R[t]=s*r,R[n]=b,l.push(R.x,R.y,R.z),R[e]=0,R[t]=0,R[n]=g>0?1:-1,c.push(R.x,R.y,R.z),u.push(a/f),u.push(1-o/m),M+=1}}for(let o=0;o<m;o++)for(let e=0;e<f;e++){const t=h+e+x*o,n=h+e+x*(o+1),i=h+(e+1)+x*(o+1),r=h+(e+1)+x*o;a.push(t,n,r),a.push(n,i,r),E+=6}o.addGroup(d,E,v),d+=E,h+=M}p("z","y","x",-1,-1,n,t,e,s,r,0),p("z","y","x",1,-1,n,t,-e,s,r,1),p("x","z","y",1,1,e,n,t,i,s,2),p("x","z","y",1,-1,e,n,-t,i,s,3),p("x","y","z",1,-1,e,t,n,i,r,4),p("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(a),this.setAttribute("position",new WC(l,3)),this.setAttribute("normal",new WC(c,3)),this.setAttribute("uv",new WC(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dw(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function pw(e){const t={};for(const n in e){t[n]={};for(const i in e[n]){const r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][i]=null):t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}}return t}function gw(e){const t={};for(let n=0;n<e.length;n++){const i=pw(e[n]);for(const e in i)t[e]=i[e]}return t}function fw(e){const t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:Ov.workingColorSpace}const mw={clone:pw,merge:gw};class vw extends MC{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=pw(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class yw extends iC{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ay,this.projectionMatrix=new Ay,this.projectionMatrixInverse=new Ay,this.coordinateSystem=ov}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Cw=new ey,ww=new xv,Sw=new xv;class bw extends yw{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*fv*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*gv*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*fv*Math.atan(Math.tan(.5*gv*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Cw.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Cw.x,Cw.y).multiplyScalar(-e/Cw.z),Cw.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Cw.x,Cw.y).multiplyScalar(-e/Cw.z)}getViewSize(e,t){return this.getViewBounds(e,ww,Sw),t.subVectors(Sw,ww)}setViewOffset(e,t,n,i,r,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*gv*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i;const s=this.view;if(null!==this.view&&this.view.enabled){const e=s.fullWidth,o=s.fullHeight;r+=s.offsetX*i/e,t-=s.offsetY*n/o,i*=s.width/e,n*=s.height/o}const o=this.filmOffset;0!==o&&(r+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const xw=-90;class _w extends iC{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new bw(xw,1,e,t);i.layers=this.layers,this.add(i);const r=new bw(xw,1,e,t);r.layers=this.layers,this.add(r);const s=new bw(xw,1,e,t);s.layers=this.layers,this.add(s);const o=new bw(xw,1,e,t);o.layers=this.layers,this.add(o);const a=new bw(xw,1,e,t);a.layers=this.layers,this.add(a);const l=new bw(xw,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,i,r,s,o,a]=t;for(const l of t)this.remove(l);if(e===ov)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),a.up.set(0,1,0),a.lookAt(0,0,-1);else{if(e!==av)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),a.up.set(0,-1,0),a.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,s,o,a,l,c]=this.children,u=e.getRenderTarget(),h=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const g=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,i),e.render(t,r),e.setRenderTarget(n,1,i),e.render(t,s),e.setRenderTarget(n,2,i),e.render(t,o),e.setRenderTarget(n,3,i),e.render(t,a),e.setRenderTarget(n,4,i),e.render(t,l),n.texture.generateMipmaps=g,e.setRenderTarget(n,5,i),e.render(t,c),e.setRenderTarget(u,h,d),e.xr.enabled=p,n.texture.needsPMREMUpdate=!0}}class Mw extends jv{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ig,arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8?arguments[8]:void 0,arguments.length>9?arguments[9]:void 0),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Ew extends Kv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new Mw(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Xg}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},i=new dw(5,5,5),r=new vw({name:"CubemapFromEquirect",uniforms:pw(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Bp,blending:Hp});r.uniforms.tEquirect.value=t;const s=new uw(i,r),o=t.minFilter;t.minFilter===Zg&&(t.minFilter=Xg);return new _w(1,10,this).update(e,s),t.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const r=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,n,i);e.setRenderTarget(r)}}class Rw extends iC{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Tw={type:"move"};class Pw{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Rw,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Rw,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ey,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ey),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Rw,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ey,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ey),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let i=null,r=null,s=null;const o=this._targetRay,a=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){s=!0;for(const s of e.hand.values()){const e=t.getJointPose(s,n),i=this._getHandJoint(l,s);null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.matrixWorldNeedsUpdate=!0,i.jointRadius=e.radius),i.visible=null!==e}const i=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],o=i.position.distanceTo(r.position),a=.02,c=.005;l.inputState.pinching&&o>a+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&o<=a-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==a&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1));null!==o&&(i=t.getPose(e.targetRaySpace,n),null===i&&null!==r&&(i=r),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(Tw)))}return null!==o&&(o.visible=null!==i),null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new Rw;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class Aw{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;this.isFogExp2=!0,this.name="",this.color=new bC(e),this.density=t}clone(){return new Aw(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Fw{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;this.isFog=!0,this.name="",this.color=new bC(e),this.near=t,this.far=n}clone(){return new Fw(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Dw extends iC{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Hy,this.environmentIntensity=1,this.environmentRotation=new Hy,this.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class Lw{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=$m,this.updateRanges=[],this.version=0,this.uuid=mv()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=mv()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=mv()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Iw=new ey;class kw{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Iw.fromBufferAttribute(this,t),Iw.applyMatrix4(e),this.setXYZ(t,Iw.x,Iw.y,Iw.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Iw.fromBufferAttribute(this,t),Iw.applyNormalMatrix(e),this.setXYZ(t,Iw.x,Iw.y,Iw.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Iw.fromBufferAttribute(this,t),Iw.transformDirection(e),this.setXYZ(t,Iw.x,Iw.y,Iw.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=wv(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Sv(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Sv(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Sv(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Sv(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Sv(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=wv(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=wv(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=wv(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=wv(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Sv(t,this.array),n=Sv(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Sv(t,this.array),n=Sv(n,this.array),i=Sv(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Sv(t,this.array),n=Sv(n,this.array),i=Sv(i,this.array),r=Sv(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new kC(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new kw(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Ow extends MC{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new bC(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Nw;const Bw=new ey,zw=new ey,Hw=new ey,Gw=new xv,Uw=new xv,Vw=new Ay,Ww=new ey,jw=new ey,qw=new ey,Xw=new xv,Kw=new xv,$w=new xv;class Zw extends iC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ow;if(super(),this.isSprite=!0,this.type="Sprite",void 0===Nw){Nw=new JC;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new Lw(e,5);Nw.setIndex([0,1,2,0,2,3]),Nw.setAttribute("position",new kw(t,3,0,!1)),Nw.setAttribute("uv",new kw(t,2,3,!1))}this.geometry=Nw,this.material=e,this.center=new xv(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),zw.setFromMatrixScale(this.matrixWorld),Vw.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Hw.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&zw.multiplyScalar(-Hw.z);const n=this.material.rotation;let i,r;0!==n&&(r=Math.cos(n),i=Math.sin(n));const s=this.center;Yw(Ww.set(-.5,-.5,0),Hw,s,zw,i,r),Yw(jw.set(.5,-.5,0),Hw,s,zw,i,r),Yw(qw.set(.5,.5,0),Hw,s,zw,i,r),Xw.set(0,0),Kw.set(1,0),$w.set(1,1);let o=e.ray.intersectTriangle(Ww,jw,qw,!1,Bw);if(null===o&&(Yw(jw.set(-.5,.5,0),Hw,s,zw,i,r),Kw.set(0,1),o=e.ray.intersectTriangle(Ww,qw,jw,!1,Bw),null===o))return;const a=e.ray.origin.distanceTo(Bw);a<e.near||a>e.far||t.push({distance:a,point:Bw.clone(),uv:vC.getInterpolation(Bw,Ww,jw,qw,Xw,Kw,$w,new xv),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function Yw(e,t,n,i,r,s){Gw.subVectors(e,n).addScalar(.5).multiply(i),void 0!==r?(Uw.x=s*Gw.x-r*Gw.y,Uw.y=r*Gw.x+s*Gw.y):Uw.copy(Gw),e.copy(t),e.x+=Uw.x,e.y+=Uw.y,e.applyMatrix4(Vw)}const Jw=new ey,Qw=new ey;class eS extends iC{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,i=t.length;n<i;n++){const e=t[n];this.addLevel(e.object.clone(),e.distance,e.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t=Math.abs(t);const i=this.levels;let r;for(r=0;r<i.length&&!(t<i[r].distance);r++);return i.splice(r,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const e=t.splice(n,1);return this.remove(e[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i;n++){let i=t[n].distance;if(t[n].object.visible&&(i-=i*t[n].hysteresis),e<i)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Jw.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(Jw);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Jw.setFromMatrixPosition(e.matrixWorld),Qw.setFromMatrixPosition(this.matrixWorld);const n=Jw.distanceTo(Qw)/e.zoom;let i,r;for(t[0].object.visible=!0,i=1,r=t.length;i<r;i++){let e=t[i].distance;if(t[i].object.visible&&(e-=e*t[i].hysteresis),!(n>=e))break;t[i-1].object.visible=!1,t[i].object.visible=!0}for(this._currentLevel=i-1;i<r;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let i=0,r=n.length;i<r;i++){const e=n[i];t.object.levels.push({object:e.object.uuid,distance:e.distance,hysteresis:e.hysteresis})}return t}}const tS=new ey,nS=new qv,iS=new qv,rS=new ey,sS=new Ay,oS=new ey,aS=new Sy,lS=new Ay,cS=new Py;class uS extends uw{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Fg,this.bindMatrix=new Ay,this.bindMatrixInverse=new Ay,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new iy),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,oS),this.boundingBox.expandByPoint(oS)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new Sy),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,oS),this.boundingSphere.expandByPoint(oS)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,i=this.matrixWorld;void 0!==n&&(null===this.boundingSphere&&this.computeBoundingSphere(),aS.copy(this.boundingSphere),aS.applyMatrix4(i),!1!==e.ray.intersectsSphere(aS)&&(lS.copy(i).invert(),cS.copy(e.ray).applyMatrix4(lS),null!==this.boundingBox&&!1===cS.intersectsBox(this.boundingBox)||this._computeIntersections(e,t,cS)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new qv,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);const i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===Fg?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Dg?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,i=this.geometry;nS.fromBufferAttribute(i.attributes.skinIndex,e),iS.fromBufferAttribute(i.attributes.skinWeight,e),tS.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const e=iS.getComponent(r);if(0!==e){const i=nS.getComponent(r);sS.multiplyMatrices(n.bones[i].matrixWorld,n.boneInverses[i]),t.addScaledVector(rS.copy(tS).applyMatrix4(sS),e)}}return t.applyMatrix4(this.bindMatrixInverse)}}class hS extends iC{constructor(){super(),this.isBone=!0,this.type="Bone"}}class dS extends jv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(null,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:Ug,arguments.length>9&&void 0!==arguments[9]?arguments[9]:Ug,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>10?arguments[10]:void 0,arguments.length>11?arguments[11]:void 0),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const pS=new Ay,gS=new Ay;class fS{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.uuid=mv(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new Ay)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new Ay;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let r=0,s=e.length;r<s;r++){const i=e[r]?e[r].matrixWorld:gS;pS.multiplyMatrices(i,t[r]),pS.toArray(n,16*r)}null!==i&&(i.needsUpdate=!0)}clone(){return new fS(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new dS(t,e,e,pf,sf);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const i=e.bones[n];let r=t[i];void 0===r&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),r=new hS),this.bones.push(r),this.boneInverses.push((new Ay).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,r=t.length;i<r;i++){const r=t[i];e.bones.push(r.uuid);const s=n[i];e.boneInverses.push(s.toArray())}return e}}class mS extends kC{constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const vS=new Ay,yS=new Ay,CS=[],wS=new iy,SS=new Ay,bS=new uw,xS=new Sy;class _S extends uw{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new mS(new Float32Array(16*n),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<n;i++)this.setMatrixAt(i,SS)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new iy),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,vS),wS.copy(e.boundingBox).applyMatrix4(vS),this.boundingBox.union(wS)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new Sy),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,vS),xS.copy(e.boundingSphere).applyMatrix4(vS),this.boundingSphere.union(xS)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.morphTexture&&(this.morphTexture=e.morphTexture.clone()),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,t){const n=t.morphTargetInfluences,i=this.morphTexture.source.data.data,r=e*(n.length+1)+1;for(let s=0;s<n.length;s++)n[s]=i[r+s]}raycast(e,t){const n=this.matrixWorld,i=this.count;if(bS.geometry=this.geometry,bS.material=this.material,void 0!==bS.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),xS.copy(this.boundingSphere),xS.applyMatrix4(n),!1!==e.ray.intersectsSphere(xS)))for(let r=0;r<i;r++){this.getMatrixAt(r,vS),yS.multiplyMatrices(n,vS),bS.matrixWorld=yS,bS.raycast(e,CS);for(let e=0,n=CS.length;e<n;e++){const n=CS[e];n.instanceId=r,n.object=this,t.push(n)}CS.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new mS(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,t){const n=t.morphTargetInfluences,i=n.length+1;null===this.morphTexture&&(this.morphTexture=new dS(new Float32Array(i*this.count),i,this.count,mf,sf));const r=this.morphTexture.source.data.data;let s=0;for(let l=0;l<n.length;l++)s+=n[l];const o=this.geometry.morphTargetsRelative?1:1-s,a=i*e;r[a]=o,r.set(n,a+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null)}}const MS=new ey,ES=new ey,RS=new _v;class TS{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ey(1,0,0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=MS.subVectors(n,t).cross(ES.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(MS),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||RS.getNormalMatrix(e),i=this.coplanarPoint(MS).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const PS=new Sy,AS=new ey;class FS{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new TS,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new TS,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new TS,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new TS,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new TS,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new TS;this.planes=[e,t,n,i,r,s]}set(e,t,n,i,r,s){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(i),o[4].copy(r),o[5].copy(s),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ov;const n=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],u=i[6],h=i[7],d=i[8],p=i[9],g=i[10],f=i[11],m=i[12],v=i[13],y=i[14],C=i[15];if(n[0].setComponents(a-r,h-l,f-d,C-m).normalize(),n[1].setComponents(a+r,h+l,f+d,C+m).normalize(),n[2].setComponents(a+s,h+c,f+p,C+v).normalize(),n[3].setComponents(a-s,h-c,f-p,C-v).normalize(),n[4].setComponents(a-o,h-u,f-g,C-y).normalize(),t===ov)n[5].setComponents(a+o,h+u,f+g,C+y).normalize();else{if(t!==av)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(o,u,g,y).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),PS.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),PS.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(PS)}intersectsSprite(e){return PS.center.set(0,0,0),PS.radius=.7071067811865476,PS.applyMatrix4(e.matrixWorld),this.intersectsSphere(PS)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let r=0;r<6;r++){if(t[r].distanceToPoint(n)<i)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(AS.x=i.normal.x>0?e.max.x:e.min.x,AS.y=i.normal.y>0?e.max.y:e.min.y,AS.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(AS)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}const DS=new Ay,LS=new FS;class IS{constructor(){this.coordinateSystem=ov}intersectsObject(e,t){if(!t.isArrayCamera||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(DS.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),LS.setFromProjectionMatrix(DS,this.coordinateSystem),LS.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(DS.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),LS.setFromProjectionMatrix(DS,this.coordinateSystem),LS.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(DS.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),LS.setFromProjectionMatrix(DS,this.coordinateSystem),LS.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(DS.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),LS.setFromProjectionMatrix(DS,this.coordinateSystem),LS.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(DS.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),LS.setFromProjectionMatrix(DS,this.coordinateSystem),LS.containsPoint(e))return!0}return!1}clone(){return new IS}}function kS(e,t){return e-t}function OS(e,t){return e.z-t.z}function NS(e,t){return t.z-e.z}class BS{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,i){const r=this.pool,s=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1,index:-1});const o=r[this.index];s.push(o),this.index++,o.start=e,o.count=t,o.z=n,o.index=i}reset(){this.list.length=0,this.index=0}}const zS=new Ay,HS=new bC(1,1,1),GS=new FS,US=new IS,VS=new iy,WS=new Sy,jS=new ey,qS=new ey,XS=new ey,KS=new BS,$S=new uw,ZS=[];function YS(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=t.itemSize;if(e.isInterleavedBufferAttribute||e.array.constructor!==t.array.constructor){const r=e.count;for(let s=0;s<r;s++)for(let r=0;r<i;r++)t.setComponent(s+n,r,e.getComponent(s,r))}else t.array.set(e.array,n*i);t.needsUpdate=!0}function JS(e,t){if(e.constructor!==t.constructor){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++)t[i]=e[i]}else{const n=Math.min(e.length,t.length);t.set(new e.constructor(e.buffer,0,n))}}class QS extends uw{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2*t,i=arguments.length>3?arguments[3]:void 0;super(new JC,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(4*this._maxInstanceCount);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new dS(t,e,e,pf,sf);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new dS(t,e,e,vf,rf);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new dS(t,e,e,pf,sf);n.colorSpace=Ov.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,i=this._maxIndexCount;if(!1===this._geometryInitialized){for(const i in e.attributes){const r=e.getAttribute(i),{array:s,itemSize:o,normalized:a}=r,l=new s.constructor(n*o),c=new kC(l,o,a);t.setAttribute(i,c)}if(null!==e.getIndex()){const e=n>65535?new Uint32Array(i):new Uint16Array(i);t.setIndex(new kC(e,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(Boolean(e.getIndex())!==Boolean(t.getIndex()))throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const i=e.getAttribute(n),r=t.getAttribute(n);if(i.itemSize!==r.itemSize||i.normalized!==r.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||!1===t[e].active)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||!1===t[e].active)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new iy);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,i=t.length;n<i;n++){if(!1===t[n].active)continue;const i=t[n].geometryIndex;this.getMatrixAt(n,zS),this.getBoundingBoxAt(i,VS).applyMatrix4(zS),e.union(VS)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Sy);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,i=t.length;n<i;n++){if(!1===t[n].active)continue;const i=t[n].geometryIndex;this.getMatrixAt(n,zS),this.getBoundingSphereAt(i,WS).applyMatrix4(zS),e.union(WS)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&0===this._availableInstanceIds.length)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const t={visible:!0,active:!0,geometryIndex:e};let n=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(kS),n=this._availableInstanceIds.shift(),this._instanceInfo[n]=t):(n=this._instanceInfo.length,this._instanceInfo.push(t));const i=this._matricesTexture;zS.identity().toArray(i.image.data,16*n),i.needsUpdate=!0;const r=this._colorsTexture;return r&&(HS.toArray(r.image.data,4*n),r.needsUpdate=!0),this._visibilityChanged=!0,n}addGeometry(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;this._initializeGeometry(e),this._validateGeometry(e);const i={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},r=this._geometryInfo;i.vertexStart=this._nextVertexStart,i.reservedVertexCount=-1===t?e.getAttribute("position").count:t;const s=e.getIndex();if(null!==s&&(i.indexStart=this._nextIndexStart,i.reservedIndexCount=-1===n?s.count:n),-1!==i.indexStart&&i.indexStart+i.reservedIndexCount>this._maxIndexCount||i.vertexStart+i.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let o;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(kS),o=this._availableGeometryIds.shift(),r[o]=i):(o=this._geometryCount,this._geometryCount++,r.push(i)),this.setGeometryAt(o,e),this._nextIndexStart=i.indexStart+i.reservedIndexCount,this._nextVertexStart=i.vertexStart+i.reservedVertexCount,o}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,i=null!==n.getIndex(),r=n.getIndex(),s=t.getIndex(),o=this._geometryInfo[e];if(i&&s.count>o.reservedIndexCount||t.attributes.position.count>o.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const a=o.vertexStart,l=o.reservedVertexCount;o.vertexCount=t.getAttribute("position").count;for(const c in n.attributes){const e=t.getAttribute(c),i=n.getAttribute(c);YS(e,i,a);const r=e.itemSize;for(let t=e.count,n=l;t<n;t++){const e=a+t;for(let t=0;t<r;t++)i.setComponent(e,t,0)}i.needsUpdate=!0,i.addUpdateRange(a*r,l*r)}if(i){const e=o.indexStart,n=o.reservedIndexCount;o.indexCount=t.getIndex().count;for(let t=0;t<s.count;t++)r.setX(e+t,a+s.getX(t));for(let t=s.count,i=n;t<i;t++)r.setX(e+t,a);r.needsUpdate=!0,r.addUpdateRange(e,o.reservedIndexCount)}return o.start=i?o.indexStart:o.vertexStart,o.count=i?o.indexCount:o.vertexCount,o.boundingBox=null,null!==t.boundingBox&&(o.boundingBox=t.boundingBox.clone()),o.boundingSphere=null,null!==t.boundingSphere&&(o.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||!1===t[e].active)return this;const n=this._instanceInfo;for(let i=0,r=n.length;i<r;i++)n[i].active&&n[i].geometryIndex===e&&this.deleteInstance(i);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,i=n.map(((e,t)=>t)).sort(((e,t)=>n[e].vertexStart-n[t].vertexStart)),r=this.geometry;for(let s=0,o=n.length;s<o;s++){const o=i[s],a=n[o];if(!1!==a.active){if(null!==r.index){if(a.indexStart!==t){const{indexStart:n,vertexStart:i,reservedIndexCount:s}=a,o=r.index,l=o.array,c=e-i;for(let e=n;e<n+s;e++)l[e]=l[e]+c;o.array.copyWithin(t,n,n+s),o.addUpdateRange(t,s),a.indexStart=t}t+=a.reservedIndexCount}if(a.vertexStart!==e){const{vertexStart:t,reservedVertexCount:n}=a,i=r.attributes;for(const r in i){const s=i[r],{array:o,itemSize:a}=s;o.copyWithin(e*a,t*a,(t+n)*a),s.addUpdateRange(e*a,n*a)}a.vertexStart=e}e+=a.reservedVertexCount,a.start=r.index?a.indexStart:a.vertexStart,this._nextIndexStart=r.index?a.indexStart+a.reservedIndexCount:0,this._nextVertexStart=a.vertexStart+a.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,i=this._geometryInfo[e];if(null===i.boundingBox){const e=new iy,t=n.index,r=n.attributes.position;for(let n=i.start,s=i.start+i.count;n<s;n++){let i=n;t&&(i=t.getX(i)),e.expandByPoint(jS.fromBufferAttribute(r,i))}i.boundingBox=e}return t.copy(i.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,i=this._geometryInfo[e];if(null===i.boundingSphere){const t=new Sy;this.getBoundingBoxAt(e,VS),VS.getCenter(t.center);const r=n.index,s=n.attributes.position;let o=0;for(let e=i.start,n=i.start+i.count;e<n;e++){let n=e;r&&(n=r.getX(n)),jS.fromBufferAttribute(s,n),o=Math.max(o,t.center.distanceToSquared(jS))}t.radius=Math.sqrt(o),i.boundingSphere=t}return t.copy(i.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,i=this._matricesTexture.image.data;return t.toArray(i,16*e),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,16*e)}setColorAt(e,t){return this.validateInstanceId(e),null===this._colorsTexture&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,4*e),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,4*e)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t||(this._instanceInfo[e].visible=t,this._visibilityChanged=!0),this}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(kS);t[t.length-1]===n.length;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const i=new Int32Array(e),r=new Int32Array(e);JS(this._multiDrawCounts,i),JS(this._multiDrawStarts,r),this._multiDrawCounts=i,this._multiDrawStarts=r,this._maxInstanceCount=e;const s=this._indirectTexture,o=this._matricesTexture,a=this._colorsTexture;s.dispose(),this._initIndirectTexture(),JS(s.image.data,this._indirectTexture.image.data),o.dispose(),this._initMatricesTexture(),JS(o.image.data,this._matricesTexture.image.data),a&&(a.dispose(),this._initColorsTexture(),JS(a.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter((e=>e.active));if(Math.max(...n.map((e=>e.vertexStart+e.reservedVertexCount)))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index){if(Math.max(...n.map((e=>e.indexStart+e.reservedIndexCount)))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`)}const i=this.geometry;i.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new JC,this._initializeGeometry(i));const r=this.geometry;i.index&&JS(i.index.array,r.index.array);for(const s in i.attributes)JS(i.attributes[s].array,r.attributes[s].array)}raycast(e,t){const n=this._instanceInfo,i=this._geometryInfo,r=this.matrixWorld,s=this.geometry;$S.material=this.material,$S.geometry.index=s.index,$S.geometry.attributes=s.attributes,null===$S.geometry.boundingBox&&($S.geometry.boundingBox=new iy),null===$S.geometry.boundingSphere&&($S.geometry.boundingSphere=new Sy);for(let o=0,a=n.length;o<a;o++){if(!n[o].visible||!n[o].active)continue;const s=n[o].geometryIndex,a=i[s];$S.geometry.setDrawRange(a.start,a.count),this.getMatrixAt(o,$S.matrixWorld).premultiply(r),this.getBoundingBoxAt(s,$S.geometry.boundingBox),this.getBoundingSphereAt(s,$S.geometry.boundingSphere),$S.raycast(e,ZS);for(let e=0,n=ZS.length;e<n;e++){const n=ZS[e];n.object=this,n.batchId=o,t.push(n)}ZS.length=0}$S.material=null,$S.geometry.index=null,$S.geometry.attributes={},$S.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=null!==e.boundingBox?e.boundingBox.clone():null,this.boundingSphere=null!==e.boundingSphere?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map((e=>({...e,boundingBox:null!==e.boundingBox?e.boundingBox.clone():null,boundingSphere:null!==e.boundingSphere?e.boundingSphere.clone():null}))),this._instanceInfo=e._instanceInfo.map((e=>({...e}))),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),null!==this._colorsTexture&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,null!==this._colorsTexture&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,i,r){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const s=i.getIndex(),o=null===s?1:s.array.BYTES_PER_ELEMENT,a=this._instanceInfo,l=this._multiDrawStarts,c=this._multiDrawCounts,u=this._geometryInfo,h=this.perObjectFrustumCulled,d=this._indirectTexture,p=d.image.data,g=n.isArrayCamera?US:GS;h&&!n.isArrayCamera&&(zS.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),GS.setFromProjectionMatrix(zS,e.coordinateSystem));let f=0;if(this.sortObjects){zS.copy(this.matrixWorld).invert(),jS.setFromMatrixPosition(n.matrixWorld).applyMatrix4(zS),qS.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(zS);for(let i=0,r=a.length;i<r;i++)if(a[i].visible&&a[i].active){const e=a[i].geometryIndex;this.getMatrixAt(i,zS),this.getBoundingSphereAt(e,WS).applyMatrix4(zS);let t=!1;if(h&&(t=!g.intersectsSphere(WS,n)),!t){const t=u[e],n=XS.subVectors(WS.center,jS).dot(qS);KS.push(t.start,t.count,n,i)}}const e=KS.list,t=this.customSort;null===t?e.sort(r.transparent?NS:OS):t.call(this,e,n);for(let n=0,i=e.length;n<i;n++){const t=e[n];l[f]=t.start*o,c[f]=t.count,p[f]=t.index,f++}KS.reset()}else for(let m=0,v=a.length;m<v;m++)if(a[m].visible&&a[m].active){const e=a[m].geometryIndex;let t=!1;if(h&&(this.getMatrixAt(m,zS),this.getBoundingSphereAt(e,WS).applyMatrix4(zS),t=!g.intersectsSphere(WS,n)),!t){const t=u[e];l[f]=t.start*o,c[f]=t.count,p[f]=m,f++}}d.needsUpdate=!0,this._multiDrawCount=f,this._visibilityChanged=!1}onBeforeShadow(e,t,n,i,r,s){this.onBeforeRender(e,null,i,r,s)}}class eb extends MC{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new bC(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const tb=new ey,nb=new ey,ib=new Ay,rb=new Py,sb=new Sy,ob=new ey,ab=new ey;class lb extends iC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new JC,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new eb;super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,i=t.count;e<i;e++)tb.fromBufferAttribute(t,e-1),nb.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=tb.distanceTo(nb);e.setAttribute("lineDistance",new WC(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Line.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),sb.copy(n.boundingSphere),sb.applyMatrix4(i),sb.radius+=r,!1===e.ray.intersectsSphere(sb))return;ib.copy(i).invert(),rb.copy(e.ray).applyMatrix4(ib);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=this.isLineSegments?2:1,c=n.index,u=n.attributes.position;if(null!==c){const n=Math.max(0,s.start),i=Math.min(c.count,s.start+s.count);for(let r=n,s=i-1;r<s;r+=l){const n=c.getX(r),i=c.getX(r+1),s=cb(this,e,rb,a,n,i,r);s&&t.push(s)}if(this.isLineLoop){const r=c.getX(i-1),s=c.getX(n),o=cb(this,e,rb,a,r,s,i-1);o&&t.push(o)}}else{const n=Math.max(0,s.start),i=Math.min(u.count,s.start+s.count);for(let r=n,s=i-1;r<s;r+=l){const n=cb(this,e,rb,a,r,r+1,r);n&&t.push(n)}if(this.isLineLoop){const r=cb(this,e,rb,a,i-1,n,i-1);r&&t.push(r)}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function cb(e,t,n,i,r,s,o){const a=e.geometry.attributes.position;tb.fromBufferAttribute(a,r),nb.fromBufferAttribute(a,s);if(n.distanceSqToSegment(tb,nb,ob,ab)>i)return;ob.applyMatrix4(e.matrixWorld);const l=t.ray.origin.distanceTo(ob);return l<t.near||l>t.far?void 0:{distance:l,point:ab.clone().applyMatrix4(e.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:e}}const ub=new ey,hb=new ey;class db extends lb{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,i=t.count;e<i;e+=2)ub.fromBufferAttribute(t,e),hb.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+ub.distanceTo(hb);e.setAttribute("lineDistance",new WC(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class pb extends lb{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class gb extends MC{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new bC(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const fb=new Ay,mb=new Py,vb=new Sy,yb=new ey;class Cb extends iC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new JC,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new gb;super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,r=e.params.Points.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),vb.copy(n.boundingSphere),vb.applyMatrix4(i),vb.radius+=r,!1===e.ray.intersectsSphere(vb))return;fb.copy(i).invert(),mb.copy(e.ray).applyMatrix4(fb);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=n.index,c=n.attributes.position;if(null!==l){for(let n=Math.max(0,s.start),r=Math.min(l.count,s.start+s.count);n<r;n++){const r=l.getX(n);yb.fromBufferAttribute(c,r),wb(yb,r,a,i,e,t,this)}}else{for(let n=Math.max(0,s.start),r=Math.min(c.count,s.start+s.count);n<r;n++)yb.fromBufferAttribute(c,n),wb(yb,n,a,i,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function wb(e,t,n,i,r,s,o){const a=mb.distanceSqToPoint(e);if(a<n){const n=new ey;mb.closestPointToPoint(e,n),n.applyMatrix4(i);const l=r.ray.origin.distanceTo(n);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:n,index:t,face:null,faceIndex:null,barycoord:null,object:o})}}class Sb extends jv{constructor(e,t,n,i){super(e,t,n,i,arguments.length>4&&void 0!==arguments[4]?arguments[4]:Xg,arguments.length>5&&void 0!==arguments[5]?arguments[5]:Xg,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8?arguments[8]:void 0),this.isVideoTexture=!0,this.generateMipmaps=!1;const r=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){r.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class bb extends Sb{constructor(e,t,n,i,r,s,o,a){super({},e,t,n,i,r,s,o,a),this.isVideoFrameTexture=!0}update(){}clone(){return(new this.constructor).copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class xb extends jv{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Ug,this.minFilter=Ug,this.generateMipmaps=!1,this.needsUpdate=!0}}class _b extends jv{constructor(e,t,n,i,r,s,o,a,l,c,u,h){super(null,s,o,a,l,c,i,r,u,h),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class Mb extends _b{constructor(e,t,n,i,r,s){super(e,t,n,r,s),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=Hg,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Eb extends _b{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,Ig),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class Rb extends jv{constructor(e,t,n,i,r,s,o,a,l){super(e,t,n,i,r,s,o,a,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Tb extends jv{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rf,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ug,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Ug,l=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:gf;if(c!==gf&&c!==ff)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,i,r,s,o,a,c,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Uv(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class Pb extends Tb{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t),this.isDepthArrayTexture=!0,this.image={width:e,height:t,depth:n},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Ab extends JC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:i,heightSegments:r},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),i=Math.max(3,Math.floor(i)),r=Math.max(1,Math.floor(r));const s=[],o=[],a=[],l=[],c=t/2,u=Math.PI/2*e,h=t,d=2*u+h,p=2*n+r,g=i+1,f=new ey,m=new ey;for(let v=0;v<=p;v++){let y=0,C=0,w=0,S=0;if(v<=n){const t=v/n,i=t*Math.PI/2;C=-c-e*Math.cos(i),w=e*Math.sin(i),S=-e*Math.cos(i),y=t*u}else if(v<=n+r){const i=(v-n)/r;C=i*t-c,w=e,S=0,y=u+i*h}else{const t=(v-n-r)/n,i=t*Math.PI/2;C=c+e*Math.sin(i),w=e*Math.cos(i),S=e*Math.sin(i),y=u+h+t*u}const b=Math.max(0,Math.min(1,y/d));let x=0;0===v?x=.5/i:v===p&&(x=-.5/i);for(let e=0;e<=i;e++){const t=e/i,n=t*Math.PI*2,r=Math.sin(n),s=Math.cos(n);m.x=-w*s,m.y=C,m.z=w*r,o.push(m.x,m.y,m.z),f.set(-w*s,S,w*r),f.normalize(),a.push(f.x,f.y,f.z),l.push(t+x,b)}if(v>0){const e=(v-1)*g;for(let t=0;t<i;t++){const n=e+t,i=e+t+1,r=v*g+t,o=v*g+t+1;s.push(n,i,r),s.push(i,o,r)}}}this.setIndex(s),this.setAttribute("position",new WC(o,3)),this.setAttribute("normal",new WC(a,3)),this.setAttribute("uv",new WC(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ab(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class Fb extends JC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const r=[],s=[],o=[],a=[],l=new ey,c=new xv;s.push(0,0,0),o.push(0,0,1),a.push(.5,.5);for(let u=0,h=3;u<=t;u++,h+=3){const r=n+u/t*i;l.x=e*Math.cos(r),l.y=e*Math.sin(r),s.push(l.x,l.y,l.z),o.push(0,0,1),c.x=(s[h]/e+1)/2,c.y=(s[h+1]/e+1)/2,a.push(c.x,c.y)}for(let u=1;u<=t;u++)r.push(u,u+1,0);this.setIndex(r),this.setAttribute("position",new WC(s,3)),this.setAttribute("normal",new WC(o,3)),this.setAttribute("uv",new WC(a,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Fb(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Db extends JC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a};const l=this;i=Math.floor(i),r=Math.floor(r);const c=[],u=[],h=[],d=[];let p=0;const g=[],f=n/2;let m=0;function v(n){const r=p,s=new xv,g=new ey;let v=0;const y=!0===n?e:t,C=!0===n?1:-1;for(let e=1;e<=i;e++)u.push(0,f*C,0),h.push(0,C,0),d.push(.5,.5),p++;const w=p;for(let e=0;e<=i;e++){const t=e/i*a+o,n=Math.cos(t),r=Math.sin(t);g.x=y*r,g.y=f*C,g.z=y*n,u.push(g.x,g.y,g.z),h.push(0,C,0),s.x=.5*n+.5,s.y=.5*r*C+.5,d.push(s.x,s.y),p++}for(let e=0;e<i;e++){const t=r+e,i=w+e;!0===n?c.push(i,i+1,t):c.push(i+1,i,t),v+=3}l.addGroup(m,v,!0===n?1:2),m+=v}!function(){const s=new ey,v=new ey;let y=0;const C=(t-e)/n;for(let l=0;l<=r;l++){const c=[],m=l/r,y=m*(t-e)+e;for(let e=0;e<=i;e++){const t=e/i,r=t*a+o,l=Math.sin(r),g=Math.cos(r);v.x=y*l,v.y=-m*n+f,v.z=y*g,u.push(v.x,v.y,v.z),s.set(l,C,g).normalize(),h.push(s.x,s.y,s.z),d.push(t,1-m),c.push(p++)}g.push(c)}for(let n=0;n<i;n++)for(let i=0;i<r;i++){const s=g[i][n],o=g[i+1][n],a=g[i+1][n+1],l=g[i][n+1];(e>0||0!==i)&&(c.push(s,o,l),y+=3),(t>0||i!==r-1)&&(c.push(o,a,l),y+=3)}l.addGroup(m,y,0),m+=y}(),!1===s&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new WC(u,3)),this.setAttribute("normal",new WC(h,3)),this.setAttribute("uv",new WC(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Db(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Lb extends Db{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;super(0,e,t,n,i,r,s,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:s,thetaLength:o}}static fromJSON(e){return new Lb(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Ib extends JC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const r=[],s=[];function o(e,t,n,i){const r=i+1,s=[];for(let o=0;o<=r;o++){s[o]=[];const i=e.clone().lerp(n,o/r),a=t.clone().lerp(n,o/r),l=r-o;for(let e=0;e<=l;e++)s[o][e]=0===e&&o===r?i:i.clone().lerp(a,e/l)}for(let o=0;o<r;o++)for(let e=0;e<2*(r-o)-1;e++){const t=Math.floor(e/2);e%2===0?(a(s[o][t+1]),a(s[o+1][t]),a(s[o][t])):(a(s[o][t+1]),a(s[o+1][t+1]),a(s[o+1][t]))}}function a(e){r.push(e.x,e.y,e.z)}function l(t,n){const i=3*t;n.x=e[i+0],n.y=e[i+1],n.z=e[i+2]}function c(e,t,n,i){i<0&&1===e.x&&(s[t]=e.x-1),0===n.x&&0===n.z&&(s[t]=i/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}!function(e){const n=new ey,i=new ey,r=new ey;for(let s=0;s<t.length;s+=3)l(t[s+0],n),l(t[s+1],i),l(t[s+2],r),o(n,i,r,e)}(i),function(e){const t=new ey;for(let n=0;n<r.length;n+=3)t.x=r[n+0],t.y=r[n+1],t.z=r[n+2],t.normalize().multiplyScalar(e),r[n+0]=t.x,r[n+1]=t.y,r[n+2]=t.z}(n),function(){const e=new ey;for(let n=0;n<r.length;n+=3){e.x=r[n+0],e.y=r[n+1],e.z=r[n+2];const i=u(e)/2/Math.PI+.5,o=(t=e,Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5);s.push(i,1-o)}var t;(function(){const e=new ey,t=new ey,n=new ey,i=new ey,o=new xv,a=new xv,l=new xv;for(let h=0,d=0;h<r.length;h+=9,d+=6){e.set(r[h+0],r[h+1],r[h+2]),t.set(r[h+3],r[h+4],r[h+5]),n.set(r[h+6],r[h+7],r[h+8]),o.set(s[d+0],s[d+1]),a.set(s[d+2],s[d+3]),l.set(s[d+4],s[d+5]),i.copy(e).add(t).add(n).divideScalar(3);const p=u(i);c(o,d+0,e,p),c(a,d+2,t,p),c(l,d+4,n,p)}})(),function(){for(let e=0;e<s.length;e+=6){const t=s[e+0],n=s[e+2],i=s[e+4],r=Math.max(t,n,i),o=Math.min(t,n,i);r>.9&&o<.1&&(t<.2&&(s[e+0]+=1),n<.2&&(s[e+2]+=1),i<.2&&(s[e+4]+=1))}}()}(),this.setAttribute("position",new WC(r,3)),this.setAttribute("normal",new WC(r.slice(),3)),this.setAttribute("uv",new WC(s,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ib(e.vertices,e.indices,e.radius,e.details)}}class kb extends Ib{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2,i=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new kb(e.radius,e.detail)}}const Ob=new ey,Nb=new ey,Bb=new ey,zb=new vC;class Hb extends JC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const n=4,i=Math.pow(10,n),r=Math.cos(gv*t),s=e.getIndex(),o=e.getAttribute("position"),a=s?s.count:o.count,l=[0,0,0],c=["a","b","c"],u=new Array(3),h={},d=[];for(let e=0;e<a;e+=3){s?(l[0]=s.getX(e),l[1]=s.getX(e+1),l[2]=s.getX(e+2)):(l[0]=e,l[1]=e+1,l[2]=e+2);const{a:t,b:n,c:a}=zb;if(t.fromBufferAttribute(o,l[0]),n.fromBufferAttribute(o,l[1]),a.fromBufferAttribute(o,l[2]),zb.getNormal(Bb),u[0]=`${Math.round(t.x*i)},${Math.round(t.y*i)},${Math.round(t.z*i)}`,u[1]=`${Math.round(n.x*i)},${Math.round(n.y*i)},${Math.round(n.z*i)}`,u[2]=`${Math.round(a.x*i)},${Math.round(a.y*i)},${Math.round(a.z*i)}`,u[0]!==u[1]&&u[1]!==u[2]&&u[2]!==u[0])for(let e=0;e<3;e++){const t=(e+1)%3,n=u[e],i=u[t],s=zb[c[e]],o=zb[c[t]],a=`${n}_${i}`,p=`${i}_${n}`;p in h&&h[p]?(Bb.dot(h[p].normal)<=r&&(d.push(s.x,s.y,s.z),d.push(o.x,o.y,o.z)),h[p]=null):a in h||(h[a]={index0:l[e],index1:l[t],normal:Bb.clone()})}}for(const e in h)if(h[e]){const{index0:t,index1:n}=h[e];Ob.fromBufferAttribute(o,t),Nb.fromBufferAttribute(o,n),d.push(Ob.x,Ob.y,Ob.z),d.push(Nb.x,Nb.y,Nb.z)}this.setAttribute("position",new WC(d,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Gb{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),r=0;t.push(0);for(let s=1;s<=e;s++)n=this.getPoint(s/e),r+=n.distanceTo(i),t.push(r),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getLengths();let i=0;const r=n.length;let s;s=t||e*n[r-1];let o,a=0,l=r-1;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),o=n[i]-s,o<0)a=i+1;else{if(!(o>0)){l=i;break}l=i-1}if(i=l,n[i]===s)return i/(r-1);const c=n[i];return(i+(s-c)/(n[i+1]-c))/(r-1)}getTangent(e,t){const n=1e-4;let i=e-n,r=e+n;i<0&&(i=0),r>1&&(r=1);const s=this.getPoint(i),o=this.getPoint(r),a=t||(s.isVector2?new xv:new ey);return a.copy(o).sub(s).normalize(),a}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new ey,i=[],r=[],s=[],o=new ey,a=new Ay;for(let d=0;d<=e;d++){const t=d/e;i[d]=this.getTangentAt(t,new ey)}r[0]=new ey,s[0]=new ey;let l=Number.MAX_VALUE;const c=Math.abs(i[0].x),u=Math.abs(i[0].y),h=Math.abs(i[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),o.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],o),s[0].crossVectors(i[0],r[0]);for(let d=1;d<=e;d++){if(r[d]=r[d-1].clone(),s[d]=s[d-1].clone(),o.crossVectors(i[d-1],i[d]),o.length()>Number.EPSILON){o.normalize();const e=Math.acos(vv(i[d-1].dot(i[d]),-1,1));r[d].applyMatrix4(a.makeRotationAxis(o,e))}s[d].crossVectors(i[d],r[d])}if(!0===t){let t=Math.acos(vv(r[0].dot(r[e]),-1,1));t/=e,i[0].dot(o.crossVectors(r[0],r[e]))>0&&(t=-t);for(let n=1;n<=e;n++)r[n].applyMatrix4(a.makeRotationAxis(i[n],t*n)),s[n].crossVectors(i[n],r[n])}return{tangents:i,normals:r,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Ub extends Gb{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new xv,n=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const r=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=r?0:n),!0!==this.aClockwise||r||(i===n?i=-n:i-=n);const s=this.aStartAngle+e*i;let o=this.aX+this.xRadius*Math.cos(s),a=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=o-this.aX,i=a-this.aY;o=n*e-i*t+this.aX,a=n*t+i*e+this.aY}return t.set(o,a)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Vb extends Ub{constructor(e,t,n,i,r,s){super(e,t,n,n,i,r,s),this.isArcCurve=!0,this.type="ArcCurve"}}function Wb(){let e=0,t=0,n=0,i=0;function r(r,s,o,a){e=r,t=o,n=-3*r+3*s-2*o-a,i=2*r-2*s+o+a}return{initCatmullRom:function(e,t,n,i,s){r(t,n,s*(n-e),s*(i-t))},initNonuniformCatmullRom:function(e,t,n,i,s,o,a){let l=(t-e)/s-(n-e)/(s+o)+(n-t)/o,c=(n-t)/o-(i-t)/(o+a)+(i-n)/a;l*=o,c*=o,r(t,n,l,c)},calc:function(r){const s=r*r;return e+t*r+n*s+i*(s*r)}}}const jb=new ey,qb=new Wb,Xb=new Wb,Kb=new Wb;class $b extends Gb{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey,n=this.points,i=n.length,r=(i-(this.closed?0:1))*e;let s,o,a=Math.floor(r),l=r-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/i)+1)*i:0===l&&a===i-1&&(a=i-2,l=1),this.closed||a>0?s=n[(a-1)%i]:(jb.subVectors(n[0],n[1]).add(n[0]),s=jb);const c=n[a%i],u=n[(a+1)%i];if(this.closed||a+2<i?o=n[(a+2)%i]:(jb.subVectors(n[i-1],n[i-2]).add(n[i-1]),o=jb),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(s.distanceToSquared(c),e),n=Math.pow(c.distanceToSquared(u),e),i=Math.pow(u.distanceToSquared(o),e);n<1e-4&&(n=1),t<1e-4&&(t=n),i<1e-4&&(i=n),qb.initNonuniformCatmullRom(s.x,c.x,u.x,o.x,t,n,i),Xb.initNonuniformCatmullRom(s.y,c.y,u.y,o.y,t,n,i),Kb.initNonuniformCatmullRom(s.z,c.z,u.z,o.z,t,n,i)}else"catmullrom"===this.curveType&&(qb.initCatmullRom(s.x,c.x,u.x,o.x,this.tension),Xb.initCatmullRom(s.y,c.y,u.y,o.y,this.tension),Kb.initCatmullRom(s.z,c.z,u.z,o.z,this.tension));return t.set(qb.calc(l),Xb.calc(l),Kb.calc(l)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new ey).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Zb(e,t,n,i,r){const s=.5*(i-t),o=.5*(r-n),a=e*e;return(2*n-2*i+s+o)*(e*a)+(-3*n+3*i-2*s-o)*a+s*e+n}function Yb(e,t,n,i){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,i)}function Jb(e,t,n,i,r){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,i)+function(e,t){return e*e*e*t}(e,r)}class Qb extends Gb{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new xv,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new xv,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new xv,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new xv;super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new xv,n=this.v0,i=this.v1,r=this.v2,s=this.v3;return t.set(Jb(e,n.x,i.x,r.x,s.x),Jb(e,n.y,i.y,r.y,s.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class ex extends Gb{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ey,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ey,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new ey;super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey,n=this.v0,i=this.v1,r=this.v2,s=this.v3;return t.set(Jb(e,n.x,i.x,r.x,s.x),Jb(e,n.y,i.y,r.y,s.y),Jb(e,n.z,i.z,r.z,s.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class tx extends Gb{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new xv,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new xv;super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new xv;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new xv).subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class nx extends Gb{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ey,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey;super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey).subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ix extends Gb{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new xv,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new xv,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new xv;super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new xv,n=this.v0,i=this.v1,r=this.v2;return t.set(Yb(e,n.x,i.x,r.x),Yb(e,n.y,i.y,r.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class rx extends Gb{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ey,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ey;super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey,n=this.v0,i=this.v1,r=this.v2;return t.set(Yb(e,n.x,i.x,r.x),Yb(e,n.y,i.y,r.y),Yb(e,n.z,i.z,r.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class sx extends Gb{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new xv,n=this.points,i=(n.length-1)*e,r=Math.floor(i),s=i-r,o=n[0===r?r:r-1],a=n[r],l=n[r>n.length-2?n.length-1:r+1],c=n[r>n.length-3?n.length-1:r+2];return t.set(Zb(s,o.x,a.x,l.x,c.x),Zb(s,o.y,a.y,l.y,c.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new xv).fromArray(n))}return this}}var ox=Object.freeze({__proto__:null,ArcCurve:Vb,CatmullRomCurve3:$b,CubicBezierCurve:Qb,CubicBezierCurve3:ex,EllipseCurve:Ub,LineCurve:tx,LineCurve3:nx,QuadraticBezierCurve:ix,QuadraticBezierCurve3:rx,SplineCurve:sx});class ax extends Gb{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=!0===e.isVector2?"LineCurve":"LineCurve3";this.curves.push(new ox[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let r=0;for(;r<i.length;){if(i[r]>=n){const e=i[r]-n,s=this.curves[r],o=s.getLength(),a=0===o?0:1-e/o;return s.getPointAt(a,t)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const t=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const s=r[i],o=s.isEllipseCurve?2*e:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,a=s.getPoints(o);for(let e=0;e<a.length;e++){const i=a[e];n&&n.equals(i)||(t.push(i),n=i)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new ox[n.type]).fromJSON(n))}return this}}class lx extends ax{constructor(e){super(),this.type="Path",this.currentPoint=new xv,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new tx(this.currentPoint.clone(),new xv(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const r=new ix(this.currentPoint.clone(),new xv(e,t),new xv(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,r,s){const o=new Qb(this.currentPoint.clone(),new xv(e,t),new xv(n,i),new xv(r,s));return this.curves.push(o),this.currentPoint.set(r,s),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new sx(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,r,s){const o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(e+o,t+a,n,i,r,s),this}absarc(e,t,n,i,r,s){return this.absellipse(e,t,n,n,i,r,s),this}ellipse(e,t,n,i,r,s,o,a){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,i,r,s,o,a),this}absellipse(e,t,n,i,r,s,o,a){const l=new Ub(e,t,n,i,r,s,o,a);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class cx extends lx{constructor(e){super(e),this.uuid=mv(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new lx).fromJSON(n))}return this}}function ux(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const i=t&&t.length,r=i?t[0]*n:e.length;let s=hx(e,0,r,n,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c;if(i&&(s=function(e,t,n,i){const r=[];for(let s=0,o=t.length;s<o;s++){const n=hx(e,t[s]*i,s<o-1?t[s+1]*i:e.length,i,!1);n===n.next&&(n.steiner=!0),r.push(bx(n))}r.sort(yx);for(let s=0;s<r.length;s++)n=Cx(r[s],n);return n}(e,t,s,n)),e.length>80*n){a=1/0,l=1/0;let t=-1/0,i=-1/0;for(let s=n;s<r;s+=n){const n=e[s],r=e[s+1];n<a&&(a=n),r<l&&(l=r),n>t&&(t=n),r>i&&(i=r)}c=Math.max(t-a,i-l),c=0!==c?32767/c:0}return px(s,o,n,a,l,c,0),o}function hx(e,t,n,i,r){let s;if(r===function(e,t,n,i){let r=0;for(let s=t,o=n-i;s<n;s+=i)r+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return r}(e,t,n,i)>0)for(let o=t;o<n;o+=i)s=Lx(o/i|0,e[o],e[o+1],s);else for(let o=n-i;o>=t;o-=i)s=Lx(o/i|0,e[o],e[o+1],s);return s&&Rx(s,s.next)&&(Ix(s),s=s.next),s}function dx(e,t){if(!e)return e;t||(t=e);let n,i=e;do{if(n=!1,i.steiner||!Rx(i,i.next)&&0!==Ex(i.prev,i,i.next))i=i.next;else{if(Ix(i),i=t=i.prev,i===i.next)break;n=!0}}while(n||i!==t);return t}function px(e,t,n,i,r,s,o){if(!e)return;!o&&s&&function(e,t,n,i){let r=e;do{0===r.z&&(r.z=Sx(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){let t,n=1;do{let i,r=e;e=null;let s=null;for(t=0;r;){t++;let o=r,a=0;for(let e=0;e<n&&(a++,o=o.nextZ,o);e++);let l=n;for(;a>0||l>0&&o;)0!==a&&(0===l||!o||r.z<=o.z)?(i=r,r=r.nextZ,a--):(i=o,o=o.nextZ,l--),s?s.nextZ=i:e=i,i.prevZ=s,s=i;r=o}s.nextZ=null,n*=2}while(t>1)}(r)}(e,i,r,s);let a=e;for(;e.prev!==e.next;){const l=e.prev,c=e.next;if(s?fx(e,i,r,s):gx(e))t.push(l.i,e.i,c.i),Ix(e),e=c.next,a=c.next;else if((e=c)===a){o?1===o?px(e=mx(dx(e),t),t,n,i,r,s,2):2===o&&vx(e,t,n,i,r,s):px(dx(e),t,n,i,r,s,1);break}}}function gx(e){const t=e.prev,n=e,i=e.next;if(Ex(t,n,i)>=0)return!1;const r=t.x,s=n.x,o=i.x,a=t.y,l=n.y,c=i.y,u=Math.min(r,s,o),h=Math.min(a,l,c),d=Math.max(r,s,o),p=Math.max(a,l,c);let g=i.next;for(;g!==t;){if(g.x>=u&&g.x<=d&&g.y>=h&&g.y<=p&&_x(r,a,s,l,o,c,g.x,g.y)&&Ex(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function fx(e,t,n,i){const r=e.prev,s=e,o=e.next;if(Ex(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,u=r.y,h=s.y,d=o.y,p=Math.min(a,l,c),g=Math.min(u,h,d),f=Math.max(a,l,c),m=Math.max(u,h,d),v=Sx(p,g,t,n,i),y=Sx(f,m,t,n,i);let C=e.prevZ,w=e.nextZ;for(;C&&C.z>=v&&w&&w.z<=y;){if(C.x>=p&&C.x<=f&&C.y>=g&&C.y<=m&&C!==r&&C!==o&&_x(a,u,l,h,c,d,C.x,C.y)&&Ex(C.prev,C,C.next)>=0)return!1;if(C=C.prevZ,w.x>=p&&w.x<=f&&w.y>=g&&w.y<=m&&w!==r&&w!==o&&_x(a,u,l,h,c,d,w.x,w.y)&&Ex(w.prev,w,w.next)>=0)return!1;w=w.nextZ}for(;C&&C.z>=v;){if(C.x>=p&&C.x<=f&&C.y>=g&&C.y<=m&&C!==r&&C!==o&&_x(a,u,l,h,c,d,C.x,C.y)&&Ex(C.prev,C,C.next)>=0)return!1;C=C.prevZ}for(;w&&w.z<=y;){if(w.x>=p&&w.x<=f&&w.y>=g&&w.y<=m&&w!==r&&w!==o&&_x(a,u,l,h,c,d,w.x,w.y)&&Ex(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function mx(e,t){let n=e;do{const i=n.prev,r=n.next.next;!Rx(i,r)&&Tx(i,n,n.next,r)&&Fx(i,r)&&Fx(r,i)&&(t.push(i.i,n.i,r.i),Ix(n),Ix(n.next),n=e=r),n=n.next}while(n!==e);return dx(n)}function vx(e,t,n,i,r,s){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&Mx(o,e)){let a=Dx(o,e);return o=dx(o,o.next),a=dx(a,a.next),px(o,t,n,i,r,s,0),void px(a,t,n,i,r,s,0)}e=e.next}o=o.next}while(o!==e)}function yx(e,t){let n=e.x-t.x;if(0===n&&(n=e.y-t.y,0===n)){n=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)}return n}function Cx(e,t){const n=function(e,t){let n=t;const i=e.x,r=e.y;let s,o=-1/0;if(Rx(e,n))return n;do{if(Rx(e,n.next))return n.next;if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const e=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=i&&e>o&&(o=e,s=n.x<n.next.x?n:n.next,e===i))return s}n=n.next}while(n!==t);if(!s)return null;const a=s,l=s.x,c=s.y;let u=1/0;n=s;do{if(i>=n.x&&n.x>=l&&i!==n.x&&xx(r<c?i:o,r,l,c,r<c?o:i,r,n.x,n.y)){const t=Math.abs(r-n.y)/(i-n.x);Fx(n,e)&&(t<u||t===u&&(n.x>s.x||n.x===s.x&&wx(s,n)))&&(s=n,u=t)}n=n.next}while(n!==a);return s}(e,t);if(!n)return t;const i=Dx(n,e);return dx(i,i.next),dx(n,n.next)}function wx(e,t){return Ex(e.prev,e,t.prev)<0&&Ex(t.next,e,e.next)<0}function Sx(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function bx(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function xx(e,t,n,i,r,s,o,a){return(r-o)*(t-a)>=(e-o)*(s-a)&&(e-o)*(i-a)>=(n-o)*(t-a)&&(n-o)*(s-a)>=(r-o)*(i-a)}function _x(e,t,n,i,r,s,o,a){return!(e===o&&t===a)&&xx(e,t,n,i,r,s,o,a)}function Mx(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Tx(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Fx(e,t)&&Fx(t,e)&&function(e,t){let n=e,i=!1;const r=(e.x+t.x)/2,s=(e.y+t.y)/2;do{n.y>s!==n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(Ex(e.prev,e,t.prev)||Ex(e,t.prev,t))||Rx(e,t)&&Ex(e.prev,e,e.next)>0&&Ex(t.prev,t,t.next)>0)}function Ex(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Rx(e,t){return e.x===t.x&&e.y===t.y}function Tx(e,t,n,i){const r=Ax(Ex(e,t,n)),s=Ax(Ex(e,t,i)),o=Ax(Ex(n,i,e)),a=Ax(Ex(n,i,t));return r!==s&&o!==a||(!(0!==r||!Px(e,n,t))||(!(0!==s||!Px(e,i,t))||(!(0!==o||!Px(n,e,i))||!(0!==a||!Px(n,t,i)))))}function Px(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Ax(e){return e>0?1:e<0?-1:0}function Fx(e,t){return Ex(e.prev,e,e.next)<0?Ex(e,t,e.next)>=0&&Ex(e,e.prev,t)>=0:Ex(e,t,e.prev)<0||Ex(e,e.next,t)<0}function Dx(e,t){const n=kx(e.i,e.x,e.y),i=kx(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function Lx(e,t,n,i){const r=kx(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Ix(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function kx(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Ox{static triangulate(e,t){return ux(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:2)}}class Nx{static area(e){const t=e.length;let n=0;for(let i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return.5*n}static isClockWise(e){return Nx.area(e)<0}static triangulateShape(e,t){const n=[],i=[],r=[];Bx(e),zx(n,e);let s=e.length;t.forEach(Bx);for(let a=0;a<t.length;a++)i.push(s),s+=t[a].length,zx(n,t[a]);const o=Ox.triangulate(n,i);for(let a=0;a<o.length;a+=3)r.push(o.slice(a,a+3));return r}}function Bx(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function zx(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}class Hx extends JC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new cx([new xv(.5,.5),new xv(-.5,.5),new xv(-.5,-.5),new xv(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],r=[];for(let o=0,a=e.length;o<a;o++){s(e[o])}function s(e){const s=[],o=void 0!==t.curveSegments?t.curveSegments:12,a=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:1;let c=void 0===t.bevelEnabled||t.bevelEnabled,u=void 0!==t.bevelThickness?t.bevelThickness:.2,h=void 0!==t.bevelSize?t.bevelSize:u-.1,d=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3;const g=t.extrudePath,f=void 0!==t.UVGenerator?t.UVGenerator:Gx;let m,v,y,C,w,S=!1;g&&(m=g.getSpacedPoints(a),S=!0,c=!1,v=g.computeFrenetFrames(a,!1),y=new ey,C=new ey,w=new ey),c||(p=0,u=0,h=0,d=0);const b=e.extractPoints(o);let x=b.shape;const _=b.holes;if(!Nx.isClockWise(x)){x=x.reverse();for(let e=0,t=_.length;e<t;e++){const t=_[e];Nx.isClockWise(t)&&(_[e]=t.reverse())}}function M(e){const t=1e-10*1e-10;let n=e[0];for(let i=1;i<=e.length;i++){const r=i%e.length,s=e[r],o=s.x-n.x,a=s.y-n.y,l=o*o+a*a,c=Math.max(Math.abs(s.x),Math.abs(s.y),Math.abs(n.x),Math.abs(n.y));l<=t*c*c?(e.splice(r,1),i--):n=s}}M(x),_.forEach(M);const E=_.length,R=x;for(let t=0;t<E;t++){const e=_[t];x=x.concat(e)}function T(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().addScaledVector(t,n)}const P=x.length;function A(e,t,n){let i,r,s;const o=e.x-t.x,a=e.y-t.y,l=n.x-e.x,c=n.y-e.y,u=o*o+a*a,h=o*c-a*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),p=t.x-a/h,g=t.y+o/h,f=((n.x-c/d-p)*c-(n.y+l/d-g)*l)/(o*c-a*l);i=p+o*f-e.x,r=g+a*f-e.y;const m=i*i+r*r;if(m<=2)return new xv(i,r);s=Math.sqrt(m/2)}else{let e=!1;o>Number.EPSILON?l>Number.EPSILON&&(e=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(a)===Math.sign(c)&&(e=!0),e?(i=-a,r=o,s=Math.sqrt(u)):(i=o,r=a,s=Math.sqrt(u/2))}return new xv(i/s,r/s)}const F=[];for(let t=0,n=R.length,i=n-1,r=t+1;t<n;t++,i++,r++)i===n&&(i=0),r===n&&(r=0),F[t]=A(R[t],R[i],R[r]);const D=[];let L,I,k=F.concat();for(let t=0,n=E;t<n;t++){const e=_[t];L=[];for(let t=0,n=e.length,i=n-1,r=t+1;t<n;t++,i++,r++)i===n&&(i=0),r===n&&(r=0),L[t]=A(e[t],e[i],e[r]);D.push(L),k=k.concat(L)}if(0===p)I=Nx.triangulateShape(R,_);else{const e=[],t=[];for(let n=0;n<p;n++){const i=n/p,r=u*Math.cos(i*Math.PI/2),s=h*Math.sin(i*Math.PI/2)+d;for(let t=0,n=R.length;t<n;t++){const n=T(R[t],F[t],s);z(n.x,n.y,-r),0===i&&e.push(n)}for(let e=0,n=E;e<n;e++){const n=_[e];L=D[e];const o=[];for(let e=0,t=n.length;e<t;e++){const t=T(n[e],L[e],s);z(t.x,t.y,-r),0===i&&o.push(t)}0===i&&t.push(o)}}I=Nx.triangulateShape(e,t)}const O=I.length,N=h+d;for(let t=0;t<P;t++){const e=c?T(x[t],k[t],N):x[t];S?(C.copy(v.normals[0]).multiplyScalar(e.x),y.copy(v.binormals[0]).multiplyScalar(e.y),w.copy(m[0]).add(C).add(y),z(w.x,w.y,w.z)):z(e.x,e.y,0)}for(let t=1;t<=a;t++)for(let e=0;e<P;e++){const n=c?T(x[e],k[e],N):x[e];S?(C.copy(v.normals[t]).multiplyScalar(n.x),y.copy(v.binormals[t]).multiplyScalar(n.y),w.copy(m[t]).add(C).add(y),z(w.x,w.y,w.z)):z(n.x,n.y,l/a*t)}for(let t=p-1;t>=0;t--){const e=t/p,n=u*Math.cos(e*Math.PI/2),i=h*Math.sin(e*Math.PI/2)+d;for(let t=0,r=R.length;t<r;t++){const e=T(R[t],F[t],i);z(e.x,e.y,l+n)}for(let t=0,r=_.length;t<r;t++){const e=_[t];L=D[t];for(let t=0,r=e.length;t<r;t++){const r=T(e[t],L[t],i);S?z(r.x,r.y+m[a-1].y,m[a-1].x+n):z(r.x,r.y,l+n)}}}function B(e,t){let n=e.length;for(;--n>=0;){const i=n;let r=n-1;r<0&&(r=e.length-1);for(let e=0,n=a+2*p;e<n;e++){const n=P*e,s=P*(e+1);G(t+i+n,t+r+n,t+r+s,t+i+s)}}}function z(e,t,n){s.push(e),s.push(t),s.push(n)}function H(e,t,r){U(e),U(t),U(r);const s=i.length/3,o=f.generateTopUV(n,i,s-3,s-2,s-1);V(o[0]),V(o[1]),V(o[2])}function G(e,t,r,s){U(e),U(t),U(s),U(t),U(r),U(s);const o=i.length/3,a=f.generateSideWallUV(n,i,o-6,o-3,o-2,o-1);V(a[0]),V(a[1]),V(a[3]),V(a[1]),V(a[2]),V(a[3])}function U(e){i.push(s[3*e+0]),i.push(s[3*e+1]),i.push(s[3*e+2])}function V(e){r.push(e.x),r.push(e.y)}!function(){const e=i.length/3;if(c){let e=0,t=P*e;for(let n=0;n<O;n++){const e=I[n];H(e[2]+t,e[1]+t,e[0]+t)}e=a+2*p,t=P*e;for(let n=0;n<O;n++){const e=I[n];H(e[0]+t,e[1]+t,e[2]+t)}}else{for(let e=0;e<O;e++){const t=I[e];H(t[2],t[1],t[0])}for(let e=0;e<O;e++){const t=I[e];H(t[0]+P*a,t[1]+P*a,t[2]+P*a)}}n.addGroup(e,i.length/3-e,0)}(),function(){const e=i.length/3;let t=0;B(R,t),t+=R.length;for(let n=0,i=_.length;n<i;n++){const e=_[n];B(e,t),t+=e.length}n.addGroup(e,i.length/3-e,1)}()}this.setAttribute("position",new WC(i,3)),this.setAttribute("uv",new WC(r,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(let i=0,r=e.length;i<r;i++){const t=e[i];n.shapes.push(t.uuid)}else n.shapes.push(e.uuid);n.options=Object.assign({},t),void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const i=t[e.shapes[r]];n.push(i)}const i=e.options.extrudePath;return void 0!==i&&(e.options.extrudePath=(new ox[i.type]).fromJSON(i)),new Hx(n,e.options)}}const Gx={generateTopUV:function(e,t,n,i,r){const s=t[3*n],o=t[3*n+1],a=t[3*i],l=t[3*i+1],c=t[3*r],u=t[3*r+1];return[new xv(s,o),new xv(a,l),new xv(c,u)]},generateSideWallUV:function(e,t,n,i,r,s){const o=t[3*n],a=t[3*n+1],l=t[3*n+2],c=t[3*i],u=t[3*i+1],h=t[3*i+2],d=t[3*r],p=t[3*r+1],g=t[3*r+2],f=t[3*s],m=t[3*s+1],v=t[3*s+2];return Math.abs(a-u)<Math.abs(o-c)?[new xv(o,1-l),new xv(c,1-h),new xv(d,1-g),new xv(f,1-v)]:[new xv(a,1-l),new xv(u,1-h),new xv(p,1-g),new xv(m,1-v)]}};class Ux extends Ib{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ux(e.radius,e.detail)}}class Vx extends JC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new xv(0,-.5),new xv(.5,0),new xv(0,.5)],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=vv(i,0,2*Math.PI);const r=[],s=[],o=[],a=[],l=[],c=1/t,u=new ey,h=new xv,d=new ey,p=new ey,g=new ey;let f=0,m=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:f=e[v+1].x-e[v].x,m=e[v+1].y-e[v].y,d.x=1*m,d.y=-f,d.z=0*m,g.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case e.length-1:a.push(g.x,g.y,g.z);break;default:f=e[v+1].x-e[v].x,m=e[v+1].y-e[v].y,d.x=1*m,d.y=-f,d.z=0*m,p.copy(d),d.x+=g.x,d.y+=g.y,d.z+=g.z,d.normalize(),a.push(d.x,d.y,d.z),g.copy(p)}for(let v=0;v<=t;v++){const r=n+v*c*i,d=Math.sin(r),p=Math.cos(r);for(let n=0;n<=e.length-1;n++){u.x=e[n].x*d,u.y=e[n].y,u.z=e[n].x*p,s.push(u.x,u.y,u.z),h.x=v/t,h.y=n/(e.length-1),o.push(h.x,h.y);const i=a[3*n+0]*d,r=a[3*n+1],c=a[3*n+0]*p;l.push(i,r,c)}}for(let v=0;v<t;v++)for(let t=0;t<e.length-1;t++){const n=t+v*e.length,i=n,s=n+e.length,o=n+e.length+1,a=n+1;r.push(i,s,a),r.push(o,a,s)}this.setIndex(r),this.setAttribute("position",new WC(s,3)),this.setAttribute("uv",new WC(o,2)),this.setAttribute("normal",new WC(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Vx(e.points,e.segments,e.phiStart,e.phiLength)}}class Wx extends Ib{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Wx(e.radius,e.detail)}}class jx extends JC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const r=e/2,s=t/2,o=Math.floor(n),a=Math.floor(i),l=o+1,c=a+1,u=e/o,h=t/a,d=[],p=[],g=[],f=[];for(let m=0;m<c;m++){const e=m*h-s;for(let t=0;t<l;t++){const n=t*u-r;p.push(n,-e,0),g.push(0,0,1),f.push(t/o),f.push(1-m/a)}}for(let m=0;m<a;m++)for(let e=0;e<o;e++){const t=e+l*m,n=e+l*(m+1),i=e+1+l*(m+1),r=e+1+l*m;d.push(t,n,r),d.push(n,i,r)}this.setIndex(d),this.setAttribute("position",new WC(p,3)),this.setAttribute("normal",new WC(g,3)),this.setAttribute("uv",new WC(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jx(e.width,e.height,e.widthSegments,e.heightSegments)}}class qx extends JC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:s},n=Math.max(3,n),i=Math.max(1,i);const o=[],a=[],l=[],c=[];let u=e;const h=(t-e)/i,d=new ey,p=new xv;for(let g=0;g<=i;g++){for(let e=0;e<=n;e++){const i=r+e/n*s;d.x=u*Math.cos(i),d.y=u*Math.sin(i),a.push(d.x,d.y,d.z),l.push(0,0,1),p.x=(d.x/t+1)/2,p.y=(d.y/t+1)/2,c.push(p.x,p.y)}u+=h}for(let g=0;g<i;g++){const e=g*(n+1);for(let t=0;t<n;t++){const i=t+e,r=i,s=i+n+1,a=i+n+2,l=i+1;o.push(r,s,l),o.push(s,a,l)}}this.setIndex(o),this.setAttribute("position",new WC(a,3)),this.setAttribute("normal",new WC(l,3)),this.setAttribute("uv",new WC(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new qx(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Xx extends JC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new cx([new xv(0,.5),new xv(-.5,-.5),new xv(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],r=[],s=[];let o=0,a=0;if(!1===Array.isArray(e))l(e);else for(let c=0;c<e.length;c++)l(e[c]),this.addGroup(o,a,c),o+=a,a=0;function l(e){const o=i.length/3,l=e.extractPoints(t);let c=l.shape;const u=l.holes;!1===Nx.isClockWise(c)&&(c=c.reverse());for(let t=0,n=u.length;t<n;t++){const e=u[t];!0===Nx.isClockWise(e)&&(u[t]=e.reverse())}const h=Nx.triangulateShape(c,u);for(let t=0,n=u.length;t<n;t++){const e=u[t];c=c.concat(e)}for(let t=0,n=c.length;t<n;t++){const e=c[t];i.push(e.x,e.y,0),r.push(0,0,1),s.push(e.x,e.y)}for(let t=0,i=h.length;t<i;t++){const e=h[t],i=e[0]+o,r=e[1]+o,s=e[2]+o;n.push(i,r,s),a+=3}}this.setIndex(n),this.setAttribute("position",new WC(i,3)),this.setAttribute("normal",new WC(r,3)),this.setAttribute("uv",new WC(s,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let n=0,i=e.length;n<i;n++){const i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let i=0,r=e.shapes.length;i<r;i++){const r=t[e.shapes[i]];n.push(r)}return new Xx(n,e.curveSegments)}}class Kx extends JC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:s,thetaLength:o},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const a=Math.min(s+o,Math.PI);let l=0;const c=[],u=new ey,h=new ey,d=[],p=[],g=[],f=[];for(let m=0;m<=n;m++){const d=[],v=m/n;let y=0;0===m&&0===s?y=.5/t:m===n&&a===Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){const a=n/t;u.x=-e*Math.cos(i+a*r)*Math.sin(s+v*o),u.y=e*Math.cos(s+v*o),u.z=e*Math.sin(i+a*r)*Math.sin(s+v*o),p.push(u.x,u.y,u.z),h.copy(u).normalize(),g.push(h.x,h.y,h.z),f.push(a+y,1-v),d.push(l++)}c.push(d)}for(let m=0;m<n;m++)for(let e=0;e<t;e++){const t=c[m][e+1],i=c[m][e],r=c[m+1][e],o=c[m+1][e+1];(0!==m||s>0)&&d.push(t,i,o),(m!==n-1||a<Math.PI)&&d.push(i,r,o)}this.setIndex(d),this.setAttribute("position",new WC(p,3)),this.setAttribute("normal",new WC(g,3)),this.setAttribute("uv",new WC(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Kx(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class $x extends Ib{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new $x(e.radius,e.detail)}}class Zx extends JC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:48,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},n=Math.floor(n),i=Math.floor(i);const s=[],o=[],a=[],l=[],c=new ey,u=new ey,h=new ey;for(let d=0;d<=n;d++)for(let s=0;s<=i;s++){const p=s/i*r,g=d/n*Math.PI*2;u.x=(e+t*Math.cos(g))*Math.cos(p),u.y=(e+t*Math.cos(g))*Math.sin(p),u.z=t*Math.sin(g),o.push(u.x,u.y,u.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),h.subVectors(u,c).normalize(),a.push(h.x,h.y,h.z),l.push(s/i),l.push(d/n)}for(let d=1;d<=n;d++)for(let e=1;e<=i;e++){const t=(i+1)*d+e-1,n=(i+1)*(d-1)+e-1,r=(i+1)*(d-1)+e,o=(i+1)*d+e;s.push(t,n,o),s.push(n,r,o)}this.setIndex(s),this.setAttribute("position",new WC(o,3)),this.setAttribute("normal",new WC(a,3)),this.setAttribute("uv",new WC(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Zx(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Yx extends JC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:s},n=Math.floor(n),i=Math.floor(i);const o=[],a=[],l=[],c=[],u=new ey,h=new ey,d=new ey,p=new ey,g=new ey,f=new ey,m=new ey;for(let y=0;y<=n;++y){const o=y/n*r*Math.PI*2;v(o,r,s,e,d),v(o+.01,r,s,e,p),f.subVectors(p,d),m.addVectors(p,d),g.crossVectors(f,m),m.crossVectors(g,f),g.normalize(),m.normalize();for(let e=0;e<=i;++e){const r=e/i*Math.PI*2,s=-t*Math.cos(r),o=t*Math.sin(r);u.x=d.x+(s*m.x+o*g.x),u.y=d.y+(s*m.y+o*g.y),u.z=d.z+(s*m.z+o*g.z),a.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(y/n),c.push(e/i)}}for(let y=1;y<=n;y++)for(let e=1;e<=i;e++){const t=(i+1)*(y-1)+(e-1),n=(i+1)*y+(e-1),r=(i+1)*y+e,s=(i+1)*(y-1)+e;o.push(t,n,s),o.push(n,r,s)}function v(e,t,n,i,r){const s=Math.cos(e),o=Math.sin(e),a=n/t*e,l=Math.cos(a);r.x=i*(2+l)*.5*s,r.y=i*(2+l)*o*.5,r.z=i*Math.sin(a)*.5}this.setIndex(o),this.setAttribute("position",new WC(a,3)),this.setAttribute("normal",new WC(l,3)),this.setAttribute("uv",new WC(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Yx(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Jx extends JC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new rx(new ey(-1,-1,0),new ey(-1,1,0),new ey(1,1,0)),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r};const s=e.computeFrenetFrames(t,r);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;const o=new ey,a=new ey,l=new xv;let c=new ey;const u=[],h=[],d=[],p=[];function g(r){c=e.getPointAt(r/t,c);const l=s.normals[r],d=s.binormals[r];for(let e=0;e<=i;e++){const t=e/i*Math.PI*2,r=Math.sin(t),s=-Math.cos(t);a.x=s*l.x+r*d.x,a.y=s*l.y+r*d.y,a.z=s*l.z+r*d.z,a.normalize(),h.push(a.x,a.y,a.z),o.x=c.x+n*a.x,o.y=c.y+n*a.y,o.z=c.z+n*a.z,u.push(o.x,o.y,o.z)}}!function(){for(let e=0;e<t;e++)g(e);g(!1===r?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=i;n++)l.x=e/t,l.y=n/i,d.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=i;t++){const n=(i+1)*(e-1)+(t-1),r=(i+1)*e+(t-1),s=(i+1)*e+t,o=(i+1)*(e-1)+t;p.push(n,r,o),p.push(r,s,o)}}()}(),this.setIndex(p),this.setAttribute("position",new WC(u,3)),this.setAttribute("normal",new WC(h,3)),this.setAttribute("uv",new WC(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Jx((new ox[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Qx extends JC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,i=new ey,r=new ey;if(null!==e.index){const s=e.attributes.position,o=e.index;let a=e.groups;0===a.length&&(a=[{start:0,count:o.count,materialIndex:0}]);for(let e=0,l=a.length;e<l;++e){const l=a[e],c=l.start;for(let e=c,a=c+l.count;e<a;e+=3)for(let l=0;l<3;l++){const a=o.getX(e+l),c=o.getX(e+(l+1)%3);i.fromBufferAttribute(s,a),r.fromBufferAttribute(s,c),!0===e_(i,r,n)&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}}else{const s=e.attributes.position;for(let e=0,o=s.count/3;e<o;e++)for(let a=0;a<3;a++){const o=3*e+a,l=3*e+(a+1)%3;i.fromBufferAttribute(s,o),r.fromBufferAttribute(s,l),!0===e_(i,r,n)&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new WC(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function e_(e,t,n){const i=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`,r=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`;return!0!==n.has(i)&&!0!==n.has(r)&&(n.add(i),n.add(r),!0)}var t_=Object.freeze({__proto__:null,BoxGeometry:dw,CapsuleGeometry:Ab,CircleGeometry:Fb,ConeGeometry:Lb,CylinderGeometry:Db,DodecahedronGeometry:kb,EdgesGeometry:Hb,ExtrudeGeometry:Hx,IcosahedronGeometry:Ux,LatheGeometry:Vx,OctahedronGeometry:Wx,PlaneGeometry:jx,PolyhedronGeometry:Ib,RingGeometry:qx,ShapeGeometry:Xx,SphereGeometry:Kx,TetrahedronGeometry:$x,TorusGeometry:Zx,TorusKnotGeometry:Yx,TubeGeometry:Jx,WireframeGeometry:Qx});class n_ extends MC{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new bC(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class i_ extends vw{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class r_ extends MC{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new bC(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new bC(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ym,this.normalScale=new xv(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Hy,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class s_ extends r_{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new xv(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return vv(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new bC(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new bC(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new bC(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!==e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!==e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!==e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!==e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!==e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!==e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class o_ extends MC{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new bC(16777215),this.specular=new bC(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new bC(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ym,this.normalScale=new xv(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Hy,this.combine=wg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class a_ extends MC{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new bC(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new bC(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ym,this.normalScale=new xv(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class l_ extends MC{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ym,this.normalScale=new xv(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class c_ extends MC{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new bC(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new bC(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ym,this.normalScale=new xv(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Hy,this.combine=wg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class u_ extends MC{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=gm,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class h_ extends MC{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class d_ extends MC{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new bC(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ym,this.normalScale=new xv(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class p_ extends eb{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function g_(e,t){return e&&e.constructor!==t?"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e}function f_(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function m_(e){const t=e.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort((function(t,n){return e[t]-e[n]})),n}function v_(e,t,n){const i=e.length,r=new e.constructor(i);for(let s=0,o=0;o!==i;++s){const i=n[s]*t;for(let n=0;n!==t;++n)r[o++]=e[i+n]}return r}function y_(e,t,n,i){let r=1,s=e[0];for(;void 0!==s&&void 0===s[i];)s=e[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(t.push(s.time),n.push(...o)),s=e[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(t.push(s.time),o.toArray(n,n.length)),s=e[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(t.push(s.time),n.push(o)),s=e[r++]}while(void 0!==s)}class C_{static convertArray(e,t){return g_(e,t)}static isTypedArray(e){return f_(e)}static getKeyframeOrder(e){return m_(e)}static sortedArray(e,t,n){return v_(e,t,n)}static flattenJSON(e,t,n,i){y_(e,t,n,i)}static subclip(e,t,n,i){return function(e,t,n,i){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30;const s=e.clone();s.name=t;const o=[];for(let l=0;l<s.tracks.length;++l){const e=s.tracks[l],t=e.getValueSize(),a=[],c=[];for(let s=0;s<e.times.length;++s){const o=e.times[s]*r;if(!(o<n||o>=i)){a.push(e.times[s]);for(let n=0;n<t;++n)c.push(e.values[s*t+n])}}0!==a.length&&(e.times=g_(a,e.times.constructor),e.values=g_(c,e.values.constructor),o.push(e))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}(e,t,n,i,arguments.length>4&&void 0!==arguments[4]?arguments[4]:30)}static makeClipAdditive(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;i<=0&&(i=30);const r=n.tracks.length,s=t/i;for(let o=0;o<r;++o){const t=n.tracks[o],i=t.ValueTypeName;if("bool"===i||"string"===i)continue;const r=e.tracks.find((function(e){return e.name===t.name&&e.ValueTypeName===i}));if(void 0===r)continue;let a=0;const l=t.getValueSize();t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=l/3);let c=0;const u=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=t.times.length-1;let d;if(s<=t.times[0]){const e=a,n=l-a;d=t.values.slice(e,n)}else if(s>=t.times[h]){const e=h*l+a,n=e+l-a;d=t.values.slice(e,n)}else{const e=t.createInterpolant(),n=a,i=l-a;e.evaluate(s),d=e.resultBuffer.slice(n,i)}"quaternion"===i&&(new Qv).fromArray(d).normalize().conjugate().toArray(d);const p=r.times.length;for(let e=0;e<p;++e){const t=e*u+c;if("quaternion"===i)Qv.multiplyQuaternionsFlat(r.values,t,d,0,r.values,t);else{const e=u-2*c;for(let n=0;n<e;++n)r.values[t+n]-=d[n]}}}return e.blendMode=um,e}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,arguments.length>3&&void 0!==arguments[3]?arguments[3]:30)}}class w_{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{let s;n:{i:if(!(e<i)){for(let s=n+2;;){if(void 0===i){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===s)break;if(r=i,i=t[++n],e<i)break t}s=t.length;break n}if(e>=r)break e;{const o=t[1];e<o&&(n=2,r=o);for(let s=n-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(n===s)break;if(i=r,r=t[--n-1],e>=r)break t}s=n,n=0}}for(;n<s;){const i=n+s>>>1;e<t[i]?s=i:n=i+1}if(i=t[n],r=t[n-1],void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i;for(let s=0;s!==i;++s)t[s]=n[r+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class S_ extends w_{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:om,endingEnd:om}}intervalChanged_(e,t,n){const i=this.parameterPositions;let r=e-2,s=e+1,o=i[r],a=i[s];if(void 0===o)switch(this.getSettings_().endingStart){case am:r=e,o=2*t-n;break;case lm:r=i.length-2,o=t+i[r]-i[r+1];break;default:r=e,o=n}if(void 0===a)switch(this.getSettings_().endingEnd){case am:s=e,a=2*n-t;break;case lm:s=1,a=n+i[1]-i[0];break;default:s=e-1,a=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(a-n),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-t)/(i-t),g=p*p,f=g*p,m=-h*f+2*h*g-h*p,v=(1+h)*f+(-1.5-2*h)*g+(-.5+h)*p+1,y=(-1-d)*f+(1.5+d)*g+.5*p,C=d*f-d*g;for(let w=0;w!==o;++w)r[w]=m*s[c+w]+v*s[l+w]+y*s[a+w]+C*s[u+w];return r}}class b_ extends w_{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=(n-t)/(i-t),u=1-c;for(let h=0;h!==o;++h)r[h]=s[l+h]*u+s[a+h]*c;return r}}class x_ extends w_{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class __{constructor(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=g_(t,this.TimeBufferType),this.values=g_(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:g_(e.times,Array),values:g_(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new x_(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new b_(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new S_(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case im:t=this.InterpolantFactoryMethodDiscrete;break;case rm:t=this.InterpolantFactoryMethodLinear;break;case sm:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return im;case this.InterpolantFactoryMethodLinear:return rm;case this.InterpolantFactoryMethodSmooth:return sm}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let r=0,s=i-1;for(;r!==i&&n[r]<e;)++r;for(;-1!==s&&n[s]>t;)--s;if(++s,0!==r||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);const e=this.getValueSize();this.times=n.slice(r,s),this.values=this.values.slice(r*e,s*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let o=0;o!==r;o++){const t=n[o];if("number"===typeof t&&isNaN(t)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,t),e=!1;break}if(null!==s&&s>t){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,t,s),e=!1;break}s=t}if(void 0!==i&&f_(i))for(let o=0,a=i.length;o!==a;++o){const t=i[o];if(isNaN(t)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,t),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===sm,r=e.length-1;let s=1;for(let o=1;o<r;++o){let r=!1;const a=e[o];if(a!==e[o+1]&&(1!==o||a!==e[0]))if(i)r=!0;else{const e=o*n,i=e-n,s=e+n;for(let o=0;o!==n;++o){const n=t[e+o];if(n!==t[i+o]||n!==t[s+o]){r=!0;break}}}if(r){if(o!==s){e[s]=e[o];const i=o*n,r=s*n;for(let e=0;e!==n;++e)t[r+e]=t[i+e]}++s}}if(r>0){e[s]=e[r];for(let e=r*n,i=s*n,o=0;o!==n;++o)t[i+o]=t[e+o];++s}return s!==e.length?(this.times=e.slice(0,s),this.values=t.slice(0,s*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}__.prototype.ValueTypeName="",__.prototype.TimeBufferType=Float32Array,__.prototype.ValueBufferType=Float32Array,__.prototype.DefaultInterpolation=rm;class M_ extends __{constructor(e,t,n){super(e,t,n)}}M_.prototype.ValueTypeName="bool",M_.prototype.ValueBufferType=Array,M_.prototype.DefaultInterpolation=im,M_.prototype.InterpolantFactoryMethodLinear=void 0,M_.prototype.InterpolantFactoryMethodSmooth=void 0;class E_ extends __{constructor(e,t,n,i){super(e,t,n,i)}}E_.prototype.ValueTypeName="color";class R_ extends __{constructor(e,t,n,i){super(e,t,n,i)}}R_.prototype.ValueTypeName="number";class T_ extends w_{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(n-t)/(i-t);let l=e*o;for(let c=l+o;l!==c;l+=4)Qv.slerpFlat(r,0,s,l-o,s,l,a);return r}}class P_ extends __{constructor(e,t,n,i){super(e,t,n,i)}InterpolantFactoryMethodLinear(e){return new T_(this.times,this.values,this.getValueSize(),e)}}P_.prototype.ValueTypeName="quaternion",P_.prototype.InterpolantFactoryMethodSmooth=void 0;class A_ extends __{constructor(e,t,n){super(e,t,n)}}A_.prototype.ValueTypeName="string",A_.prototype.ValueBufferType=Array,A_.prototype.DefaultInterpolation=im,A_.prototype.InterpolantFactoryMethodLinear=void 0,A_.prototype.InterpolantFactoryMethodSmooth=void 0;class F_ extends __{constructor(e,t,n,i){super(e,t,n,i)}}F_.prototype.ValueTypeName="vector";class D_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:cm;this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=mv(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let s=0,o=n.length;s!==o;++s)t.push(L_(n[s]).scale(i));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,s=n.length;r!==s;++r)t.push(__.toJSON(n[r]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const r=t.length,s=[];for(let o=0;o<r;o++){let e=[],a=[];e.push((o+r-1)%r,o,(o+1)%r),a.push(0,1,0);const l=m_(e);e=v_(e,1,l),a=v_(a,1,l),i||0!==e[0]||(e.push(r),a.push(a[0])),s.push(new R_(".morphTargetInfluences["+t[o].name+"]",e,a).scale(1/n))}return new this(e,-1,s)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},r=/^([\w-]*?)([\d]+)$/;for(let o=0,a=e.length;o<a;o++){const t=e[o],n=t.name.match(r);if(n&&n.length>1){const e=n[1];let r=i[e];r||(i[e]=r=[]),r.push(t)}}const s=[];for(const o in i)s.push(this.CreateFromMorphTargetSequence(o,i[o],t,n));return s}static parseAnimation(e,t){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(e,t,n,i,r){if(0!==n.length){const s=[],o=[];y_(n,s,o,i),0!==s.length&&r.push(new e(t,s,o))}},i=[],r=e.name||"default",s=e.fps||30,o=e.blendMode;let a=e.length||-1;const l=e.hierarchy||[];for(let c=0;c<l.length;c++){const e=l[c].keys;if(e&&0!==e.length)if(e[0].morphTargets){const t={};let n;for(n=0;n<e.length;n++)if(e[n].morphTargets)for(let i=0;i<e[n].morphTargets.length;i++)t[e[n].morphTargets[i]]=-1;for(const r in t){const t=[],s=[];for(let i=0;i!==e[n].morphTargets.length;++i){const i=e[n];t.push(i.time),s.push(i.morphTarget===r?1:0)}i.push(new R_(".morphTargetInfluence["+r+"]",t,s))}a=t.length*s}else{const r=".bones["+t[c].name+"]";n(F_,r+".position",e,"pos",i),n(P_,r+".quaternion",e,"rot",i),n(F_,r+".scale",e,"scl",i)}}if(0===i.length)return null;return new this(r,a,i,o)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function L_(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return R_;case"vector":case"vector2":case"vector3":case"vector4":return F_;case"color":return E_;case"quaternion":return P_;case"bool":case"boolean":return M_;case"string":return A_}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];y_(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const I_={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class k_{constructor(e,t,n){const i=this;let r,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===s&&void 0!==i.onStart&&i.onStart(e,o,a),s=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,a),o===a&&(s=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return r?r(e):e},this.setURLModifier=function(e){return r=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],i=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return i}return null}}}const O_=new k_;class N_{constructor(e){this.manager=void 0!==e?e:O_,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(i,r){n.load(e,i,t,r)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}N_.DEFAULT_MATERIAL_NAME="__DEFAULT";const B_={};class z_ extends Error{constructor(e,t){super(e),this.response=t}}class H_ extends N_{constructor(e){super(e),this.mimeType="",this.responseType=""}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=I_.get(e);if(void 0!==r)return this.manager.itemStart(e),setTimeout((()=>{t&&t(r),this.manager.itemEnd(e)}),0),r;if(void 0!==B_[e])return void B_[e].push({onLoad:t,onProgress:n,onError:i});B_[e]=[],B_[e].push({onLoad:t,onProgress:n,onError:i});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then((t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"===typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const n=B_[e],i=t.body.getReader(),r=t.headers.get("X-File-Size")||t.headers.get("Content-Length"),s=r?parseInt(r):0,o=0!==s;let a=0;const l=new ReadableStream({start(e){!function t(){i.read().then((i=>{let{done:r,value:l}=i;if(r)e.close();else{a+=l.byteLength;const i=new ProgressEvent("progress",{lengthComputable:o,loaded:a,total:s});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(i)}e.enqueue(l),t()}}),(t=>{e.error(t)}))}()}});return new Response(l)}throw new z_(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`,t)})).then((e=>{switch(a){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,o)));case"json":return e.json();default:if(""===o)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(o),n=t&&t[1]?t[1].toLowerCase():void 0,i=new TextDecoder(n);return e.arrayBuffer().then((e=>i.decode(e)))}}})).then((t=>{I_.add(e,t);const n=B_[e];delete B_[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onLoad&&i.onLoad(t)}})).catch((t=>{const n=B_[e];if(void 0===n)throw this.manager.itemError(e),t;delete B_[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onError&&i.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class G_ extends N_{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new H_(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(zD){i?i(zD):console.error(zD),r.manager.itemError(e)}}),n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=D_.parse(e[n]);t.push(i)}return t}}class U_ extends N_{constructor(e){super(e)}load(e,t,n,i){const r=this,s=[],o=new _b,a=new H_(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(r.withCredentials);let l=0;function c(c){a.load(e[c],(function(e){const n=r.parse(e,!0);s[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(o.minFilter=Xg),o.image=s,o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,i)}if(Array.isArray(e))for(let u=0,h=e.length;u<h;++u)c(u);else a.load(e,(function(e){const n=r.parse(e,!0);if(n.isCubemap){const e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){s[t]={mipmaps:[]};for(let e=0;e<n.mipmapCount;e++)s[t].mipmaps.push(n.mipmaps[t*n.mipmapCount+e]),s[t].format=n.format,s[t].width=n.width,s[t].height=n.height}o.image=s}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=Xg),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,i);return o}}class V_ extends N_{constructor(e){super(e)}load(e,t,n,i){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,s=I_.get(e);if(void 0!==s)return r.manager.itemStart(e),setTimeout((function(){t&&t(s),r.manager.itemEnd(e)}),0),s;const o=Pv("img");function a(){c(),I_.add(e,this),t&&t(this),r.manager.itemEnd(e)}function l(t){c(),i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)}function c(){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",a,!1),o.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(e),o.src=e,o}}class W_ extends N_{constructor(e){super(e)}load(e,t,n,i){const r=new Mw;r.colorSpace=Sm;const s=new V_(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let o=0;function a(n){s.load(e[n],(function(e){r.images[n]=e,o++,6===o&&(r.needsUpdate=!0,t&&t(r))}),void 0,i)}for(let l=0;l<e.length;++l)a(l);return r}}class j_ extends N_{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new dS,o=new H_(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(r.withCredentials),o.load(e,(function(e){let n;try{n=r.parse(e)}catch(CF){if(void 0===i)return void console.error(CF);i(CF)}void 0!==n.image?s.image=n.image:void 0!==n.data&&(s.image.width=n.width,s.image.height=n.height,s.image.data=n.data),s.wrapS=void 0!==n.wrapS?n.wrapS:Hg,s.wrapT=void 0!==n.wrapT?n.wrapT:Hg,s.magFilter=void 0!==n.magFilter?n.magFilter:Xg,s.minFilter=void 0!==n.minFilter?n.minFilter:Xg,s.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.colorSpace&&(s.colorSpace=n.colorSpace),void 0!==n.flipY&&(s.flipY=n.flipY),void 0!==n.format&&(s.format=n.format),void 0!==n.type&&(s.type=n.type),void 0!==n.mipmaps&&(s.mipmaps=n.mipmaps,s.minFilter=Zg),1===n.mipmapCount&&(s.minFilter=Xg),void 0!==n.generateMipmaps&&(s.generateMipmaps=n.generateMipmaps),s.needsUpdate=!0,t&&t(s,n)}),n,i),s}}class q_ extends N_{constructor(e){super(e)}load(e,t,n,i){const r=new jv,s=new V_(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,(function(e){r.image=e,r.needsUpdate=!0,void 0!==t&&t(r)}),n,i),r}}class X_ extends iC{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.isLight=!0,this.type="Light",this.color=new bC(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}}class K_ extends X_{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(iC.DEFAULT_UP),this.updateMatrix(),this.groundColor=new bC(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const $_=new Ay,Z_=new ey,Y_=new ey;class J_{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new xv(512,512),this.mapType=Jg,this.map=null,this.mapPass=null,this.matrix=new Ay,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new FS,this._frameExtents=new xv(1,1),this._viewportCount=1,this._viewports=[new qv(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Z_.setFromMatrixPosition(e.matrixWorld),t.position.copy(Z_),Y_.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Y_),t.updateMatrixWorld(),$_.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix($_),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply($_)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Q_ extends J_{constructor(){super(new bw(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*fv*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;n===t.fov&&i===t.aspect&&r===t.far||(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class eM extends X_{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(iC.DEFAULT_UP),this.updateMatrix(),this.target=new iC,this.distance=n,this.angle=i,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new Q_}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const tM=new Ay,nM=new ey,iM=new ey;class rM extends J_{constructor(){super(new bw(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new xv(4,2),this._viewportCount=6,this._viewports=[new qv(2,1,1,1),new qv(0,1,1,1),new qv(3,1,1,1),new qv(1,1,1,1),new qv(3,0,1,1),new qv(1,0,1,1)],this._cubeDirections=[new ey(1,0,0),new ey(-1,0,0),new ey(0,0,1),new ey(0,0,-1),new ey(0,1,0),new ey(0,-1,0)],this._cubeUps=[new ey(0,1,0),new ey(0,1,0),new ey(0,1,0),new ey(0,1,0),new ey(0,0,1),new ey(0,0,-1)]}updateMatrices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.camera,i=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),nM.setFromMatrixPosition(e.matrixWorld),n.position.copy(nM),iM.copy(n.position),iM.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(iM),n.updateMatrixWorld(),i.makeTranslation(-nM.x,-nM.y,-nM.z),tM.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(tM)}}class sM extends X_{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new rM}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class oM extends yw{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-e,s=n+e,o=i+t,a=i-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=e*this.view.offsetX,s=r+e*this.view.width,o-=t*this.view.offsetY,a=o-t*this.view.height}this.projectionMatrix.makeOrthographic(r,s,o,a,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class aM extends J_{constructor(){super(new oM(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class lM extends X_{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(iC.DEFAULT_UP),this.updateMatrix(),this.target=new iC,this.shadow=new aM}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class cM extends X_{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class uM extends X_{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class hM{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ey)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,r=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.282095),t.addScaledVector(s[1],.488603*i),t.addScaledVector(s[2],.488603*r),t.addScaledVector(s[3],.488603*n),t.addScaledVector(s[4],n*i*1.092548),t.addScaledVector(s[5],i*r*1.092548),t.addScaledVector(s[6],.315392*(3*r*r-1)),t.addScaledVector(s[7],n*r*1.092548),t.addScaledVector(s[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,r=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.886227),t.addScaledVector(s[1],1.023328*i),t.addScaledVector(s[2],1.023328*r),t.addScaledVector(s[3],1.023328*n),t.addScaledVector(s[4],.858086*n*i),t.addScaledVector(s[5],.858086*i*r),t.addScaledVector(s[6],.743125*r*r-.247708),t.addScaledVector(s[7],.858086*n*r),t.addScaledVector(s[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+3*i);return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+3*i);return e}static getBasisAt(e,t){const n=e.x,i=e.y,r=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-i*i)}}class dM extends X_{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new hM;super(void 0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class pM extends N_{constructor(e){super(e),this.textures={}}load(e,t,n,i){const r=this,s=new H_(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(zD){i?i(zD):console.error(zD),r.manager.itemError(e)}}),n,i)}parse(e){const t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}const i=this.createMaterialFromType(e.type);if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&void 0!==i.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.sheen&&(i.sheen=e.sheen),void 0!==e.sheenColor&&(i.sheenColor=(new bC).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(i.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==i.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==i.specular&&i.specular.setHex(e.specular),void 0!==e.specularIntensity&&(i.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==i.specularColor&&i.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearcoat&&(i.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(i.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.dispersion&&(i.dispersion=e.dispersion),void 0!==e.iridescence&&(i.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(i.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(i.transmission=e.transmission),void 0!==e.thickness&&(i.thickness=e.thickness),void 0!==e.attenuationDistance&&(i.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==i.attenuationColor&&i.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(i.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(i.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.combine&&(i.combine=e.combine),void 0!==e.side&&(i.side=e.side),void 0!==e.shadowSide&&(i.shadowSide=e.shadowSide),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(i.alphaHash=e.alphaHash),void 0!==e.depthFunc&&(i.depthFunc=e.depthFunc),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.blendSrc&&(i.blendSrc=e.blendSrc),void 0!==e.blendDst&&(i.blendDst=e.blendDst),void 0!==e.blendEquation&&(i.blendEquation=e.blendEquation),void 0!==e.blendSrcAlpha&&(i.blendSrcAlpha=e.blendSrcAlpha),void 0!==e.blendDstAlpha&&(i.blendDstAlpha=e.blendDstAlpha),void 0!==e.blendEquationAlpha&&(i.blendEquationAlpha=e.blendEquationAlpha),void 0!==e.blendColor&&void 0!==i.blendColor&&i.blendColor.setHex(e.blendColor),void 0!==e.blendAlpha&&(i.blendAlpha=e.blendAlpha),void 0!==e.stencilWriteMask&&(i.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(i.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(i.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(i.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(i.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(i.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(i.stencilZPass=e.stencilZPass),void 0!==e.stencilWrite&&(i.stencilWrite=e.stencilWrite),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),void 0!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.alphaToCoverage&&(i.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(i.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(i.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.toneMapped&&(i.toneMapped=e.toneMapped),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.vertexColors&&("number"===typeof e.vertexColors?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const r in e.uniforms){const t=e.uniforms[r];switch(i.uniforms[r]={},t.type){case"t":i.uniforms[r].value=n(t.value);break;case"c":i.uniforms[r].value=(new bC).setHex(t.value);break;case"v2":i.uniforms[r].value=(new xv).fromArray(t.value);break;case"v3":i.uniforms[r].value=(new ey).fromArray(t.value);break;case"v4":i.uniforms[r].value=(new qv).fromArray(t.value);break;case"m3":i.uniforms[r].value=(new _v).fromArray(t.value);break;case"m4":i.uniforms[r].value=(new Ay).fromArray(t.value);break;default:i.uniforms[r].value=t.value}}if(void 0!==e.defines&&(i.defines=e.defines),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(i.glslVersion=e.glslVersion),void 0!==e.extensions)for(const r in e.extensions)i.extensions[r]=e.extensions[r];if(void 0!==e.lights&&(i.lights=e.lights),void 0!==e.clipping&&(i.clipping=e.clipping),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=n(e.map)),void 0!==e.matcap&&(i.matcap=n(e.matcap)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(i.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),i.normalScale=(new xv).fromArray(t)}return void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(i.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(i.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.envMapRotation&&i.envMapRotation.fromArray(e.envMapRotation),void 0!==e.envMapIntensity&&(i.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(i.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(i.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(i.clearcoatNormalScale=(new xv).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(i.iridescenceMap=n(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(i.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(i.thicknessMap=n(e.thicknessMap)),void 0!==e.anisotropyMap&&(i.anisotropyMap=n(e.anisotropyMap)),void 0!==e.sheenColorMap&&(i.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return pM.createMaterialFromType(e)}static createMaterialFromType(e){return new{ShadowMaterial:n_,SpriteMaterial:Ow,RawShaderMaterial:i_,ShaderMaterial:vw,PointsMaterial:gb,MeshPhysicalMaterial:s_,MeshStandardMaterial:r_,MeshPhongMaterial:o_,MeshToonMaterial:a_,MeshNormalMaterial:l_,MeshLambertMaterial:c_,MeshDepthMaterial:u_,MeshDistanceMaterial:h_,MeshBasicMaterial:EC,MeshMatcapMaterial:d_,LineDashedMaterial:p_,LineBasicMaterial:eb,Material:MC}[e]}}class gM{static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!==typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class fM extends JC{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class mM extends N_{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new H_(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,(function(n){try{t(r.parse(JSON.parse(n)))}catch(zD){i?i(zD):console.error(zD),r.manager.itemError(e)}}),n,i)}parse(e){const t={},n={};function i(e,i){if(void 0!==t[i])return t[i];const r=e.interleavedBuffers[i],s=function(e,t){if(void 0!==n[t])return n[t];const i=e.arrayBuffers,r=i[t],s=new Uint32Array(r).buffer;return n[t]=s,s}(e,r.buffer),o=Tv(r.type,s),a=new Lw(o,r.stride);return a.uuid=r.uuid,t[i]=a,a}const r=e.isInstancedBufferGeometry?new fM:new JC,s=e.data.index;if(void 0!==s){const e=Tv(s.type,s.array);r.setIndex(new kC(e,1))}const o=e.data.attributes;for(const u in o){const t=o[u];let n;if(t.isInterleavedBufferAttribute){const r=i(e.data,t.data);n=new kw(r,t.itemSize,t.offset,t.normalized)}else{const e=Tv(t.type,t.array);n=new(t.isInstancedBufferAttribute?mS:kC)(e,t.itemSize,t.normalized)}void 0!==t.name&&(n.name=t.name),void 0!==t.usage&&n.setUsage(t.usage),r.setAttribute(u,n)}const a=e.data.morphAttributes;if(a)for(const u in a){const t=a[u],n=[];for(let r=0,s=t.length;r<s;r++){const s=t[r];let o;if(s.isInterleavedBufferAttribute){const t=i(e.data,s.data);o=new kw(t,s.itemSize,s.offset,s.normalized)}else{const e=Tv(s.type,s.array);o=new kC(e,s.itemSize,s.normalized)}void 0!==s.name&&(o.name=s.name),n.push(o)}r.morphAttributes[u]=n}e.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let u=0,h=l.length;u!==h;++u){const e=l[u];r.addGroup(e.start,e.count,e.materialIndex)}const c=e.data.boundingSphere;if(void 0!==c){const e=new ey;void 0!==c.center&&e.fromArray(c.center),r.boundingSphere=new Sy(e,c.radius)}return e.name&&(r.name=e.name),e.userData&&(r.userData=e.userData),r}}class vM extends N_{constructor(e){super(e)}load(e,t,n,i){const r=this,s=""===this.path?gM.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const o=new H_(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){let s=null;try{s=JSON.parse(n)}catch(CF){return void 0!==i&&i(CF),void console.error("THREE:ObjectLoader: Can't parse "+e+".",CF.message)}const o=s.metadata;if(void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase())return void 0!==i&&i(new Error("THREE.ObjectLoader: Can't load "+e)),void console.error("THREE.ObjectLoader: Can't load "+e);r.parse(s,t)}),n,i)}async loadAsync(e,t){const n=""===this.path?gM.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const i=new H_(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);const r=await i.loadAsync(e,t),s=JSON.parse(r),o=s.metadata;if(void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(s)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=this.parseImages(e.images,(function(){void 0!==t&&t(l)})),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,r,a,o,n),c=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,c),this.bindLightTargets(l),void 0!==t){let e=!1;for(const t in s)if(s[t].data instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),r=await this.parseImagesAsync(e.images),s=this.parseTextures(e.textures,r),o=this.parseMaterials(e.materials,s),a=this.parseObject(e.object,i,o,s,t),l=this.parseSkeletons(e.skeletons,a);return this.bindSkeletons(a,l),this.bindLightTargets(a),a}parseShapes(e){const t={};if(void 0!==e)for(let n=0,i=e.length;n<i;n++){const i=(new cx).fromJSON(e[n]);t[i.uuid]=i}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse((function(e){e.isBone&&(i[e.uuid]=e)})),void 0!==e)for(let r=0,s=e.length;r<s;r++){const t=(new fS).fromJSON(e[r],i);n[t.uuid]=t}return n}parseGeometries(e,t){const n={};if(void 0!==e){const i=new mM;for(let r=0,s=e.length;r<s;r++){let s;const o=e[r];switch(o.type){case"BufferGeometry":case"InstancedBufferGeometry":s=i.parse(o);break;default:o.type in t_?s=t_[o.type].fromJSON(o,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${o.type}"`)}s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.userData&&(s.userData=o.userData),n[o.uuid]=s}}return n}parseMaterials(e,t){const n={},i={};if(void 0!==e){const r=new pM;r.setTextures(t);for(let t=0,s=e.length;t<s;t++){const s=e[t];void 0===n[s.uuid]&&(n[s.uuid]=r.parse(s)),i[s.uuid]=n[s.uuid]}}return i}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const i=e[n],r=D_.parse(i);t[r.uuid]=r}return t}parseImages(e,t){const n=this,i={};let r;function s(e){if("string"===typeof e){const t=e;return function(e){return n.manager.itemStart(e),r.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemError(e),n.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t)}return e.data?{data:Tv(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){const n=new k_(t);r=new V_(n),r.setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){const n=e[t],r=n.url;if(Array.isArray(r)){const e=[];for(let t=0,n=r.length;t<n;t++){const n=s(r[t]);null!==n&&(n instanceof HTMLImageElement?e.push(n):e.push(new dS(n.data,n.width,n.height)))}i[n.uuid]=new Uv(e)}else{const e=s(n.url);i[n.uuid]=new Uv(e)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function r(e){if("string"===typeof e){const n=e,r=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:t.resourcePath+n;return await i.loadAsync(r)}return e.data?{data:Tv(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){i=new V_(this.manager),i.setCrossOrigin(this.crossOrigin);for(let t=0,i=e.length;t<i;t++){const i=e[t],s=i.url;if(Array.isArray(s)){const e=[];for(let t=0,n=s.length;t<n;t++){const n=s[t],i=await r(n);null!==i&&(i instanceof HTMLImageElement?e.push(i):e.push(new dS(i.data,i.width,i.height)))}n[i.uuid]=new Uv(e)}else{const e=await r(i.url);n[i.uuid]=new Uv(e)}}}return n}parseTextures(e,t){function n(e,t){return"number"===typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const i={};if(void 0!==e)for(let r=0,s=e.length;r<s;r++){const s=e[r];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);const o=t[s.image],a=o.data;let l;Array.isArray(a)?(l=new Mw,6===a.length&&(l.needsUpdate=!0)):(l=a&&a.data?new dS:new jv,a&&(l.needsUpdate=!0)),l.source=o,l.uuid=s.uuid,void 0!==s.name&&(l.name=s.name),void 0!==s.mapping&&(l.mapping=n(s.mapping,yM)),void 0!==s.channel&&(l.channel=s.channel),void 0!==s.offset&&l.offset.fromArray(s.offset),void 0!==s.repeat&&l.repeat.fromArray(s.repeat),void 0!==s.center&&l.center.fromArray(s.center),void 0!==s.rotation&&(l.rotation=s.rotation),void 0!==s.wrap&&(l.wrapS=n(s.wrap[0],CM),l.wrapT=n(s.wrap[1],CM)),void 0!==s.format&&(l.format=s.format),void 0!==s.internalFormat&&(l.internalFormat=s.internalFormat),void 0!==s.type&&(l.type=s.type),void 0!==s.colorSpace&&(l.colorSpace=s.colorSpace),void 0!==s.minFilter&&(l.minFilter=n(s.minFilter,wM)),void 0!==s.magFilter&&(l.magFilter=n(s.magFilter,wM)),void 0!==s.anisotropy&&(l.anisotropy=s.anisotropy),void 0!==s.flipY&&(l.flipY=s.flipY),void 0!==s.generateMipmaps&&(l.generateMipmaps=s.generateMipmaps),void 0!==s.premultiplyAlpha&&(l.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(l.unpackAlignment=s.unpackAlignment),void 0!==s.compareFunction&&(l.compareFunction=s.compareFunction),void 0!==s.userData&&(l.userData=s.userData),i[s.uuid]=l}return i}parseObject(e,t,n,i,r){let s,o,a;function l(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function c(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let i=0,r=e.length;i<r;i++){const r=e[i];void 0===n[r]&&console.warn("THREE.ObjectLoader: Undefined material",r),t.push(n[r])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}function u(e){return void 0===i[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),i[e]}switch(e.type){case"Scene":s=new Dw,void 0!==e.background&&(Number.isInteger(e.background)?s.background=new bC(e.background):s.background=u(e.background)),void 0!==e.environment&&(s.environment=u(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?s.fog=new Fw(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(s.fog=new Aw(e.fog.color,e.fog.density)),""!==e.fog.name&&(s.fog.name=e.fog.name)),void 0!==e.backgroundBlurriness&&(s.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(s.backgroundIntensity=e.backgroundIntensity),void 0!==e.backgroundRotation&&s.backgroundRotation.fromArray(e.backgroundRotation),void 0!==e.environmentIntensity&&(s.environmentIntensity=e.environmentIntensity),void 0!==e.environmentRotation&&s.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":s=new bw(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(s.focus=e.focus),void 0!==e.zoom&&(s.zoom=e.zoom),void 0!==e.filmGauge&&(s.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(s.filmOffset=e.filmOffset),void 0!==e.view&&(s.view=Object.assign({},e.view));break;case"OrthographicCamera":s=new oM(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(s.zoom=e.zoom),void 0!==e.view&&(s.view=Object.assign({},e.view));break;case"AmbientLight":s=new cM(e.color,e.intensity);break;case"DirectionalLight":s=new lM(e.color,e.intensity),s.target=e.target||"";break;case"PointLight":s=new sM(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":s=new uM(e.color,e.intensity,e.width,e.height);break;case"SpotLight":s=new eM(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),s.target=e.target||"";break;case"HemisphereLight":s=new K_(e.color,e.groundColor,e.intensity);break;case"LightProbe":s=(new dM).fromJSON(e);break;case"SkinnedMesh":o=l(e.geometry),a=c(e.material),s=new uS(o,a),void 0!==e.bindMode&&(s.bindMode=e.bindMode),void 0!==e.bindMatrix&&s.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(s.skeleton=e.skeleton);break;case"Mesh":o=l(e.geometry),a=c(e.material),s=new uw(o,a);break;case"InstancedMesh":o=l(e.geometry),a=c(e.material);const t=e.count,n=e.instanceMatrix,i=e.instanceColor;s=new _S(o,a,t),s.instanceMatrix=new mS(new Float32Array(n.array),16),void 0!==i&&(s.instanceColor=new mS(new Float32Array(i.array),i.itemSize));break;case"BatchedMesh":o=l(e.geometry),a=c(e.material),s=new QS(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,a),s.geometry=o,s.perObjectFrustumCulled=e.perObjectFrustumCulled,s.sortObjects=e.sortObjects,s._drawRanges=e.drawRanges,s._reservedRanges=e.reservedRanges,s._geometryInfo=e.geometryInfo.map((e=>{let t=null,n=null;return void 0!==e.boundingBox&&(t=new iy,t.min.fromArray(e.boundingBox.min),t.max.fromArray(e.boundingBox.max)),void 0!==e.boundingSphere&&(n=new Sy,n.radius=e.boundingSphere.radius,n.center.fromArray(e.boundingSphere.center)),{...e,boundingBox:t,boundingSphere:n}})),s._instanceInfo=e.instanceInfo,s._availableInstanceIds=e._availableInstanceIds,s._availableGeometryIds=e._availableGeometryIds,s._nextIndexStart=e.nextIndexStart,s._nextVertexStart=e.nextVertexStart,s._geometryCount=e.geometryCount,s._maxInstanceCount=e.maxInstanceCount,s._maxVertexCount=e.maxVertexCount,s._maxIndexCount=e.maxIndexCount,s._geometryInitialized=e.geometryInitialized,s._matricesTexture=u(e.matricesTexture.uuid),s._indirectTexture=u(e.indirectTexture.uuid),void 0!==e.colorsTexture&&(s._colorsTexture=u(e.colorsTexture.uuid)),void 0!==e.boundingSphere&&(s.boundingSphere=new Sy,s.boundingSphere.center.fromArray(e.boundingSphere.center),s.boundingSphere.radius=e.boundingSphere.radius),void 0!==e.boundingBox&&(s.boundingBox=new iy,s.boundingBox.min.fromArray(e.boundingBox.min),s.boundingBox.max.fromArray(e.boundingBox.max));break;case"LOD":s=new eS;break;case"Line":s=new lb(l(e.geometry),c(e.material));break;case"LineLoop":s=new pb(l(e.geometry),c(e.material));break;case"LineSegments":s=new db(l(e.geometry),c(e.material));break;case"PointCloud":case"Points":s=new Cb(l(e.geometry),c(e.material));break;case"Sprite":s=new Zw(c(e.material));break;case"Group":s=new Rw;break;case"Bone":s=new hS;break;default:s=new iC}if(s.uuid=e.uuid,void 0!==e.name&&(s.name=e.name),void 0!==e.matrix?(s.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(s.matrixAutoUpdate=e.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(void 0!==e.position&&s.position.fromArray(e.position),void 0!==e.rotation&&s.rotation.fromArray(e.rotation),void 0!==e.quaternion&&s.quaternion.fromArray(e.quaternion),void 0!==e.scale&&s.scale.fromArray(e.scale)),void 0!==e.up&&s.up.fromArray(e.up),void 0!==e.castShadow&&(s.castShadow=e.castShadow),void 0!==e.receiveShadow&&(s.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.intensity&&(s.shadow.intensity=e.shadow.intensity),void 0!==e.shadow.bias&&(s.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(s.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(s.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&s.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(s.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(s.visible=e.visible),void 0!==e.frustumCulled&&(s.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(s.renderOrder=e.renderOrder),void 0!==e.userData&&(s.userData=e.userData),void 0!==e.layers&&(s.layers.mask=e.layers),void 0!==e.children){const o=e.children;for(let e=0;e<o.length;e++)s.add(this.parseObject(o[e],t,n,i,r))}if(void 0!==e.animations){const t=e.animations;for(let e=0;e<t.length;e++){const n=t[e];s.animations.push(r[n])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(s.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const n=t[e],i=s.getObjectByProperty("uuid",n.object);void 0!==i&&s.addLevel(i,n.distance,n.hysteresis)}}return s}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){const n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))}bindLightTargets(e){e.traverse((function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,i=e.getObjectByProperty("uuid",n);t.target=void 0!==i?i:new iC}}))}}const yM={UVMapping:Lg,CubeReflectionMapping:Ig,CubeRefractionMapping:kg,EquirectangularReflectionMapping:Og,EquirectangularRefractionMapping:Ng,CubeUVReflectionMapping:Bg},CM={RepeatWrapping:zg,ClampToEdgeWrapping:Hg,MirroredRepeatWrapping:Gg},wM={NearestFilter:Ug,NearestMipmapNearestFilter:Vg,NearestMipmapLinearFilter:jg,LinearFilter:Xg,LinearMipmapNearestFilter:Kg,LinearMipmapLinearFilter:Zg};class SM extends N_{constructor(e){super(e),this.isImageBitmapLoader=!0,"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,s=I_.get(e);if(void 0!==s)return r.manager.itemStart(e),s.then?void s.then((n=>{t&&t(n),r.manager.itemEnd(e)})).catch((e=>{i&&i(e)})):(setTimeout((function(){t&&t(s),r.manager.itemEnd(e)}),0),s);const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader;const a=fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(r.options,{colorSpaceConversion:"none"}))})).then((function(n){return I_.add(e,n),t&&t(n),r.manager.itemEnd(e),n})).catch((function(t){i&&i(t),I_.remove(e),r.manager.itemError(e),r.manager.itemEnd(e)}));I_.add(e,a),r.manager.itemStart(e)}}let bM;class xM{static getContext(){return void 0===bM&&(bM=new(window.AudioContext||window.webkitAudioContext)),bM}static setContext(e){bM=e}}class _M extends N_{constructor(e){super(e)}load(e,t,n,i){const r=this,s=new H_(this.manager);function o(t){i?i(t):console.error(t),r.manager.itemError(e)}s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(e){try{const n=e.slice(0);xM.getContext().decodeAudioData(n,(function(e){t(e)})).catch(o)}catch(zD){o(zD)}}),n,i)}}const MM=new Ay,EM=new Ay,RM=new Ay;class TM{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new bw,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new bw,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,RM.copy(e.projectionMatrix);const n=t.eyeSep/2,i=n*t.near/t.focus,r=t.near*Math.tan(gv*t.fov*.5)/t.zoom;let s,o;EM.elements[12]=-n,MM.elements[12]=n,s=-r*t.aspect+i,o=r*t.aspect+i,RM.elements[0]=2*t.near/(o-s),RM.elements[8]=(o+s)/(o-s),this.cameraL.projectionMatrix.copy(RM),s=-r*t.aspect-i,o=r*t.aspect-i,RM.elements[0]=2*t.near/(o-s),RM.elements[8]=(o+s)/(o-s),this.cameraR.projectionMatrix.copy(RM)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(EM),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(MM)}}class PM extends bw{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class AM{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=FM(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=FM();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function FM(){return performance.now()}const DM=new ey,LM=new Qv,IM=new ey,kM=new ey;class OM extends iC{constructor(){super(),this.type="AudioListener",this.context=xM.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new AM}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(DM,LM,IM),kM.set(0,0,-1).applyQuaternion(LM),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(DM.x,e),t.positionY.linearRampToValueAtTime(DM.y,e),t.positionZ.linearRampToValueAtTime(DM.z,e),t.forwardX.linearRampToValueAtTime(kM.x,e),t.forwardY.linearRampToValueAtTime(kM.y,e),t.forwardZ.linearRampToValueAtTime(kM.z,e),t.upX.linearRampToValueAtTime(n.x,e),t.upY.linearRampToValueAtTime(n.y,e),t.upZ.linearRampToValueAtTime(n.z,e)}else t.setPosition(DM.x,DM.y,DM.z),t.setOrientation(kM.x,kM.y,kM.z,n.x,n.y,n.z)}}class NM extends iC{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!1!==this.hasPlaybackControl)return this._progress=0,null!==this.source&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,!0===this.isPlaying&&void 0!==this.source.detune&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),"buffer"!==e.sourceType?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const BM=new ey,zM=new Qv,HM=new ey,GM=new ey;class UM extends NM{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(BM,zM,HM),GM.set(0,0,1).applyQuaternion(zM);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(BM.x,e),t.positionY.linearRampToValueAtTime(BM.y,e),t.positionZ.linearRampToValueAtTime(BM.z,e),t.orientationX.linearRampToValueAtTime(GM.x,e),t.orientationY.linearRampToValueAtTime(GM.y,e),t.orientationZ.linearRampToValueAtTime(GM.z,e)}else t.setPosition(BM.x,BM.y,BM.z),t.setOrientation(GM.x,GM.y,GM.z)}}class VM{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class WM{constructor(e,t,n){let i,r,s;switch(this.binding=e,this.valueSize=n,t){case"quaternion":i=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,r=e*i+i;let s=this.cumulativeWeight;if(0===s){for(let e=0;e!==i;++e)n[r+e]=n[e];s=t}else{s+=t;const e=t/s;this._mixBufferRegion(n,r,0,e,i)}this.cumulativeWeight=s}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const e=t*this._origIndex;this._mixBufferRegion(n,i,e,1-r,t)}s>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let a=t,l=t+t;a!==l;++a)if(n[a]!==n[a+t]){o.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let r=n,s=i;r!==s;++r)t[r]=t[i+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,r){if(i>=.5)for(let s=0;s!==r;++s)e[t+s]=e[n+s]}_slerp(e,t,n,i){Qv.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,r){const s=this._workIndex*r;Qv.multiplyQuaternionsFlat(e,s,e,t,e,n),Qv.slerpFlat(e,t,e,t,e,s,i)}_lerp(e,t,n,i,r){const s=1-i;for(let o=0;o!==r;++o){const r=t+o;e[r]=e[r]*s+e[n+o]*i}}_lerpAdditive(e,t,n,i,r){for(let s=0;s!==r;++s){const r=t+s;e[r]=e[r]+e[n+s]*i}}}const jM="\\[\\]\\.:\\/",qM=new RegExp("["+jM+"]","g"),XM="[^"+jM+"]",KM="[^"+jM.replace("\\.","")+"]",$M=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",XM)+/(WCOD+)?/.source.replace("WCOD",KM)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",XM)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",XM)+"$"),ZM=["material","materials","bones","map"];class YM{constructor(e,t,n){this.path=t,this.parsedPath=n||YM.parseTrackName(t),this.node=YM.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new YM.Composite(e,t,n):new YM(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(qM,"")}static parseTrackName(e){const t=$M.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const e=n.nodeName.substring(i+1);-1!==ZM.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let i=0;i<e.length;i++){const r=e[i];if(r.name===t||r.uuid===t)return r;const s=n(r.children);if(s)return s}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let r=t.propertyIndex;if(e||(e=YM.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(n){let i=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===i){i=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==i){if(void 0===e[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}const s=e[i];if(void 0===s){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+i+" but it wasn't found.",e)}let o=this.Versioning.None;this.targetObject=e,!0===e.isMaterial?o=this.Versioning.NeedsUpdate:!0===e.isObject3D&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[r]&&(r=e.morphTargetDictionary[r])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}YM.Composite=class{constructor(e,t,n){const i=n||YM.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},YM.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},YM.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},YM.prototype.GetterByBindingType=[YM.prototype._getValue_direct,YM.prototype._getValue_array,YM.prototype._getValue_arrayElement,YM.prototype._getValue_toArray],YM.prototype.SetterByBindingTypeAndVersioning=[[YM.prototype._setValue_direct,YM.prototype._setValue_direct_setNeedsUpdate,YM.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[YM.prototype._setValue_array,YM.prototype._setValue_array_setNeedsUpdate,YM.prototype._setValue_array_setMatrixWorldNeedsUpdate],[YM.prototype._setValue_arrayElement,YM.prototype._setValue_arrayElement_setNeedsUpdate,YM.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[YM.prototype._setValue_fromArray,YM.prototype._setValue_fromArray_setNeedsUpdate,YM.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class JM{constructor(){this.isAnimationObjectGroup=!0,this.uuid=mv(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,r=this._bindings,s=r.length;let o,a=e.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],h=u.uuid;let d=t[h];if(void 0===d){d=a++,t[h]=d,e.push(u);for(let e=0,t=s;e!==t;++e)r[e].push(new YM(u,n[e],i[e]))}else if(d<l){o=e[d];const a=--l,c=e[a];t[c.uuid]=d,e[d]=c,t[h]=a,e[a]=u;for(let e=0,t=s;e!==t;++e){const t=r[e],s=t[a];let o=t[d];t[d]=s,void 0===o&&(o=new YM(u,n[e],i[e])),t[a]=o}}else e[d]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_;for(let s=0,o=arguments.length;s!==o;++s){const o=arguments[s],a=o.uuid,l=t[a];if(void 0!==l&&l>=r){const s=r++,c=e[s];t[c.uuid]=l,e[l]=c,t[a]=s,e[s]=o;for(let e=0,t=i;e!==t;++e){const t=n[e],i=t[s],r=t[l];t[l]=i,t[s]=r}}}this.nCachedObjects_=r}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let r=this.nCachedObjects_,s=e.length;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o].uuid,l=t[a];if(void 0!==l)if(delete t[a],l<r){const o=--r,a=e[o],c=--s,u=e[c];t[a.uuid]=l,e[l]=a,t[u.uuid]=o,e[o]=u,e.pop();for(let e=0,t=i;e!==t;++e){const t=n[e],i=t[o],r=t[c];t[l]=i,t[o]=r,t.pop()}}else{const r=--s,o=e[r];r>0&&(t[o.uuid]=l),e[l]=o,e.pop();for(let e=0,t=i;e!==t;++e){const t=n[e];t[l]=t[r],t.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const r=this._bindings;if(void 0!==i)return r[i];const s=this._paths,o=this._parsedPaths,a=this._objects,l=a.length,c=this.nCachedObjects_,u=new Array(l);i=r.length,n[e]=i,s.push(e),o.push(t),r.push(u);for(let h=c,d=a.length;h!==d;++h){const n=a[h];u[h]=new YM(n,e,t)}return u}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length-1,a=s[o];t[e[o]]=n,s[n]=a,s.pop(),r[n]=r[o],r.pop(),i[n]=i[o],i.pop()}}}class QM{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.blendMode;this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const r=t.tracks,s=r.length,o=new Array(s),a={endingStart:om,endingEnd:om};for(let l=0;l!==s;++l){const e=r[l].createInterpolant(null);o[l]=e,e.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=tm,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.fadeOut(t),this.fadeIn(t),!0===n){const n=this._clip.duration,i=e._clip.duration,r=i/n,s=n/i;e.warp(1,r,t),this.warp(s,1,t)}return this}crossFadeTo(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,r=i.time,s=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=r,a[1]=r+n,l[0]=e/s,l[1]=t/s,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled)return void this._updateWeight(e);const r=this._startTime;if(null!==r){const i=(e-r)*n;i<0||0===n?t=0:(this._startTime=null,t=n*i)}t*=this._updateTimeScale(e);const s=this._updateTime(t),o=this._updateWeight(e);if(o>0){const e=this._interpolants,t=this._propertyBindings;if(this.blendMode===um)for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(s),t[n].accumulateAdditive(o);else for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(s),t[n].accumulate(i,o)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,r=this._loopCount;const s=n===nm;if(0===e)return-1===r?i:s&&1===(1&r)?t-i:i;if(n===em){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else{if(!(i<0)){this.time=i;break e}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===r&&(e>=0?(r=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),i>=t||i<0){const n=Math.floor(i/t);i-=t*n,r+=Math.abs(n);const o=this.repetitions-r;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===o){const t=e<0;this._setEndings(t,!t,s)}else this._setEndings(!1,!1,s);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=i;if(s&&1===(1&r))return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=am,i.endingEnd=am):(i.endingStart=e?this.zeroSlopeAtStart?am:om:lm,i.endingEnd=t?this.zeroSlopeAtEnd?am:om:lm)}_scheduleFading(e,t,n){const i=this._mixer,r=i.time;let s=this._weightInterpolant;null===s&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);const o=s.parameterPositions,a=s.sampleValues;return o[0]=r,a[0]=t,o[1]=r+e,a[1]=n,this}}const eE=new Float32Array(1);class tE extends hv{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,s=e._propertyBindings,o=e._interpolants,a=n.uuid,l=this._bindingsByRootAndName;let c=l[a];void 0===c&&(c={},l[a]=c);for(let u=0;u!==r;++u){const e=i[u],r=e.name;let l=c[r];if(void 0!==l)++l.referenceCount,s[u]=l;else{if(l=s[u],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,a,r));continue}const i=t&&t._propertyBindings[u].binding.parsedPath;l=new WM(YM.create(n,r,i),e.ValueTypeName,e.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,a,r),s[u]=l}o[u].resultBuffer=l.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,r=this._actionsByClip;let s=r[t];if(void 0===s)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=s;else{const t=s.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=i.length,i.push(e),s.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,s=this._actionsByClip,o=s[r],a=o.knownActions,l=a[a.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),e._byClipCacheIndex=null;delete o.actionByRoot[(e._localRoot||this._root).uuid],0===a.length&&delete s[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const e=t[n];0===--e.referenceCount&&this._removeInactiveBinding(e)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,r=this._bindings;let s=i[t];void 0===s&&(s={},i[t]=s),s[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,s=this._bindingsByRootAndName,o=s[i],a=t[t.length-1],l=e._cacheIndex;a._cacheIndex=l,t[l]=a,t.pop(),delete o[r],0===Object.keys(o).length&&delete s[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new b_(new Float32Array(2),new Float32Array(2),1,eE),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];e.__cacheIndex=i,t[i]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){const i=t||this._root,r=i.uuid;let s="string"===typeof e?D_.findByName(i,e):e;const o=null!==s?s.uuid:e,a=this._actionsByClip[o];let l=null;if(void 0===n&&(n=null!==s?s.blendMode:cm),void 0!==a){const e=a.actionByRoot[r];if(void 0!==e&&e.blendMode===n)return e;l=a.knownActions[0],null===s&&(s=l._clip)}if(null===s)return null;const c=new QM(this,s,t,n);return this._bindAction(c,l),this._addInactiveAction(c,o,r),c}existingAction(e,t){const n=t||this._root,i=n.uuid,r="string"===typeof e?D_.findByName(n,e):e,s=r?r.uuid:e,o=this._actionsByClip[s];return void 0!==o&&o.actionByRoot[i]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),s=this._accuIndex^=1;for(let l=0;l!==n;++l){t[l]._update(i,e,r,s)}const o=this._bindings,a=this._nActiveBindings;for(let l=0;l!==a;++l)o[l].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){const e=r.knownActions;for(let n=0,i=e.length;n!==i;++n){const i=e[n];this._deactivateAction(i);const r=i._cacheIndex,s=t[t.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,s._cacheIndex=r,t[r]=s,t.pop(),this._removeInactiveBindingsForAction(i)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const r in n){const e=n[r].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}const i=this._bindingsByRootAndName[t];if(void 0!==i)for(const r in i){const e=i[r];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class nE extends Xv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isRenderTarget3D=!0,this.depth=n,this.texture=new Yv(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class iE extends Xv{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),this.isRenderTargetArray=!0,this.depth=n,this.texture=new $v(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class rE{constructor(e){this.value=e}clone(){return new rE(void 0===this.value.clone?this.value:this.value.clone())}}let sE=0;class oE extends hv{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:sE++}),this.name="",this.usage=$m,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,i=t.length;n<i;n++){const e=Array.isArray(t[n])?t[n]:[t[n]];for(let t=0;t<e.length;t++)this.uniforms.push(e[t].clone())}return this}clone(){return(new this.constructor).copy(this)}}class aE extends Lw{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class lE{constructor(e,t,n,i,r){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=r,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const cE=new Ay;class uE{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new Py(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new Gy,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return cE.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(cE),this}intersectObject(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return dE(e,this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),t.sort(hE),t}intersectObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let i=0,r=e.length;i<r;i++)dE(e[i],this,n,t);return n.sort(hE),n}}function hE(e,t){return e.distance-t.distance}function dE(e,t,n,i){let r=!0;if(e.layers.test(t.layers)){!1===e.raycast(t,n)&&(r=!1)}if(!0===r&&!0===i){const i=e.children;for(let e=0,r=i.length;e<r;e++)dE(i[e],t,n,!0)}}class pE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=vv(this.phi,e,Math.PI-e),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(vv(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class gE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}}class fE{constructor(e,t,n,i){fE.prototype.isMatrix2=!0,this.elements=[1,0,0,1],void 0!==e&&this.set(e,t,n,i)}identity(){return this.set(1,0,0,1),this}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,i){const r=this.elements;return r[0]=e,r[2]=t,r[1]=n,r[3]=i,this}}const mE=new xv;class vE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new xv(1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new xv(-1/0,-1/0);this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=mE.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,mE).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const yE=new ey,CE=new ey;class wE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ey,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey;this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){yE.subVectors(e,this.start),CE.subVectors(this.end,this.start);const n=CE.dot(CE);let i=CE.dot(yE)/n;return t&&(i=vv(i,0,1)),i}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const SE=new ey;class bE extends iC{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new JC,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,o=1,a=32;s<a;s++,o++){const e=s/a*Math.PI*2,t=o/a*Math.PI*2;i.push(Math.cos(e),Math.sin(e),1,Math.cos(t),Math.sin(t),1)}n.setAttribute("position",new WC(i,3));const r=new eb({fog:!1,toneMapped:!1});this.cone=new db(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),SE.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(SE),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const xE=new ey,_E=new Ay,ME=new Ay;class EE extends db{constructor(e){const t=RE(e),n=new JC,i=[],r=[],s=new bC(0,0,1),o=new bC(0,1,0);for(let a=0;a<t.length;a++){const e=t[a];e.parent&&e.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(s.r,s.g,s.b),r.push(o.r,o.g,o.b))}n.setAttribute("position",new WC(i,3)),n.setAttribute("color",new WC(r,3));super(n,new eb({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");ME.copy(this.root.matrixWorld).invert();for(let r=0,s=0;r<t.length;r++){const e=t[r];e.parent&&e.parent.isBone&&(_E.multiplyMatrices(ME,e.matrixWorld),xE.setFromMatrixPosition(_E),i.setXYZ(s,xE.x,xE.y,xE.z),_E.multiplyMatrices(ME,e.parent.matrixWorld),xE.setFromMatrixPosition(_E),i.setXYZ(s+1,xE.x,xE.y,xE.z),s+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function RE(e){const t=[];!0===e.isBone&&t.push(e);for(let n=0;n<e.children.length;n++)t.push(...RE(e.children[n]));return t}class TE extends uw{constructor(e,t,n){super(new Kx(t,4,2),new EC({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const PE=new ey,AE=new bC,FE=new bC;class DE extends iC{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const i=new Wx(t);i.rotateY(.5*Math.PI),this.material=new EC({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const r=i.getAttribute("position"),s=new Float32Array(3*r.count);i.setAttribute("color",new kC(s,3)),this.add(new uw(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");AE.copy(this.light.color),FE.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){const i=e<n/2?AE:FE;t.setXYZ(e,i.r,i.g,i.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(PE.setFromMatrixPosition(this.light.matrixWorld).negate())}}class LE extends db{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;n=new bC(n),i=new bC(i);const r=t/2,s=e/t,o=e/2,a=[],l=[];for(let u=0,h=0,d=-o;u<=t;u++,d+=s){a.push(-o,0,d,o,0,d),a.push(d,0,-o,d,0,o);const e=u===r?n:i;e.toArray(l,h),h+=3,e.toArray(l,h),h+=3,e.toArray(l,h),h+=3,e.toArray(l,h),h+=3}const c=new JC;c.setAttribute("position",new WC(a,3)),c.setAttribute("color",new WC(l,3));super(c,new eb({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class IE extends db{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4473924,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8947848;r=new bC(r),s=new bC(s);const o=[],a=[];if(t>1)for(let c=0;c<t;c++){const n=c/t*(2*Math.PI),i=Math.sin(n)*e,l=Math.cos(n)*e;o.push(0,0,0),o.push(i,0,l);const u=1&c?r:s;a.push(u.r,u.g,u.b),a.push(u.r,u.g,u.b)}for(let c=0;c<n;c++){const t=1&c?r:s,l=e-e/n*c;for(let e=0;e<i;e++){let n=e/i*(2*Math.PI),r=Math.sin(n)*l,s=Math.cos(n)*l;o.push(r,0,s),a.push(t.r,t.g,t.b),n=(e+1)/i*(2*Math.PI),r=Math.sin(n)*l,s=Math.cos(n)*l,o.push(r,0,s),a.push(t.r,t.g,t.b)}}const l=new JC;l.setAttribute("position",new WC(o,3)),l.setAttribute("color",new WC(a,3));super(l,new eb({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const kE=new ey,OE=new ey,NE=new ey;class BE extends iC{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===t&&(t=1);let i=new JC;i.setAttribute("position",new WC([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new eb({fog:!1,toneMapped:!1});this.lightPlane=new lb(i,r),this.add(this.lightPlane),i=new JC,i.setAttribute("position",new WC([0,0,0,0,0,1],3)),this.targetLine=new lb(i,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),kE.setFromMatrixPosition(this.light.matrixWorld),OE.setFromMatrixPosition(this.light.target.matrixWorld),NE.subVectors(OE,kE),this.lightPlane.lookAt(OE),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(OE),this.targetLine.scale.z=NE.length()}}const zE=new ey,HE=new yw;class GE extends db{constructor(e){const t=new JC,n=new eb({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],s={};function o(e,t){a(e),a(t)}function a(e){i.push(0,0,0),r.push(0,0,0),void 0===s[e]&&(s[e]=[]),s[e].push(i.length/3-1)}o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4"),t.setAttribute("position",new WC(i,3)),t.setAttribute("color",new WC(r,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();const l=new bC(16755200),c=new bC(16711680),u=new bC(43775),h=new bC(16777215),d=new bC(3355443);this.setColors(l,c,u,h,d)}setColors(e,t,n,i,r){const s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,n.r,n.g,n.b),s.setXYZ(33,n.r,n.g,n.b),s.setXYZ(34,n.r,n.g,n.b),s.setXYZ(35,n.r,n.g,n.b),s.setXYZ(36,n.r,n.g,n.b),s.setXYZ(37,n.r,n.g,n.b),s.setXYZ(38,i.r,i.g,i.b),s.setXYZ(39,i.r,i.g,i.b),s.setXYZ(40,r.r,r.g,r.b),s.setXYZ(41,r.r,r.g,r.b),s.setXYZ(42,r.r,r.g,r.b),s.setXYZ(43,r.r,r.g,r.b),s.setXYZ(44,r.r,r.g,r.b),s.setXYZ(45,r.r,r.g,r.b),s.setXYZ(46,r.r,r.g,r.b),s.setXYZ(47,r.r,r.g,r.b),s.setXYZ(48,r.r,r.g,r.b),s.setXYZ(49,r.r,r.g,r.b),s.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap;HE.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const n=this.camera.coordinateSystem===ov?-1:0;UE("c",t,e,HE,0,0,n),UE("t",t,e,HE,0,0,1),UE("n1",t,e,HE,-1,-1,n),UE("n2",t,e,HE,1,-1,n),UE("n3",t,e,HE,-1,1,n),UE("n4",t,e,HE,1,1,n),UE("f1",t,e,HE,-1,-1,1),UE("f2",t,e,HE,1,-1,1),UE("f3",t,e,HE,-1,1,1),UE("f4",t,e,HE,1,1,1),UE("u1",t,e,HE,.7,1.1,n),UE("u2",t,e,HE,-.7,1.1,n),UE("u3",t,e,HE,0,2,n),UE("cf1",t,e,HE,-1,0,1),UE("cf2",t,e,HE,1,0,1),UE("cf3",t,e,HE,0,-1,1),UE("cf4",t,e,HE,0,1,1),UE("cn1",t,e,HE,-1,0,n),UE("cn2",t,e,HE,1,0,n),UE("cn3",t,e,HE,0,-1,n),UE("cn4",t,e,HE,0,1,n),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function UE(e,t,n,i,r,s,o){zE.set(r,s,o).unproject(i);const a=t[e];if(void 0!==a){const e=n.getAttribute("position");for(let t=0,n=a.length;t<n;t++)e.setXYZ(a[t],zE.x,zE.y,zE.z)}}const VE=new iy;class WE extends db{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),r=new JC;r.setIndex(new kC(n,1)),r.setAttribute("position",new kC(i,3)),super(r,new eb({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(void 0!==this.object&&VE.setFromObject(this.object),VE.isEmpty())return;const e=VE.min,t=VE.max,n=this.geometry.attributes.position,i=n.array;i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=e.x,i[4]=t.y,i[5]=t.z,i[6]=e.x,i[7]=e.y,i[8]=t.z,i[9]=t.x,i[10]=e.y,i[11]=t.z,i[12]=t.x,i[13]=t.y,i[14]=e.z,i[15]=e.x,i[16]=t.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=t.x,i[22]=e.y,i[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class jE extends db{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new JC;i.setIndex(new kC(n,1)),i.setAttribute("position",new WC([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(i,new eb({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class qE extends lb{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16776960,i=new JC;i.setAttribute("position",new WC([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),i.computeBoundingSphere(),super(i,new eb({color:n,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const r=new JC;r.setAttribute("position",new WC([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),r.computeBoundingSphere(),this.add(new uw(r,new EC({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const XE=new ey;let KE,$E;class ZE extends iC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ey(0,0,1),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ey(0,0,0),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16776960,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2*n,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2*r;super(),this.type="ArrowHelper",void 0===KE&&(KE=new JC,KE.setAttribute("position",new WC([0,0,0,0,1,0],3)),$E=new Lb(.5,1,5,1),$E.translate(0,-.5,0)),this.position.copy(t),this.line=new lb(KE,new eb({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new uw($E,new EC({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,s)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{XE.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(XE,t)}}setLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class YE extends db{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new JC;n.setAttribute("position",new WC(t,3)),n.setAttribute("color",new WC([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new eb({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const i=new bC,r=this.geometry.attributes.color.array;return i.set(e),i.toArray(r,0),i.toArray(r,3),i.set(t),i.toArray(r,6),i.toArray(r,9),i.set(n),i.toArray(r,12),i.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class JE{constructor(){this.type="ShapePath",this.color=new bC,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new lx,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,r,s){return this.currentPath.bezierCurveTo(e,t,n,i,r,s),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(e,t){const n=t.length;let i=!1;for(let r=n-1,s=0;s<n;r=s++){let n=t[r],o=t[s],a=o.x-n.x,l=o.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=t[s],a=-a,o=t[r],l=-l),e.y<n.y||e.y>o.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{const t=l*(e.x-n.x)-a*(e.y-n.y);if(0===t)return!0;if(t<0)continue;i=!i}}else{if(e.y!==n.y)continue;if(o.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=o.x)return!0}}return i}const n=Nx.isClockWise,i=this.subPaths;if(0===i.length)return[];let r,s,o;const a=[];if(1===i.length)return s=i[0],o=new cx,o.curves=s.curves,a.push(o),a;let l=!n(i[0].getPoints());l=e?!l:l;const c=[],u=[];let h,d,p=[],g=0;u[g]=void 0,p[g]=[];for(let f=0,m=i.length;f<m;f++)s=i[f],h=s.getPoints(),r=n(h),r=e?!r:r,r?(!l&&u[g]&&g++,u[g]={s:new cx,p:h},u[g].s.curves=s.curves,l&&g++,p[g]=[]):p[g].push({h:s,p:h[0]});if(!u[0])return function(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n],r=new cx;r.curves=i.curves,t.push(r)}return t}(i);if(u.length>1){let e=!1,n=0;for(let t=0,i=u.length;t<i;t++)c[t]=[];for(let i=0,r=u.length;i<r;i++){const r=p[i];for(let s=0;s<r.length;s++){const o=r[s];let a=!0;for(let r=0;r<u.length;r++)t(o.p,u[r].p)&&(i!==r&&n++,a?(a=!1,c[r].push(o)):e=!0);a&&c[i].push(o)}}n>0&&!1===e&&(p=c)}for(let f=0,m=u.length;f<m;f++){o=u[f].s,a.push(o),d=p[f];for(let e=0,t=d.length;e<t;e++)o.holes.push(d[e].h)}return a}}class QE extends hv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){void 0!==e?(null!==this.domElement&&this.disconnect(),this.domElement=e):console.warn("THREE.Controls: connect() now requires an element.")}disconnect(){}dispose(){}update(){}}function eR(e,t,n,i){const r=function(e){switch(e){case Jg:case Qg:return{byteLength:1,components:1};case tf:case ef:case of:return{byteLength:2,components:1};case af:case lf:return{byteLength:2,components:4};case rf:case nf:case sf:return{byteLength:4,components:1};case uf:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${e}.`)}(i);switch(n){case hf:return e*t;case mf:case vf:return e*t/r.components*r.byteLength;case yf:case Cf:return e*t*2/r.components*r.byteLength;case df:return e*t*3/r.components*r.byteLength;case pf:case Sf:return e*t*4/r.components*r.byteLength;case bf:case xf:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case _f:case Mf:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case Rf:case Pf:return Math.max(e,16)*Math.max(t,8)/4;case Ef:case Tf:return Math.max(e,8)*Math.max(t,8)/2;case Af:case Ff:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case Df:case Lf:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case If:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case kf:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case Of:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case Nf:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case Bf:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case zf:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case Hf:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case Gf:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case Uf:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case Vf:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case Wf:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case jf:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case qf:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case Xf:case Kf:case $f:return Math.ceil(e/4)*Math.ceil(t/4)*16;case Zf:case Yf:return Math.ceil(e/4)*Math.ceil(t/4)*8;case Jf:case Qf:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}class tR{static contain(e,t){return function(e,t){const n=e.image&&e.image.width?e.image.width/e.image.height:1;return n>t?(e.repeat.x=1,e.repeat.y=n/t,e.offset.x=0,e.offset.y=(1-e.repeat.y)/2):(e.repeat.x=t/n,e.repeat.y=1,e.offset.x=(1-e.repeat.x)/2,e.offset.y=0),e}(e,t)}static cover(e,t){return function(e,t){const n=e.image&&e.image.width?e.image.width/e.image.height:1;return n>t?(e.repeat.x=t/n,e.repeat.y=1,e.offset.x=(1-e.repeat.x)/2,e.offset.y=0):(e.repeat.x=1,e.repeat.y=n/t,e.offset.x=0,e.offset.y=(1-e.repeat.y)/2),e}(e,t)}static fill(e){return function(e){return e.repeat.x=1,e.repeat.y=1,e.offset.x=0,e.offset.y=0,e}(e)}static getByteLength(e,t,n,i){return eR(e,t,n,i)}}function nR(){let e=null,t=!1,n=null,i=null;function r(t,s){n(t,s),i=e.requestAnimationFrame(r)}return{start:function(){!0!==t&&null!==n&&(i=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function iR(e){const t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const i=t.get(n);i&&(e.deleteBuffer(i.buffer),t.delete(n))},update:function(n,i){if(n.isInterleavedBufferAttribute&&(n=n.data),n.isGLBufferAttribute){const e=t.get(n);return void((!e||e.version<n.version)&&t.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}const r=t.get(n);if(void 0===r)t.set(n,function(t,n){const i=t.array,r=t.usage,s=i.byteLength,o=e.createBuffer();let a;if(e.bindBuffer(n,o),e.bufferData(n,i,r),t.onUploadCallback(),i instanceof Float32Array)a=e.FLOAT;else if(i instanceof Uint16Array)a=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(i instanceof Int16Array)a=e.SHORT;else if(i instanceof Uint32Array)a=e.UNSIGNED_INT;else if(i instanceof Int32Array)a=e.INT;else if(i instanceof Int8Array)a=e.BYTE;else if(i instanceof Uint8Array)a=e.UNSIGNED_BYTE;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);a=e.UNSIGNED_BYTE}return{buffer:o,type:a,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version,size:s}}(n,i));else if(r.version<n.version){if(r.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,n,i){const r=n.array,s=n.updateRanges;if(e.bindBuffer(i,t),0===s.length)e.bufferSubData(i,0,r);else{s.sort(((e,t)=>e.start-t.start));let t=0;for(let e=1;e<s.length;e++){const n=s[t],i=s[e];i.start<=n.start+n.count+1?n.count=Math.max(n.count,i.start+i.count-n.start):(++t,s[t]=i)}s.length=t+1;for(let n=0,o=s.length;n<o;n++){const t=s[n];e.bufferSubData(i,t.start*r.BYTES_PER_ELEMENT,r,t.start,t.count)}n.clearUpdateRanges()}n.onUploadCallback()}(r.buffer,n,i),r.version=n.version}}}}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Ep}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Ep);const rR={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},sR={common:{diffuse:{value:new bC(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new _v},alphaMap:{value:null},alphaMapTransform:{value:new _v},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new _v}},envmap:{envMap:{value:null},envMapRotation:{value:new _v},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new _v}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new _v}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new _v},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new _v},normalScale:{value:new xv(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new _v},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new _v}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new _v}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new _v}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new bC(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new bC(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new _v},alphaTest:{value:0},uvTransform:{value:new _v}},sprite:{diffuse:{value:new bC(16777215)},opacity:{value:1},center:{value:new xv(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new _v},alphaMap:{value:null},alphaMapTransform:{value:new _v},alphaTest:{value:0}}},oR={basic:{uniforms:gw([sR.common,sR.specularmap,sR.envmap,sR.aomap,sR.lightmap,sR.fog]),vertexShader:rR.meshbasic_vert,fragmentShader:rR.meshbasic_frag},lambert:{uniforms:gw([sR.common,sR.specularmap,sR.envmap,sR.aomap,sR.lightmap,sR.emissivemap,sR.bumpmap,sR.normalmap,sR.displacementmap,sR.fog,sR.lights,{emissive:{value:new bC(0)}}]),vertexShader:rR.meshlambert_vert,fragmentShader:rR.meshlambert_frag},phong:{uniforms:gw([sR.common,sR.specularmap,sR.envmap,sR.aomap,sR.lightmap,sR.emissivemap,sR.bumpmap,sR.normalmap,sR.displacementmap,sR.fog,sR.lights,{emissive:{value:new bC(0)},specular:{value:new bC(1118481)},shininess:{value:30}}]),vertexShader:rR.meshphong_vert,fragmentShader:rR.meshphong_frag},standard:{uniforms:gw([sR.common,sR.envmap,sR.aomap,sR.lightmap,sR.emissivemap,sR.bumpmap,sR.normalmap,sR.displacementmap,sR.roughnessmap,sR.metalnessmap,sR.fog,sR.lights,{emissive:{value:new bC(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:rR.meshphysical_vert,fragmentShader:rR.meshphysical_frag},toon:{uniforms:gw([sR.common,sR.aomap,sR.lightmap,sR.emissivemap,sR.bumpmap,sR.normalmap,sR.displacementmap,sR.gradientmap,sR.fog,sR.lights,{emissive:{value:new bC(0)}}]),vertexShader:rR.meshtoon_vert,fragmentShader:rR.meshtoon_frag},matcap:{uniforms:gw([sR.common,sR.bumpmap,sR.normalmap,sR.displacementmap,sR.fog,{matcap:{value:null}}]),vertexShader:rR.meshmatcap_vert,fragmentShader:rR.meshmatcap_frag},points:{uniforms:gw([sR.points,sR.fog]),vertexShader:rR.points_vert,fragmentShader:rR.points_frag},dashed:{uniforms:gw([sR.common,sR.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:rR.linedashed_vert,fragmentShader:rR.linedashed_frag},depth:{uniforms:gw([sR.common,sR.displacementmap]),vertexShader:rR.depth_vert,fragmentShader:rR.depth_frag},normal:{uniforms:gw([sR.common,sR.bumpmap,sR.normalmap,sR.displacementmap,{opacity:{value:1}}]),vertexShader:rR.meshnormal_vert,fragmentShader:rR.meshnormal_frag},sprite:{uniforms:gw([sR.sprite,sR.fog]),vertexShader:rR.sprite_vert,fragmentShader:rR.sprite_frag},background:{uniforms:{uvTransform:{value:new _v},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:rR.background_vert,fragmentShader:rR.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new _v}},vertexShader:rR.backgroundCube_vert,fragmentShader:rR.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:rR.cube_vert,fragmentShader:rR.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:rR.equirect_vert,fragmentShader:rR.equirect_frag},distanceRGBA:{uniforms:gw([sR.common,sR.displacementmap,{referencePosition:{value:new ey},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:rR.distanceRGBA_vert,fragmentShader:rR.distanceRGBA_frag},shadow:{uniforms:gw([sR.lights,sR.fog,{color:{value:new bC(0)},opacity:{value:1}}]),vertexShader:rR.shadow_vert,fragmentShader:rR.shadow_frag}};oR.physical={uniforms:gw([oR.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new _v},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new _v},clearcoatNormalScale:{value:new xv(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new _v},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new _v},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new _v},sheen:{value:0},sheenColor:{value:new bC(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new _v},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new _v},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new _v},transmissionSamplerSize:{value:new xv},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new _v},attenuationDistance:{value:0},attenuationColor:{value:new bC(0)},specularColor:{value:new bC(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new _v},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new _v},anisotropyVector:{value:new xv},anisotropyMap:{value:null},anisotropyMapTransform:{value:new _v}}]),vertexShader:rR.meshphysical_vert,fragmentShader:rR.meshphysical_frag};const aR={r:0,b:0,g:0},lR=new Hy,cR=new Ay;function uR(e,t,n,i,r,s,o){const a=new bC(0);let l,c,u=!0===s?0:1,h=null,d=0,p=null;function g(e){let i=!0===e.isScene?e.background:null;if(i&&i.isTexture){i=(e.backgroundBlurriness>0?n:t).get(i)}return i}function f(t,n){t.getRGB(aR,fw(e)),i.buffers.color.setClear(aR.r,aR.g,aR.b,n,o)}return{getClearColor:function(){return a},setClearColor:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;a.set(e),u=t,f(a,u)},getClearAlpha:function(){return u},setClearAlpha:function(e){u=e,f(a,u)},render:function(t){let n=!1;const r=g(t);null===r?f(a,u):r&&r.isColor&&(f(r,1),n=!0);const s=e.xr.getEnvironmentBlendMode();"additive"===s?i.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===s&&i.buffers.color.setClear(0,0,0,0,o),(e.autoClear||n)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,n){const i=g(n);i&&(i.isCubeTexture||i.mapping===Bg)?(void 0===c&&(c=new uw(new dw(1,1,1),new vw({name:"BackgroundCubeMaterial",uniforms:pw(oR.backgroundCube.uniforms),vertexShader:oR.backgroundCube.vertexShader,fragmentShader:oR.backgroundCube.fragmentShader,side:Bp,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),lR.copy(n.backgroundRotation),lR.x*=-1,lR.y*=-1,lR.z*=-1,i.isCubeTexture&&!1===i.isRenderTargetTexture&&(lR.y*=-1,lR.z*=-1),c.material.uniforms.envMap.value=i,c.material.uniforms.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(cR.makeRotationFromEuler(lR)),c.material.toneMapped=Ov.getTransfer(i.colorSpace)!==_m,h===i&&d===i.version&&p===e.toneMapping||(c.material.needsUpdate=!0,h=i,d=i.version,p=e.toneMapping),c.layers.enableAll(),t.unshift(c,c.geometry,c.material,0,0,null)):i&&i.isTexture&&(void 0===l&&(l=new uw(new jx(2,2),new vw({name:"BackgroundMaterial",uniforms:pw(oR.background.uniforms),vertexShader:oR.background.vertexShader,fragmentShader:oR.background.fragmentShader,side:Np,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=i,l.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,l.material.toneMapped=Ov.getTransfer(i.colorSpace)!==_m,!0===i.matrixAutoUpdate&&i.updateMatrix(),l.material.uniforms.uvTransform.value.copy(i.matrix),h===i&&d===i.version&&p===e.toneMapping||(l.material.needsUpdate=!0,h=i,d=i.version,p=e.toneMapping),l.layers.enableAll(),t.unshift(l,l.geometry,l.material,0,0,null))},dispose:function(){void 0!==c&&(c.geometry.dispose(),c.material.dispose(),c=void 0),void 0!==l&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}}}function hR(e,t){const n=e.getParameter(e.MAX_VERTEX_ATTRIBS),i={},r=c(null);let s=r,o=!1;function a(t){return e.bindVertexArray(t)}function l(t){return e.deleteVertexArray(t)}function c(e){const t=[],i=[],r=[];for(let s=0;s<n;s++)t[s]=0,i[s]=0,r[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:i,attributeDivisors:r,object:e,attributes:{},index:null}}function u(){const e=s.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function h(e){d(e,0)}function d(t,n){const i=s.newAttributes,r=s.enabledAttributes,o=s.attributeDivisors;i[t]=1,0===r[t]&&(e.enableVertexAttribArray(t),r[t]=1),o[t]!==n&&(e.vertexAttribDivisor(t,n),o[t]=n)}function p(){const t=s.newAttributes,n=s.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==t[i]&&(e.disableVertexAttribArray(i),n[i]=0)}function g(t,n,i,r,s,o,a){!0===a?e.vertexAttribIPointer(t,n,i,s,o):e.vertexAttribPointer(t,n,i,r,s,o)}function f(){m(),o=!0,s!==r&&(s=r,a(s.object))}function m(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:function(n,r,l,f,m){let v=!1;const y=function(t,n,r){const s=!0===r.wireframe;let o=i[t.id];void 0===o&&(o={},i[t.id]=o);let a=o[n.id];void 0===a&&(a={},o[n.id]=a);let l=a[s];void 0===l&&(l=c(e.createVertexArray()),a[s]=l);return l}(f,l,r);s!==y&&(s=y,a(s.object)),v=function(e,t,n,i){const r=s.attributes,o=t.attributes;let a=0;const l=n.getAttributes();for(const s in l){if(l[s].location>=0){const t=r[s];let n=o[s];if(void 0===n&&("instanceMatrix"===s&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===s&&e.instanceColor&&(n=e.instanceColor)),void 0===t)return!0;if(t.attribute!==n)return!0;if(n&&t.data!==n.data)return!0;a++}}return s.attributesNum!==a||s.index!==i}(n,f,l,m),v&&function(e,t,n,i){const r={},o=t.attributes;let a=0;const l=n.getAttributes();for(const s in l){if(l[s].location>=0){let t=o[s];void 0===t&&("instanceMatrix"===s&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===s&&e.instanceColor&&(t=e.instanceColor));const n={};n.attribute=t,t&&t.data&&(n.data=t.data),r[s]=n,a++}}s.attributes=r,s.attributesNum=a,s.index=i}(n,f,l,m),null!==m&&t.update(m,e.ELEMENT_ARRAY_BUFFER),(v||o)&&(o=!1,function(n,i,r,s){u();const o=s.attributes,a=r.getAttributes(),l=i.defaultAttributeValues;for(const c in a){const i=a[c];if(i.location>=0){let r=o[c];if(void 0===r&&("instanceMatrix"===c&&n.instanceMatrix&&(r=n.instanceMatrix),"instanceColor"===c&&n.instanceColor&&(r=n.instanceColor)),void 0!==r){const o=r.normalized,a=r.itemSize,l=t.get(r);if(void 0===l)continue;const c=l.buffer,u=l.type,p=l.bytesPerElement,f=u===e.INT||u===e.UNSIGNED_INT||r.gpuType===nf;if(r.isInterleavedBufferAttribute){const t=r.data,l=t.stride,m=r.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<i.locationSize;e++)d(i.location+e,t.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<i.locationSize;e++)h(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<i.locationSize;e++)g(i.location+e,a/i.locationSize,u,o,l*p,(m+a/i.locationSize*e)*p,f)}else{if(r.isInstancedBufferAttribute){for(let e=0;e<i.locationSize;e++)d(i.location+e,r.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=r.meshPerAttribute*r.count)}else for(let e=0;e<i.locationSize;e++)h(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<i.locationSize;e++)g(i.location+e,a/i.locationSize,u,o,a*p,a/i.locationSize*e*p,f)}}else if(void 0!==l){const t=l[c];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(i.location,t);break;case 3:e.vertexAttrib3fv(i.location,t);break;case 4:e.vertexAttrib4fv(i.location,t);break;default:e.vertexAttrib1fv(i.location,t)}}}}p()}(n,r,l,f),null!==m&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(m).buffer))},reset:f,resetDefaultState:m,dispose:function(){f();for(const e in i){const t=i[e];for(const e in t){const n=t[e];for(const e in n)l(n[e].object),delete n[e];delete t[e]}delete i[e]}},releaseStatesOfGeometry:function(e){if(void 0===i[e.id])return;const t=i[e.id];for(const n in t){const e=t[n];for(const t in e)l(e[t].object),delete e[t];delete t[n]}delete i[e.id]},releaseStatesOfProgram:function(e){for(const t in i){const n=i[t];if(void 0===n[e.id])continue;const r=n[e.id];for(const e in r)l(r[e].object),delete r[e];delete n[e.id]}},initAttributes:u,enableAttribute:h,disableUnusedAttributes:p}}function dR(e,t,n){let i;function r(t,r,s){0!==s&&(e.drawArraysInstanced(i,t,r,s),n.update(r,i,s))}this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i,1)},this.renderInstances=r,this.renderMultiDraw=function(e,r,s){if(0===s)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,e,0,r,0,s);let o=0;for(let t=0;t<s;t++)o+=r[t];n.update(o,i,1)},this.renderMultiDrawInstances=function(e,s,o,a){if(0===o)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)r(e[t],s[t],a[t]);else{l.multiDrawArraysInstancedWEBGL(i,e,0,s,0,a,0,o);let t=0;for(let e=0;e<o;e++)t+=s[e]*a[e];n.update(t,i,1)}}}function pR(e,t,n,i){let r;function s(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let o=void 0!==n.precision?n.precision:"highp";const a=s(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);const l=!0===n.logarithmicDepthBuffer,c=!0===n.reverseDepthBuffer&&t.has("EXT_clip_control"),u=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:s,textureFormatReadable:function(t){return t===pf||i.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const r=n===of&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(n!==Jg&&i.convert(n)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==sf&&!r)},precision:o,logarithmicDepthBuffer:l,reverseDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:e.getParameter(e.MAX_TEXTURE_SIZE),maxCubemapSize:e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:e.getParameter(e.MAX_VERTEX_ATTRIBS),maxVertexUniforms:e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:e.getParameter(e.MAX_VARYING_VECTORS),maxFragmentUniforms:e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:h>0,maxSamples:e.getParameter(e.MAX_SAMPLES)}}function gR(e){const t=this;let n=null,i=0,r=!1,s=!1;const o=new TS,a=new _v,l={value:null,needsUpdate:!1};function c(e,n,i,r){const s=null!==e?e.length:0;let c=null;if(0!==s){if(c=l.value,!0!==r||null===c){const t=i+4*s,r=n.matrixWorldInverse;a.getNormalMatrix(r),(null===c||c.length<t)&&(c=new Float32Array(t));for(let n=0,l=i;n!==s;++n,l+=4)o.copy(e[n]).applyMatrix4(r,a),o.normal.toArray(c,l),c[l+3]=o.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=s,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const n=0!==e.length||t||0!==i||r;return r=t,i=e.length,n},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(e,t){n=c(e,t,0)},this.setState=function(o,a,u){const h=o.clippingPlanes,d=o.clipIntersection,p=o.clipShadows,g=e.get(o);if(!r||null===h||0===h.length||s&&!p)s?c(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=i>0);t.numPlanes=i,t.numIntersection=0}();else{const e=s?0:i,t=4*e;let r=g.clippingState||null;l.value=r,r=c(h,a,t,u);for(let i=0;i!==t;++i)r[i]=n[i];g.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function fR(e){let t=new WeakMap;function n(e,t){return t===Og?e.mapping=Ig:t===Ng&&(e.mapping=kg),e}function i(e){const n=e.target;n.removeEventListener("dispose",i);const r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping;if(s===Og||s===Ng){if(t.has(r)){return n(t.get(r).texture,r.mapping)}{const s=r.image;if(s&&s.height>0){const o=new Ew(s.height);return o.fromEquirectangularTexture(e,r),t.set(r,o),r.addEventListener("dispose",i),n(o.texture,r.mapping)}return null}}}return r},dispose:function(){t=new WeakMap}}}const mR=[.125,.215,.35,.446,.526,.582],vR=20,yR=new oM,CR=new bC;let wR=null,SR=0,bR=0,xR=!1;const _R=(1+Math.sqrt(5))/2,MR=1/_R,ER=[new ey(-_R,MR,0),new ey(_R,MR,0),new ey(-MR,0,_R),new ey(MR,0,_R),new ey(0,_R,-MR),new ey(0,_R,MR),new ey(-1,1,-1),new ey(1,1,-1),new ey(-1,1,1),new ey(1,1,1)],RR=new ey;class TR{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const{size:s=256,position:o=RR}=r;wR=this._renderer.getRenderTarget(),SR=this._renderer.getActiveCubeFace(),bR=this._renderer.getActiveMipmapLevel(),xR=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(s);const a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,n,i,a,o),t>0&&this._blur(a,0,0,t),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=DR(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=FR(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(wR,SR,bR),this._renderer.xr.enabled=xR,e.scissorTest=!1,AR(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Ig||e.mapping===kg?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),wR=this._renderer.getRenderTarget(),SR=this._renderer.getActiveCubeFace(),bR=this._renderer.getActiveMipmapLevel(),xR=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Xg,minFilter:Xg,generateMipmaps:!1,type:of,format:pf,colorSpace:bm,depthBuffer:!1},i=PR(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=PR(e,t,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],n=[],i=[];let r=e;const s=e-4+1+mR.length;for(let o=0;o<s;o++){const s=Math.pow(2,r);n.push(s);let a=1/s;o>e-4?a=mR[o-e+4-1]:0===o&&(a=0),i.push(a);const l=1/(s-2),c=-l,u=1+l,h=[c,c,u,c,u,u,c,c,u,u,c,u],d=6,p=6,g=3,f=2,m=1,v=new Float32Array(g*p*d),y=new Float32Array(f*p*d),C=new Float32Array(m*p*d);for(let e=0;e<d;e++){const t=e%3*2/3-1,n=e>2?0:-1,i=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];v.set(i,g*p*e),y.set(h,f*p*e);const r=[e,e,e,e,e,e];C.set(r,m*p*e)}const w=new JC;w.setAttribute("position",new kC(v,g)),w.setAttribute("uv",new kC(y,f)),w.setAttribute("faceIndex",new kC(C,m)),t.push(w),r>4&&r--}return{lodPlanes:t,sizeLods:n,sigmas:i}}(i)),this._blurMaterial=function(e,t,n){const i=new Float32Array(vR),r=new ey(0,1,0),s=new vw({name:"SphericalGaussianBlur",defines:{n:vR,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:LR(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:Hp,depthTest:!1,depthWrite:!1});return s}(i,e,t)}return i}_compileMaterial(e){const t=new uw(this._lodPlanes[0],e);this._renderer.compile(t,yR)}_sceneToCubeUV(e,t,n,i,r){const s=new bw(90,1,t,n),o=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],l=this._renderer,c=l.autoClear,u=l.toneMapping;l.getClearColor(CR),l.toneMapping=xg,l.autoClear=!1;const h=new EC({name:"PMREM.Background",side:Bp,depthWrite:!1,depthTest:!1}),d=new uw(new dw,h);let p=!1;const g=e.background;g?g.isColor&&(h.color.copy(g),e.background=null,p=!0):(h.color.copy(CR),p=!0);for(let f=0;f<6;f++){const t=f%3;0===t?(s.up.set(0,o[f],0),s.position.set(r.x,r.y,r.z),s.lookAt(r.x+a[f],r.y,r.z)):1===t?(s.up.set(0,0,o[f]),s.position.set(r.x,r.y,r.z),s.lookAt(r.x,r.y+a[f],r.z)):(s.up.set(0,o[f],0),s.position.set(r.x,r.y,r.z),s.lookAt(r.x,r.y,r.z+a[f]));const n=this._cubeSize;AR(i,t*n,f>2?n:0,n,n),l.setRenderTarget(i),p&&l.render(d,s),l.render(e,s)}d.geometry.dispose(),d.material.dispose(),l.toneMapping=u,l.autoClear=c,e.background=g}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===Ig||e.mapping===kg;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=DR()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=FR());const r=i?this._cubemapMaterial:this._equirectMaterial,s=new uw(this._lodPlanes[0],r);r.uniforms.envMap.value=e;const o=this._cubeSize;AR(t,0,0,3*o,2*o),n.setRenderTarget(t),n.render(s,yR)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const i=this._lodPlanes.length;for(let r=1;r<i;r++){const t=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),n=ER[(i-r-1)%ER.length];this._blur(e,r-1,r,t,n)}t.autoClear=n}_blur(e,t,n,i,r){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,n,i,"latitudinal",r),this._halfBlur(s,e,n,n,i,"longitudinal",r)}_halfBlur(e,t,n,i,r,s,o){const a=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new uw(this._lodPlanes[i],l),u=l.uniforms,h=this._sizeLods[n]-1,d=isFinite(r)?Math.PI/(2*h):2*Math.PI/39,p=r/d,g=isFinite(r)?1+Math.floor(3*p):vR;g>vR&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const f=[];let m=0;for(let C=0;C<vR;++C){const e=C/p,t=Math.exp(-e*e/2);f.push(t),0===C?m+=t:C<g&&(m+=2*t)}for(let C=0;C<f.length;C++)f[C]=f[C]/m;u.envMap.value=e.texture,u.samples.value=g,u.weights.value=f,u.latitudinal.value="latitudinal"===s,o&&(u.poleAxis.value=o);const{_lodMax:v}=this;u.dTheta.value=d,u.mipInt.value=v-n;const y=this._sizeLods[i];AR(t,3*y*(i>v-4?i-v+4:0),4*(this._cubeSize-y),3*y,2*y),a.setRenderTarget(t),a.render(c,yR)}}function PR(e,t,n){const i=new Kv(e,t,n);return i.texture.mapping=Bg,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function AR(e,t,n,i,r){e.viewport.set(t,n,i,r),e.scissor.set(t,n,i,r)}function FR(){return new vw({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:LR(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:Hp,depthTest:!1,depthWrite:!1})}function DR(){return new vw({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:LR(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:Hp,depthTest:!1,depthWrite:!1})}function LR(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function IR(e){let t=new WeakMap,n=null;function i(e){const n=e.target;n.removeEventListener("dispose",i);const r=t.get(n);void 0!==r&&(t.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping,o=s===Og||s===Ng,a=s===Ig||s===kg;if(o||a){let s=t.get(r);const l=void 0!==s?s.texture.pmremVersion:0;if(r.isRenderTargetTexture&&r.pmremVersion!==l)return null===n&&(n=new TR(e)),s=o?n.fromEquirectangular(r,s):n.fromCubemap(r,s),s.texture.pmremVersion=r.pmremVersion,t.set(r,s),s.texture;if(void 0!==s)return s.texture;{const l=r.image;return o&&l&&l.height>0||a&&l&&function(e){let t=0;const n=6;for(let i=0;i<n;i++)void 0!==e[i]&&t++;return t===n}(l)?(null===n&&(n=new TR(e)),s=o?n.fromEquirectangular(r):n.fromCubemap(r),s.texture.pmremVersion=r.pmremVersion,t.set(r,s),r.addEventListener("dispose",i),s.texture):null}}}return r},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function kR(e){const t={};function n(n){if(void 0!==t[n])return t[n];let i;switch(n){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return t[n]=i,i}return{has:function(e){return null!==n(e)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(e){const t=n(e);return null===t&&Dv("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function OR(e,t,n,i){const r={},s=new WeakMap;function o(e){const a=e.target;null!==a.index&&t.remove(a.index);for(const n in a.attributes)t.remove(a.attributes[n]);a.removeEventListener("dispose",o),delete r[a.id];const l=s.get(a);l&&(t.remove(l),s.delete(a)),i.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,n.memory.geometries--}function a(e){const n=[],i=e.index,r=e.attributes.position;let o=0;if(null!==i){const e=i.array;o=i.version;for(let t=0,i=e.length;t<i;t+=3){const i=e[t+0],r=e[t+1],s=e[t+2];n.push(i,r,r,s,s,i)}}else{if(void 0===r)return;{const e=r.array;o=r.version;for(let t=0,i=e.length/3-1;t<i;t+=3){const e=t+0,i=t+1,r=t+2;n.push(e,i,i,r,r,e)}}}const a=new(Ev(n)?UC:HC)(n,1);a.version=o;const l=s.get(e);l&&t.remove(l),s.set(e,a)}return{get:function(e,t){return!0===r[t.id]||(t.addEventListener("dispose",o),r[t.id]=!0,n.memory.geometries++),t},update:function(n){const i=n.attributes;for(const r in i)t.update(i[r],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){const t=s.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&a(e)}else a(e);return s.get(e)}}}function NR(e,t,n){let i,r,s;function o(t,o,a){0!==a&&(e.drawElementsInstanced(i,o,r,t*s,a),n.update(o,i,a))}this.setMode=function(e){i=e},this.setIndex=function(e){r=e.type,s=e.bytesPerElement},this.render=function(t,o){e.drawElements(i,o,r,t*s),n.update(o,i,1)},this.renderInstances=o,this.renderMultiDraw=function(e,s,o){if(0===o)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,s,0,r,e,0,o);let a=0;for(let t=0;t<o;t++)a+=s[t];n.update(a,i,1)},this.renderMultiDrawInstances=function(e,a,l,c){if(0===l)return;const u=t.get("WEBGL_multi_draw");if(null===u)for(let t=0;t<e.length;t++)o(e[t]/s,a[t],c[t]);else{u.multiDrawElementsInstancedWEBGL(i,a,0,r,e,0,c,0,l);let t=0;for(let e=0;e<l;e++)t+=a[e]*c[e];n.update(t,i,1)}}}function BR(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,i,r){switch(t.calls++,i){case e.TRIANGLES:t.triangles+=r*(n/3);break;case e.LINES:t.lines+=r*(n/2);break;case e.LINE_STRIP:t.lines+=r*(n-1);break;case e.LINE_LOOP:t.lines+=r*n;break;case e.POINTS:t.points+=r*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",i)}}}}function zR(e,t,n){const i=new WeakMap,r=new qv;return{update:function(s,o,a){const l=s.morphTargetInfluences,c=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,u=void 0!==c?c.length:0;let h=i.get(o);if(void 0===h||h.count!==u){void 0!==h&&h.texture.dispose();const d=void 0!==o.morphAttributes.position,p=void 0!==o.morphAttributes.normal,g=void 0!==o.morphAttributes.color,f=o.morphAttributes.position||[],m=o.morphAttributes.normal||[],v=o.morphAttributes.color||[];let y=0;!0===d&&(y=1),!0===p&&(y=2),!0===g&&(y=3);let C=o.attributes.position.count*y,w=1;C>t.maxTextureSize&&(w=Math.ceil(C/t.maxTextureSize),C=t.maxTextureSize);const S=new Float32Array(C*w*4*u),b=new $v(S,C,w,u);b.type=sf,b.needsUpdate=!0;const x=4*y;for(let M=0;M<u;M++){const E=f[M],R=m[M],T=v[M],P=C*w*4*M;for(let A=0;A<E.count;A++){const F=A*x;!0===d&&(r.fromBufferAttribute(E,A),S[P+F+0]=r.x,S[P+F+1]=r.y,S[P+F+2]=r.z,S[P+F+3]=0),!0===p&&(r.fromBufferAttribute(R,A),S[P+F+4]=r.x,S[P+F+5]=r.y,S[P+F+6]=r.z,S[P+F+7]=0),!0===g&&(r.fromBufferAttribute(T,A),S[P+F+8]=r.x,S[P+F+9]=r.y,S[P+F+10]=r.z,S[P+F+11]=4===T.itemSize?r.w:1)}}function _(){b.dispose(),i.delete(o),o.removeEventListener("dispose",_)}h={count:u,texture:b,size:new xv(C,w)},i.set(o,h),o.addEventListener("dispose",_)}if(!0===s.isInstancedMesh&&null!==s.morphTexture)a.getUniforms().setValue(e,"morphTexture",s.morphTexture,n);else{let D=0;for(let I=0;I<l.length;I++)D+=l[I];const L=o.morphTargetsRelative?1:1-D;a.getUniforms().setValue(e,"morphTargetBaseInfluence",L),a.getUniforms().setValue(e,"morphTargetInfluences",l)}a.getUniforms().setValue(e,"morphTargetsTexture",h.texture,n),a.getUniforms().setValue(e,"morphTargetsTextureSize",h.size)}}}function HR(e,t,n,i){let r=new WeakMap;function s(e){const t=e.target;t.removeEventListener("dispose",s),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(o){const a=i.render.frame,l=o.geometry,c=t.get(o,l);if(r.get(c)!==a&&(t.update(c),r.set(c,a)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",s)&&o.addEventListener("dispose",s),r.get(o)!==a&&(n.update(o.instanceMatrix,e.ARRAY_BUFFER),null!==o.instanceColor&&n.update(o.instanceColor,e.ARRAY_BUFFER),r.set(o,a))),o.isSkinnedMesh){const e=o.skeleton;r.get(e)!==a&&(e.update(),r.set(e,a))}return c},dispose:function(){r=new WeakMap}}}const GR=new jv,UR=new Tb(1,1),VR=new $v,WR=new Yv,jR=new Mw,qR=[],XR=[],KR=new Float32Array(16),$R=new Float32Array(9),ZR=new Float32Array(4);function YR(e,t,n){const i=e[0];if(i<=0||i>0)return e;const r=t*n;let s=qR[r];if(void 0===s&&(s=new Float32Array(r),qR[r]=s),0!==t){i.toArray(s,0);for(let i=1,r=0;i!==t;++i)r+=n,e[i].toArray(s,r)}return s}function JR(e,t){if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}function QR(e,t){for(let n=0,i=t.length;n<i;n++)e[n]=t[n]}function eT(e,t){let n=XR[t];void 0===n&&(n=new Int32Array(t),XR[t]=n);for(let i=0;i!==t;++i)n[i]=e.allocateTextureUnit();return n}function tT(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function nT(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(JR(n,t))return;e.uniform2fv(this.addr,t),QR(n,t)}}function iT(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(JR(n,t))return;e.uniform3fv(this.addr,t),QR(n,t)}}function rT(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(JR(n,t))return;e.uniform4fv(this.addr,t),QR(n,t)}}function sT(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(JR(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),QR(n,t)}else{if(JR(n,i))return;ZR.set(i),e.uniformMatrix2fv(this.addr,!1,ZR),QR(n,i)}}function oT(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(JR(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),QR(n,t)}else{if(JR(n,i))return;$R.set(i),e.uniformMatrix3fv(this.addr,!1,$R),QR(n,i)}}function aT(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(JR(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),QR(n,t)}else{if(JR(n,i))return;KR.set(i),e.uniformMatrix4fv(this.addr,!1,KR),QR(n,i)}}function lT(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function cT(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(JR(n,t))return;e.uniform2iv(this.addr,t),QR(n,t)}}function uT(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(JR(n,t))return;e.uniform3iv(this.addr,t),QR(n,t)}}function hT(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(JR(n,t))return;e.uniform4iv(this.addr,t),QR(n,t)}}function dT(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function pT(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(JR(n,t))return;e.uniform2uiv(this.addr,t),QR(n,t)}}function gT(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(JR(n,t))return;e.uniform3uiv(this.addr,t),QR(n,t)}}function fT(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(JR(n,t))return;e.uniform4uiv(this.addr,t),QR(n,t)}}function mT(e,t,n){const i=this.cache,r=n.allocateTextureUnit();let s;i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),this.type===e.SAMPLER_2D_SHADOW?(UR.compareFunction=Wm,s=UR):s=GR,n.setTexture2D(t||s,r)}function vT(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(t||WR,r)}function yT(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(t||jR,r)}function CT(e,t,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(t||VR,r)}function wT(e,t){e.uniform1fv(this.addr,t)}function ST(e,t){const n=YR(t,this.size,2);e.uniform2fv(this.addr,n)}function bT(e,t){const n=YR(t,this.size,3);e.uniform3fv(this.addr,n)}function xT(e,t){const n=YR(t,this.size,4);e.uniform4fv(this.addr,n)}function _T(e,t){const n=YR(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function MT(e,t){const n=YR(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function ET(e,t){const n=YR(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function RT(e,t){e.uniform1iv(this.addr,t)}function TT(e,t){e.uniform2iv(this.addr,t)}function PT(e,t){e.uniform3iv(this.addr,t)}function AT(e,t){e.uniform4iv(this.addr,t)}function FT(e,t){e.uniform1uiv(this.addr,t)}function DT(e,t){e.uniform2uiv(this.addr,t)}function LT(e,t){e.uniform3uiv(this.addr,t)}function IT(e,t){e.uniform4uiv(this.addr,t)}function kT(e,t,n){const i=this.cache,r=t.length,s=eT(n,r);JR(i,s)||(e.uniform1iv(this.addr,s),QR(i,s));for(let o=0;o!==r;++o)n.setTexture2D(t[o]||GR,s[o])}function OT(e,t,n){const i=this.cache,r=t.length,s=eT(n,r);JR(i,s)||(e.uniform1iv(this.addr,s),QR(i,s));for(let o=0;o!==r;++o)n.setTexture3D(t[o]||WR,s[o])}function NT(e,t,n){const i=this.cache,r=t.length,s=eT(n,r);JR(i,s)||(e.uniform1iv(this.addr,s),QR(i,s));for(let o=0;o!==r;++o)n.setTextureCube(t[o]||jR,s[o])}function BT(e,t,n){const i=this.cache,r=t.length,s=eT(n,r);JR(i,s)||(e.uniform1iv(this.addr,s),QR(i,s));for(let o=0;o!==r;++o)n.setTexture2DArray(t[o]||VR,s[o])}class zT{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return tT;case 35664:return nT;case 35665:return iT;case 35666:return rT;case 35674:return sT;case 35675:return oT;case 35676:return aT;case 5124:case 35670:return lT;case 35667:case 35671:return cT;case 35668:case 35672:return uT;case 35669:case 35673:return hT;case 5125:return dT;case 36294:return pT;case 36295:return gT;case 36296:return fT;case 35678:case 36198:case 36298:case 36306:case 35682:return mT;case 35679:case 36299:case 36307:return vT;case 35680:case 36300:case 36308:case 36293:return yT;case 36289:case 36303:case 36311:case 36292:return CT}}(t.type)}}class HT{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return wT;case 35664:return ST;case 35665:return bT;case 35666:return xT;case 35674:return _T;case 35675:return MT;case 35676:return ET;case 5124:case 35670:return RT;case 35667:case 35671:return TT;case 35668:case 35672:return PT;case 35669:case 35673:return AT;case 5125:return FT;case 36294:return DT;case 36295:return LT;case 36296:return IT;case 35678:case 36198:case 36298:case 36306:case 35682:return kT;case 35679:case 36299:case 36307:return OT;case 35680:case 36300:case 36308:case 36293:return NT;case 36289:case 36303:case 36311:case 36292:return BT}}(t.type)}}class GT{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const s=i[r];s.setValue(e,t[s.id],n)}}}const UT=/(\w+)(\])?(\[|\.)?/g;function VT(e,t){e.seq.push(t),e.map[t.id]=t}function WT(e,t,n){const i=e.name,r=i.length;for(UT.lastIndex=0;;){const s=UT.exec(i),o=UT.lastIndex;let a=s[1];const l="]"===s[2],c=s[3];if(l&&(a|=0),void 0===c||"["===c&&o+2===r){VT(n,void 0===c?new zT(a,e,t):new HT(a,e,t));break}{let e=n.map[a];void 0===e&&(e=new GT(a),VT(n,e)),n=e}}}class jT{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const n=e.getActiveUniform(t,i);WT(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,i){const r=this.map[t];void 0!==r&&r.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];void 0!==i&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let r=0,s=t.length;r!==s;++r){const s=t[r],o=n[s.id];!1!==o.needsUpdate&&s.setValue(e,o.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,r=e.length;i!==r;++i){const r=e[i];r.id in t&&n.push(r)}return n}}function qT(e,t,n){const i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),i}let XT=0;const KT=new _v;function $T(e,t,n){const i=e.getShaderParameter(t,e.COMPILE_STATUS),r=e.getShaderInfoLog(t).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const i=parseInt(s[1]);return n.toUpperCase()+"\n\n"+r+"\n\n"+function(e,t){const n=e.split("\n"),i=[],r=Math.max(t-6,0),s=Math.min(t+6,n.length);for(let o=r;o<s;o++){const e=o+1;i.push(`${e===t?">":" "} ${e}: ${n[o]}`)}return i.join("\n")}(e.getShaderSource(t),i)}return r}function ZT(e,t){const n=function(e){Ov._getMatrix(KT,Ov.workingColorSpace,e);const t=`mat3( ${KT.elements.map((e=>e.toFixed(4)))} )`;switch(Ov.getTransfer(e)){case xm:return[t,"LinearTransferOETF"];case _m:return[t,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}(t);return[`vec4 ${e}( vec4 value ) {`,`\treturn ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join("\n")}function YT(e,t){let n;switch(t){case _g:n="Linear";break;case Mg:n="Reinhard";break;case Eg:n="Cineon";break;case Rg:n="ACESFilmic";break;case Pg:n="AgX";break;case Ag:n="Neutral";break;case Tg:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const JT=new ey;function QT(){Ov.getLuminanceCoefficients(JT);return["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${JT.x.toFixed(4)}, ${JT.y.toFixed(4)}, ${JT.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")}function eP(e){return""!==e}function tP(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function nP(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const iP=/^[ \t]*#include +<([\w\d./]+)>/gm;function rP(e){return e.replace(iP,oP)}const sP=new Map;function oP(e,t){let n=rR[t];if(void 0===n){const e=sP.get(t);if(void 0===e)throw new Error("Can not resolve #include <"+t+">");n=rR[e],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e)}return rP(n)}const aP=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function lP(e){return e.replace(aP,cP)}function cP(e,t,n,i){let r="";for(let s=parseInt(t);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function uP(e){let t=`precision ${e.precision} float;\n\tprecision ${e.precision} int;\n\tprecision ${e.precision} sampler2D;\n\tprecision ${e.precision} samplerCube;\n\tprecision ${e.precision} sampler3D;\n\tprecision ${e.precision} sampler2DArray;\n\tprecision ${e.precision} sampler2DShadow;\n\tprecision ${e.precision} samplerCubeShadow;\n\tprecision ${e.precision} sampler2DArrayShadow;\n\tprecision ${e.precision} isampler2D;\n\tprecision ${e.precision} isampler3D;\n\tprecision ${e.precision} isamplerCube;\n\tprecision ${e.precision} isampler2DArray;\n\tprecision ${e.precision} usampler2D;\n\tprecision ${e.precision} usampler3D;\n\tprecision ${e.precision} usamplerCube;\n\tprecision ${e.precision} usampler2DArray;\n\t`;return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function hP(e,t,n,i){const r=e.getContext(),s=n.defines;let o=n.vertexShader,a=n.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===Ip?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===kp?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===Op&&(t="SHADOWMAP_TYPE_VSM"),t}(n),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Ig:case kg:t="ENVMAP_TYPE_CUBE";break;case Bg:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),u=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===kg&&(t="ENVMAP_MODE_REFRACTION");return t}(n),h=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case wg:t="ENVMAP_BLENDING_MULTIPLY";break;case Sg:t="ENVMAP_BLENDING_MIX";break;case bg:t="ENVMAP_BLENDING_ADD"}return t}(n),d=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}(n),p=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(eP).join("\n")}(n),g=function(e){const t=[];for(const n in e){const i=e[n];!1!==i&&t.push("#define "+n+" "+i)}return t.join("\n")}(s),f=r.createProgram();let m,v,y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(m=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g].filter(eP).join("\n"),m.length>0&&(m+="\n"),v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g].filter(eP).join("\n"),v.length>0&&(v+="\n")):(m=[uP(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(eP).join("\n"),v=[uP(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==xg?"#define TONE_MAPPING":"",n.toneMapping!==xg?rR.tonemapping_pars_fragment:"",n.toneMapping!==xg?YT("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",rR.colorspace_pars_fragment,ZT("linearToOutputTexel",n.outputColorSpace),QT(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(eP).join("\n")),o=rP(o),o=tP(o,n),o=nP(o,n),a=rP(a),a=tP(a,n),a=nP(a,n),o=lP(o),a=lP(a),!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",m=[p,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,v=["#define varying in",n.glslVersion===sv?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===sv?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const C=y+m+o,w=y+v+a,S=qT(r,r.VERTEX_SHADER,C),b=qT(r,r.FRAGMENT_SHADER,w);function x(t){if(e.debug.checkShaderErrors){const n=r.getProgramInfoLog(f).trim(),i=r.getShaderInfoLog(S).trim(),s=r.getShaderInfoLog(b).trim();let o=!0,a=!0;if(!1===r.getProgramParameter(f,r.LINK_STATUS))if(o=!1,"function"===typeof e.debug.onShaderError)e.debug.onShaderError(r,f,S,b);else{const e=$T(r,S,"vertex"),i=$T(r,b,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(f,r.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+n+"\n"+e+"\n"+i)}else""!==n?console.warn("THREE.WebGLProgram: Program Info Log:",n):""!==i&&""!==s||(a=!1);a&&(t.diagnostics={runnable:o,programLog:n,vertexShader:{log:i,prefix:m},fragmentShader:{log:s,prefix:v}})}r.deleteShader(S),r.deleteShader(b),_=new jT(r,f),M=function(e,t){const n={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const i=e.getActiveAttrib(t,r),s=i.name;let o=1;i.type===e.FLOAT_MAT2&&(o=2),i.type===e.FLOAT_MAT3&&(o=3),i.type===e.FLOAT_MAT4&&(o=4),n[s]={type:i.type,location:e.getAttribLocation(t,s),locationSize:o}}return n}(r,f)}let _,M;r.attachShader(f,S),r.attachShader(f,b),void 0!==n.index0AttributeName?r.bindAttribLocation(f,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(f,0,"position"),r.linkProgram(f),this.getUniforms=function(){return void 0===_&&x(this),_},this.getAttributes=function(){return void 0===M&&x(this),M};let E=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===E&&(E=r.getProgramParameter(f,37297)),E},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(f),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=XT++,this.cacheKey=t,this.usedTimes=1,this.program=f,this.vertexShader=S,this.fragmentShader=b,this}let dP=0;class pP{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),r=this._getShaderStage(n),s=this._getShaderCacheForMaterial(e);return!1===s.has(i)&&(s.add(i),i.usedTimes++),!1===s.has(r)&&(s.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new gP(e),t.set(e,n)),n}}class gP{constructor(e){this.id=dP++,this.code=e,this.usedTimes=0}}function fP(e,t,n,i,r,s,o){const a=new Gy,l=new pP,c=new Set,u=[],h=r.logarithmicDepthBuffer,d=r.vertexTextures;let p=r.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function f(e){return c.add(e),0===e?"uv":`uv${e}`}return{getParameters:function(s,a,u,m,v){const y=m.fog,C=v.geometry,w=s.isMeshStandardMaterial?m.environment:null,S=(s.isMeshStandardMaterial?n:t).get(s.envMap||w),b=S&&S.mapping===Bg?S.image.height:null,x=g[s.type];null!==s.precision&&(p=r.getMaxPrecision(s.precision),p!==s.precision&&console.warn("THREE.WebGLProgram.getParameters:",s.precision,"not supported, using",p,"instead."));const _=C.morphAttributes.position||C.morphAttributes.normal||C.morphAttributes.color,M=void 0!==_?_.length:0;let E,R,T,P,A=0;if(void 0!==C.morphAttributes.position&&(A=1),void 0!==C.morphAttributes.normal&&(A=2),void 0!==C.morphAttributes.color&&(A=3),x){const e=oR[x];E=e.vertexShader,R=e.fragmentShader}else E=s.vertexShader,R=s.fragmentShader,l.update(s),T=l.getVertexShaderID(s),P=l.getFragmentShaderID(s);const F=e.getRenderTarget(),D=e.state.buffers.depth.getReversed(),L=!0===v.isInstancedMesh,I=!0===v.isBatchedMesh,k=!!s.map,O=!!s.matcap,N=!!S,B=!!s.aoMap,z=!!s.lightMap,H=!!s.bumpMap,G=!!s.normalMap,U=!!s.displacementMap,V=!!s.emissiveMap,W=!!s.metalnessMap,j=!!s.roughnessMap,q=s.anisotropy>0,X=s.clearcoat>0,K=s.dispersion>0,$=s.iridescence>0,Z=s.sheen>0,Y=s.transmission>0,J=q&&!!s.anisotropyMap,Q=X&&!!s.clearcoatMap,ee=X&&!!s.clearcoatNormalMap,te=X&&!!s.clearcoatRoughnessMap,ne=$&&!!s.iridescenceMap,ie=$&&!!s.iridescenceThicknessMap,re=Z&&!!s.sheenColorMap,se=Z&&!!s.sheenRoughnessMap,oe=!!s.specularMap,ae=!!s.specularColorMap,le=!!s.specularIntensityMap,ce=Y&&!!s.transmissionMap,ue=Y&&!!s.thicknessMap,he=!!s.gradientMap,de=!!s.alphaMap,pe=s.alphaTest>0,ge=!!s.alphaHash,fe=!!s.extensions;let me=xg;s.toneMapped&&(null!==F&&!0!==F.isXRRenderTarget||(me=e.toneMapping));const ve={shaderID:x,shaderType:s.type,shaderName:s.name,vertexShader:E,fragmentShader:R,defines:s.defines,customVertexShaderID:T,customFragmentShaderID:P,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:p,batching:I,batchingColor:I&&null!==v._colorsTexture,instancing:L,instancingColor:L&&null!==v.instanceColor,instancingMorph:L&&null!==v.morphTexture,supportsVertexTextures:d,outputColorSpace:null===F?e.outputColorSpace:!0===F.isXRRenderTarget?F.texture.colorSpace:bm,alphaToCoverage:!!s.alphaToCoverage,map:k,matcap:O,envMap:N,envMapMode:N&&S.mapping,envMapCubeUVHeight:b,aoMap:B,lightMap:z,bumpMap:H,normalMap:G,displacementMap:d&&U,emissiveMap:V,normalMapObjectSpace:G&&s.normalMapType===Cm,normalMapTangentSpace:G&&s.normalMapType===ym,metalnessMap:W,roughnessMap:j,anisotropy:q,anisotropyMap:J,clearcoat:X,clearcoatMap:Q,clearcoatNormalMap:ee,clearcoatRoughnessMap:te,dispersion:K,iridescence:$,iridescenceMap:ne,iridescenceThicknessMap:ie,sheen:Z,sheenColorMap:re,sheenRoughnessMap:se,specularMap:oe,specularColorMap:ae,specularIntensityMap:le,transmission:Y,transmissionMap:ce,thicknessMap:ue,gradientMap:he,opaque:!1===s.transparent&&s.blending===Gp&&!1===s.alphaToCoverage,alphaMap:de,alphaTest:pe,alphaHash:ge,combine:s.combine,mapUv:k&&f(s.map.channel),aoMapUv:B&&f(s.aoMap.channel),lightMapUv:z&&f(s.lightMap.channel),bumpMapUv:H&&f(s.bumpMap.channel),normalMapUv:G&&f(s.normalMap.channel),displacementMapUv:U&&f(s.displacementMap.channel),emissiveMapUv:V&&f(s.emissiveMap.channel),metalnessMapUv:W&&f(s.metalnessMap.channel),roughnessMapUv:j&&f(s.roughnessMap.channel),anisotropyMapUv:J&&f(s.anisotropyMap.channel),clearcoatMapUv:Q&&f(s.clearcoatMap.channel),clearcoatNormalMapUv:ee&&f(s.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:te&&f(s.clearcoatRoughnessMap.channel),iridescenceMapUv:ne&&f(s.iridescenceMap.channel),iridescenceThicknessMapUv:ie&&f(s.iridescenceThicknessMap.channel),sheenColorMapUv:re&&f(s.sheenColorMap.channel),sheenRoughnessMapUv:se&&f(s.sheenRoughnessMap.channel),specularMapUv:oe&&f(s.specularMap.channel),specularColorMapUv:ae&&f(s.specularColorMap.channel),specularIntensityMapUv:le&&f(s.specularIntensityMap.channel),transmissionMapUv:ce&&f(s.transmissionMap.channel),thicknessMapUv:ue&&f(s.thicknessMap.channel),alphaMapUv:de&&f(s.alphaMap.channel),vertexTangents:!!C.attributes.tangent&&(G||q),vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!C.attributes.color&&4===C.attributes.color.itemSize,pointsUvs:!0===v.isPoints&&!!C.attributes.uv&&(k||de),fog:!!y,useFog:!0===s.fog,fogExp2:!!y&&y.isFogExp2,flatShading:!0===s.flatShading,sizeAttenuation:!0===s.sizeAttenuation,logarithmicDepthBuffer:h,reverseDepthBuffer:D,skinning:!0===v.isSkinnedMesh,morphTargets:void 0!==C.morphAttributes.position,morphNormals:void 0!==C.morphAttributes.normal,morphColors:void 0!==C.morphAttributes.color,morphTargetsCount:M,morphTextureStride:A,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numSpotLightMaps:a.spotLightMap.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numSpotLightShadowsWithMaps:a.numSpotLightShadowsWithMaps,numLightProbes:a.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:s.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.length>0,shadowMapType:e.shadowMap.type,toneMapping:me,decodeVideoTexture:k&&!0===s.map.isVideoTexture&&Ov.getTransfer(s.map.colorSpace)===_m,decodeVideoTextureEmissive:V&&!0===s.emissiveMap.isVideoTexture&&Ov.getTransfer(s.emissiveMap.colorSpace)===_m,premultipliedAlpha:s.premultipliedAlpha,doubleSided:s.side===zp,flipSided:s.side===Bp,useDepthPacking:s.depthPacking>=0,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionClipCullDistance:fe&&!0===s.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(fe&&!0===s.extensions.multiDraw||I)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:s.customProgramCacheKey()};return ve.vertexUv1s=c.has(1),ve.vertexUv2s=c.has(2),ve.vertexUv3s=c.has(3),c.clear(),ve},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){a.disableAll(),t.supportsVertexTextures&&a.enable(0);t.instancing&&a.enable(1);t.instancingColor&&a.enable(2);t.instancingMorph&&a.enable(3);t.matcap&&a.enable(4);t.envMap&&a.enable(5);t.normalMapObjectSpace&&a.enable(6);t.normalMapTangentSpace&&a.enable(7);t.clearcoat&&a.enable(8);t.iridescence&&a.enable(9);t.alphaTest&&a.enable(10);t.vertexColors&&a.enable(11);t.vertexAlphas&&a.enable(12);t.vertexUv1s&&a.enable(13);t.vertexUv2s&&a.enable(14);t.vertexUv3s&&a.enable(15);t.vertexTangents&&a.enable(16);t.anisotropy&&a.enable(17);t.alphaHash&&a.enable(18);t.batching&&a.enable(19);t.dispersion&&a.enable(20);t.batchingColor&&a.enable(21);e.push(a.mask),a.disableAll(),t.fog&&a.enable(0);t.useFog&&a.enable(1);t.flatShading&&a.enable(2);t.logarithmicDepthBuffer&&a.enable(3);t.reverseDepthBuffer&&a.enable(4);t.skinning&&a.enable(5);t.morphTargets&&a.enable(6);t.morphNormals&&a.enable(7);t.morphColors&&a.enable(8);t.premultipliedAlpha&&a.enable(9);t.shadowMapEnabled&&a.enable(10);t.doubleSided&&a.enable(11);t.flipSided&&a.enable(12);t.useDepthPacking&&a.enable(13);t.dithering&&a.enable(14);t.transmission&&a.enable(15);t.sheen&&a.enable(16);t.opaque&&a.enable(17);t.pointsUvs&&a.enable(18);t.decodeVideoTexture&&a.enable(19);t.decodeVideoTextureEmissive&&a.enable(20);t.alphaToCoverage&&a.enable(21);e.push(a.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=g[e.type];let n;if(t){const e=oR[t];n=mw.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let i;for(let e=0,r=u.length;e<r;e++){const t=u[e];if(t.cacheKey===n){i=t,++i.usedTimes;break}}return void 0===i&&(i=new hP(e,n,t,s),u.push(i)),i},releaseProgram:function(e){if(0===--e.usedTimes){const t=u.indexOf(e);u[t]=u[u.length-1],u.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:u,dispose:function(){l.dispose()}}}function mP(){let e=new WeakMap;return{has:function(t){return e.has(t)},get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,i){e.get(t)[n]=i},dispose:function(){e=new WeakMap}}}function vP(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function yP(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function CP(){const e=[];let t=0;const n=[],i=[],r=[];function s(n,i,r,s,o,a){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:i,material:r,groupOrder:s,renderOrder:n.renderOrder,z:o,group:a},e[t]=l):(l.id=n.id,l.object=n,l.geometry=i,l.material=r,l.groupOrder=s,l.renderOrder=n.renderOrder,l.z=o,l.group=a),t++,l}return{opaque:n,transmissive:i,transparent:r,init:function(){t=0,n.length=0,i.length=0,r.length=0},push:function(e,t,o,a,l,c){const u=s(e,t,o,a,l,c);o.transmission>0?i.push(u):!0===o.transparent?r.push(u):n.push(u)},unshift:function(e,t,o,a,l,c){const u=s(e,t,o,a,l,c);o.transmission>0?i.unshift(u):!0===o.transparent?r.unshift(u):n.unshift(u)},finish:function(){for(let n=t,i=e.length;n<i;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||vP),i.length>1&&i.sort(t||yP),r.length>1&&r.sort(t||yP)}}}function wP(){let e=new WeakMap;return{get:function(t,n){const i=e.get(t);let r;return void 0===i?(r=new CP,e.set(t,[r])):n>=i.length?(r=new CP,i.push(r)):r=i[n],r},dispose:function(){e=new WeakMap}}}function SP(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new ey,color:new bC};break;case"SpotLight":n={position:new ey,direction:new ey,color:new bC,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new ey,color:new bC,distance:0,decay:0};break;case"HemisphereLight":n={direction:new ey,skyColor:new bC,groundColor:new bC};break;case"RectAreaLight":n={color:new bC,position:new ey,halfWidth:new ey,halfHeight:new ey}}return e[t.id]=n,n}}}let bP=0;function xP(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function _P(e){const t=new SP,n=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xv};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xv,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let a=0;a<9;a++)i.probe.push(new ey);const r=new ey,s=new Ay,o=new Ay;return{setup:function(r){let s=0,o=0,a=0;for(let e=0;e<9;e++)i.probe[e].set(0,0,0);let l=0,c=0,u=0,h=0,d=0,p=0,g=0,f=0,m=0,v=0,y=0;r.sort(xP);for(let e=0,w=r.length;e<w;e++){const C=r[e],w=C.color,S=C.intensity,b=C.distance,x=C.shadow&&C.shadow.map?C.shadow.map.texture:null;if(C.isAmbientLight)s+=w.r*S,o+=w.g*S,a+=w.b*S;else if(C.isLightProbe){for(let e=0;e<9;e++)i.probe[e].addScaledVector(C.sh.coefficients[e],S);y++}else if(C.isDirectionalLight){const e=t.get(C);if(e.color.copy(C.color).multiplyScalar(C.intensity),C.castShadow){const e=C.shadow,t=n.get(C);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,i.directionalShadow[l]=t,i.directionalShadowMap[l]=x,i.directionalShadowMatrix[l]=C.shadow.matrix,p++}i.directional[l]=e,l++}else if(C.isSpotLight){const e=t.get(C);e.position.setFromMatrixPosition(C.matrixWorld),e.color.copy(w).multiplyScalar(S),e.distance=b,e.coneCos=Math.cos(C.angle),e.penumbraCos=Math.cos(C.angle*(1-C.penumbra)),e.decay=C.decay,i.spot[u]=e;const r=C.shadow;if(C.map&&(i.spotLightMap[m]=C.map,m++,r.updateMatrices(C),C.castShadow&&v++),i.spotLightMatrix[u]=r.matrix,C.castShadow){const e=n.get(C);e.shadowIntensity=r.intensity,e.shadowBias=r.bias,e.shadowNormalBias=r.normalBias,e.shadowRadius=r.radius,e.shadowMapSize=r.mapSize,i.spotShadow[u]=e,i.spotShadowMap[u]=x,f++}u++}else if(C.isRectAreaLight){const e=t.get(C);e.color.copy(w).multiplyScalar(S),e.halfWidth.set(.5*C.width,0,0),e.halfHeight.set(0,.5*C.height,0),i.rectArea[h]=e,h++}else if(C.isPointLight){const e=t.get(C);if(e.color.copy(C.color).multiplyScalar(C.intensity),e.distance=C.distance,e.decay=C.decay,C.castShadow){const e=C.shadow,t=n.get(C);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,i.pointShadow[c]=t,i.pointShadowMap[c]=x,i.pointShadowMatrix[c]=C.shadow.matrix,g++}i.point[c]=e,c++}else if(C.isHemisphereLight){const e=t.get(C);e.skyColor.copy(C.color).multiplyScalar(S),e.groundColor.copy(C.groundColor).multiplyScalar(S),i.hemi[d]=e,d++}}h>0&&(!0===e.has("OES_texture_float_linear")?(i.rectAreaLTC1=sR.LTC_FLOAT_1,i.rectAreaLTC2=sR.LTC_FLOAT_2):(i.rectAreaLTC1=sR.LTC_HALF_1,i.rectAreaLTC2=sR.LTC_HALF_2)),i.ambient[0]=s,i.ambient[1]=o,i.ambient[2]=a;const C=i.hash;C.directionalLength===l&&C.pointLength===c&&C.spotLength===u&&C.rectAreaLength===h&&C.hemiLength===d&&C.numDirectionalShadows===p&&C.numPointShadows===g&&C.numSpotShadows===f&&C.numSpotMaps===m&&C.numLightProbes===y||(i.directional.length=l,i.spot.length=u,i.rectArea.length=h,i.point.length=c,i.hemi.length=d,i.directionalShadow.length=p,i.directionalShadowMap.length=p,i.pointShadow.length=g,i.pointShadowMap.length=g,i.spotShadow.length=f,i.spotShadowMap.length=f,i.directionalShadowMatrix.length=p,i.pointShadowMatrix.length=g,i.spotLightMatrix.length=f+m-v,i.spotLightMap.length=m,i.numSpotLightShadowsWithMaps=v,i.numLightProbes=y,C.directionalLength=l,C.pointLength=c,C.spotLength=u,C.rectAreaLength=h,C.hemiLength=d,C.numDirectionalShadows=p,C.numPointShadows=g,C.numSpotShadows=f,C.numSpotMaps=m,C.numLightProbes=y,i.version=bP++)},setupView:function(e,t){let n=0,a=0,l=0,c=0,u=0;const h=t.matrixWorldInverse;for(let d=0,p=e.length;d<p;d++){const t=e[d];if(t.isDirectionalLight){const e=i.directional[n];e.direction.setFromMatrixPosition(t.matrixWorld),r.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(r),e.direction.transformDirection(h),n++}else if(t.isSpotLight){const e=i.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(t.matrixWorld),r.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(r),e.direction.transformDirection(h),l++}else if(t.isRectAreaLight){const e=i.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),o.identity(),s.copy(t.matrixWorld),s.premultiply(h),o.extractRotation(s),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(o),e.halfHeight.applyMatrix4(o),c++}else if(t.isPointLight){const e=i.point[a];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),a++}else if(t.isHemisphereLight){const e=i.hemi[u];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(h),u++}}},state:i}}function MP(e){const t=new _P(e),n=[],i=[];const r={lightsArray:n,shadowsArray:i,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){r.camera=e,n.length=0,i.length=0},state:r,setupLights:function(){t.setup(n)},setupLightsView:function(e){t.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){i.push(e)}}}function EP(e){let t=new WeakMap;return{get:function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=t.get(n);let s;return void 0===r?(s=new MP(e),t.set(n,[s])):i>=r.length?(s=new MP(e),r.push(s)):s=r[i],s},dispose:function(){t=new WeakMap}}}function RP(e,t,n){let i=new FS;const r=new xv,s=new xv,o=new qv,a=new u_({depthPacking:fm}),l=new h_,c={},u=n.maxTextureSize,h={[Np]:Bp,[Bp]:Np,[zp]:zp},d=new vw({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new xv},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const g=new JC;g.setAttribute("position",new kC(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const f=new uw(g,d),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Ip;let v=this.type;function y(n,i){const s=t.update(f);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new Kv(r.x,r.y)),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(i,null,s,d,f,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(i,null,s,p,f,null)}function C(t,n,i,r){let s=null;const o=!0===i.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==o)s=o;else if(s=!0===i.isPointLight?l:a,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0||!0===n.alphaToCoverage){const e=s.uuid,t=n.uuid;let i=c[e];void 0===i&&(i={},c[e]=i);let r=i[t];void 0===r&&(r=s.clone(),i[t]=r,n.addEventListener("dispose",S)),s=r}if(s.visible=n.visible,s.wireframe=n.wireframe,s.side=r===Op?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:h[n.side],s.alphaMap=n.alphaMap,s.alphaTest=!0===n.alphaToCoverage?.5:n.alphaTest,s.map=n.map,s.clipShadows=n.clipShadows,s.clippingPlanes=n.clippingPlanes,s.clipIntersection=n.clipIntersection,s.displacementMap=n.displacementMap,s.displacementScale=n.displacementScale,s.displacementBias=n.displacementBias,s.wireframeLinewidth=n.wireframeLinewidth,s.linewidth=n.linewidth,!0===i.isPointLight&&!0===s.isMeshDistanceMaterial){e.properties.get(s).light=i}return s}function w(n,r,s,o,a){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&a===Op)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);const i=t.update(n),l=n.material;if(Array.isArray(l)){const t=i.groups;for(let c=0,u=t.length;c<u;c++){const u=t[c],h=l[u.materialIndex];if(h&&h.visible){const t=C(n,h,o,a);n.onBeforeShadow(e,n,r,s,i,t,u),e.renderBufferDirect(s,null,i,t,n,u),n.onAfterShadow(e,n,r,s,i,t,u)}}}else if(l.visible){const t=C(n,l,o,a);n.onBeforeShadow(e,n,r,s,i,t,null),e.renderBufferDirect(s,null,i,t,n,null),n.onAfterShadow(e,n,r,s,i,t,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)w(l[e],r,s,o,a)}function S(e){e.target.removeEventListener("dispose",S);for(const t in c){const n=c[t],i=e.target.uuid;if(i in n){n[i].dispose(),delete n[i]}}}this.render=function(t,n,a){if(!1===m.enabled)return;if(!1===m.autoUpdate&&!1===m.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),d=e.state;d.setBlending(Hp),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);const p=v!==Op&&this.type===Op,g=v===Op&&this.type!==Op;for(let f=0,m=t.length;f<m;f++){const l=t[f],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;r.copy(c.mapSize);const h=c.getFrameExtents();if(r.multiply(h),s.copy(c.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/h.x),r.x=s.x*h.x,c.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/h.y),r.y=s.y*h.y,c.mapSize.y=s.y)),null===c.map||!0===p||!0===g){const e=this.type!==Op?{minFilter:Ug,magFilter:Ug}:{};null!==c.map&&c.map.dispose(),c.map=new Kv(r.x,r.y,e),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()}e.setRenderTarget(c.map),e.clear();const m=c.getViewportCount();for(let e=0;e<m;e++){const t=c.getViewport(e);o.set(s.x*t.x,s.y*t.y,s.x*t.z,s.y*t.w),d.viewport(o),c.updateMatrices(l,e),i=c.getFrustum(),w(n,a,c.camera,l,this.type)}!0!==c.isPointLightShadow&&this.type===Op&&y(c,a),c.needsUpdate=!1}v=this.type,m.needsUpdate=!1,e.setRenderTarget(l,c,h)}}const TP={[dg]:pg,[gg]:yg,[mg]:Cg,[fg]:vg,[pg]:dg,[yg]:gg,[Cg]:mg,[vg]:fg};function PP(e,t){const n=new function(){let t=!1;const n=new qv;let i=null;const r=new qv(0,0,0,0);return{setMask:function(n){i===n||t||(e.colorMask(n,n,n,n),i=n)},setLocked:function(e){t=e},setClear:function(t,i,s,o,a){!0===a&&(t*=o,i*=o,s*=o),n.set(t,i,s,o),!1===r.equals(n)&&(e.clearColor(t,i,s,o),r.copy(n))},reset:function(){t=!1,i=null,r.set(-1,0,0,0)}}},i=new function(){let n=!1,i=!1,r=null,s=null,o=null;return{setReversed:function(e){if(i!==e){const n=t.get("EXT_clip_control");e?n.clipControlEXT(n.LOWER_LEFT_EXT,n.ZERO_TO_ONE_EXT):n.clipControlEXT(n.LOWER_LEFT_EXT,n.NEGATIVE_ONE_TO_ONE_EXT),i=e;const r=o;o=null,this.setClear(r)}},getReversed:function(){return i},setTest:function(t){t?H(e.DEPTH_TEST):G(e.DEPTH_TEST)},setMask:function(t){r===t||n||(e.depthMask(t),r=t)},setFunc:function(t){if(i&&(t=TP[t]),s!==t){switch(t){case dg:e.depthFunc(e.NEVER);break;case pg:e.depthFunc(e.ALWAYS);break;case gg:e.depthFunc(e.LESS);break;case fg:e.depthFunc(e.LEQUAL);break;case mg:e.depthFunc(e.EQUAL);break;case vg:e.depthFunc(e.GEQUAL);break;case yg:e.depthFunc(e.GREATER);break;case Cg:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}s=t}},setLocked:function(e){n=e},setClear:function(t){o!==t&&(i&&(t=1-t),e.clearDepth(t),o=t)},reset:function(){n=!1,r=null,s=null,o=null,i=!1}}},r=new function(){let t=!1,n=null,i=null,r=null,s=null,o=null,a=null,l=null,c=null;return{setTest:function(n){t||(n?H(e.STENCIL_TEST):G(e.STENCIL_TEST))},setMask:function(i){n===i||t||(e.stencilMask(i),n=i)},setFunc:function(t,n,o){i===t&&r===n&&s===o||(e.stencilFunc(t,n,o),i=t,r=n,s=o)},setOp:function(t,n,i){o===t&&a===n&&l===i||(e.stencilOp(t,n,i),o=t,a=n,l=i)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,i=null,r=null,s=null,o=null,a=null,l=null,c=null}}},s=new WeakMap,o=new WeakMap;let a={},l={},c=new WeakMap,u=[],h=null,d=!1,p=null,g=null,f=null,m=null,v=null,y=null,C=null,w=new bC(0,0,0),S=0,b=!1,x=null,_=null,M=null,E=null,R=null;const T=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let P=!1,A=0;const F=e.getParameter(e.VERSION);-1!==F.indexOf("WebGL")?(A=parseFloat(/^WebGL (\d)/.exec(F)[1]),P=A>=1):-1!==F.indexOf("OpenGL ES")&&(A=parseFloat(/^OpenGL ES (\d)/.exec(F)[1]),P=A>=2);let D=null,L={};const I=e.getParameter(e.SCISSOR_BOX),k=e.getParameter(e.VIEWPORT),O=(new qv).fromArray(I),N=(new qv).fromArray(k);function B(t,n,i,r){const s=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let a=0;a<i;a++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,r,0,e.RGBA,e.UNSIGNED_BYTE,s):e.texImage2D(n+a,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s);return o}const z={};function H(t){!0!==a[t]&&(e.enable(t),a[t]=!0)}function G(t){!1!==a[t]&&(e.disable(t),a[t]=!1)}z[e.TEXTURE_2D]=B(e.TEXTURE_2D,e.TEXTURE_2D,1),z[e.TEXTURE_CUBE_MAP]=B(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),z[e.TEXTURE_2D_ARRAY]=B(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),z[e.TEXTURE_3D]=B(e.TEXTURE_3D,e.TEXTURE_3D,1,1),n.setClear(0,0,0,1),i.setClear(1),r.setClear(0),H(e.DEPTH_TEST),i.setFunc(fg),j(!1),q(Ap),H(e.CULL_FACE),W(Hp);const U={[qp]:e.FUNC_ADD,[Xp]:e.FUNC_SUBTRACT,[Kp]:e.FUNC_REVERSE_SUBTRACT};U[$p]=e.MIN,U[Zp]=e.MAX;const V={[Yp]:e.ZERO,[Jp]:e.ONE,[Qp]:e.SRC_COLOR,[tg]:e.SRC_ALPHA,[ag]:e.SRC_ALPHA_SATURATE,[sg]:e.DST_COLOR,[ig]:e.DST_ALPHA,[eg]:e.ONE_MINUS_SRC_COLOR,[ng]:e.ONE_MINUS_SRC_ALPHA,[og]:e.ONE_MINUS_DST_COLOR,[rg]:e.ONE_MINUS_DST_ALPHA,[lg]:e.CONSTANT_COLOR,[cg]:e.ONE_MINUS_CONSTANT_COLOR,[ug]:e.CONSTANT_ALPHA,[hg]:e.ONE_MINUS_CONSTANT_ALPHA};function W(t,n,i,r,s,o,a,l,c,u){if(t!==Hp){if(!1===d&&(H(e.BLEND),d=!0),t===jp)s=s||n,o=o||i,a=a||r,n===g&&s===v||(e.blendEquationSeparate(U[n],U[s]),g=n,v=s),i===f&&r===m&&o===y&&a===C||(e.blendFuncSeparate(V[i],V[r],V[o],V[a]),f=i,m=r,y=o,C=a),!1!==l.equals(w)&&c===S||(e.blendColor(l.r,l.g,l.b,c),w.copy(l),S=c),p=t,b=!1;else if(t!==p||u!==b){if(g===qp&&v===qp||(e.blendEquation(e.FUNC_ADD),g=qp,v=qp),u)switch(t){case Gp:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case Up:e.blendFunc(e.ONE,e.ONE);break;case Vp:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case Wp:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case Gp:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case Up:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case Vp:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case Wp:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}f=null,m=null,y=null,C=null,w.set(0,0,0),S=0,p=t,b=u}}else!0===d&&(G(e.BLEND),d=!1)}function j(t){x!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),x=t)}function q(t){t!==Pp?(H(e.CULL_FACE),t!==_&&(t===Ap?e.cullFace(e.BACK):t===Fp?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):G(e.CULL_FACE),_=t}function X(t,n,i){t?(H(e.POLYGON_OFFSET_FILL),E===n&&R===i||(e.polygonOffset(n,i),E=n,R=i)):G(e.POLYGON_OFFSET_FILL)}return{buffers:{color:n,depth:i,stencil:r},enable:H,disable:G,bindFramebuffer:function(t,n){return l[t]!==n&&(e.bindFramebuffer(t,n),l[t]=n,t===e.DRAW_FRAMEBUFFER&&(l[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(l[e.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(t,n){let i=u,r=!1;if(t){i=c.get(n),void 0===i&&(i=[],c.set(n,i));const s=t.textures;if(i.length!==s.length||i[0]!==e.COLOR_ATTACHMENT0){for(let t=0,n=s.length;t<n;t++)i[t]=e.COLOR_ATTACHMENT0+t;i.length=s.length,r=!0}}else i[0]!==e.BACK&&(i[0]=e.BACK,r=!0);r&&e.drawBuffers(i)},useProgram:function(t){return h!==t&&(e.useProgram(t),h=t,!0)},setBlending:W,setMaterial:function(t,s){t.side===zp?G(e.CULL_FACE):H(e.CULL_FACE);let o=t.side===Bp;s&&(o=!o),j(o),t.blending===Gp&&!1===t.transparent?W(Hp):W(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),i.setFunc(t.depthFunc),i.setTest(t.depthTest),i.setMask(t.depthWrite),n.setMask(t.colorWrite);const a=t.stencilWrite;r.setTest(a),a&&(r.setMask(t.stencilWriteMask),r.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),r.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),X(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?H(e.SAMPLE_ALPHA_TO_COVERAGE):G(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:j,setCullFace:q,setLineWidth:function(t){t!==M&&(P&&e.lineWidth(t),M=t)},setPolygonOffset:X,setScissorTest:function(t){t?H(e.SCISSOR_TEST):G(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+T-1),D!==t&&(e.activeTexture(t),D=t)},bindTexture:function(t,n,i){void 0===i&&(i=null===D?e.TEXTURE0+T-1:D);let r=L[i];void 0===r&&(r={type:void 0,texture:void 0},L[i]=r),r.type===t&&r.texture===n||(D!==i&&(e.activeTexture(i),D=i),e.bindTexture(t,n||z[t]),r.type=t,r.texture=n)},unbindTexture:function(){const t=L[D];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D(...arguments)}catch(CF){console.error("THREE.WebGLState:",CF)}},compressedTexImage3D:function(){try{e.compressedTexImage3D(...arguments)}catch(CF){console.error("THREE.WebGLState:",CF)}},texImage2D:function(){try{e.texImage2D(...arguments)}catch(CF){console.error("THREE.WebGLState:",CF)}},texImage3D:function(){try{e.texImage3D(...arguments)}catch(CF){console.error("THREE.WebGLState:",CF)}},updateUBOMapping:function(t,n){let i=o.get(n);void 0===i&&(i=new WeakMap,o.set(n,i));let r=i.get(t);void 0===r&&(r=e.getUniformBlockIndex(n,t.name),i.set(t,r))},uniformBlockBinding:function(t,n){const i=o.get(n).get(t);s.get(n)!==i&&(e.uniformBlockBinding(n,i,t.__bindingPointIndex),s.set(n,i))},texStorage2D:function(){try{e.texStorage2D(...arguments)}catch(CF){console.error("THREE.WebGLState:",CF)}},texStorage3D:function(){try{e.texStorage3D(...arguments)}catch(CF){console.error("THREE.WebGLState:",CF)}},texSubImage2D:function(){try{e.texSubImage2D(...arguments)}catch(CF){console.error("THREE.WebGLState:",CF)}},texSubImage3D:function(){try{e.texSubImage3D(...arguments)}catch(CF){console.error("THREE.WebGLState:",CF)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D(...arguments)}catch(CF){console.error("THREE.WebGLState:",CF)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D(...arguments)}catch(CF){console.error("THREE.WebGLState:",CF)}},scissor:function(t){!1===O.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),O.copy(t))},viewport:function(t){!1===N.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),N.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),i.setReversed(!1),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),a={},D=null,L={},l={},c=new WeakMap,u=[],h=null,d=!1,p=null,g=null,f=null,m=null,v=null,y=null,C=null,w=new bC(0,0,0),S=0,b=!1,x=null,_=null,M=null,E=null,R=null,O.set(0,0,e.canvas.width,e.canvas.height),N.set(0,0,e.canvas.width,e.canvas.height),n.reset(),i.reset(),r.reset()}}}function AP(e,t,n,i,r,s,o){const a=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,l="undefined"!==typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new xv,u=new WeakMap;let h;const d=new WeakMap;let p=!1;try{p="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(V){}function g(e,t){return p?new OffscreenCanvas(e,t):Pv("canvas")}function f(e,t,n){let i=1;const r=U(e);if((r.width>n||r.height>n)&&(i=n/Math.max(r.width,r.height)),i<1){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof VideoFrame&&e instanceof VideoFrame){const n=Math.floor(i*r.width),s=Math.floor(i*r.height);void 0===h&&(h=g(n,s));const o=t?g(n,s):h;o.width=n,o.height=s;return o.getContext("2d").drawImage(e,0,0,n,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+r.width+"x"+r.height+") to ("+n+"x"+s+")."),o}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+r.width+"x"+r.height+")."),e}return e}function m(e){return e.generateMipmaps}function v(t){e.generateMipmap(t)}function y(t){return t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:t.isWebGL3DRenderTarget?e.TEXTURE_3D:t.isWebGLArrayRenderTarget||t.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function C(n,i,r,s){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let a=i;if(i===e.RED&&(r===e.FLOAT&&(a=e.R32F),r===e.HALF_FLOAT&&(a=e.R16F),r===e.UNSIGNED_BYTE&&(a=e.R8)),i===e.RED_INTEGER&&(r===e.UNSIGNED_BYTE&&(a=e.R8UI),r===e.UNSIGNED_SHORT&&(a=e.R16UI),r===e.UNSIGNED_INT&&(a=e.R32UI),r===e.BYTE&&(a=e.R8I),r===e.SHORT&&(a=e.R16I),r===e.INT&&(a=e.R32I)),i===e.RG&&(r===e.FLOAT&&(a=e.RG32F),r===e.HALF_FLOAT&&(a=e.RG16F),r===e.UNSIGNED_BYTE&&(a=e.RG8)),i===e.RG_INTEGER&&(r===e.UNSIGNED_BYTE&&(a=e.RG8UI),r===e.UNSIGNED_SHORT&&(a=e.RG16UI),r===e.UNSIGNED_INT&&(a=e.RG32UI),r===e.BYTE&&(a=e.RG8I),r===e.SHORT&&(a=e.RG16I),r===e.INT&&(a=e.RG32I)),i===e.RGB_INTEGER&&(r===e.UNSIGNED_BYTE&&(a=e.RGB8UI),r===e.UNSIGNED_SHORT&&(a=e.RGB16UI),r===e.UNSIGNED_INT&&(a=e.RGB32UI),r===e.BYTE&&(a=e.RGB8I),r===e.SHORT&&(a=e.RGB16I),r===e.INT&&(a=e.RGB32I)),i===e.RGBA_INTEGER&&(r===e.UNSIGNED_BYTE&&(a=e.RGBA8UI),r===e.UNSIGNED_SHORT&&(a=e.RGBA16UI),r===e.UNSIGNED_INT&&(a=e.RGBA32UI),r===e.BYTE&&(a=e.RGBA8I),r===e.SHORT&&(a=e.RGBA16I),r===e.INT&&(a=e.RGBA32I)),i===e.RGB&&r===e.UNSIGNED_INT_5_9_9_9_REV&&(a=e.RGB9_E5),i===e.RGBA){const t=o?xm:Ov.getTransfer(s);r===e.FLOAT&&(a=e.RGBA32F),r===e.HALF_FLOAT&&(a=e.RGBA16F),r===e.UNSIGNED_BYTE&&(a=t===_m?e.SRGB8_ALPHA8:e.RGBA8),r===e.UNSIGNED_SHORT_4_4_4_4&&(a=e.RGBA4),r===e.UNSIGNED_SHORT_5_5_5_1&&(a=e.RGB5_A1)}return a!==e.R16F&&a!==e.R32F&&a!==e.RG16F&&a!==e.RG32F&&a!==e.RGBA16F&&a!==e.RGBA32F||t.get("EXT_color_buffer_float"),a}function w(t,n){let i;return t?null===n||n===rf||n===cf?i=e.DEPTH24_STENCIL8:n===sf?i=e.DEPTH32F_STENCIL8:n===tf&&(i=e.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===n||n===rf||n===cf?i=e.DEPTH_COMPONENT24:n===sf?i=e.DEPTH_COMPONENT32F:n===tf&&(i=e.DEPTH_COMPONENT16),i}function S(e,t){return!0===m(e)||e.isFramebufferTexture&&e.minFilter!==Ug&&e.minFilter!==Xg?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function b(e){const t=e.target;t.removeEventListener("dispose",b),function(e){const t=i.get(e);if(void 0===t.__webglInit)return;const n=e.source,r=d.get(n);if(r){const i=r[t.__cacheKey];i.usedTimes--,0===i.usedTimes&&_(e),0===Object.keys(r).length&&d.delete(n)}i.remove(e)}(t),t.isVideoTexture&&u.delete(t)}function x(t){const n=t.target;n.removeEventListener("dispose",x),function(t){const n=i.get(t);t.depthTexture&&(t.depthTexture.dispose(),i.remove(t.depthTexture));if(t.isWebGLCubeRenderTarget)for(let i=0;i<6;i++){if(Array.isArray(n.__webglFramebuffer[i]))for(let t=0;t<n.__webglFramebuffer[i].length;t++)e.deleteFramebuffer(n.__webglFramebuffer[i][t]);else e.deleteFramebuffer(n.__webglFramebuffer[i]);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[i])}else{if(Array.isArray(n.__webglFramebuffer))for(let t=0;t<n.__webglFramebuffer.length;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let t=0;t<n.__webglColorRenderbuffer.length;t++)n.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(n.__webglColorRenderbuffer[t]);n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const r=t.textures;for(let s=0,a=r.length;s<a;s++){const t=i.get(r[s]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),o.memory.textures--),i.remove(r[s])}i.remove(t)}(n)}function _(t){const n=i.get(t);e.deleteTexture(n.__webglTexture);const r=t.source;delete d.get(r)[n.__cacheKey],o.memory.textures--}let M=0;function E(t,r){const s=i.get(t);if(t.isVideoTexture&&function(e){const t=o.render.frame;u.get(e)!==t&&(u.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&s.__version!==t.version){const e=t.image;if(null===e)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void D(s,t,r);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(e.TEXTURE_2D,s.__webglTexture,e.TEXTURE0+r)}const R={[zg]:e.REPEAT,[Hg]:e.CLAMP_TO_EDGE,[Gg]:e.MIRRORED_REPEAT},T={[Ug]:e.NEAREST,[Vg]:e.NEAREST_MIPMAP_NEAREST,[jg]:e.NEAREST_MIPMAP_LINEAR,[Xg]:e.LINEAR,[Kg]:e.LINEAR_MIPMAP_NEAREST,[Zg]:e.LINEAR_MIPMAP_LINEAR},P={[Gm]:e.NEVER,[Km]:e.ALWAYS,[Um]:e.LESS,[Wm]:e.LEQUAL,[Vm]:e.EQUAL,[Xm]:e.GEQUAL,[jm]:e.GREATER,[qm]:e.NOTEQUAL};function A(n,s){if(s.type!==sf||!1!==t.has("OES_texture_float_linear")||s.magFilter!==Xg&&s.magFilter!==Kg&&s.magFilter!==jg&&s.magFilter!==Zg&&s.minFilter!==Xg&&s.minFilter!==Kg&&s.minFilter!==jg&&s.minFilter!==Zg||console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(n,e.TEXTURE_WRAP_S,R[s.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,R[s.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,R[s.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,T[s.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,T[s.minFilter]),s.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,P[s.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){if(s.magFilter===Ug)return;if(s.minFilter!==jg&&s.minFilter!==Zg)return;if(s.type===sf&&!1===t.has("OES_texture_float_linear"))return;if(s.anisotropy>1||i.get(s).__currentAnisotropy){const o=t.get("EXT_texture_filter_anisotropic");e.texParameterf(n,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy}}}function F(t,n){let i=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",b));const r=n.source;let s=d.get(r);void 0===s&&(s={},d.set(r,s));const a=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(a!==t.__cacheKey){void 0===s[a]&&(s[a]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,i=!0),s[a].usedTimes++;const r=s[t.__cacheKey];void 0!==r&&(s[t.__cacheKey].usedTimes--,0===r.usedTimes&&_(n)),t.__cacheKey=a,t.__webglTexture=s[a].texture}return i}function D(t,o,a){let l=e.TEXTURE_2D;(o.isDataArrayTexture||o.isCompressedArrayTexture)&&(l=e.TEXTURE_2D_ARRAY),o.isData3DTexture&&(l=e.TEXTURE_3D);const c=F(t,o),u=o.source;n.bindTexture(l,t.__webglTexture,e.TEXTURE0+a);const h=i.get(u);if(u.version!==h.__version||!0===c){n.activeTexture(e.TEXTURE0+a);const t=Ov.getPrimaries(Ov.workingColorSpace),i=o.colorSpace===wm?null:Ov.getPrimaries(o.colorSpace),d=o.colorSpace===wm||t===i?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);let p=f(o.image,!1,r.maxTextureSize);p=G(o,p);const g=s.convert(o.format,o.colorSpace),y=s.convert(o.type);let b,x=C(o.internalFormat,g,y,o.colorSpace,o.isVideoTexture);A(l,o);const _=o.mipmaps,M=!0!==o.isVideoTexture,E=void 0===h.__version||!0===c,R=u.dataReady,T=S(o,p);if(o.isDepthTexture)x=w(o.format===ff,o.type),E&&(M?n.texStorage2D(e.TEXTURE_2D,1,x,p.width,p.height):n.texImage2D(e.TEXTURE_2D,0,x,p.width,p.height,0,g,y,null));else if(o.isDataTexture)if(_.length>0){M&&E&&n.texStorage2D(e.TEXTURE_2D,T,x,_[0].width,_[0].height);for(let t=0,i=_.length;t<i;t++)b=_[t],M?R&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,b.width,b.height,g,y,b.data):n.texImage2D(e.TEXTURE_2D,t,x,b.width,b.height,0,g,y,b.data);o.generateMipmaps=!1}else M?(E&&n.texStorage2D(e.TEXTURE_2D,T,x,p.width,p.height),R&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,p.width,p.height,g,y,p.data)):n.texImage2D(e.TEXTURE_2D,0,x,p.width,p.height,0,g,y,p.data);else if(o.isCompressedTexture)if(o.isCompressedArrayTexture){M&&E&&n.texStorage3D(e.TEXTURE_2D_ARRAY,T,x,_[0].width,_[0].height,p.depth);for(let t=0,i=_.length;t<i;t++)if(b=_[t],o.format!==pf)if(null!==g)if(M){if(R)if(o.layerUpdates.size>0){const i=eR(b.width,b.height,o.format,o.type);for(const r of o.layerUpdates){const s=b.data.subarray(r*i/b.data.BYTES_PER_ELEMENT,(r+1)*i/b.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,r,b.width,b.height,1,g,s)}o.clearLayerUpdates()}else n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,b.width,b.height,p.depth,g,b.data)}else n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,x,b.width,b.height,p.depth,0,b.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else M?R&&n.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,b.width,b.height,p.depth,g,y,b.data):n.texImage3D(e.TEXTURE_2D_ARRAY,t,x,b.width,b.height,p.depth,0,g,y,b.data)}else{M&&E&&n.texStorage2D(e.TEXTURE_2D,T,x,_[0].width,_[0].height);for(let t=0,i=_.length;t<i;t++)b=_[t],o.format!==pf?null!==g?M?R&&n.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,b.width,b.height,g,b.data):n.compressedTexImage2D(e.TEXTURE_2D,t,x,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):M?R&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,b.width,b.height,g,y,b.data):n.texImage2D(e.TEXTURE_2D,t,x,b.width,b.height,0,g,y,b.data)}else if(o.isDataArrayTexture)if(M){if(E&&n.texStorage3D(e.TEXTURE_2D_ARRAY,T,x,p.width,p.height,p.depth),R)if(o.layerUpdates.size>0){const t=eR(p.width,p.height,o.format,o.type);for(const i of o.layerUpdates){const r=p.data.subarray(i*t/p.data.BYTES_PER_ELEMENT,(i+1)*t/p.data.BYTES_PER_ELEMENT);n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,i,p.width,p.height,1,g,y,r)}o.clearLayerUpdates()}else n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,p.width,p.height,p.depth,g,y,p.data)}else n.texImage3D(e.TEXTURE_2D_ARRAY,0,x,p.width,p.height,p.depth,0,g,y,p.data);else if(o.isData3DTexture)M?(E&&n.texStorage3D(e.TEXTURE_3D,T,x,p.width,p.height,p.depth),R&&n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,p.width,p.height,p.depth,g,y,p.data)):n.texImage3D(e.TEXTURE_3D,0,x,p.width,p.height,p.depth,0,g,y,p.data);else if(o.isFramebufferTexture){if(E)if(M)n.texStorage2D(e.TEXTURE_2D,T,x,p.width,p.height);else{let t=p.width,i=p.height;for(let r=0;r<T;r++)n.texImage2D(e.TEXTURE_2D,r,x,t,i,0,g,y,null),t>>=1,i>>=1}}else if(_.length>0){if(M&&E){const t=U(_[0]);n.texStorage2D(e.TEXTURE_2D,T,x,t.width,t.height)}for(let t=0,i=_.length;t<i;t++)b=_[t],M?R&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,g,y,b):n.texImage2D(e.TEXTURE_2D,t,x,g,y,b);o.generateMipmaps=!1}else if(M){if(E){const t=U(p);n.texStorage2D(e.TEXTURE_2D,T,x,t.width,t.height)}R&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,g,y,p)}else n.texImage2D(e.TEXTURE_2D,0,x,g,y,p);m(o)&&v(l),h.__version=u.version,o.onUpdate&&o.onUpdate(o)}t.__version=o.version}function L(t,r,o,l,c,u){const h=s.convert(o.format,o.colorSpace),d=s.convert(o.type),p=C(o.internalFormat,h,d,o.colorSpace),g=i.get(r),f=i.get(o);if(f.__renderTarget=r,!g.__hasExternalTextures){const t=Math.max(1,r.width>>u),i=Math.max(1,r.height>>u);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?n.texImage3D(c,u,p,t,i,r.depth,0,h,d,null):n.texImage2D(c,u,p,t,i,0,h,d,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),H(r)?a.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,l,c,f.__webglTexture,0,z(r)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,l,c,f.__webglTexture,u),n.bindFramebuffer(e.FRAMEBUFFER,null)}function I(t,n,i){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer){const r=n.depthTexture,s=r&&r.isDepthTexture?r.type:null,o=w(n.stencilBuffer,s),l=n.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,c=z(n);H(n)?a.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,c,o,n.width,n.height):i?e.renderbufferStorageMultisample(e.RENDERBUFFER,c,o,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,o,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,l,e.RENDERBUFFER,t)}else{const t=n.textures;for(let r=0;r<t.length;r++){const o=t[r],l=s.convert(o.format,o.colorSpace),c=s.convert(o.type),u=C(o.internalFormat,l,c,o.colorSpace),h=z(n);i&&!1===H(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,h,u,n.width,n.height):H(n)?a.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,h,u,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,u,n.width,n.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function k(t,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const s=i.get(r.depthTexture);s.__renderTarget=r,s.__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),E(r.depthTexture,0);const o=s.__webglTexture,l=z(r);if(r.depthTexture.format===gf)H(r)?a.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,o,0,l):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,o,0);else{if(r.depthTexture.format!==ff)throw new Error("Unknown depthTexture format");H(r)?a.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,o,0,l):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,o,0)}}function O(t){const r=i.get(t),s=!0===t.isWebGLCubeRenderTarget;if(r.__boundDepthTexture!==t.depthTexture){const e=t.depthTexture;if(r.__depthDisposeCallback&&r.__depthDisposeCallback(),e){const t=()=>{delete r.__boundDepthTexture,delete r.__depthDisposeCallback,e.removeEventListener("dispose",t)};e.addEventListener("dispose",t),r.__depthDisposeCallback=t}r.__boundDepthTexture=e}if(t.depthTexture&&!r.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");const e=t.texture.mipmaps;e&&e.length>0?k(r.__webglFramebuffer[0],t):k(r.__webglFramebuffer,t)}else if(s){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)if(n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[i]),void 0===r.__webglDepthbuffer[i])r.__webglDepthbuffer[i]=e.createRenderbuffer(),I(r.__webglDepthbuffer[i],t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,s=r.__webglDepthbuffer[i];e.bindRenderbuffer(e.RENDERBUFFER,s),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,s)}}else{const i=t.texture.mipmaps;if(i&&i.length>0?n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[0]):n.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer),void 0===r.__webglDepthbuffer)r.__webglDepthbuffer=e.createRenderbuffer(),I(r.__webglDepthbuffer,t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,i=r.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,i),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,i)}}n.bindFramebuffer(e.FRAMEBUFFER,null)}const N=[],B=[];function z(e){return Math.min(r.maxSamples,e.samples)}function H(e){const n=i.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function G(e,t){const n=e.colorSpace,i=e.format,r=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||n!==bm&&n!==wm&&(Ov.getTransfer(n)===_m?i===pf&&r===Jg||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",n)),t}function U(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement?(c.width=e.naturalWidth||e.width,c.height=e.naturalHeight||e.height):"undefined"!==typeof VideoFrame&&e instanceof VideoFrame?(c.width=e.displayWidth,c.height=e.displayHeight):(c.width=e.width,c.height=e.height),c}this.allocateTextureUnit=function(){const e=M;return e>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+r.maxTextures),M+=1,e},this.resetTextureUnits=function(){M=0},this.setTexture2D=E,this.setTexture2DArray=function(t,r){const s=i.get(t);t.version>0&&s.__version!==t.version?D(s,t,r):n.bindTexture(e.TEXTURE_2D_ARRAY,s.__webglTexture,e.TEXTURE0+r)},this.setTexture3D=function(t,r){const s=i.get(t);t.version>0&&s.__version!==t.version?D(s,t,r):n.bindTexture(e.TEXTURE_3D,s.__webglTexture,e.TEXTURE0+r)},this.setTextureCube=function(t,o){const a=i.get(t);t.version>0&&a.__version!==t.version?function(t,o,a){if(6!==o.image.length)return;const l=F(t,o),c=o.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+a);const u=i.get(c);if(c.version!==u.__version||!0===l){n.activeTexture(e.TEXTURE0+a);const t=Ov.getPrimaries(Ov.workingColorSpace),i=o.colorSpace===wm?null:Ov.getPrimaries(o.colorSpace),h=o.colorSpace===wm||t===i?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,h);const d=o.isCompressedTexture||o.image[0].isCompressedTexture,p=o.image[0]&&o.image[0].isDataTexture,g=[];for(let e=0;e<6;e++)g[e]=d||p?p?o.image[e].image:o.image[e]:f(o.image[e],!0,r.maxCubemapSize),g[e]=G(o,g[e]);const y=g[0],w=s.convert(o.format,o.colorSpace),b=s.convert(o.type),x=C(o.internalFormat,w,b,o.colorSpace),_=!0!==o.isVideoTexture,M=void 0===u.__version||!0===l,E=c.dataReady;let R,T=S(o,y);if(A(e.TEXTURE_CUBE_MAP,o),d){_&&M&&n.texStorage2D(e.TEXTURE_CUBE_MAP,T,x,y.width,y.height);for(let t=0;t<6;t++){R=g[t].mipmaps;for(let i=0;i<R.length;i++){const r=R[i];o.format!==pf?null!==w?_?E&&n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,0,0,r.width,r.height,w,r.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,x,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):_?E&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,0,0,r.width,r.height,w,b,r.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i,x,r.width,r.height,0,w,b,r.data)}}}else{if(R=o.mipmaps,_&&M){R.length>0&&T++;const t=U(g[0]);n.texStorage2D(e.TEXTURE_CUBE_MAP,T,x,t.width,t.height)}for(let t=0;t<6;t++)if(p){_?E&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,g[t].width,g[t].height,w,b,g[t].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,x,g[t].width,g[t].height,0,w,b,g[t].data);for(let i=0;i<R.length;i++){const r=R[i].image[t].image;_?E&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,0,0,r.width,r.height,w,b,r.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,x,r.width,r.height,0,w,b,r.data)}}else{_?E&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,w,b,g[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,x,w,b,g[t]);for(let i=0;i<R.length;i++){const r=R[i];_?E&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,0,0,w,b,r.image[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,i+1,x,w,b,r.image[t])}}}m(o)&&v(e.TEXTURE_CUBE_MAP),u.__version=c.version,o.onUpdate&&o.onUpdate(o)}t.__version=o.version}(a,t,o):n.bindTexture(e.TEXTURE_CUBE_MAP,a.__webglTexture,e.TEXTURE0+o)},this.rebindTextures=function(t,n,r){const s=i.get(t);void 0!==n&&L(s.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==r&&O(t)},this.setupRenderTarget=function(t){const r=t.texture,a=i.get(t),l=i.get(r);t.addEventListener("dispose",x);const c=t.textures,u=!0===t.isWebGLCubeRenderTarget,h=c.length>1;if(h||(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=r.version,o.memory.textures++),u){a.__webglFramebuffer=[];for(let t=0;t<6;t++)if(r.mipmaps&&r.mipmaps.length>0){a.__webglFramebuffer[t]=[];for(let n=0;n<r.mipmaps.length;n++)a.__webglFramebuffer[t][n]=e.createFramebuffer()}else a.__webglFramebuffer[t]=e.createFramebuffer()}else{if(r.mipmaps&&r.mipmaps.length>0){a.__webglFramebuffer=[];for(let t=0;t<r.mipmaps.length;t++)a.__webglFramebuffer[t]=e.createFramebuffer()}else a.__webglFramebuffer=e.createFramebuffer();if(h)for(let t=0,n=c.length;t<n;t++){const n=i.get(c[t]);void 0===n.__webglTexture&&(n.__webglTexture=e.createTexture(),o.memory.textures++)}if(t.samples>0&&!1===H(t)){a.__webglMultisampledFramebuffer=e.createFramebuffer(),a.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,a.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const i=c[n];a.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,a.__webglColorRenderbuffer[n]);const r=s.convert(i.format,i.colorSpace),o=s.convert(i.type),l=C(i.internalFormat,r,o,i.colorSpace,!0===t.isXRRenderTarget),u=z(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,u,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,e.RENDERBUFFER,a.__webglColorRenderbuffer[n])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(a.__webglDepthRenderbuffer=e.createRenderbuffer(),I(a.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(u){n.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),A(e.TEXTURE_CUBE_MAP,r);for(let n=0;n<6;n++)if(r.mipmaps&&r.mipmaps.length>0)for(let i=0;i<r.mipmaps.length;i++)L(a.__webglFramebuffer[n][i],t,r,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i);else L(a.__webglFramebuffer[n],t,r,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);m(r)&&v(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(h){for(let r=0,s=c.length;r<s;r++){const s=c[r],o=i.get(s);n.bindTexture(e.TEXTURE_2D,o.__webglTexture),A(e.TEXTURE_2D,s),L(a.__webglFramebuffer,t,s,e.COLOR_ATTACHMENT0+r,e.TEXTURE_2D,0),m(s)&&v(e.TEXTURE_2D)}n.unbindTexture()}else{let i=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(i=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(i,l.__webglTexture),A(i,r),r.mipmaps&&r.mipmaps.length>0)for(let n=0;n<r.mipmaps.length;n++)L(a.__webglFramebuffer[n],t,r,e.COLOR_ATTACHMENT0,i,n);else L(a.__webglFramebuffer,t,r,e.COLOR_ATTACHMENT0,i,0);m(r)&&v(i),n.unbindTexture()}t.depthBuffer&&O(t)},this.updateRenderTargetMipmap=function(e){const t=e.textures;for(let r=0,s=t.length;r<s;r++){const s=t[r];if(m(s)){const t=y(e),r=i.get(s).__webglTexture;n.bindTexture(t,r),v(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0)if(!1===H(t)){const r=t.textures,s=t.width,o=t.height;let a=e.COLOR_BUFFER_BIT;const c=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,u=i.get(t),h=r.length>1;if(h)for(let t=0;t<r.length;t++)n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer);const d=t.texture.mipmaps;d&&d.length>0?n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer[0]):n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let n=0;n<r.length;n++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(a|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(a|=e.STENCIL_BUFFER_BIT)),h){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,u.__webglColorRenderbuffer[n]);const t=i.get(r[n]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,s,o,0,0,s,o,a,e.NEAREST),!0===l&&(N.length=0,B.length=0,N.push(e.COLOR_ATTACHMENT0+n),t.depthBuffer&&!1===t.resolveDepthBuffer&&(N.push(c),B.push(c),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,B)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,N))}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),h)for(let t=0;t<r.length;t++){n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,u.__webglColorRenderbuffer[t]);const s=i.get(r[t]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,s,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&l){const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=O,this.setupFrameBufferTexture=L,this.useMultisampledRTT=H}function FP(e,t){return{convert:function(n){let i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:wm;const s=Ov.getTransfer(r);if(n===Jg)return e.UNSIGNED_BYTE;if(n===af)return e.UNSIGNED_SHORT_4_4_4_4;if(n===lf)return e.UNSIGNED_SHORT_5_5_5_1;if(n===uf)return e.UNSIGNED_INT_5_9_9_9_REV;if(n===Qg)return e.BYTE;if(n===ef)return e.SHORT;if(n===tf)return e.UNSIGNED_SHORT;if(n===nf)return e.INT;if(n===rf)return e.UNSIGNED_INT;if(n===sf)return e.FLOAT;if(n===of)return e.HALF_FLOAT;if(n===hf)return e.ALPHA;if(n===df)return e.RGB;if(n===pf)return e.RGBA;if(n===gf)return e.DEPTH_COMPONENT;if(n===ff)return e.DEPTH_STENCIL;if(n===mf)return e.RED;if(n===vf)return e.RED_INTEGER;if(n===yf)return e.RG;if(n===Cf)return e.RG_INTEGER;if(n===Sf)return e.RGBA_INTEGER;if(n===bf||n===xf||n===_f||n===Mf)if(s===_m){if(i=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(n===bf)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===xf)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===_f)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Mf)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=t.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(n===bf)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===xf)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===_f)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Mf)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===Ef||n===Rf||n===Tf||n===Pf){if(i=t.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(n===Ef)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Rf)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Tf)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Pf)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===Af||n===Ff||n===Df){if(i=t.get("WEBGL_compressed_texture_etc"),null===i)return null;if(n===Af||n===Ff)return s===_m?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===Df)return s===_m?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(n===Lf||n===If||n===kf||n===Of||n===Nf||n===Bf||n===zf||n===Hf||n===Gf||n===Uf||n===Vf||n===Wf||n===jf||n===qf){if(i=t.get("WEBGL_compressed_texture_astc"),null===i)return null;if(n===Lf)return s===_m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===If)return s===_m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===kf)return s===_m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Of)return s===_m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Nf)return s===_m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Bf)return s===_m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===zf)return s===_m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Hf)return s===_m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===Gf)return s===_m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Uf)return s===_m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Vf)return s===_m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Wf)return s===_m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===jf)return s===_m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===qf)return s===_m?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===Xf||n===Kf||n===$f){if(i=t.get("EXT_texture_compression_bptc"),null===i)return null;if(n===Xf)return s===_m?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===Kf)return i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===$f)return i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===Zf||n===Yf||n===Jf||n===Qf){if(i=t.get("EXT_texture_compression_rgtc"),null===i)return null;if(n===Xf)return i.COMPRESSED_RED_RGTC1_EXT;if(n===Yf)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===Jf)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Qf)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===cf?e.UNSIGNED_INT_24_8:void 0!==e[n]?e[n]:null}}}class DP{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(null===this.texture){const i=new jv;e.properties.get(i).__webglTexture=t.texture,t.depthNear===n.depthNear&&t.depthFar===n.depthFar||(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=i}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,n=new vw({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new uw(new jx(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class LP extends hv{constructor(e,t){super();const n=this;let i=null,r=1,s=null,o="local-floor",a=1,l=null,c=null,u=null,h=null,d=null,p=null;const g=new DP,f=t.getContextAttributes();let m=null,v=null;const y=[],C=[],w=new xv;let S=null;const b=new bw;b.viewport=new qv;const x=new bw;x.viewport=new qv;const _=[b,x],M=new PM;let E=null,R=null;function T(e){const t=C.indexOf(e.inputSource);if(-1===t)return;const n=y[t];void 0!==n&&(n.update(e.inputSource,e.frame,l||s),n.dispatchEvent({type:e.type,data:e.inputSource}))}function P(){i.removeEventListener("select",T),i.removeEventListener("selectstart",T),i.removeEventListener("selectend",T),i.removeEventListener("squeeze",T),i.removeEventListener("squeezestart",T),i.removeEventListener("squeezeend",T),i.removeEventListener("end",P),i.removeEventListener("inputsourceschange",A);for(let e=0;e<y.length;e++){const t=C[e];null!==t&&(C[e]=null,y[e].disconnect(t))}E=null,R=null,g.reset(),e.setRenderTarget(m),d=null,h=null,u=null,i=null,v=null,k.stop(),n.isPresenting=!1,e.setPixelRatio(S),e.setSize(w.width,w.height,!1),n.dispatchEvent({type:"sessionend"})}function A(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],i=C.indexOf(n);i>=0&&(C[i]=null,y[i].disconnect(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let i=C.indexOf(n);if(-1===i){for(let e=0;e<y.length;e++){if(e>=C.length){C.push(n),i=e;break}if(null===C[e]){C[e]=n,i=e;break}}if(-1===i)break}const r=y[i];r&&r.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=y[e];return void 0===t&&(t=new Pw,y[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=y[e];return void 0===t&&(t=new Pw,y[e]=t),t.getGripSpace()},this.getHand=function(e){let t=y[e];return void 0===t&&(t=new Pw,y[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){r=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){o=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(c){if(i=c,null!==i){m=e.getRenderTarget(),i.addEventListener("select",T),i.addEventListener("selectstart",T),i.addEventListener("selectend",T),i.addEventListener("squeeze",T),i.addEventListener("squeezestart",T),i.addEventListener("squeezeend",T),i.addEventListener("end",P),i.addEventListener("inputsourceschange",A),!0!==f.xrCompatible&&await t.makeXRCompatible(),S=e.getPixelRatio(),e.getSize(w);if("undefined"!==typeof XRWebGLBinding&&"createProjectionLayer"in XRWebGLBinding.prototype){let n=null,s=null,o=null;f.depth&&(o=f.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,n=f.stencil?ff:gf,s=f.stencil?cf:rf);const a={colorFormat:t.RGBA8,depthFormat:o,scaleFactor:r};u=new XRWebGLBinding(i,t),h=u.createProjectionLayer(a),i.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),v=new Kv(h.textureWidth,h.textureHeight,{format:pf,type:Jg,depthTexture:new Tb(h.textureWidth,h.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:f.stencil,colorSpace:e.outputColorSpace,samples:f.antialias?4:0,resolveDepthBuffer:!1===h.ignoreDepthValues,resolveStencilBuffer:!1===h.ignoreDepthValues})}else{const n={antialias:f.antialias,alpha:!0,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:r};d=new XRWebGLLayer(i,t,n),i.updateRenderState({baseLayer:d}),e.setPixelRatio(1),e.setSize(d.framebufferWidth,d.framebufferHeight,!1),v=new Kv(d.framebufferWidth,d.framebufferHeight,{format:pf,type:Jg,colorSpace:e.outputColorSpace,stencilBuffer:f.stencil,resolveDepthBuffer:!1===d.ignoreDepthValues,resolveStencilBuffer:!1===d.ignoreDepthValues})}v.isXRRenderTarget=!0,this.setFoveation(a),l=null,s=await i.requestReferenceSpace(o),k.setContext(i),k.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==i)return i.environmentBlendMode},this.getDepthTexture=function(){return g.getDepthTexture()};const F=new ey,D=new ey;function L(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===i)return;let t=e.near,n=e.far;null!==g.texture&&(g.depthNear>0&&(t=g.depthNear),g.depthFar>0&&(n=g.depthFar)),M.near=x.near=b.near=t,M.far=x.far=b.far=n,E===M.near&&R===M.far||(i.updateRenderState({depthNear:M.near,depthFar:M.far}),E=M.near,R=M.far),b.layers.mask=2|e.layers.mask,x.layers.mask=4|e.layers.mask,M.layers.mask=b.layers.mask|x.layers.mask;const r=e.parent,s=M.cameras;L(M,r);for(let i=0;i<s.length;i++)L(s[i],r);2===s.length?function(e,t,n){F.setFromMatrixPosition(t.matrixWorld),D.setFromMatrixPosition(n.matrixWorld);const i=F.distanceTo(D),r=t.projectionMatrix.elements,s=n.projectionMatrix.elements,o=r[14]/(r[10]-1),a=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],u=(r[8]-1)/r[0],h=(s[8]+1)/s[0],d=o*u,p=o*h,g=i/(-u+h),f=g*-u;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(f),e.translateZ(g),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===r[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{const t=o+g,n=a+g,r=d-f,s=p+(i-f),u=l*a/n*t,h=c*a/n*t;e.projectionMatrix.makePerspective(r,s,u,h,t,n),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(M,b,x):M.projectionMatrix.copy(b.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*fv*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,M,r)},this.getCamera=function(){return M},this.getFoveation=function(){if(null!==h||null!==d)return a},this.setFoveation=function(e){a=e,null!==h&&(h.fixedFoveation=e),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==g.texture},this.getDepthSensingMesh=function(){return g.getMesh(M)};let I=null;const k=new nR;k.setAnimationLoop((function(t,r){if(c=r.getViewerPose(l||s),p=r,null!==c){const t=c.views;null!==d&&(e.setRenderTargetFramebuffer(v,d.framebuffer),e.setRenderTarget(v));let n=!1;t.length!==M.cameras.length&&(M.cameras.length=0,n=!0);for(let i=0;i<t.length;i++){const r=t[i];let s=null;if(null!==d)s=d.getViewport(r);else{const t=u.getViewSubImage(h,r);s=t.viewport,0===i&&(e.setRenderTargetTextures(v,t.colorTexture,t.depthStencilTexture),e.setRenderTarget(v))}let o=_[i];void 0===o&&(o=new bw,o.layers.enable(i),o.viewport=new qv,_[i]=o),o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.quaternion,o.scale),o.projectionMatrix.fromArray(r.projectionMatrix),o.projectionMatrixInverse.copy(o.projectionMatrix).invert(),o.viewport.set(s.x,s.y,s.width,s.height),0===i&&(M.matrix.copy(o.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),!0===n&&M.cameras.push(o)}const r=i.enabledFeatures;if(r&&r.includes("depth-sensing")&&"gpu-optimized"==i.depthUsage&&u){const n=u.getDepthInformation(t[0]);n&&n.isValid&&n.texture&&g.init(e,n,i.renderState)}}for(let e=0;e<y.length;e++){const t=C[e],n=y[e];null!==t&&void 0!==n&&n.update(t,r,l||s)}I&&I(t,r),r.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:r}),p=null})),this.setAnimationLoop=function(e){I=e},this.dispose=function(){}}}const IP=new Hy,kP=new Ay;function OP(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function i(e,i){e.opacity.value=i.opacity,i.color&&e.diffuse.value.copy(i.color),i.emissive&&e.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(e.map.value=i.map,n(i.map,e.mapTransform)),i.alphaMap&&(e.alphaMap.value=i.alphaMap,n(i.alphaMap,e.alphaMapTransform)),i.bumpMap&&(e.bumpMap.value=i.bumpMap,n(i.bumpMap,e.bumpMapTransform),e.bumpScale.value=i.bumpScale,i.side===Bp&&(e.bumpScale.value*=-1)),i.normalMap&&(e.normalMap.value=i.normalMap,n(i.normalMap,e.normalMapTransform),e.normalScale.value.copy(i.normalScale),i.side===Bp&&e.normalScale.value.negate()),i.displacementMap&&(e.displacementMap.value=i.displacementMap,n(i.displacementMap,e.displacementMapTransform),e.displacementScale.value=i.displacementScale,e.displacementBias.value=i.displacementBias),i.emissiveMap&&(e.emissiveMap.value=i.emissiveMap,n(i.emissiveMap,e.emissiveMapTransform)),i.specularMap&&(e.specularMap.value=i.specularMap,n(i.specularMap,e.specularMapTransform)),i.alphaTest>0&&(e.alphaTest.value=i.alphaTest);const r=t.get(i),s=r.envMap,o=r.envMapRotation;s&&(e.envMap.value=s,IP.copy(o),IP.x*=-1,IP.y*=-1,IP.z*=-1,s.isCubeTexture&&!1===s.isRenderTargetTexture&&(IP.y*=-1,IP.z*=-1),e.envMapRotation.value.setFromMatrix4(kP.makeRotationFromEuler(IP)),e.flipEnvMap.value=s.isCubeTexture&&!1===s.isRenderTargetTexture?-1:1,e.reflectivity.value=i.reflectivity,e.ior.value=i.ior,e.refractionRatio.value=i.refractionRatio),i.lightMap&&(e.lightMap.value=i.lightMap,e.lightMapIntensity.value=i.lightMapIntensity,n(i.lightMap,e.lightMapTransform)),i.aoMap&&(e.aoMap.value=i.aoMap,e.aoMapIntensity.value=i.aoMapIntensity,n(i.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,fw(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,r,s,o,a){r.isMeshBasicMaterial||r.isMeshLambertMaterial?i(e,r):r.isMeshToonMaterial?(i(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,r)):r.isMeshPhongMaterial?(i(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,r)):r.isMeshStandardMaterial?(i(e,r),function(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,n(t.metalnessMap,e.metalnessMapTransform));e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,n(t.roughnessMap,e.roughnessMapTransform));t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}(e,r),r.isMeshPhysicalMaterial&&function(e,t,i){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),t.side===Bp&&e.clearcoatNormalScale.value.negate()));t.dispersion>0&&(e.dispersion.value=t.dispersion);t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=i.texture,e.transmissionSamplerSize.value.set(i.width,i.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform)));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,r,a)):r.isMeshMatcapMaterial?(i(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,r)):r.isMeshDepthMaterial?i(e,r):r.isMeshDistanceMaterial?(i(e,r),function(e,n){const i=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(i.matrixWorld),e.nearDistance.value=i.shadow.camera.near,e.farDistance.value=i.shadow.camera.far}(e,r)):r.isMeshNormalMaterial?i(e,r):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,i,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*i,e.scale.value=.5*r,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,r,s,o):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function NP(e,t,n,i){let r={},s={},o=[];const a=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(e,t,n,i){const r=e.value,s=t+"_"+n;if(void 0===i[s])return i[s]="number"===typeof r||"boolean"===typeof r?r:r.clone(),!0;{const e=i[s];if("number"===typeof r||"boolean"===typeof r){if(e!==r)return i[s]=r,!0}else if(!1===e.equals(r))return e.copy(r),!0}return!1}function c(e){const t={boundary:0,storage:0};return"number"===typeof e||"boolean"===typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function u(t){const n=t.target;n.removeEventListener("dispose",u);const i=o.indexOf(n.__bindingPointIndex);o.splice(i,1),e.deleteBuffer(r[n.id]),delete r[n.id],delete s[n.id]}return{bind:function(e,t){const n=t.program;i.uniformBlockBinding(e,n)},update:function(n,h){let d=r[n.id];void 0===d&&(!function(e){const t=e.uniforms;let n=0;const i=16;for(let s=0,o=t.length;s<o;s++){const e=Array.isArray(t[s])?t[s]:[t[s]];for(let t=0,r=e.length;t<r;t++){const r=e[t],s=Array.isArray(r.value)?r.value:[r.value];for(let e=0,t=s.length;e<t;e++){const t=c(s[e]),o=n%i,a=o%t.boundary,l=o+a;n+=a,0!==l&&i-l<t.storage&&(n+=i-l),r.__data=new Float32Array(t.storage/Float32Array.BYTES_PER_ELEMENT),r.__offset=n,n+=t.storage}}}const r=n%i;r>0&&(n+=i-r);e.__size=n,e.__cache={}}(n),d=function(t){const n=function(){for(let e=0;e<a;e++)if(-1===o.indexOf(e))return o.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const i=e.createBuffer(),r=t.__size,s=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,i),e.bufferData(e.UNIFORM_BUFFER,r,s),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,i),i}(n),r[n.id]=d,n.addEventListener("dispose",u));const p=h.program;i.updateUBOMapping(n,p);const g=t.render.frame;s[n.id]!==g&&(!function(t){const n=r[t.id],i=t.uniforms,s=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(let r=0,o=i.length;r<o;r++){const t=Array.isArray(i[r])?i[r]:[i[r]];for(let n=0,i=t.length;n<i;n++){const i=t[n];if(!0===l(i,r,n,s)){const t=i.__offset,n=Array.isArray(i.value)?i.value:[i.value];let r=0;for(let s=0;s<n.length;s++){const o=n[s],a=c(o);"number"===typeof o||"boolean"===typeof o?(i.__data[0]=o,e.bufferSubData(e.UNIFORM_BUFFER,t+r,i.__data)):o.isMatrix3?(i.__data[0]=o.elements[0],i.__data[1]=o.elements[1],i.__data[2]=o.elements[2],i.__data[3]=0,i.__data[4]=o.elements[3],i.__data[5]=o.elements[4],i.__data[6]=o.elements[5],i.__data[7]=0,i.__data[8]=o.elements[6],i.__data[9]=o.elements[7],i.__data[10]=o.elements[8],i.__data[11]=0):(o.toArray(i.__data,r),r+=a.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,i.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),s[n.id]=g)},dispose:function(){for(const t in r)e.deleteBuffer(r[t]);o=[],r={},s={}}}}class BP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{canvas:t=Av(),context:n=null,depth:i=!0,stencil:r=!1,alpha:s=!1,antialias:o=!1,premultipliedAlpha:a=!0,preserveDrawingBuffer:l=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:u=!1,reverseDepthBuffer:h=!1}=e;let d;if(this.isWebGLRenderer=!0,null!==n){if("undefined"!==typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");d=n.getContextAttributes().alpha}else d=s;const p=new Uint32Array(4),g=new Int32Array(4);let f=null,m=null;const v=[],y=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=xg,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const C=this;let w=!1;this._outputColorSpace=Sm;let S=0,b=0,x=null,_=-1,M=null;const E=new qv,R=new qv;let T=null;const P=new bC(0);let A=0,F=t.width,D=t.height,L=1,I=null,k=null;const O=new qv(0,0,F,D),N=new qv(0,0,F,D);let B=!1;const z=new FS;let H=!1,G=!1;const U=new Ay,V=new Ay,W=new ey,j=new qv,q={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let X=!1;function K(){return null===x?L:1}let $,Z,Y,J,Q,ee,te,ne,ie,re,se,oe,ae,le,ce,ue,he,de,pe,ge,fe,me,ve,ye,Ce=n;function we(e,n){return t.getContext(e,n)}try{const e={alpha:!0,depth:i,stencil:r,antialias:o,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Ep}`),t.addEventListener("webglcontextlost",xe,!1),t.addEventListener("webglcontextrestored",_e,!1),t.addEventListener("webglcontextcreationerror",Me,!1),null===Ce){const t="webgl2";if(Ce=we(t,e),null===Ce)throw we(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(CF){throw console.error("THREE.WebGLRenderer: "+CF.message),CF}function Se(){$=new kR(Ce),$.init(),me=new FP(Ce,$),Z=new pR(Ce,$,e,me),Y=new PP(Ce,$),Z.reverseDepthBuffer&&h&&Y.buffers.depth.setReversed(!0),J=new BR(Ce),Q=new mP,ee=new AP(Ce,$,Y,Q,Z,me,J),te=new fR(C),ne=new IR(C),ie=new iR(Ce),ve=new hR(Ce,ie),re=new OR(Ce,ie,J,ve),se=new HR(Ce,re,ie,J),pe=new zR(Ce,Z,ee),ue=new gR(Q),oe=new fP(C,te,ne,$,Z,ve,ue),ae=new OP(C,Q),le=new wP,ce=new EP($),de=new uR(C,te,ne,Y,se,d,a),he=new RP(C,se,Z),ye=new NP(Ce,J,Z,Y),ge=new dR(Ce,$,J),fe=new NR(Ce,$,J),J.programs=oe.programs,C.capabilities=Z,C.extensions=$,C.properties=Q,C.renderLists=le,C.shadowMap=he,C.state=Y,C.info=J}Se();const be=new LP(C,Ce);function xe(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),w=!0}function _e(){console.log("THREE.WebGLRenderer: Context Restored."),w=!1;const e=J.autoReset,t=he.enabled,n=he.autoUpdate,i=he.needsUpdate,r=he.type;Se(),J.autoReset=e,he.enabled=t,he.autoUpdate=n,he.needsUpdate=i,he.type=r}function Me(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Ee(e){const t=e.target;t.removeEventListener("dispose",Ee),function(e){(function(e){const t=Q.get(e).programs;void 0!==t&&(t.forEach((function(e){oe.releaseProgram(e)})),e.isShaderMaterial&&oe.releaseShaderCache(e))})(e),Q.remove(e)}(t)}function Re(e,t,n){!0===e.transparent&&e.side===zp&&!1===e.forceSinglePass?(e.side=Bp,e.needsUpdate=!0,Ne(e,t,n),e.side=Np,e.needsUpdate=!0,Ne(e,t,n),e.side=zp):Ne(e,t,n)}this.xr=be,this.getContext=function(){return Ce},this.getContextAttributes=function(){return Ce.getContextAttributes()},this.forceContextLoss=function(){const e=$.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=$.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return L},this.setPixelRatio=function(e){void 0!==e&&(L=e,this.setSize(F,D,!1))},this.getSize=function(e){return e.set(F,D)},this.setSize=function(e,n){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];be.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(F=e,D=n,t.width=Math.floor(e*L),t.height=Math.floor(n*L),!0===i&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(F*L,D*L).floor()},this.setDrawingBufferSize=function(e,n,i){F=e,D=n,L=i,t.width=Math.floor(e*i),t.height=Math.floor(n*i),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(E)},this.getViewport=function(e){return e.copy(O)},this.setViewport=function(e,t,n,i){e.isVector4?O.set(e.x,e.y,e.z,e.w):O.set(e,t,n,i),Y.viewport(E.copy(O).multiplyScalar(L).round())},this.getScissor=function(e){return e.copy(N)},this.setScissor=function(e,t,n,i){e.isVector4?N.set(e.x,e.y,e.z,e.w):N.set(e,t,n,i),Y.scissor(R.copy(N).multiplyScalar(L).round())},this.getScissorTest=function(){return B},this.setScissorTest=function(e){Y.setScissorTest(B=e)},this.setOpaqueSort=function(e){I=e},this.setTransparentSort=function(e){k=e},this.getClearColor=function(e){return e.copy(de.getClearColor())},this.setClearColor=function(){de.setClearColor(...arguments)},this.getClearAlpha=function(){return de.getClearAlpha()},this.setClearAlpha=function(){de.setClearAlpha(...arguments)},this.clear=function(){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=0;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){let e=!1;if(null!==x){const t=x.texture.format;e=t===Sf||t===Cf||t===vf}if(e){const e=x.texture.type,t=e===Jg||e===rf||e===tf||e===cf||e===af||e===lf,n=de.getClearColor(),i=de.getClearAlpha(),r=n.r,s=n.g,o=n.b;t?(p[0]=r,p[1]=s,p[2]=o,p[3]=i,Ce.clearBufferuiv(Ce.COLOR,0,p)):(g[0]=r,g[1]=s,g[2]=o,g[3]=i,Ce.clearBufferiv(Ce.COLOR,0,g))}else n|=Ce.COLOR_BUFFER_BIT}e&&(n|=Ce.DEPTH_BUFFER_BIT),t&&(n|=Ce.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Ce.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",xe,!1),t.removeEventListener("webglcontextrestored",_e,!1),t.removeEventListener("webglcontextcreationerror",Me,!1),de.dispose(),le.dispose(),ce.dispose(),Q.dispose(),te.dispose(),ne.dispose(),se.dispose(),ve.dispose(),ye.dispose(),oe.dispose(),be.dispose(),be.removeEventListener("sessionstart",Pe),be.removeEventListener("sessionend",Ae),Fe.stop()},this.renderBufferDirect=function(e,t,n,i,r,s){null===t&&(t=q);const o=r.isMesh&&r.matrixWorld.determinant()<0,a=function(e,t,n,i,r){!0!==t.isScene&&(t=q);ee.resetTextureUnits();const s=t.fog,o=i.isMeshStandardMaterial?t.environment:null,a=null===x?C.outputColorSpace:!0===x.isXRRenderTarget?x.texture.colorSpace:bm,l=(i.isMeshStandardMaterial?ne:te).get(i.envMap||o),c=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!n.attributes.tangent&&(!!i.normalMap||i.anisotropy>0),h=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,p=!!n.morphAttributes.color;let g=xg;i.toneMapped&&(null!==x&&!0!==x.isXRRenderTarget||(g=C.toneMapping));const f=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==f?f.length:0,y=Q.get(i),w=m.state.lights;if(!0===H&&(!0===G||e!==M)){const t=e===M&&i.id===_;ue.setState(i,e,t)}let S=!1;i.version===y.__version?y.needsLights&&y.lightsStateVersion!==w.state.version||y.outputColorSpace!==a||r.isBatchedMesh&&!1===y.batching?S=!0:r.isBatchedMesh||!0!==y.batching?r.isBatchedMesh&&!0===y.batchingColor&&null===r.colorTexture||r.isBatchedMesh&&!1===y.batchingColor&&null!==r.colorTexture||r.isInstancedMesh&&!1===y.instancing?S=!0:r.isInstancedMesh||!0!==y.instancing?r.isSkinnedMesh&&!1===y.skinning?S=!0:r.isSkinnedMesh||!0!==y.skinning?r.isInstancedMesh&&!0===y.instancingColor&&null===r.instanceColor||r.isInstancedMesh&&!1===y.instancingColor&&null!==r.instanceColor||r.isInstancedMesh&&!0===y.instancingMorph&&null===r.morphTexture||r.isInstancedMesh&&!1===y.instancingMorph&&null!==r.morphTexture||y.envMap!==l||!0===i.fog&&y.fog!==s?S=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===ue.numPlanes&&y.numIntersection===ue.numIntersection?(y.vertexAlphas!==c||y.vertexTangents!==u||y.morphTargets!==h||y.morphNormals!==d||y.morphColors!==p||y.toneMapping!==g||y.morphTargetsCount!==v)&&(S=!0):S=!0:S=!0:S=!0:S=!0:(S=!0,y.__version=i.version);let b=y.currentProgram;!0===S&&(b=Ne(i,t,r));let E=!1,R=!1,T=!1;const P=b.getUniforms(),A=y.uniforms;Y.useProgram(b.program)&&(E=!0,R=!0,T=!0);i.id!==_&&(_=i.id,R=!0);if(E||M!==e){Y.buffers.depth.getReversed()?(U.copy(e.projectionMatrix),function(e){const t=e.elements;t[2]=.5*t[2]+.5*t[3],t[6]=.5*t[6]+.5*t[7],t[10]=.5*t[10]+.5*t[11],t[14]=.5*t[14]+.5*t[15]}(U),function(e){const t=e.elements;-1===t[11]?(t[10]=-t[10]-1,t[14]=-t[14]):(t[10]=-t[10],t[14]=1-t[14])}(U),P.setValue(Ce,"projectionMatrix",U)):P.setValue(Ce,"projectionMatrix",e.projectionMatrix),P.setValue(Ce,"viewMatrix",e.matrixWorldInverse);const t=P.map.cameraPosition;void 0!==t&&t.setValue(Ce,W.setFromMatrixPosition(e.matrixWorld)),Z.logarithmicDepthBuffer&&P.setValue(Ce,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&P.setValue(Ce,"isOrthographic",!0===e.isOrthographicCamera),M!==e&&(M=e,R=!0,T=!0)}if(r.isSkinnedMesh){P.setOptional(Ce,r,"bindMatrix"),P.setOptional(Ce,r,"bindMatrixInverse");const e=r.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),P.setValue(Ce,"boneTexture",e.boneTexture,ee))}r.isBatchedMesh&&(P.setOptional(Ce,r,"batchingTexture"),P.setValue(Ce,"batchingTexture",r._matricesTexture,ee),P.setOptional(Ce,r,"batchingIdTexture"),P.setValue(Ce,"batchingIdTexture",r._indirectTexture,ee),P.setOptional(Ce,r,"batchingColorTexture"),null!==r._colorsTexture&&P.setValue(Ce,"batchingColorTexture",r._colorsTexture,ee));const F=n.morphAttributes;void 0===F.position&&void 0===F.normal&&void 0===F.color||pe.update(r,n,b);(R||y.receiveShadow!==r.receiveShadow)&&(y.receiveShadow=r.receiveShadow,P.setValue(Ce,"receiveShadow",r.receiveShadow));i.isMeshGouraudMaterial&&null!==i.envMap&&(A.envMap.value=l,A.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);i.isMeshStandardMaterial&&null===i.envMap&&null!==t.environment&&(A.envMapIntensity.value=t.environmentIntensity);R&&(P.setValue(Ce,"toneMappingExposure",C.toneMappingExposure),y.needsLights&&(k=T,(I=A).ambientLightColor.needsUpdate=k,I.lightProbe.needsUpdate=k,I.directionalLights.needsUpdate=k,I.directionalLightShadows.needsUpdate=k,I.pointLights.needsUpdate=k,I.pointLightShadows.needsUpdate=k,I.spotLights.needsUpdate=k,I.spotLightShadows.needsUpdate=k,I.rectAreaLights.needsUpdate=k,I.hemisphereLights.needsUpdate=k),s&&!0===i.fog&&ae.refreshFogUniforms(A,s),ae.refreshMaterialUniforms(A,i,L,D,m.state.transmissionRenderTarget[e.id]),jT.upload(Ce,Be(y),A,ee));var I,k;i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(jT.upload(Ce,Be(y),A,ee),i.uniformsNeedUpdate=!1);i.isSpriteMaterial&&P.setValue(Ce,"center",r.center);if(P.setValue(Ce,"modelViewMatrix",r.modelViewMatrix),P.setValue(Ce,"normalMatrix",r.normalMatrix),P.setValue(Ce,"modelMatrix",r.matrixWorld),i.isShaderMaterial||i.isRawShaderMaterial){const e=i.uniformsGroups;for(let t=0,n=e.length;t<n;t++){const n=e[t];ye.update(n,b),ye.bind(n,b)}}return b}(e,t,n,i,r);Y.setMaterial(i,o);let l=n.index,c=1;if(!0===i.wireframe){if(l=re.getWireframeAttribute(n),void 0===l)return;c=2}const u=n.drawRange,h=n.attributes.position;let d=u.start*c,p=(u.start+u.count)*c;null!==s&&(d=Math.max(d,s.start*c),p=Math.min(p,(s.start+s.count)*c)),null!==l?(d=Math.max(d,0),p=Math.min(p,l.count)):void 0!==h&&null!==h&&(d=Math.max(d,0),p=Math.min(p,h.count));const g=p-d;if(g<0||g===1/0)return;let f;ve.setup(r,i,a,n,l);let v=ge;if(null!==l&&(f=ie.get(l),v=fe,v.setIndex(f)),r.isMesh)!0===i.wireframe?(Y.setLineWidth(i.wireframeLinewidth*K()),v.setMode(Ce.LINES)):v.setMode(Ce.TRIANGLES);else if(r.isLine){let e=i.linewidth;void 0===e&&(e=1),Y.setLineWidth(e*K()),r.isLineSegments?v.setMode(Ce.LINES):r.isLineLoop?v.setMode(Ce.LINE_LOOP):v.setMode(Ce.LINE_STRIP)}else r.isPoints?v.setMode(Ce.POINTS):r.isSprite&&v.setMode(Ce.TRIANGLES);if(r.isBatchedMesh)if(null!==r._multiDrawInstances)Dv("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),v.renderMultiDrawInstances(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount,r._multiDrawInstances);else if($.get("WEBGL_multi_draw"))v.renderMultiDraw(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount);else{const e=r._multiDrawStarts,t=r._multiDrawCounts,n=r._multiDrawCount,s=l?ie.get(l).bytesPerElement:1,o=Q.get(i).currentProgram.getUniforms();for(let i=0;i<n;i++)o.setValue(Ce,"_gl_DrawID",i),v.render(e[i]/s,t[i])}else if(r.isInstancedMesh)v.renderInstances(d,g,r.count);else if(n.isInstancedBufferGeometry){const e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);v.renderInstances(d,g,t)}else v.render(d,g)},this.compile=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===n&&(n=e),m=ce.get(n),m.init(t),y.push(m),n.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(m.pushLight(e),e.castShadow&&m.pushShadow(e))})),e!==n&&e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(m.pushLight(e),e.castShadow&&m.pushShadow(e))})),m.setupLights();const i=new Set;return e.traverse((function(e){if(!(e.isMesh||e.isPoints||e.isLine||e.isSprite))return;const t=e.material;if(t)if(Array.isArray(t))for(let r=0;r<t.length;r++){const s=t[r];Re(s,n,e),i.add(s)}else Re(t,n,e),i.add(t)})),m=y.pop(),i},this.compileAsync=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=this.compile(e,t,n);return new Promise((t=>{function n(){i.forEach((function(e){Q.get(e).currentProgram.isReady()&&i.delete(e)})),0!==i.size?setTimeout(n,10):t(e)}null!==$.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)}))};let Te=null;function Pe(){Fe.stop()}function Ae(){Fe.start()}const Fe=new nR;function De(e,t,n,i){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)m.pushLight(e),e.castShadow&&m.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||z.intersectsSprite(e)){i&&j.setFromMatrixPosition(e.matrixWorld).applyMatrix4(V);const t=se.update(e),r=e.material;r.visible&&f.push(e,t,r,n,j.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||z.intersectsObject(e))){const t=se.update(e),r=e.material;if(i&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),j.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),j.copy(t.boundingSphere.center)),j.applyMatrix4(e.matrixWorld).applyMatrix4(V)),Array.isArray(r)){const i=t.groups;for(let s=0,o=i.length;s<o;s++){const o=i[s],a=r[o.materialIndex];a&&a.visible&&f.push(e,t,a,n,j.z,o)}}else r.visible&&f.push(e,t,r,n,j.z,null)}const r=e.children;for(let s=0,o=r.length;s<o;s++)De(r[s],t,n,i)}function Le(e,t,n,i){const r=e.opaque,s=e.transmissive,o=e.transparent;m.setupLightsView(n),!0===H&&ue.setGlobalState(C.clippingPlanes,n),i&&Y.viewport(E.copy(i)),r.length>0&&ke(r,t,n),s.length>0&&ke(s,t,n),o.length>0&&ke(o,t,n),Y.buffers.depth.setTest(!0),Y.buffers.depth.setMask(!0),Y.buffers.color.setMask(!0),Y.setPolygonOffset(!1)}function Ie(e,t,n,i){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===m.state.transmissionRenderTarget[i.id]&&(m.state.transmissionRenderTarget[i.id]=new Kv(1,1,{generateMipmaps:!0,type:$.has("EXT_color_buffer_half_float")||$.has("EXT_color_buffer_float")?of:Jg,minFilter:Zg,samples:4,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Ov.workingColorSpace}));const s=m.state.transmissionRenderTarget[i.id],o=i.viewport||E;s.setSize(o.z*C.transmissionResolutionScale,o.w*C.transmissionResolutionScale);const a=C.getRenderTarget();C.setRenderTarget(s),C.getClearColor(P),A=C.getClearAlpha(),A<1&&C.setClearColor(16777215,.5),C.clear(),X&&de.render(n);const l=C.toneMapping;C.toneMapping=xg;const c=i.viewport;if(void 0!==i.viewport&&(i.viewport=void 0),m.setupLightsView(i),!0===H&&ue.setGlobalState(C.clippingPlanes,i),ke(e,n,i),ee.updateMultisampleRenderTarget(s),ee.updateRenderTargetMipmap(s),!1===$.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let r=0,s=t.length;r<s;r++){const s=t[r],o=s.object,a=s.geometry,l=s.material,c=s.group;if(l.side===zp&&o.layers.test(i.layers)){const t=l.side;l.side=Bp,l.needsUpdate=!0,Oe(o,n,i,a,l,c),l.side=t,l.needsUpdate=!0,e=!0}}!0===e&&(ee.updateMultisampleRenderTarget(s),ee.updateRenderTargetMipmap(s))}C.setRenderTarget(a),C.setClearColor(P,A),void 0!==c&&(i.viewport=c),C.toneMapping=l}function ke(e,t,n){const i=!0===t.isScene?t.overrideMaterial:null;for(let r=0,s=e.length;r<s;r++){const s=e[r],o=s.object,a=s.geometry,l=s.group;let c=s.material;!0===c.allowOverride&&null!==i&&(c=i),o.layers.test(n.layers)&&Oe(o,t,n,a,c,l)}}function Oe(e,t,n,i,r,s){e.onBeforeRender(C,t,n,i,r,s),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),r.onBeforeRender(C,t,n,i,e,s),!0===r.transparent&&r.side===zp&&!1===r.forceSinglePass?(r.side=Bp,r.needsUpdate=!0,C.renderBufferDirect(n,t,i,r,e,s),r.side=Np,r.needsUpdate=!0,C.renderBufferDirect(n,t,i,r,e,s),r.side=zp):C.renderBufferDirect(n,t,i,r,e,s),e.onAfterRender(C,t,n,i,r,s)}function Ne(e,t,n){!0!==t.isScene&&(t=q);const i=Q.get(e),r=m.state.lights,s=m.state.shadowsArray,o=r.state.version,a=oe.getParameters(e,r.state,s,t,n),l=oe.getProgramCacheKey(a);let c=i.programs;i.environment=e.isMeshStandardMaterial?t.environment:null,i.fog=t.fog,i.envMap=(e.isMeshStandardMaterial?ne:te).get(e.envMap||i.environment),i.envMapRotation=null!==i.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===c&&(e.addEventListener("dispose",Ee),c=new Map,i.programs=c);let u=c.get(l);if(void 0!==u){if(i.currentProgram===u&&i.lightsStateVersion===o)return ze(e,a),u}else a.uniforms=oe.getUniforms(e),e.onBeforeCompile(a,C),u=oe.acquireProgram(a,l),c.set(l,u),i.uniforms=a.uniforms;const h=i.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=ue.uniform),ze(e,a),i.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),i.lightsStateVersion=o,i.needsLights&&(h.ambientLightColor.value=r.state.ambient,h.lightProbe.value=r.state.probe,h.directionalLights.value=r.state.directional,h.directionalLightShadows.value=r.state.directionalShadow,h.spotLights.value=r.state.spot,h.spotLightShadows.value=r.state.spotShadow,h.rectAreaLights.value=r.state.rectArea,h.ltc_1.value=r.state.rectAreaLTC1,h.ltc_2.value=r.state.rectAreaLTC2,h.pointLights.value=r.state.point,h.pointLightShadows.value=r.state.pointShadow,h.hemisphereLights.value=r.state.hemi,h.directionalShadowMap.value=r.state.directionalShadowMap,h.directionalShadowMatrix.value=r.state.directionalShadowMatrix,h.spotShadowMap.value=r.state.spotShadowMap,h.spotLightMatrix.value=r.state.spotLightMatrix,h.spotLightMap.value=r.state.spotLightMap,h.pointShadowMap.value=r.state.pointShadowMap,h.pointShadowMatrix.value=r.state.pointShadowMatrix),i.currentProgram=u,i.uniformsList=null,u}function Be(e){if(null===e.uniformsList){const t=e.currentProgram.getUniforms();e.uniformsList=jT.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function ze(e,t){const n=Q.get(e);n.outputColorSpace=t.outputColorSpace,n.batching=t.batching,n.batchingColor=t.batchingColor,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.instancingMorph=t.instancingMorph,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}Fe.setAnimationLoop((function(e){Te&&Te(e)})),"undefined"!==typeof self&&Fe.setContext(self),this.setAnimationLoop=function(e){Te=e,be.setAnimationLoop(e),null===e?Fe.stop():Fe.start()},be.addEventListener("sessionstart",Pe),be.addEventListener("sessionend",Ae),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===w)return;if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===be.enabled&&!0===be.isPresenting&&(!0===be.cameraAutoUpdate&&be.updateCamera(t),t=be.getCamera()),!0===e.isScene&&e.onBeforeRender(C,e,t,x),m=ce.get(e,y.length),m.init(t),y.push(m),V.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),z.setFromProjectionMatrix(V),G=this.localClippingEnabled,H=ue.init(this.clippingPlanes,G),f=le.get(e,v.length),f.init(),v.push(f),!0===be.enabled&&!0===be.isPresenting){const e=C.xr.getDepthSensingMesh();null!==e&&De(e,t,-1/0,C.sortObjects)}De(e,t,0,C.sortObjects),f.finish(),!0===C.sortObjects&&f.sort(I,k),X=!1===be.enabled||!1===be.isPresenting||!1===be.hasDepthSensing(),X&&de.addToRenderList(f,e),this.info.render.frame++,!0===H&&ue.beginShadows();const n=m.state.shadowsArray;he.render(n,e,t),!0===H&&ue.endShadows(),!0===this.info.autoReset&&this.info.reset();const i=f.opaque,r=f.transmissive;if(m.setupLights(),t.isArrayCamera){const n=t.cameras;if(r.length>0)for(let t=0,s=n.length;t<s;t++){Ie(i,r,e,n[t])}X&&de.render(e);for(let t=0,i=n.length;t<i;t++){const i=n[t];Le(f,e,i,i.viewport)}}else r.length>0&&Ie(i,r,e,t),X&&de.render(e),Le(f,e,t);null!==x&&0===b&&(ee.updateMultisampleRenderTarget(x),ee.updateRenderTargetMipmap(x)),!0===e.isScene&&e.onAfterRender(C,e,t),ve.resetDefaultState(),_=-1,M=null,y.pop(),y.length>0?(m=y[y.length-1],!0===H&&ue.setGlobalState(C.clippingPlanes,m.state.camera)):m=null,v.pop(),f=v.length>0?v[v.length-1]:null},this.getActiveCubeFace=function(){return S},this.getActiveMipmapLevel=function(){return b},this.getRenderTarget=function(){return x},this.setRenderTargetTextures=function(e,t,n){const i=Q.get(e);i.__autoAllocateDepthBuffer=!1===e.resolveDepthBuffer,!1===i.__autoAllocateDepthBuffer&&(i.__useRenderToTexture=!1),Q.get(e.texture).__webglTexture=t,Q.get(e.depthTexture).__webglTexture=i.__autoAllocateDepthBuffer?void 0:n,i.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(e,t){const n=Q.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t};const He=Ce.createFramebuffer();this.setRenderTarget=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;x=e,S=t,b=n;let i=!0,r=null,s=!1,o=!1;if(e){const a=Q.get(e);if(void 0!==a.__useDefaultFramebuffer)Y.bindFramebuffer(Ce.FRAMEBUFFER,null),i=!1;else if(void 0===a.__webglFramebuffer)ee.setupRenderTarget(e);else if(a.__hasExternalTextures)ee.rebindTextures(e,Q.get(e.texture).__webglTexture,Q.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){const t=e.depthTexture;if(a.__boundDepthTexture!==t){if(null!==t&&Q.has(t)&&(e.width!==t.image.width||e.height!==t.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ee.setupDepthRenderbuffer(e)}}const l=e.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(o=!0);const c=Q.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=Array.isArray(c[t])?c[t][n]:c[t],s=!0):r=e.samples>0&&!1===ee.useMultisampledRTT(e)?Q.get(e).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,E.copy(e.viewport),R.copy(e.scissor),T=e.scissorTest}else E.copy(O).multiplyScalar(L).floor(),R.copy(N).multiplyScalar(L).floor(),T=B;0!==n&&(r=He);if(Y.bindFramebuffer(Ce.FRAMEBUFFER,r)&&i&&Y.drawBuffers(e,r),Y.viewport(E),Y.scissor(R),Y.setScissorTest(T),s){const i=Q.get(e.texture);Ce.framebufferTexture2D(Ce.FRAMEBUFFER,Ce.COLOR_ATTACHMENT0,Ce.TEXTURE_CUBE_MAP_POSITIVE_X+t,i.__webglTexture,n)}else if(o){const i=Q.get(e.texture),r=t;Ce.framebufferTextureLayer(Ce.FRAMEBUFFER,Ce.COLOR_ATTACHMENT0,i.__webglTexture,n,r)}else if(null!==e&&0!==n){const t=Q.get(e.texture);Ce.framebufferTexture2D(Ce.FRAMEBUFFER,Ce.COLOR_ATTACHMENT0,Ce.TEXTURE_2D,t.__webglTexture,n)}_=-1},this.readRenderTargetPixels=function(e,t,n,i,r,s,o){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=Q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(a=a[o]),a){Y.bindFramebuffer(Ce.FRAMEBUFFER,a);try{const o=e.texture,a=o.format,l=o.type;if(!Z.textureFormatReadable(a))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!Z.textureTypeReadable(l))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r&&Ce.readPixels(t,n,i,r,me.convert(a),me.convert(l),s)}finally{const e=null!==x?Q.get(x).__webglFramebuffer:null;Y.bindFramebuffer(Ce.FRAMEBUFFER,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,n,i,r,s,o){if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=Q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(a=a[o]),a){if(t>=0&&t<=e.width-i&&n>=0&&n<=e.height-r){Y.bindFramebuffer(Ce.FRAMEBUFFER,a);const o=e.texture,l=o.format,c=o.type;if(!Z.textureFormatReadable(l))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Z.textureTypeReadable(c))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const u=Ce.createBuffer();Ce.bindBuffer(Ce.PIXEL_PACK_BUFFER,u),Ce.bufferData(Ce.PIXEL_PACK_BUFFER,s.byteLength,Ce.STREAM_READ),Ce.readPixels(t,n,i,r,me.convert(l),me.convert(c),0);const h=null!==x?Q.get(x).__webglFramebuffer:null;Y.bindFramebuffer(Ce.FRAMEBUFFER,h);const d=Ce.fenceSync(Ce.SYNC_GPU_COMMANDS_COMPLETE,0);return Ce.flush(),await function(e,t,n){return new Promise((function(i,r){setTimeout((function s(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:r();break;case e.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:i()}}),n)}))}(Ce,d,4),Ce.bindBuffer(Ce.PIXEL_PACK_BUFFER,u),Ce.getBufferSubData(Ce.PIXEL_PACK_BUFFER,0,s),Ce.deleteBuffer(u),Ce.deleteSync(d),s}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i=Math.pow(2,-n),r=Math.floor(e.image.width*i),s=Math.floor(e.image.height*i),o=null!==t?t.x:0,a=null!==t?t.y:0;ee.setTexture2D(e,0),Ce.copyTexSubImage2D(Ce.TEXTURE_2D,n,0,0,o,a,r,s),Y.unbindTexture()};const Ge=Ce.createFramebuffer(),Ue=Ce.createFramebuffer();this.copyTextureToTexture=function(e,t){let n,i,r,s,o,a,l,c,u,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,g=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;null===g&&(0!==p?(Dv("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),g=p,p=0):g=0);const f=e.isCompressedTexture?e.mipmaps[g]:e.image;if(null!==h)n=h.max.x-h.min.x,i=h.max.y-h.min.y,r=h.isBox3?h.max.z-h.min.z:1,s=h.min.x,o=h.min.y,a=h.isBox3?h.min.z:0;else{const t=Math.pow(2,-p);n=Math.floor(f.width*t),i=Math.floor(f.height*t),r=e.isDataArrayTexture?f.depth:e.isData3DTexture?Math.floor(f.depth*t):1,s=0,o=0,a=0}null!==d?(l=d.x,c=d.y,u=d.z):(l=0,c=0,u=0);const m=me.convert(t.format),v=me.convert(t.type);let y;t.isData3DTexture?(ee.setTexture3D(t,0),y=Ce.TEXTURE_3D):t.isDataArrayTexture||t.isCompressedArrayTexture?(ee.setTexture2DArray(t,0),y=Ce.TEXTURE_2D_ARRAY):(ee.setTexture2D(t,0),y=Ce.TEXTURE_2D),Ce.pixelStorei(Ce.UNPACK_FLIP_Y_WEBGL,t.flipY),Ce.pixelStorei(Ce.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),Ce.pixelStorei(Ce.UNPACK_ALIGNMENT,t.unpackAlignment);const C=Ce.getParameter(Ce.UNPACK_ROW_LENGTH),w=Ce.getParameter(Ce.UNPACK_IMAGE_HEIGHT),S=Ce.getParameter(Ce.UNPACK_SKIP_PIXELS),b=Ce.getParameter(Ce.UNPACK_SKIP_ROWS),x=Ce.getParameter(Ce.UNPACK_SKIP_IMAGES);Ce.pixelStorei(Ce.UNPACK_ROW_LENGTH,f.width),Ce.pixelStorei(Ce.UNPACK_IMAGE_HEIGHT,f.height),Ce.pixelStorei(Ce.UNPACK_SKIP_PIXELS,s),Ce.pixelStorei(Ce.UNPACK_SKIP_ROWS,o),Ce.pixelStorei(Ce.UNPACK_SKIP_IMAGES,a);const _=e.isDataArrayTexture||e.isData3DTexture,M=t.isDataArrayTexture||t.isData3DTexture;if(e.isDepthTexture){const h=Q.get(e),d=Q.get(t),f=Q.get(h.__renderTarget),m=Q.get(d.__renderTarget);Y.bindFramebuffer(Ce.READ_FRAMEBUFFER,f.__webglFramebuffer),Y.bindFramebuffer(Ce.DRAW_FRAMEBUFFER,m.__webglFramebuffer);for(let v=0;v<r;v++)_&&(Ce.framebufferTextureLayer(Ce.READ_FRAMEBUFFER,Ce.COLOR_ATTACHMENT0,Q.get(e).__webglTexture,p,a+v),Ce.framebufferTextureLayer(Ce.DRAW_FRAMEBUFFER,Ce.COLOR_ATTACHMENT0,Q.get(t).__webglTexture,g,u+v)),Ce.blitFramebuffer(s,o,n,i,l,c,n,i,Ce.DEPTH_BUFFER_BIT,Ce.NEAREST);Y.bindFramebuffer(Ce.READ_FRAMEBUFFER,null),Y.bindFramebuffer(Ce.DRAW_FRAMEBUFFER,null)}else if(0!==p||e.isRenderTargetTexture||Q.has(e)){const h=Q.get(e),d=Q.get(t);Y.bindFramebuffer(Ce.READ_FRAMEBUFFER,Ge),Y.bindFramebuffer(Ce.DRAW_FRAMEBUFFER,Ue);for(let e=0;e<r;e++)_?Ce.framebufferTextureLayer(Ce.READ_FRAMEBUFFER,Ce.COLOR_ATTACHMENT0,h.__webglTexture,p,a+e):Ce.framebufferTexture2D(Ce.READ_FRAMEBUFFER,Ce.COLOR_ATTACHMENT0,Ce.TEXTURE_2D,h.__webglTexture,p),M?Ce.framebufferTextureLayer(Ce.DRAW_FRAMEBUFFER,Ce.COLOR_ATTACHMENT0,d.__webglTexture,g,u+e):Ce.framebufferTexture2D(Ce.DRAW_FRAMEBUFFER,Ce.COLOR_ATTACHMENT0,Ce.TEXTURE_2D,d.__webglTexture,g),0!==p?Ce.blitFramebuffer(s,o,n,i,l,c,n,i,Ce.COLOR_BUFFER_BIT,Ce.NEAREST):M?Ce.copyTexSubImage3D(y,g,l,c,u+e,s,o,n,i):Ce.copyTexSubImage2D(y,g,l,c,s,o,n,i);Y.bindFramebuffer(Ce.READ_FRAMEBUFFER,null),Y.bindFramebuffer(Ce.DRAW_FRAMEBUFFER,null)}else M?e.isDataTexture||e.isData3DTexture?Ce.texSubImage3D(y,g,l,c,u,n,i,r,m,v,f.data):t.isCompressedArrayTexture?Ce.compressedTexSubImage3D(y,g,l,c,u,n,i,r,m,f.data):Ce.texSubImage3D(y,g,l,c,u,n,i,r,m,v,f):e.isDataTexture?Ce.texSubImage2D(Ce.TEXTURE_2D,g,l,c,n,i,m,v,f.data):e.isCompressedTexture?Ce.compressedTexSubImage2D(Ce.TEXTURE_2D,g,l,c,f.width,f.height,m,f.data):Ce.texSubImage2D(Ce.TEXTURE_2D,g,l,c,n,i,m,v,f);Ce.pixelStorei(Ce.UNPACK_ROW_LENGTH,C),Ce.pixelStorei(Ce.UNPACK_IMAGE_HEIGHT,w),Ce.pixelStorei(Ce.UNPACK_SKIP_PIXELS,S),Ce.pixelStorei(Ce.UNPACK_SKIP_ROWS,b),Ce.pixelStorei(Ce.UNPACK_SKIP_IMAGES,x),0===g&&t.generateMipmaps&&Ce.generateMipmap(y),Y.unbindTexture()},this.copyTextureToTexture3D=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return Dv('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(e,t,n,i,r)},this.initRenderTarget=function(e){void 0===Q.get(e).__webglFramebuffer&&ee.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?ee.setTextureCube(e,0):e.isData3DTexture?ee.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?ee.setTexture2DArray(e,0):ee.setTexture2D(e,0),Y.unbindTexture()},this.resetState=function(){S=0,b=0,x=null,Y.reset(),ve.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ov}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Ov._getDrawingBufferColorSpace(e),t.unpackColorSpace=Ov._getUnpackColorSpace()}}var zP=n(205);function HP(e){let t;const n=new Set,i=(e,i)=>{const r="function"===typeof e?e(t):e;if(r!==t){const e=t;t=i?r:Object.assign({},t,r),n.forEach((n=>n(t,e)))}},r=()=>t,s={setState:i,getState:r,subscribe:(e,i,s)=>i||s?function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is;console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let o=i(t);function a(){const n=i(t);if(!s(o,n)){const t=o;e(o=n,t)}}return n.add(a),()=>n.delete(a)}(e,i,s):(n.add(e),()=>n.delete(e)),destroy:()=>n.clear()};return t=e(i,r,s),s}const GP="undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?t.useEffect:t.useLayoutEffect;const UP=[];function VP(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;if(e===t)return!0;if(!e||!t)return!1;const i=e.length;if(t.length!==i)return!1;for(let r=0;r<i;r++)if(!n(e[r],t[r]))return!1;return!0}function WP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};null===t&&(t=[e]);for(const o of UP)if(VP(t,o.keys,o.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(o,"error"))throw o.error;if(Object.prototype.hasOwnProperty.call(o,"response"))return i.lifespan&&i.lifespan>0&&(o.timeout&&clearTimeout(o.timeout),o.timeout=setTimeout(o.remove,i.lifespan)),o.response;if(!n)throw o.promise}const r={keys:t,equal:i.equal,remove:()=>{const e=UP.indexOf(r);-1!==e&&UP.splice(e,1)},promise:(s=e,"object"===typeof s&&"function"===typeof s.then?e:e(...t)).then((e=>{r.response=e,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))})).catch((e=>r.error=e))};var s;if(UP.push(r),!n)throw r.promise}var jP=n(16),qP=n.n(jP),XP=n(784);const KP={};var $P,ZP;const YP=e=>"colorSpace"in e||"outputColorSpace"in e,JP=()=>{var e;return null!=(e=KP.ColorManagement)?e:null},QP=e=>e&&e.isOrthographicCamera,eA="undefined"!==typeof window&&(null!=($P=window.document)&&$P.createElement||"ReactNative"===(null==(ZP=window.navigator)?void 0:ZP.product))?t.useLayoutEffect:t.useEffect;function tA(e){const n=t.useRef(e);return eA((()=>{n.current=e}),[e]),n}function nA(e){let{set:t}=e;return eA((()=>(t(new Promise((()=>null))),()=>t(!1))),[t]),null}class iA extends t.Component{constructor(){super(...arguments),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}iA.getDerivedStateFromError=()=>({error:!0});const rA="__default",sA=new Map,oA=e=>e&&!!e.memoized&&!!e.changes;function aA(e){var t;const n="undefined"!==typeof window?null!=(t=window.devicePixelRatio)?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}const lA=e=>{var t;return null==(t=e.__r3f)?void 0:t.root.getState()};function cA(e){let t=e.__r3f.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const uA={obj:e=>e===Object(e)&&!uA.arr(e)&&"function"!==typeof e,fun:e=>"function"===typeof e,str:e=>"string"===typeof e,num:e=>"number"===typeof e,boo:e=>"boolean"===typeof e,und:e=>void 0===e,arr:e=>Array.isArray(e),equ(e,t){let{arrays:n="shallow",objects:i="reference",strict:r=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(typeof e!==typeof t||!!e!==!!t)return!1;if(uA.str(e)||uA.num(e)||uA.boo(e))return e===t;const s=uA.obj(e);if(s&&"reference"===i)return e===t;const o=uA.arr(e);if(o&&"reference"===n)return e===t;if((o||s)&&e===t)return!0;let a;for(a in e)if(!(a in t))return!1;if(s&&"shallow"===n&&"shallow"===i){for(a in r?t:e)if(!uA.equ(e[a],t[a],{strict:r,objects:"reference"}))return!1}else for(a in r?t:e)if(e[a]!==t[a])return!1;if(uA.und(a)){if(o&&0===e.length&&0===t.length)return!0;if(s&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};function hA(e){const t={nodes:{},materials:{}};return e&&e.traverse((e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)})),t}function dA(e,t){return e.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function pA(e,t){let n=e;if(t.includes("-")){const i=t.split("-"),r=i.pop();return n=i.reduce(((e,t)=>e[t]),e),{target:n,key:r}}return{target:n,key:t}}const gA=/-\d+$/;function fA(e,t,n){if(uA.str(n)){if(gA.test(n)){const t=n.replace(gA,""),{target:i,key:r}=pA(e,t);Array.isArray(i[r])||(i[r]=[])}const{target:i,key:r}=pA(e,n);t.__r3f.previousAttach=i[r],i[r]=t}else t.__r3f.previousAttach=n(e,t)}function mA(e,t,n){var i,r;if(uA.str(n)){const{target:i,key:r}=pA(e,n),s=t.__r3f.previousAttach;void 0===s?delete i[r]:i[r]=s}else null==(i=t.__r3f)||null==i.previousAttach||i.previousAttach(e,t);null==(r=t.__r3f)||delete r.previousAttach}function vA(e,t){let{children:n,key:i,ref:r,...s}=t,{children:o,key:a,ref:l,...c}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const h=e.__r3f,d=Object.entries(s),p=[];if(u){const e=Object.keys(c);for(let t=0;t<e.length;t++)s.hasOwnProperty(e[t])||d.unshift([e[t],rA+"remove"])}d.forEach((t=>{let[n,i]=t;var r;if(null!=(r=e.__r3f)&&r.primitive&&"object"===n)return;if(uA.equ(i,c[n]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(n))return p.push([n,i,!0,[]]);let o=[];n.includes("-")&&(o=n.split("-")),p.push([n,i,!1,o]);for(const e in s){const t=s[e];e.startsWith(`${n}-`)&&p.push([e,t,!1,e.split("-")])}}));const g={...s};return null!=h&&h.memoizedProps&&null!=h&&h.memoizedProps.args&&(g.args=h.memoizedProps.args),null!=h&&h.memoizedProps&&null!=h&&h.memoizedProps.attach&&(g.attach=h.memoizedProps.attach),{memoized:g,changes:p}}const yA="undefined"!==typeof process&&!1;function CA(e,t){var n;const i=e.__r3f,r=null==i?void 0:i.root,s=null==r||null==r.getState?void 0:r.getState(),{memoized:o,changes:a}=oA(t)?t:vA(e,t),l=null==i?void 0:i.eventCount;e.__r3f&&(e.__r3f.memoizedProps=o);for(let h=0;h<a.length;h++){let[t,n,r,o]=a[h];if(YP(e)){const e=3001,i="srgb",r="srgb-linear";"encoding"===t?(t="colorSpace",n=n===e?i:r):"outputEncoding"===t&&(t="outputColorSpace",n=n===e?i:r)}let l=e,d=l[t];if(o.length&&(d=o.reduce(((e,t)=>e[t]),e),!d||!d.set)){const[n,...i]=o.reverse();l=i.reverse().reduce(((e,t)=>e[t]),e),t=n}if(n===rA+"remove")if(l.constructor){let e=sA.get(l.constructor);e||(e=new l.constructor,sA.set(l.constructor,e)),n=e[t]}else n=0;if(r&&i)n?i.handlers[t]=n:delete i.handlers[t],i.eventCount=Object.keys(i.handlers).length;else if(d&&d.set&&(d.copy||d instanceof Gy)){if(Array.isArray(n))d.fromArray?d.fromArray(n):d.set(...n);else if(d.copy&&n&&n.constructor&&(yA?d.constructor.name===n.constructor.name:d.constructor===n.constructor))d.copy(n);else if(void 0!==n){var c;const e=null==(c=d)?void 0:c.isColor;!e&&d.setScalar?d.setScalar(n):d instanceof Gy&&n instanceof Gy?d.mask=n.mask:d.set(n),!JP()&&s&&!s.linear&&e&&d.convertSRGBToLinear()}}else{var u;if(l[t]=n,null!=(u=l[t])&&u.isTexture&&l[t].format===pf&&l[t].type===Jg&&s){const e=l[t];YP(e)&&YP(s.gl)?e.colorSpace=s.gl.outputColorSpace:e.encoding=s.gl.outputEncoding}}wA(e)}if(i&&i.parent&&e.raycast&&l!==i.eventCount){const t=cA(e).getState().internal,n=t.interaction.indexOf(e);n>-1&&t.interaction.splice(n,1),i.eventCount&&t.interaction.push(e)}return!(1===a.length&&"onUpdate"===a[0][0])&&a.length&&null!=(n=e.__r3f)&&n.parent&&SA(e),e}function wA(e){var t,n;const i=null==(t=e.__r3f)||null==(n=t.root)||null==n.getState?void 0:n.getState();i&&0===i.internal.frames&&i.invalidate()}function SA(e){null==e.onUpdate||e.onUpdate(e)}function bA(e,t){e.manual||(QP(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function xA(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function _A(e,t,n,i){const r=n.get(t);r&&(n.delete(t),0===n.size&&(e.delete(i),r.target.releasePointerCapture(i)))}function MA(e){function t(e){return e.filter((e=>["Move","Over","Enter","Out","Leave"].some((t=>{var n;return null==(n=e.__r3f)?void 0:n.handlers["onPointer"+t]}))))}function n(t){const{internal:n}=e.getState();for(const e of n.hovered.values())if(!t.length||!t.find((t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId))){const i=e.eventObject.__r3f,r=null==i?void 0:i.handlers;if(n.hovered.delete(xA(e)),null!=i&&i.eventCount){const n={...e,intersections:t};null==r.onPointerOut||r.onPointerOut(n),null==r.onPointerLeave||r.onPointerLeave(n)}}}function i(e,t){for(let n=0;n<t.length;n++){const i=t[n].__r3f;null==i||null==i.handlers.onPointerMissed||i.handlers.onPointerMissed(e)}}return{handlePointer:function(r){switch(r){case"onPointerLeave":case"onPointerCancel":return()=>n([]);case"onLostPointerCapture":return t=>{const{internal:i}=e.getState();"pointerId"in t&&i.capturedMap.has(t.pointerId)&&requestAnimationFrame((()=>{i.capturedMap.has(t.pointerId)&&(i.capturedMap.delete(t.pointerId),n([]))}))}}return function(s){const{onPointerMissed:o,internal:a}=e.getState();a.lastEvent.current=s;const l="onPointerMove"===r,c="onClick"===r||"onContextMenu"===r||"onDoubleClick"===r,u=function(t,n){const i=e.getState(),r=new Set,s=[],o=n?n(i.internal.interaction):i.internal.interaction;for(let e=0;e<o.length;e++){const t=lA(o[e]);t&&(t.raycaster.camera=void 0)}i.previousRoot||null==i.events.compute||i.events.compute(t,i);let a=o.flatMap((function(e){const n=lA(e);return n&&n.events.enabled&&null!==n.raycaster.camera?(void 0===n.raycaster.camera&&(null==n.events.compute||n.events.compute(t,n,null==(i=n.previousRoot)?void 0:i.getState()),void 0===n.raycaster.camera&&(n.raycaster.camera=null)),n.raycaster.camera?n.raycaster.intersectObject(e,!0):[]):[];var i})).sort(((e,t)=>{const n=lA(e.object),i=lA(t.object);return n&&i&&i.events.priority-n.events.priority||e.distance-t.distance})).filter((e=>{const t=xA(e);return!r.has(t)&&(r.add(t),!0)}));i.events.filter&&(a=i.events.filter(a,i));for(const e of a){let t=e.object;for(;t;){var l;null!=(l=t.__r3f)&&l.eventCount&&s.push({...e,eventObject:t}),t=t.parent}}if("pointerId"in t&&i.internal.capturedMap.has(t.pointerId))for(let e of i.internal.capturedMap.get(t.pointerId).values())r.has(xA(e.intersection))||s.push(e.intersection);return s}(s,l?t:void 0),h=c?function(t){const{internal:n}=e.getState(),i=t.offsetX-n.initialClick[0],r=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(i*i+r*r))}(s):0;"onPointerDown"===r&&(a.initialClick=[s.offsetX,s.offsetY],a.initialHits=u.map((e=>e.eventObject))),c&&!u.length&&h<=2&&(i(s,a.interaction),o&&o(s)),l&&n(u),function(t,i,r,s){const o=e.getState();if(t.length){const e={stopped:!1};for(const a of t){const l=lA(a.object)||o,{raycaster:c,pointer:u,camera:h,internal:d}=l,p=new ey(u.x,u.y,0).unproject(h),g=e=>{var t,n;return null!=(t=null==(n=d.capturedMap.get(e))?void 0:n.has(a.eventObject))&&t},f=e=>{const t={intersection:a,target:i.target};d.capturedMap.has(e)?d.capturedMap.get(e).set(a.eventObject,t):d.capturedMap.set(e,new Map([[a.eventObject,t]])),i.target.setPointerCapture(e)},m=e=>{const t=d.capturedMap.get(e);t&&_A(d.capturedMap,a.eventObject,t,e)};let v={};for(let e in i){let t=i[e];"function"!==typeof t&&(v[e]=t)}let y={...a,...v,pointer:u,intersections:t,stopped:e.stopped,delta:r,unprojectedPoint:p,ray:c.ray,camera:h,stopPropagation(){const r="pointerId"in i&&d.capturedMap.get(i.pointerId);(!r||r.has(a.eventObject))&&(y.stopped=e.stopped=!0,d.hovered.size&&Array.from(d.hovered.values()).find((e=>e.eventObject===a.eventObject)))&&n([...t.slice(0,t.indexOf(a)),a])},target:{hasPointerCapture:g,setPointerCapture:f,releasePointerCapture:m},currentTarget:{hasPointerCapture:g,setPointerCapture:f,releasePointerCapture:m},nativeEvent:i};if(s(y),!0===e.stopped)break}}}(u,s,h,(function(e){const t=e.eventObject,n=t.__r3f,o=null==n?void 0:n.handlers;if(null!=n&&n.eventCount)if(l){if(o.onPointerOver||o.onPointerEnter||o.onPointerOut||o.onPointerLeave){const t=xA(e),n=a.hovered.get(t);n?n.stopped&&e.stopPropagation():(a.hovered.set(t,e),null==o.onPointerOver||o.onPointerOver(e),null==o.onPointerEnter||o.onPointerEnter(e))}null==o.onPointerMove||o.onPointerMove(e)}else{const n=o[r];n?c&&!a.initialHits.includes(t)||(i(s,a.interaction.filter((e=>!a.initialHits.includes(e)))),n(e)):c&&a.initialHits.includes(t)&&i(s,a.interaction.filter((e=>!a.initialHits.includes(e))))}}))}}}}const EA=e=>!(null==e||!e.render),RA=t.createContext(null),TA=(e,n)=>{const i=function(e){const n="function"===typeof e?HP(e):e,i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.getState,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is;const[,r]=(0,t.useReducer)((e=>e+1),0),s=n.getState(),o=(0,t.useRef)(s),a=(0,t.useRef)(e),l=(0,t.useRef)(i),c=(0,t.useRef)(!1),u=(0,t.useRef)();let h;void 0===u.current&&(u.current=e(s));let d=!1;(o.current!==s||a.current!==e||l.current!==i||c.current)&&(h=e(s),d=!i(u.current,h)),GP((()=>{d&&(u.current=h),o.current=s,a.current=e,l.current=i,c.current=!1}));const p=(0,t.useRef)(s);GP((()=>{const e=()=>{try{const e=n.getState(),t=a.current(e);l.current(u.current,t)||(o.current=e,u.current=t,r())}catch(CF){c.current=!0,r()}},t=n.subscribe(e);return n.getState()!==p.current&&e(),t}),[]);const g=d?h:u.current;return(0,t.useDebugValue)(g),g};return Object.assign(i,n),i[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const e=[i,n];return{next(){const t=e.length<=0;return{value:e.shift(),done:t}}}},i}(((i,r)=>{const s=new ey,o=new ey,a=new ey;function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r().camera,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r().size;const{width:i,height:l,top:c,left:u}=n,h=i/l;t.isVector3?a.copy(t):a.set(...t);const d=e.getWorldPosition(s).distanceTo(a);if(QP(e))return{width:i/e.zoom,height:l/e.zoom,top:c,left:u,factor:1,distance:d,aspect:h};{const t=e.fov*Math.PI/180,n=2*Math.tan(t/2)*d,r=n*(i/l);return{width:r,height:n,top:c,left:u,factor:i/r,distance:d,aspect:h}}}let c;const u=e=>i((t=>({performance:{...t.performance,current:e}}))),h=new xv,d={set:i,get:r,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e(r(),t)},advance:(e,t)=>n(e,t,r()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new AM,pointer:h,mouse:h,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const e=r();c&&clearTimeout(c),e.performance.current!==e.performance.min&&u(e.performance.min),c=setTimeout((()=>u(r().performance.max)),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:e=>i((t=>({...t,events:{...t.events,...e}}))),setSize:(e,t,n,s,a)=>{const c=r().camera,u={width:e,height:t,top:s||0,left:a||0,updateStyle:n};i((e=>({size:u,viewport:{...e.viewport,...l(c,o,u)}})))},setDpr:e=>i((t=>{const n=aA(e);return{viewport:{...t.viewport,dpr:n,initialDpr:t.viewport.initialDpr||n}}})),setFrameloop:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"always";const t=r().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),i((()=>({frameloop:e})))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:t.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(e,t,n)=>{const i=r().internal;return i.priority=i.priority+(t>0?1:0),i.subscribers.push({ref:e,priority:t,store:n}),i.subscribers=i.subscribers.sort(((e,t)=>e.priority-t.priority)),()=>{const n=r().internal;null!=n&&n.subscribers&&(n.priority=n.priority-(t>0?1:0),n.subscribers=n.subscribers.filter((t=>t.ref!==e)))}}}};return d})),r=i.getState();let s=r.size,o=r.viewport.dpr,a=r.camera;return i.subscribe((()=>{const{camera:e,size:t,viewport:n,gl:r,set:l}=i.getState();if(t.width!==s.width||t.height!==s.height||n.dpr!==o){var c;s=t,o=n.dpr,bA(e,t),r.setPixelRatio(n.dpr);const i=null!=(c=t.updateStyle)?c:"undefined"!==typeof HTMLCanvasElement&&r.domElement instanceof HTMLCanvasElement;r.setSize(t.width,t.height,i)}e!==a&&(a=e,l((t=>({viewport:{...t.viewport,...t.viewport.getCurrentViewport(e)}}))))})),i.subscribe((t=>e(t))),i};let PA,AA=new Set,FA=new Set,DA=new Set;function LA(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function IA(e,t){switch(e){case"before":return LA(AA,t);case"after":return LA(FA,t);case"tail":return LA(DA,t)}}let kA,OA;function NA(e,t,n){let i=t.clock.getDelta();for("never"===t.frameloop&&"number"===typeof e&&(i=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),kA=t.internal.subscribers,PA=0;PA<kA.length;PA++)OA=kA[PA],OA.ref.current(OA.store.getState(),i,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function BA(){const e=t.useContext(RA);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function zA(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e,t=arguments.length>1?arguments[1]:void 0;return BA()(e,t)}function HA(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=BA(),i=n.getState().internal.subscribe,r=tA(e);return eA((()=>i(r,t,n)),[t,i,n]),null}const GA=new WeakMap;function UA(e,t){return function(n){let i=GA.get(n);i||(i=new n,GA.set(n,i)),e&&e(i);for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return Promise.all(s.map((e=>new Promise(((n,r)=>i.load(e,(e=>{e.scene&&Object.assign(e,hA(e.scene)),n(e)}),t,(t=>r(new Error(`Could not load ${e}: ${null==t?void 0:t.message}`)))))))))}}function VA(e,t,n,i){const r=Array.isArray(t)?t:[t],s=((e,t,n)=>WP(e,t,!1,n))(UA(n,i),[e,...r],{equal:uA.equ});return Array.isArray(t)?s:s[0]}VA.preload=function(e,t,n){const i=Array.isArray(t)?t:[t];return((e,t,n)=>{WP(e,t,!0,n)})(UA(n),[e,...i])},VA.clear=function(e,t){return(e=>{if(void 0===e||0===e.length)UP.splice(0,UP.length);else{const t=UP.find((t=>VP(e,t.keys,t.equal)));t&&t.remove()}})([e,...Array.isArray(t)?t:[t]])};const WA=new Map,{invalidate:jA,advance:qA}=function(e){let t,n,i,r=!1,s=!1;function o(a){n=requestAnimationFrame(o),r=!0,t=0,IA("before",a),s=!0;for(const n of e.values()){var l;i=n.store.getState(),!i.internal.active||!("always"===i.frameloop||i.internal.frames>0)||null!=(l=i.gl.xr)&&l.isPresenting||(t+=NA(a,i))}if(s=!1,IA("after",a),0===t)return IA("tail",a),r=!1,cancelAnimationFrame(n)}return{loop:o,invalidate:function t(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;var a;if(!n)return e.forEach((e=>t(e.store.getState(),i)));null!=(a=n.gl.xr)&&a.isPresenting||!n.internal.active||"never"===n.frameloop||(n.internal.frames=i>1?Math.min(60,n.internal.frames+i):s?2:1,r||(r=!0,requestAnimationFrame(o)))},advance:function(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(n&&IA("before",t),i)NA(t,i,r);else for(const s of e.values())NA(t,s.store.getState());n&&IA("after",t)}}}(WA),{reconciler:XA,applyProps:KA}=function(e,t){function n(e,t,n){let i,{args:r=[],attach:s,...o}=t,a=`${e[0].toUpperCase()}${e.slice(1)}`;if("primitive"===e){if(void 0===o.object)throw new Error("R3F: Primitives without 'object' are invalid!");i=dA(o.object,{type:e,root:n,attach:s,primitive:!0})}else{const t=KP[a];if(!t)throw new Error(`R3F: ${a} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(r))throw new Error("R3F: The args prop must be an array!");i=dA(new t(...r),{type:e,root:n,attach:s,memoizedProps:{args:r}})}return void 0===i.__r3f.attach&&(i.isBufferGeometry?i.__r3f.attach="geometry":i.isMaterial&&(i.__r3f.attach="material")),"inject"!==a&&CA(i,o),i}function i(e,t){let n=!1;var i,r;t&&(null!=(i=t.__r3f)&&i.attach?fA(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.add(t),n=!0),n||null==(r=e.__r3f)||r.objects.push(t),t.__r3f||dA(t,{}),t.__r3f.parent=e,SA(t),wA(t))}function r(e,t,n){let i=!1;if(t){var r,s;if(null!=(r=t.__r3f)&&r.attach)fA(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){t.parent=e,t.dispatchEvent({type:"added"}),e.dispatchEvent({type:"childadded",child:t});const r=e.children.filter((e=>e!==t)),s=r.indexOf(n);e.children=[...r.slice(0,s),t,...r.slice(s)],i=!0}i||null==(s=e.__r3f)||s.objects.push(t),t.__r3f||dA(t,{}),t.__r3f.parent=e,SA(t),wA(t)}}function s(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&[...e].forEach((e=>o(t,e,n)))}function o(e,t,n){if(t){var i,r,o;if(t.__r3f&&(t.__r3f.parent=null),null!=(i=e.__r3f)&&i.objects&&(e.__r3f.objects=e.__r3f.objects.filter((e=>e!==t))),null!=(r=t.__r3f)&&r.attach)mA(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){var a;e.remove(t),null!=(a=t.__r3f)&&a.root&&function(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter((e=>e!==t)),n.initialHits=n.initialHits.filter((e=>e!==t)),n.hovered.forEach(((e,i)=>{e.eventObject!==t&&e.object!==t||n.hovered.delete(i)})),n.capturedMap.forEach(((e,i)=>{_A(n.capturedMap,t,e,i)}))}(cA(t),t)}const c=null==(o=t.__r3f)?void 0:o.primitive,u=!c&&(void 0===n?null!==t.dispose:n);var l;if(!c)s(null==(l=t.__r3f)?void 0:l.objects,t,u),s(t.children,t,u);if(delete t.__r3f,u&&t.dispose&&"Scene"!==t.type){const e=()=>{try{t.dispose()}catch(zD){}};"undefined"===typeof IS_REACT_ACT_ENVIRONMENT?(0,XP.unstable_scheduleCallback)(XP.unstable_IdlePriority,e):e()}wA(e)}}const a=()=>{};return{reconciler:qP()({createInstance:n,removeChild:o,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(e,t)=>{if(!t)return;const n=e.getState().scene;n.__r3f&&(n.__r3f.root=e,i(n,t))},removeChildFromContainer:(e,t)=>{t&&o(e.getState().scene,t)},insertInContainerBefore:(e,t,n)=>{if(!t||!n)return;const i=e.getState().scene;i.__r3f&&r(i,t,n)},getRootHostContext:()=>null,getChildHostContext:e=>e,finalizeInitialChildren(e){var t;const n=null!=(t=null==e?void 0:e.__r3f)?t:{};return Boolean(n.handlers)},prepareUpdate(e,t,n,i){var r;if((null!=(r=null==e?void 0:e.__r3f)?r:{}).primitive&&i.object&&i.object!==e)return[!0];{const{args:t=[],children:r,...s}=i,{args:o=[],children:a,...l}=n;if(!Array.isArray(t))throw new Error("R3F: the args prop must be an array!");if(t.some(((e,t)=>e!==o[t])))return[!0];const c=vA(e,s,l,!0);return c.changes.length?[!1,c]:null}},commitUpdate(e,t,r,s,a,l){let[c,u]=t;c?function(e,t,r,s){var a;const l=null==(a=e.__r3f)?void 0:a.parent;if(!l)return;const c=n(t,r,e.__r3f.root);if(e.children){for(const t of e.children)t.__r3f&&i(c,t);e.children=e.children.filter((e=>!e.__r3f))}e.__r3f.objects.forEach((e=>i(c,e))),e.__r3f.objects=[],e.__r3f.autoRemovedBeforeAppend||o(l,e),c.parent&&(c.__r3f.autoRemovedBeforeAppend=!0),i(l,c),c.raycast&&c.__r3f.eventCount&&cA(c).getState().internal.interaction.push(c);[s,s.alternate].forEach((e=>{null!==e&&(e.stateNode=c,e.ref&&("function"===typeof e.ref?e.ref(c):e.ref.current=c))}))}(e,r,a,l):CA(e,u)},commitMount(e,t,n,i){var r;const s=null!=(r=e.__r3f)?r:{};e.raycast&&s.handlers&&s.eventCount&&cA(e).getState().internal.interaction.push(e)},getPublicInstance:e=>e,prepareForCommit:()=>null,preparePortalMount:e=>dA(e.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(e){var t;const{attach:n,parent:i}=null!=(t=e.__r3f)?t:{};n&&i&&mA(i,e,n),e.isObject3D&&(e.visible=!1),wA(e)},unhideInstance(e,t){var n;const{attach:i,parent:r}=null!=(n=e.__r3f)?n:{};i&&r&&fA(r,e,i),(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0),wA(e)},createTextInstance:a,hideTextInstance:a,unhideTextInstance:a,getCurrentEventPriority:()=>t?t():zP.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:"undefined"!==typeof performance&&uA.fun(performance.now)?performance.now:uA.fun(Date.now)?Date.now:()=>0,scheduleTimeout:uA.fun(setTimeout)?setTimeout:void 0,cancelTimeout:uA.fun(clearTimeout)?clearTimeout:void 0}),applyProps:CA}}(0,(function(){var e;const t="undefined"!==typeof self&&self||"undefined"!==typeof window&&window;if(!t)return zP.DefaultEventPriority;switch(null==(e=t.event)?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return zP.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return zP.ContinuousEventPriority;default:return zP.DefaultEventPriority}})),$A={objects:"shallow",strict:!1},ZA=(e,t)=>{const n="function"===typeof e?e(t):e;return EA(n)?n:new BP({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function YA(e){const t=WA.get(e),n=null==t?void 0:t.fiber,i=null==t?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const r="function"===typeof reportError?reportError:console.error,s=i||TA(jA,qA),o=n||XA.createContainer(s,zP.ConcurrentRoot,null,!1,null,"",r,null);let a;t||WA.set(e,{fiber:o,store:s});let l,c=!1;return{configure(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{gl:n,size:i,scene:r,events:o,onCreated:u,shadows:h=!1,linear:d=!1,flat:p=!1,legacy:g=!1,orthographic:f=!1,frameloop:m="always",dpr:v=[1,2],performance:y,raycaster:C,camera:w,onPointerMissed:S}=t,b=s.getState(),x=b.gl;b.gl||b.set({gl:x=ZA(n,e)});let _=b.raycaster;_||b.set({raycaster:_=new uE});const{params:M,...E}=C||{};if(uA.equ(E,_,$A)||KA(_,{...E}),uA.equ(M,_.params,$A)||KA(_,{params:{..._.params,...M}}),!b.camera||b.camera===l&&!uA.equ(l,w,$A)){l=w;const e=w instanceof yw,t=e?w:f?new oM(0,0,0,0,.1,1e3):new bw(75,0,.1,1e3);e||(t.position.z=5,w&&(KA(t,w),("aspect"in w||"left"in w||"right"in w||"bottom"in w||"top"in w)&&(t.manual=!0,t.updateProjectionMatrix())),b.camera||null!=w&&w.rotation||t.lookAt(0,0,0)),b.set({camera:t}),_.camera=t}if(!b.scene){let e;null!=r&&r.isScene?e=r:(e=new Dw,r&&KA(e,r)),b.set({scene:dA(e)})}if(!b.xr){var R;const e=(e,t)=>{const n=s.getState();"never"!==n.frameloop&&qA(e,!0,n,t)},t=()=>{const t=s.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||jA(t)},n={connect(){const e=s.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){const e=s.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};"function"===typeof(null==(R=x.xr)?void 0:R.addEventListener)&&n.connect(),b.set({xr:n})}if(x.shadowMap){const e=x.shadowMap.enabled,t=x.shadowMap.type;if(x.shadowMap.enabled=!!h,uA.boo(h))x.shadowMap.type=kp;else if(uA.str(h)){var T;const e={basic:Lp,percentage:Ip,soft:kp,variance:Op};x.shadowMap.type=null!=(T=e[h])?T:kp}else uA.obj(h)&&Object.assign(x.shadowMap,h);e===x.shadowMap.enabled&&t===x.shadowMap.type||(x.shadowMap.needsUpdate=!0)}const P=JP();if(P&&("enabled"in P?P.enabled=!g:"legacyMode"in P&&(P.legacyMode=g)),!c){KA(x,{outputEncoding:d?3e3:3001,toneMapping:p?xg:Rg})}b.legacy!==g&&b.set((()=>({legacy:g}))),b.linear!==d&&b.set((()=>({linear:d}))),b.flat!==p&&b.set((()=>({flat:p}))),!n||uA.fun(n)||EA(n)||uA.equ(n,x,$A)||KA(x,n),o&&!b.events.handlers&&b.set({events:o(s)});const A=function(e,t){const n="undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement;if(t){const{width:e,height:i,top:r,left:s,updateStyle:o=n}=t;return{width:e,height:i,top:r,left:s,updateStyle:o}}if("undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:t,height:i,top:r,left:s}=e.parentElement.getBoundingClientRect();return{width:t,height:i,top:r,left:s,updateStyle:n}}return"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0,updateStyle:n}:{width:0,height:0,top:0,left:0}}(e,i);return uA.equ(A,b.size,$A)||b.setSize(A.width,A.height,A.updateStyle,A.top,A.left),v&&b.viewport.dpr!==aA(v)&&b.setDpr(v),b.frameloop!==m&&b.setFrameloop(m),b.onPointerMissed||b.set({onPointerMissed:S}),y&&!uA.equ(y,b.performance,$A)&&b.set((e=>({performance:{...e.performance,...y}}))),a=u,c=!0,this},render(t){return c||this.configure(),XA.updateContainer((0,st.jsx)(JA,{store:s,children:t,onCreated:a,rootElement:e}),o,null,(()=>{})),s},unmount(){QA(e)}}}function JA(e){let{store:t,children:n,onCreated:i,rootElement:r}=e;return eA((()=>{const e=t.getState();e.set((e=>({internal:{...e.internal,active:!0}}))),i&&i(e),t.getState().events.connected||null==e.events.connect||e.events.connect(r)}),[]),(0,st.jsx)(RA.Provider,{value:t,children:n})}function QA(e,t){const n=WA.get(e),i=null==n?void 0:n.fiber;if(i){const r=null==n?void 0:n.store.getState();r&&(r.internal.active=!1),XA.updateContainer(null,i,null,(()=>{r&&setTimeout((()=>{try{var n,i,s,o;null==r.events.disconnect||r.events.disconnect(),null==(n=r.gl)||null==(i=n.renderLists)||null==i.dispose||i.dispose(),null==(s=r.gl)||null==s.forceContextLoss||s.forceContextLoss(),null!=(o=r.gl)&&o.xr&&r.xr.disconnect(),function(e){e.dispose&&"Scene"!==e.type&&e.dispose();for(const t in e)null==t.dispose||t.dispose(),delete e[t]}(r),WA.delete(e),t&&t(e)}catch(zD){}}),500)}))}}XA.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:t.version});t.unstable_act;const eF={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function tF(e){const{handlePointer:t}=MA(e);return{priority:1,enabled:!0,compute(e,t,n){t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(eF).reduce(((e,n)=>({...e,[n]:t(n)})),{}),update:()=>{var t;const{events:n,internal:i}=e.getState();null!=(t=i.lastEvent)&&t.current&&n.handlers&&n.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var n;const{set:i,events:r}=e.getState();null==r.disconnect||r.disconnect(),i((e=>({events:{...e.events,connected:t}}))),Object.entries(null!=(n=r.handlers)?n:[]).forEach((e=>{let[n,i]=e;const[r,s]=eF[n];t.addEventListener(r,i,{passive:s})}))},disconnect:()=>{const{set:t,events:n}=e.getState();var i;n.connected&&(Object.entries(null!=(i=n.handlers)?i:[]).forEach((e=>{let[t,i]=e;if(n&&n.connected instanceof HTMLElement){const[e]=eF[t];n.connected.removeEventListener(e,i)}})),t((e=>({events:{...e.events,connected:void 0}}))))}}}function nF(e,t){let n;return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];window.clearTimeout(n),n=window.setTimeout((()=>e(...r)),t)}}function iF(){let{debounce:e,scroll:n,polyfill:i,offsetSize:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{debounce:0,scroll:!1,offsetSize:!1};const s=i||("undefined"==typeof window?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,a]=(0,t.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=(0,t.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o,orientationHandler:null}),c=e?"number"==typeof e?e:e.scroll:null,u=e?"number"==typeof e?e:e.resize:null,h=(0,t.useRef)(!1);(0,t.useEffect)((()=>(h.current=!0,()=>{h.current=!1})));const[d,p,g]=(0,t.useMemo)((()=>{const e=()=>{if(!l.current.element)return;const{left:e,top:t,width:n,height:i,bottom:s,right:o,x:c,y:u}=l.current.element.getBoundingClientRect(),d={left:e,top:t,width:n,height:i,bottom:s,right:o,x:c,y:u};l.current.element instanceof HTMLElement&&r&&(d.height=l.current.element.offsetHeight,d.width=l.current.element.offsetWidth),Object.freeze(d),h.current&&!oF(l.current.lastBounds,d)&&a(l.current.lastBounds=d)};return[e,u?nF(e,u):e,c?nF(e,c):e]}),[a,r,c,u]);function f(){l.current.scrollContainers&&(l.current.scrollContainers.forEach((e=>e.removeEventListener("scroll",g,!0))),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null),l.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",l.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",l.current.orientationHandler))}function m(){l.current.element&&(l.current.resizeObserver=new s(g),l.current.resizeObserver.observe(l.current.element),n&&l.current.scrollContainers&&l.current.scrollContainers.forEach((e=>e.addEventListener("scroll",g,{capture:!0,passive:!0}))),l.current.orientationHandler=()=>{g()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",l.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",l.current.orientationHandler))}return function(e,n){(0,t.useEffect)((()=>{if(n){const t=e;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}}),[e,n])}(g,!!n),function(e){(0,t.useEffect)((()=>{const t=e;return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}}),[e])}(p),(0,t.useEffect)((()=>{f(),m()}),[n,g,p]),(0,t.useEffect)((()=>f),[]),[e=>{!e||e===l.current.element||(f(),l.current.element=e,l.current.scrollContainers=rF(e),m())},o,d]}function rF(e){const t=[];if(!e||e===document.body)return t;const{overflow:n,overflowX:i,overflowY:r}=window.getComputedStyle(e);return[n,i,r].some((e=>"auto"===e||"scroll"===e))&&t.push(e),[...t,...rF(e.parentElement)]}const sF=["x","y","top","bottom","left","right","width","height"],oF=(e,t)=>sF.every((n=>e[n]===t[n]));var aF,lF,cF=Object.defineProperty,uF=Object.defineProperties,hF=Object.getOwnPropertyDescriptors,dF=Object.getOwnPropertySymbols,pF=Object.prototype.hasOwnProperty,gF=Object.prototype.propertyIsEnumerable,fF=(e,t,n)=>t in e?cF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,mF=(e,t)=>{for(var n in t||(t={}))pF.call(t,n)&&fF(e,n,t[n]);if(dF)for(var n of dF(t))gF.call(t,n)&&fF(e,n,t[n]);return e};"undefined"===typeof window||!(null==(aF=window.document)?void 0:aF.createElement)&&"ReactNative"!==(null==(lF=window.navigator)?void 0:lF.product)?t.useEffect:t.useLayoutEffect;function vF(e,t,n){if(!e)return;if(!0===n(e))return e;let i=t?e.return:e.child;for(;i;){const e=vF(i,t,n);if(e)return e;i=t?null:i.sibling}}function yF(e){try{return Object.defineProperties(e,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch(t){return e}}const CF=console.error;console.error=function(){const e=[...arguments].join("");if(!(null==e?void 0:e.startsWith("Warning:"))||!e.includes("useContext"))return CF.apply(this,arguments);console.error=CF};const wF=yF(t.createContext(null));class SF extends t.Component{render(){return t.createElement(wF.Provider,{value:this._reactInternals},this.props.children)}}function bF(){const e=t.useContext(wF);if(null===e)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const n=t.useId();return t.useMemo((()=>{for(const t of[e,null==e?void 0:e.alternate]){if(!t)continue;const e=vF(t,!1,(e=>{let t=e.memoizedState;for(;t;){if(t.memoizedState===n)return!0;t=t.next}}));if(e)return e}}),[e,n])}function xF(){const e=function(){const e=bF(),[n]=t.useState((()=>new Map));n.clear();let i=e;for(;i;){if(i.type&&"object"===typeof i.type){const e=void 0===i.type._context&&i.type.Provider===i.type?i.type:i.type._context;e&&e!==wF&&!n.has(e)&&n.set(e,t.useContext(yF(e)))}i=i.return}return n}();return t.useMemo((()=>Array.from(e.keys()).reduce(((n,i)=>r=>{return t.createElement(n,null,t.createElement(i.Provider,(s=mF({},r),o={value:e.get(i)},uF(s,hF(o)))));var s,o}),(e=>t.createElement(SF,mF({},e))))),[e])}const _F=t.forwardRef((function(n,i){let{children:r,fallback:s,resize:o,style:a,gl:l,events:c=tF,eventSource:u,eventPrefix:h,shadows:d,linear:p,flat:g,legacy:f,orthographic:m,frameloop:v,dpr:y,performance:C,raycaster:w,camera:S,scene:b,onPointerMissed:x,onCreated:_,...M}=n;t.useMemo((()=>{return t=e,void Object.assign(KP,t);var t}),[]);const E=xF(),[R,T]=iF({scroll:!0,debounce:{scroll:50,resize:0},...o}),P=t.useRef(null),A=t.useRef(null);t.useImperativeHandle(i,(()=>P.current));const F=tA(x),[D,L]=t.useState(!1),[I,k]=t.useState(!1);if(D)throw D;if(I)throw I;const O=t.useRef(null);eA((()=>{const e=P.current;T.width>0&&T.height>0&&e&&(O.current||(O.current=YA(e)),O.current.configure({gl:l,events:c,shadows:d,linear:p,flat:g,legacy:f,orthographic:m,frameloop:v,dpr:y,performance:C,raycaster:w,camera:S,scene:b,size:T,onPointerMissed:function(){return null==F.current?void 0:F.current(...arguments)},onCreated:e=>{var t;null==e.events.connect||e.events.connect(u?(t=u)&&t.hasOwnProperty("current")?u.current:u:A.current),h&&e.setEvents({compute:(e,t)=>{const n=e[h+"X"],i=e[h+"Y"];t.pointer.set(n/t.size.width*2-1,-i/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==_||_(e)}}),O.current.render((0,st.jsx)(E,{children:(0,st.jsx)(iA,{set:k,children:(0,st.jsx)(t.Suspense,{fallback:(0,st.jsx)(nA,{set:L}),children:null!=r?r:null})})})))})),t.useEffect((()=>{const e=P.current;if(e)return()=>QA(e)}),[]);const N=u?"none":"auto";return(0,st.jsx)("div",{ref:A,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:N,...a},...M,children:(0,st.jsx)("div",{ref:R,style:{width:"100%",height:"100%"},children:(0,st.jsx)("canvas",{ref:P,style:{display:"block"},children:s})})})})),MF=t.forwardRef((function(e,t){return(0,st.jsx)(SF,{children:(0,st.jsx)(_F,{...e,ref:t})})}));function EF(){return EF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},EF.apply(null,arguments)}const RF=new ey,TF=new ey,PF=new ey,AF=new xv;function FF(e,t,n){const i=RF.setFromMatrixPosition(e.matrixWorld);i.project(t);const r=n.width/2,s=n.height/2;return[i.x*r+r,-i.y*s+s]}const DF=e=>Math.abs(e)<1e-10?0:e;function LF(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i="matrix3d(";for(let r=0;16!==r;r++)i+=DF(t[r]*e.elements[r])+(15!==r?",":")");return n+i}const IF=(kF=[1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1],e=>LF(e,kF));var kF;const OF=(e,t)=>{return LF(e,[1/(n=t),1/n,1/n,1,-1/n,-1/n,-1/n,-1,1/n,1/n,1/n,1,1,1,1,1],"translate(-50%,-50%)");var n};const NF=t.forwardRef(((e,n)=>{let{children:r,eps:s=.001,style:o,className:a,prepend:l,center:c,fullscreen:u,portal:h,distanceFactor:d,sprite:p=!1,transform:g=!1,occlude:f,onOcclude:m,castShadow:v,receiveShadow:y,material:C,geometry:w,zIndexRange:S=[16777271,0],calculatePosition:b=FF,as:x="div",wrapperClass:_,pointerEvents:M="auto",...E}=e;const{gl:R,camera:T,scene:P,size:A,raycaster:F,events:D,viewport:L}=zA(),[I]=t.useState((()=>document.createElement(x))),k=t.useRef(),O=t.useRef(null),N=t.useRef(0),B=t.useRef([0,0]),z=t.useRef(null),H=t.useRef(null),G=(null==h?void 0:h.current)||D.connected||R.domElement.parentNode,U=t.useRef(null),V=t.useRef(!1),W=t.useMemo((()=>f&&"blending"!==f||Array.isArray(f)&&f.length&&function(e){return e&&"object"===typeof e&&"current"in e}(f[0])),[f]);t.useLayoutEffect((()=>{const e=R.domElement;f&&"blending"===f?(e.style.zIndex=`${Math.floor(S[0]/2)}`,e.style.position="absolute",e.style.pointerEvents="none"):(e.style.zIndex=null,e.style.position=null,e.style.pointerEvents=null)}),[f]),t.useLayoutEffect((()=>{if(O.current){const e=k.current=i.createRoot(I);if(P.updateMatrixWorld(),g)I.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const e=b(O.current,T,A);I.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${e[0]}px,${e[1]}px,0);transform-origin:0 0;`}return G&&(l?G.prepend(I):G.appendChild(I)),()=>{G&&G.removeChild(I),e.unmount()}}}),[G,g]),t.useLayoutEffect((()=>{_&&(I.className=_)}),[_]);const j=t.useMemo((()=>g?{position:"absolute",top:0,left:0,width:A.width,height:A.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:c?"translate3d(-50%,-50%,0)":"none",...u&&{top:-A.height/2,left:-A.width/2,width:A.width,height:A.height},...o}),[o,c,u,A,g]),q=t.useMemo((()=>({position:"absolute",pointerEvents:M})),[M]);t.useLayoutEffect((()=>{var e,i;(V.current=!1,g)?null==(e=k.current)||e.render(t.createElement("div",{ref:z,style:j},t.createElement("div",{ref:H,style:q},t.createElement("div",{ref:n,className:a,style:o,children:r})))):null==(i=k.current)||i.render(t.createElement("div",{ref:n,style:j,className:a,children:r}))}));const X=t.useRef(!0);HA((e=>{if(O.current){T.updateMatrixWorld(),O.current.updateWorldMatrix(!0,!1);const e=g?B.current:b(O.current,T,A);if(g||Math.abs(N.current-T.zoom)>s||Math.abs(B.current[0]-e[0])>s||Math.abs(B.current[1]-e[1])>s){const t=function(e,t){const n=RF.setFromMatrixPosition(e.matrixWorld),i=TF.setFromMatrixPosition(t.matrixWorld),r=n.sub(i),s=t.getWorldDirection(PF);return r.angleTo(s)>Math.PI/2}(O.current,T);let n=!1;W&&(Array.isArray(f)?n=f.map((e=>e.current)):"blending"!==f&&(n=[P]));const i=X.current;if(n){const e=function(e,t,n,i){const r=RF.setFromMatrixPosition(e.matrixWorld),s=r.clone();s.project(t),AF.set(s.x,s.y),n.setFromCamera(AF,t);const o=n.intersectObjects(i,!0);if(o.length){const e=o[0].distance;return r.distanceTo(n.ray.origin)<e}return!0}(O.current,T,F,n);X.current=e&&!t}else X.current=!t;i!==X.current&&(m?m(!X.current):I.style.display=X.current?"block":"none");const r=Math.floor(S[0]/2),s=f?W?[S[0],r]:[r-1,0]:S;if(I.style.zIndex=`${function(e,t,n){if(t instanceof bw||t instanceof oM){const i=RF.setFromMatrixPosition(e.matrixWorld),r=TF.setFromMatrixPosition(t.matrixWorld),s=i.distanceTo(r),o=(n[1]-n[0])/(t.far-t.near),a=n[1]-o*t.far;return Math.round(o*s+a)}}(O.current,T,s)}`,g){const[e,t]=[A.width/2,A.height/2],n=T.projectionMatrix.elements[5]*t,{isOrthographicCamera:i,top:r,left:s,bottom:o,right:a}=T,l=IF(T.matrixWorldInverse),c=i?`scale(${n})translate(${DF(-(a+s)/2)}px,${DF((r+o)/2)}px)`:`translateZ(${n}px)`;let u=O.current.matrixWorld;p&&(u=T.matrixWorldInverse.clone().transpose().copyPosition(u).scale(O.current.scale),u.elements[3]=u.elements[7]=u.elements[11]=0,u.elements[15]=1),I.style.width=A.width+"px",I.style.height=A.height+"px",I.style.perspective=i?"":`${n}px`,z.current&&H.current&&(z.current.style.transform=`${c}${l}translate(${e}px,${t}px)`,H.current.style.transform=OF(u,1/((d||10)/400)))}else{const t=void 0===d?1:function(e,t){if(t instanceof oM)return t.zoom;if(t instanceof bw){const n=RF.setFromMatrixPosition(e.matrixWorld),i=TF.setFromMatrixPosition(t.matrixWorld),r=t.fov*Math.PI/180,s=n.distanceTo(i);return 1/(2*Math.tan(r/2)*s)}return 1}(O.current,T)*d;I.style.transform=`translate3d(${e[0]}px,${e[1]}px,0) scale(${t})`}B.current=e,N.current=T.zoom}}if(!W&&U.current&&!V.current)if(g){if(z.current){const e=z.current.children[0];if(null!=e&&e.clientWidth&&null!=e&&e.clientHeight){const{isOrthographicCamera:t}=T;if(t||w)E.scale&&(Array.isArray(E.scale)?E.scale instanceof ey?U.current.scale.copy(E.scale.clone().divideScalar(1)):U.current.scale.set(1/E.scale[0],1/E.scale[1],1/E.scale[2]):U.current.scale.setScalar(1/E.scale));else{const t=(d||10)/400,n=e.clientWidth*t,i=e.clientHeight*t;U.current.scale.set(n,i,1)}V.current=!0}}}else{const t=I.children[0];if(null!=t&&t.clientWidth&&null!=t&&t.clientHeight){const e=1/L.factor,n=t.clientWidth*e,i=t.clientHeight*e;U.current.scale.set(n,i,1),V.current=!0}U.current.lookAt(e.camera.position)}}));const K=t.useMemo((()=>({vertexShader:g?void 0:'\n          /*\n            This shader is from the THREE\'s SpriteMaterial.\n            We need to turn the backing plane into a Sprite\n            (make it always face the camera) if "transfrom"\n            is false.\n          */\n          #include <common>\n\n          void main() {\n            vec2 center = vec2(0., 1.);\n            float rotation = 0.0;\n\n            // This is somewhat arbitrary, but it seems to work well\n            // Need to figure out how to derive this dynamically if it even matters\n            float size = 0.03;\n\n            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n            vec2 scale;\n            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n            bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n            if ( isPerspective ) scale *= - mvPosition.z;\n\n            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n            vec2 rotatedPosition;\n            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n            mvPosition.xy += rotatedPosition;\n\n            gl_Position = projectionMatrix * mvPosition;\n          }\n      ',fragmentShader:"\n        void main() {\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n        }\n      "})),[g]);return t.createElement("group",EF({},E,{ref:O}),f&&!W&&t.createElement("mesh",{castShadow:v,receiveShadow:y,ref:U},w||t.createElement("planeGeometry",null),C||t.createElement("shaderMaterial",{side:zp,vertexShader:K.vertexShader,fragmentShader:K.fragmentShader})))}));var BF=Object.defineProperty,zF=(e,t,n)=>(((e,t,n)=>{t in e?BF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!==typeof t?t+"":t,n),n);class HF{constructor(){zF(this,"_listeners")}addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,i=n.length;t<i;t++)n[t].call(this,e);e.target=null}}}var GF=Object.defineProperty,UF=(e,t,n)=>(((e,t,n)=>{t in e?GF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!==typeof t?t+"":t,n),n);const VF=new Py,WF=new TS,jF=Math.cos(Math.PI/180*70),qF=(e,t)=>(e%t+t)%t;class XF extends HF{constructor(e,t){super(),UF(this,"object"),UF(this,"domElement"),UF(this,"enabled",!0),UF(this,"target",new ey),UF(this,"minDistance",0),UF(this,"maxDistance",1/0),UF(this,"minZoom",0),UF(this,"maxZoom",1/0),UF(this,"minPolarAngle",0),UF(this,"maxPolarAngle",Math.PI),UF(this,"minAzimuthAngle",-1/0),UF(this,"maxAzimuthAngle",1/0),UF(this,"enableDamping",!1),UF(this,"dampingFactor",.05),UF(this,"enableZoom",!0),UF(this,"zoomSpeed",1),UF(this,"enableRotate",!0),UF(this,"rotateSpeed",1),UF(this,"enablePan",!0),UF(this,"panSpeed",1),UF(this,"screenSpacePanning",!0),UF(this,"keyPanSpeed",7),UF(this,"zoomToCursor",!1),UF(this,"autoRotate",!1),UF(this,"autoRotateSpeed",2),UF(this,"reverseOrbit",!1),UF(this,"reverseHorizontalOrbit",!1),UF(this,"reverseVerticalOrbit",!1),UF(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),UF(this,"mouseButtons",{LEFT:Rp.ROTATE,MIDDLE:Rp.DOLLY,RIGHT:Rp.PAN}),UF(this,"touches",{ONE:Tp.ROTATE,TWO:Tp.DOLLY_PAN}),UF(this,"target0"),UF(this,"position0"),UF(this,"zoom0"),UF(this,"_domElementKeyEvents",null),UF(this,"getPolarAngle"),UF(this,"getAzimuthalAngle"),UF(this,"setPolarAngle"),UF(this,"setAzimuthalAngle"),UF(this,"getDistance"),UF(this,"getZoomScale"),UF(this,"listenToKeyEvents"),UF(this,"stopListenToKeyEvents"),UF(this,"saveState"),UF(this,"reset"),UF(this,"update"),UF(this,"connect"),UF(this,"dispose"),UF(this,"dollyIn"),UF(this,"dollyOut"),UF(this,"getScale"),UF(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>c.phi,this.getAzimuthalAngle=()=>c.theta,this.setPolarAngle=e=>{let t=qF(e,2*Math.PI),i=c.phi;i<0&&(i+=2*Math.PI),t<0&&(t+=2*Math.PI);let r=Math.abs(t-i);2*Math.PI-r<r&&(t<i?t+=2*Math.PI:i+=2*Math.PI),u.phi=t-i,n.update()},this.setAzimuthalAngle=e=>{let t=qF(e,2*Math.PI),i=c.theta;i<0&&(i+=2*Math.PI),t<0&&(t+=2*Math.PI);let r=Math.abs(t-i);2*Math.PI-r<r&&(t<i?t+=2*Math.PI:i+=2*Math.PI),u.theta=t-i,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",Z),this._domElementKeyEvents=e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Z),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(i),n.update(),a=o.NONE},this.update=(()=>{const t=new ey,r=new ey(0,1,0),s=(new Qv).setFromUnitVectors(e.up,r),p=s.clone().invert(),g=new ey,f=new Qv,m=2*Math.PI;return function(){const v=n.object.position;s.setFromUnitVectors(e.up,r),p.copy(s).invert(),t.copy(v).sub(n.target),t.applyQuaternion(s),c.setFromVector3(t),n.autoRotate&&a===o.NONE&&T(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(c.theta+=u.theta*n.dampingFactor,c.phi+=u.phi*n.dampingFactor):(c.theta+=u.theta,c.phi+=u.phi);let y=n.minAzimuthAngle,C=n.maxAzimuthAngle;isFinite(y)&&isFinite(C)&&(y<-Math.PI?y+=m:y>Math.PI&&(y-=m),C<-Math.PI?C+=m:C>Math.PI&&(C-=m),c.theta=y<=C?Math.max(y,Math.min(C,c.theta)):c.theta>(y+C)/2?Math.max(y,c.theta):Math.min(C,c.theta)),c.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,c.phi)),c.makeSafe(),!0===n.enableDamping?n.target.addScaledVector(d,n.dampingFactor):n.target.add(d),n.zoomToCursor&&_||n.object.isOrthographicCamera?c.radius=N(c.radius):c.radius=N(c.radius*h),t.setFromSpherical(c),t.applyQuaternion(p),v.copy(n.target).add(t),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),!0===n.enableDamping?(u.theta*=1-n.dampingFactor,u.phi*=1-n.dampingFactor,d.multiplyScalar(1-n.dampingFactor)):(u.set(0,0,0),d.set(0,0,0));let w=!1;if(n.zoomToCursor&&_){let i=null;if(n.object instanceof bw&&n.object.isPerspectiveCamera){const e=t.length();i=N(e*h);const r=e-i;n.object.position.addScaledVector(b,r),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const e=new ey(x.x,x.y,0);e.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/h)),n.object.updateProjectionMatrix(),w=!0;const r=new ey(x.x,x.y,0);r.unproject(n.object),n.object.position.sub(r).add(e),n.object.updateMatrixWorld(),i=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;null!==i&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(i).add(n.object.position):(VF.origin.copy(n.object.position),VF.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(VF.direction))<jF?e.lookAt(n.target):(WF.setFromNormalAndCoplanarPoint(n.object.up,n.target),VF.intersectPlane(WF,n.target))))}else n.object instanceof oM&&n.object.isOrthographicCamera&&(w=1!==h,w&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/h)),n.object.updateProjectionMatrix()));return h=1,_=!1,!!(w||g.distanceToSquared(n.object.position)>l||8*(1-f.dot(n.object.quaternion))>l)&&(n.dispatchEvent(i),g.copy(n.object.position),f.copy(n.object.quaternion),w=!1,!0)}})(),this.connect=e=>{n.domElement=e,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Y),n.domElement.addEventListener("pointerdown",q),n.domElement.addEventListener("pointercancel",K),n.domElement.addEventListener("wheel",$)},this.dispose=()=>{var e,t,i,r,s,o;n.domElement&&(n.domElement.style.touchAction="auto"),null==(e=n.domElement)||e.removeEventListener("contextmenu",Y),null==(t=n.domElement)||t.removeEventListener("pointerdown",q),null==(i=n.domElement)||i.removeEventListener("pointercancel",K),null==(r=n.domElement)||r.removeEventListener("wheel",$),null==(s=n.domElement)||s.ownerDocument.removeEventListener("pointermove",X),null==(o=n.domElement)||o.ownerDocument.removeEventListener("pointerup",K),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",Z)};const n=this,i={type:"change"},r={type:"start"},s={type:"end"},o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=o.NONE;const l=1e-6,c=new pE,u=new pE;let h=1;const d=new ey,p=new xv,g=new xv,f=new xv,m=new xv,v=new xv,y=new xv,C=new xv,w=new xv,S=new xv,b=new ey,x=new xv;let _=!1;const M=[],E={};function R(){return Math.pow(.95,n.zoomSpeed)}function T(e){n.reverseOrbit||n.reverseHorizontalOrbit?u.theta+=e:u.theta-=e}function P(e){n.reverseOrbit||n.reverseVerticalOrbit?u.phi+=e:u.phi-=e}const A=(()=>{const e=new ey;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),d.add(e)}})(),F=(()=>{const e=new ey;return function(t,i){!0===n.screenSpacePanning?e.setFromMatrixColumn(i,1):(e.setFromMatrixColumn(i,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),d.add(e)}})(),D=(()=>{const e=new ey;return function(t,i){const r=n.domElement;if(r&&n.object instanceof bw&&n.object.isPerspectiveCamera){const s=n.object.position;e.copy(s).sub(n.target);let o=e.length();o*=Math.tan(n.object.fov/2*Math.PI/180),A(2*t*o/r.clientHeight,n.object.matrix),F(2*i*o/r.clientHeight,n.object.matrix)}else r&&n.object instanceof oM&&n.object.isOrthographicCamera?(A(t*(n.object.right-n.object.left)/n.object.zoom/r.clientWidth,n.object.matrix),F(i*(n.object.top-n.object.bottom)/n.object.zoom/r.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function L(e){n.object instanceof bw&&n.object.isPerspectiveCamera||n.object instanceof oM&&n.object.isOrthographicCamera?h=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function I(e){L(h/e)}function k(e){L(h*e)}function O(e){if(!n.zoomToCursor||!n.domElement)return;_=!0;const t=n.domElement.getBoundingClientRect(),i=e.clientX-t.left,r=e.clientY-t.top,s=t.width,o=t.height;x.x=i/s*2-1,x.y=-r/o*2+1,b.set(x.x,x.y,1).unproject(n.object).sub(n.object.position).normalize()}function N(e){return Math.max(n.minDistance,Math.min(n.maxDistance,e))}function B(e){p.set(e.clientX,e.clientY)}function z(e){m.set(e.clientX,e.clientY)}function H(){if(1==M.length)p.set(M[0].pageX,M[0].pageY);else{const e=.5*(M[0].pageX+M[1].pageX),t=.5*(M[0].pageY+M[1].pageY);p.set(e,t)}}function G(){if(1==M.length)m.set(M[0].pageX,M[0].pageY);else{const e=.5*(M[0].pageX+M[1].pageX),t=.5*(M[0].pageY+M[1].pageY);m.set(e,t)}}function U(){const e=M[0].pageX-M[1].pageX,t=M[0].pageY-M[1].pageY,n=Math.sqrt(e*e+t*t);C.set(0,n)}function V(e){if(1==M.length)g.set(e.pageX,e.pageY);else{const t=Q(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);g.set(n,i)}f.subVectors(g,p).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(T(2*Math.PI*f.x/t.clientHeight),P(2*Math.PI*f.y/t.clientHeight)),p.copy(g)}function W(e){if(1==M.length)v.set(e.pageX,e.pageY);else{const t=Q(e),n=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);v.set(n,i)}y.subVectors(v,m).multiplyScalar(n.panSpeed),D(y.x,y.y),m.copy(v)}function j(e){const t=Q(e),i=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(i*i+r*r);w.set(0,s),S.set(0,Math.pow(w.y/C.y,n.zoomSpeed)),I(S.y),C.copy(w)}function q(e){var t,i;!1!==n.enabled&&(0===M.length&&(null==(t=n.domElement)||t.ownerDocument.addEventListener("pointermove",X),null==(i=n.domElement)||i.ownerDocument.addEventListener("pointerup",K)),function(e){M.push(e)}(e),"touch"===e.pointerType?function(e){switch(J(e),M.length){case 1:switch(n.touches.ONE){case Tp.ROTATE:if(!1===n.enableRotate)return;H(),a=o.TOUCH_ROTATE;break;case Tp.PAN:if(!1===n.enablePan)return;G(),a=o.TOUCH_PAN;break;default:a=o.NONE}break;case 2:switch(n.touches.TWO){case Tp.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&U(),n.enablePan&&G(),a=o.TOUCH_DOLLY_PAN;break;case Tp.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&U(),n.enableRotate&&H(),a=o.TOUCH_DOLLY_ROTATE;break;default:a=o.NONE}break;default:a=o.NONE}a!==o.NONE&&n.dispatchEvent(r)}(e):function(e){let t;switch(e.button){case 0:t=n.mouseButtons.LEFT;break;case 1:t=n.mouseButtons.MIDDLE;break;case 2:t=n.mouseButtons.RIGHT;break;default:t=-1}switch(t){case Rp.DOLLY:if(!1===n.enableZoom)return;!function(e){O(e),C.set(e.clientX,e.clientY)}(e),a=o.DOLLY;break;case Rp.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;z(e),a=o.PAN}else{if(!1===n.enableRotate)return;B(e),a=o.ROTATE}break;case Rp.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;B(e),a=o.ROTATE}else{if(!1===n.enablePan)return;z(e),a=o.PAN}break;default:a=o.NONE}a!==o.NONE&&n.dispatchEvent(r)}(e))}function X(e){!1!==n.enabled&&("touch"===e.pointerType?function(e){switch(J(e),a){case o.TOUCH_ROTATE:if(!1===n.enableRotate)return;V(e),n.update();break;case o.TOUCH_PAN:if(!1===n.enablePan)return;W(e),n.update();break;case o.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;!function(e){n.enableZoom&&j(e),n.enablePan&&W(e)}(e),n.update();break;case o.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;!function(e){n.enableZoom&&j(e),n.enableRotate&&V(e)}(e),n.update();break;default:a=o.NONE}}(e):function(e){if(!1===n.enabled)return;switch(a){case o.ROTATE:if(!1===n.enableRotate)return;!function(e){g.set(e.clientX,e.clientY),f.subVectors(g,p).multiplyScalar(n.rotateSpeed);const t=n.domElement;t&&(T(2*Math.PI*f.x/t.clientHeight),P(2*Math.PI*f.y/t.clientHeight)),p.copy(g),n.update()}(e);break;case o.DOLLY:if(!1===n.enableZoom)return;!function(e){w.set(e.clientX,e.clientY),S.subVectors(w,C),S.y>0?I(R()):S.y<0&&k(R()),C.copy(w),n.update()}(e);break;case o.PAN:if(!1===n.enablePan)return;!function(e){v.set(e.clientX,e.clientY),y.subVectors(v,m).multiplyScalar(n.panSpeed),D(y.x,y.y),m.copy(v),n.update()}(e)}}(e))}function K(e){var t,i,r;!function(e){delete E[e.pointerId];for(let t=0;t<M.length;t++)if(M[t].pointerId==e.pointerId)return void M.splice(t,1)}(e),0===M.length&&(null==(t=n.domElement)||t.releasePointerCapture(e.pointerId),null==(i=n.domElement)||i.ownerDocument.removeEventListener("pointermove",X),null==(r=n.domElement)||r.ownerDocument.removeEventListener("pointerup",K)),n.dispatchEvent(s),a=o.NONE}function $(e){!1===n.enabled||!1===n.enableZoom||a!==o.NONE&&a!==o.ROTATE||(e.preventDefault(),n.dispatchEvent(r),function(e){O(e),e.deltaY<0?k(R()):e.deltaY>0&&I(R()),n.update()}(e),n.dispatchEvent(s))}function Z(e){!1!==n.enabled&&!1!==n.enablePan&&function(e){let t=!1;switch(e.code){case n.keys.UP:D(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:D(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:D(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:D(-n.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),n.update())}(e)}function Y(e){!1!==n.enabled&&e.preventDefault()}function J(e){let t=E[e.pointerId];void 0===t&&(t=new xv,E[e.pointerId]=t),t.set(e.pageX,e.pageY)}function Q(e){const t=e.pointerId===M[0].pointerId?M[1]:M[0];return E[t.pointerId]}this.dollyIn=function(){k(arguments.length>0&&void 0!==arguments[0]?arguments[0]:R()),n.update()},this.dollyOut=function(){I(arguments.length>0&&void 0!==arguments[0]?arguments[0]:R()),n.update()},this.getScale=()=>h,this.setScale=e=>{L(e),n.update()},this.getZoomScale=()=>R(),void 0!==t&&this.connect(t),this.update()}}const KF=t.forwardRef(((e,n)=>{let{makeDefault:i,camera:r,regress:s,domElement:o,enableDamping:a=!0,keyEvents:l=!1,onChange:c,onStart:u,onEnd:h,...d}=e;const p=zA((e=>e.invalidate)),g=zA((e=>e.camera)),f=zA((e=>e.gl)),m=zA((e=>e.events)),v=zA((e=>e.setEvents)),y=zA((e=>e.set)),C=zA((e=>e.get)),w=zA((e=>e.performance)),S=r||g,b=o||m.connected||f.domElement,x=t.useMemo((()=>new XF(S)),[S]);return HA((()=>{x.enabled&&x.update()}),-1),t.useEffect((()=>(l&&x.connect(!0===l?b:l),x.connect(b),()=>{x.dispose()})),[l,b,s,x,p]),t.useEffect((()=>{const e=e=>{p(),s&&w.regress(),c&&c(e)},t=e=>{u&&u(e)},n=e=>{h&&h(e)};return x.addEventListener("change",e),x.addEventListener("start",t),x.addEventListener("end",n),()=>{x.removeEventListener("start",t),x.removeEventListener("end",n),x.removeEventListener("change",e)}}),[c,u,h,x,p,v]),t.useEffect((()=>{if(i){const e=C().controls;return y({controls:x}),()=>y({controls:e})}}),[i,x]),t.createElement("primitive",EF({ref:n,object:x,enableDamping:a},d))}));const $F=(0,t.createContext)(null),ZF=$F.Provider;function YF(){const e=(0,t.useContext)($F);if(null==e)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}var JF=n(228),QF=n.n(JF);function eD(){return eD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},eD.apply(this,arguments)}function tD(e,n){let{bounds:i,boundsOptions:r,center:s,children:o,className:a,id:l,placeholder:c,style:u,whenReady:h,zoom:d,...p}=e;const[g]=(0,t.useState)({className:a,id:l,style:u}),[f,m]=(0,t.useState)(null);(0,t.useImperativeHandle)(n,(()=>f?.map??null),[f]);const v=(0,t.useCallback)((e=>{if(null!==e&&null===f){const t=new JF.Map(e,p);null!=s&&null!=d?t.setView(s,d):null!=i&&t.fitBounds(i,r),null!=h&&t.whenReady(h),m(function(e){return Object.freeze({__version:1,map:e})}(t))}}),[]);(0,t.useEffect)((()=>()=>{f?.map.remove()}),[f]);const y=f?t.createElement(ZF,{value:f},o):c??null;return t.createElement("div",eD({},g,{ref:v}),y)}const nD=(0,t.forwardRef)(tD);function iD(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function rD(e,n){return null==n?function(n,i){const r=(0,t.useRef)();return r.current||(r.current=e(n,i)),r}:function(i,r){const s=(0,t.useRef)();s.current||(s.current=e(i,r));const o=(0,t.useRef)(i),{instance:a}=s.current;return(0,t.useEffect)((function(){o.current!==i&&(n(a,i,o.current),o.current=i)}),[a,i,r]),s}}function sD(e,n){const i=(0,t.useRef)(n);(0,t.useEffect)((function(){n!==i.current&&null!=e.attributionControl&&(null!=i.current&&e.attributionControl.removeAttribution(i.current),null!=n&&e.attributionControl.addAttribution(n)),i.current=n}),[e,n])}function oD(e,n){const i=(0,t.useRef)();(0,t.useEffect)((function(){return null!=n&&e.instance.on(n),i.current=n,function(){null!=i.current&&e.instance.off(i.current),i.current=null}}),[e,n])}function aD(e,t){const n=e.pane??t.pane;return n?{...e,pane:n}:e}function lD(e){return function(n){const i=YF(),r=e(aD(n,i),i);return sD(i.map,n.attribution),oD(r.current,n.eventHandlers),function(e,n){(0,t.useEffect)((function(){return(n.layerContainer??n.map).addLayer(e.instance),function(){n.layerContainer?.removeLayer(e.instance),n.map.removeLayer(e.instance)}}),[n,e])}(r.current,i),r}}const cD=(uD=function(e,t){let{url:n,...i}=e;return iD(new JF.TileLayer(n,aD(i,t)),t)},function(e){function n(n,i){const{instance:r}=e(n).current;return(0,t.useImperativeHandle)(i,(()=>r)),null}return(0,t.forwardRef)(n)}(lD(rD(uD,(function(e,t,n){!function(e,t,n){const{opacity:i,zIndex:r}=t;null!=i&&i!==n.opacity&&e.setOpacity(i),null!=r&&r!==n.zIndex&&e.setZIndex(r)}(e,t,n);const{url:i}=t;null!=i&&i!==n.url&&e.setUrl(i)})))));var uD;const hD=function(e,n){return function(e){function n(n,i){const{instance:r,context:s}=e(n).current;return(0,t.useImperativeHandle)(i,(()=>r)),null==n.children?null:t.createElement(ZF,{value:s},n.children)}return(0,t.forwardRef)(n)}(lD(rD(e,n)))}((function(e,t){let{position:n,...i}=e;const r=new JF.Marker(n,i);return iD(r,(s=t,o={overlayContainer:r},Object.freeze({...s,...o})));var s,o}),(function(e,t,n){t.position!==n.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==n.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==n.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==n.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==n.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())})),dD=function(e,n){const i=function(e,t){return function(n,i){const r=YF(),s=e(aD(n,r),r);return sD(r.map,n.attribution),oD(s.current,n.eventHandlers),t(s.current,r,n,i),s}}(rD(e),n);return function(e){function n(n,i){const[r,s]=(0,t.useState)(!1),{instance:o}=e(n,s).current;(0,t.useImperativeHandle)(i,(()=>o)),(0,t.useEffect)((function(){r&&o.update()}),[o,r,n.children]);const a=o._contentNode;return a?(0,Cd.createPortal)(n.children,a):null}return(0,t.forwardRef)(n)}(i)}((function(e,t){return iD(new JF.Popup(e,t.overlayContainer),t)}),(function(e,n,i,r){let{position:s}=i;(0,t.useEffect)((function(){const{instance:t}=e;function i(e){e.popup===t&&(t.update(),r(!0))}function o(e){e.popup===t&&r(!1)}return n.map.on({popupopen:i,popupclose:o}),null==n.overlayContainer?(null!=s&&t.setLatLng(s),t.openOn(n.map)):n.overlayContainer.bindPopup(t),function(){n.map.off({popupopen:i,popupclose:o}),n.overlayContainer?.unbindPopup(),n.map.removeLayer(t)}}),[e,n,r,s])})),pD=n.p+"static/media/location.65b3dab66a019895e632.png",gD=[{available:!1,company_name:"\uc0bc\uc131\uc804\uc790",product_name:"SSD 1TB",slot_name:"SLOT-0-0-0"},{available:!0,company_name:"",product_name:"",slot_name:"SLOT-1-0-0"},{available:!1,company_name:"LG\uc804\uc790",product_name:"TV \ud328\ub110",slot_name:"SLOT-2-0-0"}],fD=[{id:1,company_name:"CJ\ub300\ud55c\ud1b5\uc6b4",product_name:"\ud3ec\uc7a5 \ubc15\uc2a4"},{id:2,company_name:"\ucfe0\ud321",product_name:"\ubb3c\ub958 \uc2a4\ud2f0\ucee4"}];delete QF().Icon.Default.prototype._getIconUrl,QF().Icon.Default.mergeOptions({iconRetinaUrl:n(249),iconUrl:n(24),shadowUrl:n(71)});const mD=[{id:1,name:"\ubcf4\uad00\uc18c A",lat:37.5665,lng:126.978},{id:2,name:"\ubcf4\uad00\uc18c B",lat:37.5668,lng:126.9782},{id:3,name:"\ubcf4\uad00\uc18c C",lat:37.5662,lng:126.9778},{id:4,name:"\ubcf4\uad00\uc18c D",lat:37.5666,lng:126.9785},{id:5,name:"\ubcf4\uad00\uc18c E",lat:37.5661,lng:126.9783},{id:6,name:"\ubcf4\uad00\uc18c F",lat:37.5664,lng:126.9775},{id:7,name:"\ubcf4\uad00\uc18c G",lat:37.5663,lng:126.9787},{id:8,name:"\ubcf4\uad00\uc18c H",lat:37.5669,lng:126.9779},{id:9,name:"\ubcf4\uad00\uc18c I",lat:37.566,lng:126.9781}],vD=e=>{let{position:n,slot:i,index:r,onClick:s}=e;const o=(0,t.useRef)();return(0,st.jsxs)("group",{position:n,children:[(0,st.jsxs)("mesh",{ref:o,onClick:()=>i.available&&s(r),castShadow:!0,children:[(0,st.jsx)("boxGeometry",{args:[1.8,1.2,1]}),(0,st.jsx)("meshStandardMaterial",{color:i.available?"#f5e3ff":"#c25afa",metalness:.4,roughness:.8})]}),(0,st.jsx)(NF,{position:[0,0,.6],transform:!0,occlude:!0,children:(0,st.jsx)("div",{style:{color:"white",fontSize:"10px",textAlign:"center",maxWidth:"120px",whiteSpace:"normal",overflowWrap:"break-word",wordBreak:"break-word",padding:"5px 8px",borderRadius:"6px",transform:"rotateY(0deg) rotateX(0deg)"},children:i.available?"":(0,st.jsxs)(st.Fragment,{children:[(0,st.jsx)("div",{style:{fontWeight:"bold"},children:i.company_name}),(0,st.jsx)("div",{children:i.product_name}),(0,st.jsx)("div",{style:{fontSize:"10px",opacity:.6},children:i.slot_name})]})})})]})},yD=()=>{const[e,n]=(0,t.useState)([]),[i,r]=(0,t.useState)([]),[s,o]=(0,t.useState)(null),[a,l]=(0,t.useState)(!1),c=new(QF().Icon)({iconUrl:pD,iconSize:[30,30],iconAnchor:[15,42],popupAnchor:[0,-40]});return(0,st.jsx)("div",{style:wD.container,children:(0,st.jsxs)("div",{style:wD.content,children:[(0,st.jsx)("h2",{style:wD.sectionTitle,children:"\ucc3d\uace0 \ud604\ud669"}),(0,st.jsxs)(nD,{center:[37.5664,126.9782],zoom:30,scrollWheelZoom:!0,style:{height:"600px",width:"100%",borderRadius:"12px",boxShadow:"0 6px 12px rgba(0,0,0,0.1)",overflow:"hidden"},children:[(0,st.jsx)(cD,{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attribution:'\xa9 <a href="https://carto.com/">CARTO</a>'}),mD.map((t=>(0,st.jsx)(hD,{position:[t.lat,t.lng],icon:c,eventHandlers:{click:()=>(async()=>{n(gD),r(fD)})(t.id)},children:(0,st.jsx)(dD,{className:"custom-popup",children:(0,st.jsxs)("div",{style:{padding:"10px",textAlign:"center",width:"150px"},children:[(0,st.jsxs)("h4",{style:{marginBottom:"12px",fontSize:"16px",color:"#6f47c5",fontWeight:"bold"},children:["\ud83d\udce6 ",t.name]}),(0,st.jsxs)("div",{style:{backgroundColor:"#e3ddff",padding:"8px",borderRadius:"6px",marginBottom:"8px",fontSize:"13px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,st.jsx)("span",{children:"\u2705 \ubc30\uc815 \uc2ac\ub86f"}),(0,st.jsxs)("strong",{style:{color:"#4a27c5"},children:[e.filter((e=>!e.available)).length,"\uac1c"]})]}),(0,st.jsxs)("div",{style:{backgroundColor:"#e7f8ec",padding:"8px",borderRadius:"6px",marginBottom:"10px",fontSize:"13px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,st.jsx)("span",{children:"\u2705 \ub0a8\uc740 \uc2ac\ub86f"}),(0,st.jsxs)("strong",{style:{color:"#4a27c5"},children:[e.filter((e=>e.available)).length,"\uac1c"]})]}),(0,st.jsxs)("div",{style:{backgroundColor:"#ffe3e3",padding:"8px",borderRadius:"6px",marginBottom:"10px",fontSize:"13px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,st.jsx)("span",{children:"\u26d4 \ubbf8\ubc30\uc815"}),(0,st.jsxs)("strong",{style:{color:"#c54242"},children:[i.length,"\uac74"]})]}),(0,st.jsx)("button",{onClick:()=>{o(t),l(!0)},style:{width:"100%",padding:"6px 12px",backgroundColor:"#6f47c5",color:"white",border:"none",borderRadius:"6px",fontSize:"13px",cursor:"pointer",boxShadow:"0px 2px 6px rgba(0, 0, 0, 0.15)"},children:"\uc704\uce58 \uc9c0\uc815"})]})})},t.id)))]}),a&&s&&(0,st.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:1e3,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,st.jsxs)("div",{style:wD.modalContent,children:[(0,st.jsxs)("div",{style:wD.modalHeader,children:[(0,st.jsxs)("h3",{style:wD.modalTitle,children:["\ud83d\udccd ",s.name]}),(0,st.jsx)("button",{onClick:()=>l(!1),style:wD.closeButton,children:"\xd7"})]}),(0,st.jsxs)("div",{style:{display:"flex",gap:"10px",marginTop:"10px"},children:[(0,st.jsx)("div",{style:{backgroundColor:"#c25afa",padding:"4px 10px",borderRadius:"6px",fontSize:"12px",color:"white"},children:"    "})," \uc774\uc6a9\uc911",(0,st.jsx)("div",{style:{backgroundColor:"#f5e3ff",padding:"4px 10px",borderRadius:"6px",fontSize:"12px",color:"#4f47c5"},children:"   "})," \ube44\uc5b4\uc788\uc74c"]}),(0,st.jsx)(CD,{locationId:s.id})]})})]})})},CD=e=>{let{locationId:n}=e;const[i,r]=(0,t.useState)(null),[s,o]=(0,t.useState)([]),[a,l]=(0,t.useState)([]),[c,u]=(0,t.useState)(null),[h,d]=(0,t.useState)(!1);(0,t.useEffect)((()=>{o(gD)}),[n]);const p=e=>{u(e),l(fD),d(!0)},g=e=>({x:e%3,y:Math.floor(e/3)%3,z:Math.floor(e/9)});return(0,st.jsxs)(st.Fragment,{children:[(0,st.jsx)("div",{style:{height:"600px",width:"100%",overflow:"hidden"},children:(0,st.jsxs)(MF,{camera:{position:[10,5,10],fov:45},shadows:!0,children:[(0,st.jsx)("ambientLight",{intensity:.7}),(0,st.jsx)("directionalLight",{position:[5,10,5],intensity:1.2,castShadow:!0}),(0,st.jsx)(KF,{enableZoom:!0,enableRotate:!0,minPolarAngle:Math.PI/3,maxPolarAngle:Math.PI/2}),Array.from({length:45}).map(((e,t)=>{const{x:n,y:i,z:r}=g(t),o=[2*(n-1),2*i,2*(2-r)],a=s[t]||{available:!0,company_name:"",product_name:""};return(0,st.jsx)(vD,{position:o,slot:{...a,coords:`(${n}, ${i}, ${r})`},index:t,onClick:p},t)}))]})}),h&&(0,st.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.6)",zIndex:2e3,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,st.jsxs)("div",{style:{backgroundColor:"#fff",padding:"24px",borderRadius:"12px",width:"90%",maxWidth:"420px",boxShadow:"0 6px 18px rgba(0,0,0,0.25)",backdropFilter:"blur(8px)",zIndex:2100},children:[(0,st.jsx)("h3",{style:{fontSize:"18px",color:"#4f47c5",marginBottom:"16px"},children:"\ud83d\udcbc \uc2ac\ub86f\uc5d0 \ubb3c\ud488 \ud560\ub2f9"}),(0,st.jsx)("ul",{style:{listStyle:"none",padding:0,maxHeight:"300px",overflowY:"auto",backgroundColor:"#fff"},children:a.map((e=>(0,st.jsxs)("li",{onClick:()=>(e=>{const{x:t,y:n,z:i}=g(c),r=`SLOT-${t}-${n}-${i}`,a=s.map(((t,n)=>n===c?{...t,available:!1,product_name:e,company_name:"Mock\uc5c5\uccb4",slot_name:r}:t));o(a),d(!1),alert(`\uc2ac\ub86f ${r}\uc5d0 ${e} \ubc30\uc815 \uc644\ub8cc`)})(e.product_name),style:{padding:"10px 14px",marginBottom:"8px",borderRadius:"8px",backgroundColor:"#f4f2ff",cursor:"pointer",fontSize:"14px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,st.jsx)("span",{children:e.company_name}),(0,st.jsx)("strong",{children:e.product_name})]},e.id)))}),(0,st.jsx)("button",{onClick:()=>d(!1),style:{marginTop:"12px",width:"100%",padding:"10px",backgroundColor:"#6f47c5",color:"#fff",border:"none",borderRadius:"8px",fontSize:"15px",cursor:"pointer"},children:"\ub2eb\uae30"})]})})]})},wD={container:{padding:"20px"},content:{backgroundColor:"#ffffff",borderRadius:"8px",padding:"20px"},sectionTitle:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"15px",paddingBottom:"10px",borderBottom:"2px solid #6f47c5"},grid:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px",marginTop:"20px",padding:"10px"},slot:{height:"140px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:"20px",fontWeight:"600",fontSize:"14px",textAlign:"center",padding:"16px",whiteSpace:"pre-wrap",background:"linear-gradient(135deg, #6f8af7 0%, #4f5bd5 100%)",color:"#fff",boxShadow:"10px 20px 30px rgba(0,0,0,0.2)",transform:"rotateX(10deg) rotateY(-5deg)",transformStyle:"preserve-3d",perspective:"800px",transition:"transform 0.4s ease",userSelect:"none"},slotHover:{transform:"scale(1.05) rotateX(5deg) rotateY(5deg)",boxShadow:"0 12px 24px rgba(0, 0, 0, 0.25)"},modalContent:{backgroundColor:"white",padding:"30px",borderRadius:"10px",minWidth:"600px",position:"relative",boxShadow:"0 8px 20px rgba(0,0,0,0.2)"},modalHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},modalTitle:{color:"#6f47c5",fontSize:"18px",fontWeight:"bold",margin:0},modalListItem:{cursor:"pointer",padding:"8px",borderBottom:"1px solid #eee",fontSize:"14px",transition:"background 0.2s ease"},closeButton:{border:"none",backgroundColor:"#6f47c5",color:"white",fontSize:"16px",fontWeight:"bold",borderRadius:"50%",width:"30px",height:"30px",lineHeight:"30px",textAlign:"center",cursor:"pointer",boxShadow:"0 2px 6px rgba(0, 0, 0, 0.15)"}},SD=[{id:1,title:"\uc0bc\uc131\uc804\uc790 \uacc4\uc57d\uc11c",content:"\uc0bc\uc131 \ub0c9\uc7a5\uace0 100\ub300 \uacc4\uc57d\uc11c \ub0b4\uc6a9\uc785\ub2c8\ub2e4.",terms:"3\uac1c\uc6d4",signature:"\ud64d\uae38\ub3d9"},{id:2,title:"LG\uc804\uc790 \uacc4\uc57d\uc11c",content:"LG \uc138\ud0c1\uae30 80\ub300 \uacc4\uc57d\uc11c \ub0b4\uc6a9\uc785\ub2c8\ub2e4.",terms:"1\uac1c\uc6d4",signature:"\uc774\uc21c\uc2e0"},{id:3,title:"\ud604\ub300\ucc28 \ubd80\ud488 \uacc4\uc57d\uc11c",content:"\uc790\ub3d9\ucc28 \ubd80\ud488 \ubcf4\uad00 \uacc4\uc57d\uc11c",terms:"6\uac1c\uc6d4",signature:"\uc720\uc7ac\uc11d"}];const bD={border:"1px solid #e0dff3",padding:"10px 14px",fontWeight:600,backgroundColor:"#f4f1fb",color:"#5a3ea1",width:"35%",fontSize:"13px",textAlign:"left"},xD={border:"1px solid #e0dff3",padding:"10px 14px",backgroundColor:"#ffffff",fontSize:"12px",color:"#333",textAlign:"left"},_D=function(e){let{contract:n,isOpen:i,onClose:r}=e;const s=(0,t.useRef)(null),o=(0,t.useRef)(null),a=(0,t.useRef)(null),[l,c]=(0,t.useState)(1),[u,h]=(0,t.useState)(""),[d,p]=(0,t.useState)({title:"",content:"",terms:"",signature:""}),[g,f]=(0,t.useState)(!0),[m,v]=(0,t.useState)(!0),[y,C]=(0,t.useState)(null),[w,S]=(0,t.useState)({}),[b,x]=(0,t.useState)({}),_=async e=>{try{const t=SD.find((t=>t.id===e));if(!t)throw new Error("Mock \ub370\uc774\ud130\uc5d0\uc11c \uacc4\uc57d\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");p({title:t.title||"",content:t.content||"",terms:t.terms||"",signature:t.signature||""}),C(t)}catch(CF){console.error("\uacc4\uc57d\uc11c \ud3fc \ub85c\ub4dc \uc2e4\ud328:",CF)}},[M,E]=(0,t.useState)(!0);(0,t.useEffect)((()=>{null!==n&&void 0!==n&&n.id&&(E(!0),_(n.id).finally((()=>E(!1))),h(`/mock/barcode_${n.id}.png`),console.log("\uacc4\uc57d\ub370\uc774\ud130:",n),f(!0),v(!0))}),[n]);const R=(e,t)=>{p((n=>({...n,[e]:t})))},T=e=>{e&&e.preventDefault(),r()},P=()=>{window.print()};if(!i)return null;const A={padding:"10px 20px",margin:"10px 5px",borderRadius:"5px",border:"none",cursor:"pointer",color:"white",fontSize:"14px"},F={padding:"8px 16px",margin:"0 5px",border:"none",borderRadius:"4px",cursor:"pointer",backgroundColor:"#f0f0f0",color:"#333",fontSize:"14px",transition:"all 0.3s ease"},D={...F,backgroundColor:"#6f47c5",color:"white"},L={fontSize:"20px",fontWeight:"bold",color:"#333",marginBottom:"20px",borderBottom:"2px solid #6f47c5",paddingBottom:"10px"};return(null===n||void 0===n?void 0:n.contract_id)||null===n||void 0===n||n.id,(0,st.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:T,children:(0,st.jsxs)("div",{style:{backgroundColor:"#ffffff",padding:"30px",borderRadius:"12px",height:"80%",width:"90%",maxWidth:"600px",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.2)",position:"relative",textAlign:"center"},onClick:e=>e.stopPropagation(),children:[(0,st.jsx)("button",{style:{position:"absolute",top:"10px",right:"10px",border:"none",borderRadius:"50%",background:"#b794ff",fontSize:"20px",cursor:"pointer",color:"white"},onClick:T,children:"\xd7"}),(0,st.jsxs)("div",{style:{marginBottom:"10px",textAlign:"center"},children:[(0,st.jsx)("button",{style:1===l?D:F,onClick:()=>c(1),children:"\uc2e4\uacac\uc801 \uacc4\uc0b0\uae30"}),(0,st.jsx)("button",{style:2===l?D:F,onClick:()=>c(2),children:"\ucc3d\uace0 \ud604\ud669"}),(0,st.jsx)("button",{style:3===l?D:F,onClick:()=>c(3),children:"\uacc4\uc57d\uc11c \uc791\uc131"}),(0,st.jsx)("button",{style:4===l?D:F,onClick:()=>c(4),children:"\uacc4\uc57d \uc0c1\uc138 \uc815\ubcf4"})]}),1===l&&(0,st.jsxs)("div",{style:{maxWidth:"1300px",height:"calc(100vh - 200px)",margin:"0 auto",overflow:"auto"},children:[(0,st.jsx)("h2",{style:L,children:"\uc2e4\uacac\uc801 \uacc4\uc0b0\ud558\uae30"}),(0,st.jsx)(_p,{selectedRowData:y,onUpdate:async e=>{try{var t;const i=null!==(t=e.total_cost)&&void 0!==t?t:0,r=`\n                \ubc1c\ud589\uc77c: ${(new Date).toLocaleDateString("ko-KR")}\n                \ud68c\uc0ac\uba85: ${e.company_name}\n                \uc0c1\ud488\uba85: ${e.product_name}\n                \uc785\uace0\uc218\ub7c9: ${e.inbound_quantity} \uac1c\n                \ubb34\uac8c: ${e.weight} kg\n                \uc81c\ud488\ubc88\ud638: ${e.product_number}\n                \ucc3d\uace0\uc704\uce58: ${e.warehouse_location}\n                \ucc3d\uace0\ud0c0\uc785: ${e.warehouse_type}\n                \uc785\uace0\uc77c: ${e.subscription_inbound_date}\n                \ucd9c\uace0\uc77c: ${e.outbound_date}\n                \ubcf4\uad00\uae30\uac04: ${e.storage_duration} \uc77c\n                \ud314\ub808\ud2b8\ud06c\uae30: ${e.pallet_size}\n                \ud314\ub808\ud2b8\uac1c\uc218: ${e.pallet_num} \uac1c\n                \ucd1d\ube44\uc6a9: ${e.total} \uc6d0\n                `,s={...e,estimate:r,total_cost:i};await fetch(`http://34.64.211.3:5002/inbound-status/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),C((t=>({...t,...e,total_cost:i}))),await _(n.id),p((t=>({...t,...e,total_cost:i}))),alert("\uc785\uace0 \uc815\ubcf4 \uc800\uc7a5 \uc131\uacf5!")}catch(i){console.error("\u274c \uc800\uc7a5 \uc2e4\ud328:",i),alert("\uc785\uace0 \uc815\ubcf4 \uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}},onClose:()=>c(2)})]}),2===l&&(0,st.jsx)("div",{style:{maxWidth:"1200px",height:"calc(100vh - 300px)",margin:"0 auto",overflow:"hidden"},children:(0,st.jsx)(yD,{})}),3===l&&(0,st.jsx)("form",{onSubmit:async e=>{e.preventDefault();const t=n.id;try{const e=SD.findIndex((e=>e.id===t));if(-1===e)return void alert("\ud574\ub2f9 \uacc4\uc57d\uc11c\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");SD[e]={...SD[e],...d},console.log("\ud83d\udcbe Mock \uacc4\uc57d\uc11c \uc800\uc7a5 \uc644\ub8cc:",SD[e]),alert("\uacc4\uc57d\uc11c\uac00 \uc800\uc7a5\ub418\uc5c8\uc2b5\ub2c8\ub2e4. (Mock)"),f(!1),v(!1)}catch(CF){console.error("\uacc4\uc57d\uc11c \uc800\uc7a5 \uc911 \uc624\ub958:",CF),alert("\uacc4\uc57d\uc11c \uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}},children:(0,st.jsxs)("div",{style:{maxWidth:"1300px",height:"calc(100vh - 200px)",margin:"0 auto",overflow:"auto"},children:[(0,st.jsx)("h2",{style:L,children:"\uacac\uc801\ud655\uc778 \ubc0f \uacc4\uc57d\uc11c \uc791\uc131"}),(0,st.jsxs)("div",{style:{display:"flex",gap:"40px",height:"550px",alignItems:"flex-start",marginTop:"20px",justifyContent:"center"},children:[(0,st.jsxs)("div",{style:{flex:1,maxWidth:"300px",overflow:"auto"},children:[(0,st.jsx)("h4",{style:{color:"#6f47c5",fontWeight:"bold",marginBottom:"10px"},children:"\uacac\uc801\uc11c \uc815\ubcf4"}),(0,st.jsx)("table",{style:{width:"100%",height:"70%",borderCollapse:"collapse",backgroundColor:"#fff",border:"1px solid #ddd",borderRadius:"8px"},children:(0,st.jsx)("tbody",{children:[["\ubc1c\ud589\uc77c",(new Date).toLocaleDateString("ko-KR")],["\ud68c\uc0ac\uba85",null===y||void 0===y?void 0:y.company_name],["\uc0c1\ud488\uba85",null===y||void 0===y?void 0:y.product_name],["\uc785\uace0\uc218\ub7c9",`${null===y||void 0===y?void 0:y.inbound_quantity} \uac1c`],["\ubb34\uac8c",`${null===y||void 0===y?void 0:y.weight} kg`],["\uc81c\ud488\ubc88\ud638",null===y||void 0===y?void 0:y.product_number],["\ucc3d\uace0\uc704\uce58",null===y||void 0===y?void 0:y.warehouse_location],["\ucc3d\uace0\ud0c0\uc785",null===y||void 0===y?void 0:y.warehouse_type],["\uc785\uace0\uc77c",null===y||void 0===y?void 0:y.subscription_inbound_date],["\ucd9c\uace0\uc77c",null===y||void 0===y?void 0:y.outbound_date],["\ubcf4\uad00\uae30\uac04",`${null===y||void 0===y?void 0:y.storage_duration} \uc77c`],["\ud314\ub808\ud2b8 \ud06c\uae30",null===y||void 0===y?void 0:y.pallet_size],["\ud314\ub808\ud2b8 \uc218",`${null===y||void 0===y?void 0:y.pallet_num} \uac1c`],["\ucd1d \ube44\uc6a9",`${null===y||void 0===y?void 0:y.total_cost} \uc6d0`]].map(((e,t)=>{let[n,i]=e;return(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:{padding:"5px 10px",fontWeight:"bold",fontSize:"13px",backgroundColor:"#f4f1fb",width:"40%",textAlign:"left",color:"#5a3ea1"},children:n}),(0,st.jsx)("td",{style:{padding:"5px 10px",textAlign:"left",fontSize:"12px"},children:i||"N/A"})]},t)}))})})]}),(0,st.jsxs)("div",{style:{flex:1,maxWidth:"300px",overflow:"auto"},children:[(0,st.jsx)("h4",{style:{color:"#6f47c5",fontWeight:"bold",marginBottom:"10px"},children:"\uacc4\uc57d\uc11c \uc791\uc131"}),(0,st.jsx)("table",{style:{...MD.table,height:"70%"},children:(0,st.jsxs)("tbody",{children:[(0,st.jsx)("tr",{onClick:()=>{var e;return null===(e=s.current)||void 0===e?void 0:e.focus()},style:MD.clickableRow,children:(0,st.jsx)("td",{colSpan:2,children:(0,st.jsx)("input",{ref:s,type:"text",value:d.title,onChange:e=>R("title",e.target.value),placeholder:"\uacc4\uc57d \uc81c\ubaa9\uc744 \uc785\ub825\ud558\uc138\uc694",style:MD.fullWidthInput(g),disabled:!g})})}),(0,st.jsx)("tr",{onClick:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.focus()},style:MD.clickableRow,children:(0,st.jsx)("td",{colSpan:2,children:(0,st.jsx)("textarea",{ref:o,value:d.content,onChange:e=>R("content",e.target.value),placeholder:"\uacc4\uc57d \ub0b4\uc6a9\uc744 \uc785\ub825\ud558\uc138\uc694",style:MD.fullWidthTextarea(g),disabled:!g})})}),(0,st.jsx)("tr",{onClick:()=>{var e;return null===(e=a.current)||void 0===e?void 0:e.focus()},style:MD.clickableRow,children:(0,st.jsx)("td",{colSpan:2,children:(0,st.jsx)("input",{ref:a,type:"text",value:d.signature,onChange:e=>R("signature",e.target.value),placeholder:"\uc11c\uba85\uc790 \uc774\ub984\uc744 \uc785\ub825\ud558\uc138\uc694",style:MD.fullWidthInput(g),disabled:!g})})})]})})]})]}),(0,st.jsxs)("div",{style:{position:"absolute",bottom:"20px",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"20px"},children:[(0,st.jsx)("button",{type:"submit",style:{...A,backgroundColor:m?"#6f47c5":"#cccccc",cursor:m?"pointer":"not-allowed"},disabled:!m,children:"\uc800\uc7a5"}),(0,st.jsx)("button",{type:"button",onClick:()=>{f(!0),v(!0)},style:{...A,backgroundColor:g?"#cccccc":"#6f47c5",cursor:g?"not-allowed":"pointer"},disabled:g,children:"\uc218\uc815"}),(0,st.jsx)("button",{type:"button",onClick:P,style:{...A,backgroundColor:"#b794ff"},children:"\ucd9c\ub825"})]})]})}),4===l&&n&&(0,st.jsx)(st.Fragment,{children:(0,st.jsxs)("div",{style:{maxWidth:"1300px",height:"calc(100vh - 220px)",margin:"0 auto",overflow:"auto"},children:[(0,st.jsx)("h2",{style:L,children:"\uacc4\uc57d \uc0c1\uc138 \uc815\ubcf4"}),(0,st.jsxs)("div",{style:{display:"flex",gap:"40px",height:"550px",alignItems:"flex-start",marginTop:"20px",justifyContent:"center"},children:[(0,st.jsxs)("div",{style:{flex:1,maxWidth:"300px",height:"100%",overflow:"auto"},children:[(0,st.jsx)("h4",{style:{color:"#6f47c5",fontWeight:"bold"},children:"\uacc4\uc57d \uc815\ubcf4"}),(0,st.jsx)("table",{style:{width:"100%",height:"80%",borderCollapse:"collapse",backgroundColor:"#fff",border:"1px solid #ddd",borderRadius:"8px"},children:(0,st.jsxs)("tbody",{children:[(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:bD,children:"\uacc4\uc57d ID"}),(0,st.jsx)("td",{style:xD,children:null===n||void 0===n?void 0:n.id})]}),(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:bD,children:"\ud68c\uc0ac\uba85"}),(0,st.jsx)("td",{style:xD,children:null===n||void 0===n?void 0:n.company_name})]}),(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:bD,children:"\uacc4\uc57d ID"}),(0,st.jsx)("td",{style:xD,children:null===n||void 0===n?void 0:n.id})]}),(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:bD,children:"\uc0c1\ud488\uba85"}),(0,st.jsx)("td",{style:xD,children:null===n||void 0===n?void 0:n.product_name})]}),(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:bD,children:"\uc218\ub7c9"}),(0,st.jsx)("td",{style:xD,children:null===n||void 0===n?void 0:n.inbound_quantity})]}),(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:bD,children:"\ucc3d\uace0\uba85"}),(0,st.jsx)("td",{style:xD,children:(null===y||void 0===y?void 0:y.warehouse_location)||"N/A"})]}),(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:bD,children:"\ubcf4\uad00\ucc3d\uace0"}),(0,st.jsx)("td",{style:xD,children:null===n||void 0===n?void 0:n.warehouse_type})]}),(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:bD,children:"\ucc3d\uace0\uc704\uce58"}),(0,st.jsx)("td",{style:xD,children:(null===y||void 0===y?void 0:y.warehouse_num)||"N/A"})]}),(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:bD,children:"\uc785\uace0\uc608\uc815\uc77c"}),(0,st.jsx)("td",{style:xD,children:null!==n&&void 0!==n&&n.subscription_inbound_date?new Date(n.subscription_inbound_date).toISOString().slice(0,10):""})]}),(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:bD,children:"\ucd9c\uace0\uc608\uc815\uc77c"}),(0,st.jsx)("td",{style:xD,children:null!==n&&void 0!==n&&n.outbound_date?new Date(n.outbound_date).toISOString().slice(0,10):""})]}),(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:bD,children:"\uacc4\uc57d \ub0a0\uc9dc"}),(0,st.jsx)("td",{style:xD,children:(null===n||void 0===n?void 0:n.contract_date)||"\uacc4\uc57d \ub300\uae30"})]})]})})]}),(0,st.jsxs)("div",{style:{flex:1,maxWidth:"300px",height:"100%",overflow:"auto"},children:[(0,st.jsx)("h4",{style:{color:"#6f47c5",fontWeight:"bold",marginBottom:"10px"},children:"\ubc14\ucf54\ub4dc"}),u&&(0,st.jsx)("div",{style:{height:"73%",textAlign:"center",border:"1px solid #eee",padding:"20px",marginTop:"20px",backgroundColor:"#fafafa"},children:(0,st.jsx)("img",{src:u,alt:"\ubc14\ucf54\ub4dc",style:{maxWidth:"200px"},onError:e=>{console.error("\ubc14\ucf54\ub4dc \uc774\ubbf8\uc9c0 \ub85c\ub4dc \uc2e4\ud328"),e.target.style.display="none"}})})]})]}),(0,st.jsx)("div",{style:{position:"absolute",bottom:"20px",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"20px"},children:(0,st.jsx)("button",{onClick:P,style:{...A,backgroundColor:"#b794ff"},children:"\ucd9c\ub825"})})]})})]})})},MD={fullWidthInput:e=>({width:"100%",padding:"16px",border:"none",backgroundColor:e?"#fff":"#f3f3f3",fontSize:"15px",outline:"none",boxSizing:"border-box",borderRadius:"6px",transition:"all 0.2s ease-in-out",boxShadow:e?"inset 0 0 0 1px #c1b2e0":"none"}),fullWidthTextarea:e=>({width:"100%",height:"300px",padding:"16px",border:"none",resize:"none",backgroundColor:e?"#fff":"#f3f3f3",fontSize:"15px",outline:"none",boxSizing:"border-box",borderRadius:"6px",transition:"all 0.2s ease-in-out",boxShadow:e?"inset 0 0 0 1px #c1b2e0":"none"}),table:{width:"100%",tableLayout:"fixed",backgroundColor:"#fff",borderCollapse:"collapse",wordBreak:"break-word"},clickableRow:{cursor:"pointer",borderBottom:"1px solid #eee"},wrapper:{flex:1,width:"100%",overflowX:"hidden"}},ED=[{id:1,company_name:"\uc0bc\uc131\uc804\uc790",product_name:"\ub0c9\uc7a5\uace0",contract_date:null,warehouse_location:"\uc11c\uc6b81\ucc3d\uace0",warehouse_type:"\ub0c9\uc7a5",inbound_quantity:100,title:"\uc0bc\uc131\uc804\uc790 \uacc4\uc57d\uc11c",content:"\ub0c9\uc7a5\uace0 100\ub300 \ubcf4\uad00 \uacc4\uc57d",terms:"3\uac1c\uc6d4",signature:"\ud64d\uae38\ub3d9"},{id:2,company_name:"LG\uc804\uc790",product_name:"\uc138\ud0c1\uae30",contract_date:"2024-12-01",warehouse_location:"\ubd80\uc0b02\ucc3d\uace0",warehouse_type:"\uc0c1\uc628",inbound_quantity:80,title:"LG \uacc4\uc57d\uc11c",content:"\uc138\ud0c1\uae30 \uc785\uace0 \uacc4\uc57d",terms:"1\uac1c\uc6d4",signature:"\uc774\uc21c\uc2e0"},{id:3,company_name:"\ud604\ub300\ucc28",product_name:"\uc790\ub3d9\ucc28 \ubd80\ud488",contract_date:null,warehouse_location:"\ub300\uad6c\ucc3d\uace0",warehouse_type:"\ud2b9\uc218",inbound_quantity:50,title:"\ud604\ub300\ucc28 \uacc4\uc57d\uc11c",content:"\ubd80\ud488 \ubcf4\uad00",terms:"6\uac1c\uc6d4",signature:"\uc720\uc7ac\uc11d"}];const RD={container:{padding:"20px"},content:{backgroundColor:"#ffffff",borderRadius:"8px",padding:"20px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},sectionTitle:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"15px",paddingBottom:"10px",borderBottom:"2px solid #6f47c5"},searchContainer:{marginBottom:"20px",display:"flex",flexWrap:"wrap",alignItems:"center",gap:"10px",justifyContent:"space-between"},inputField:{flex:"1 1 250px",padding:"10px 15px",borderRadius:"8px",border:"1px solid #ccc",fontSize:"14px",outline:"none",transition:"border 0.2s ease-in-out"},buttonGroup:{display:"flex",gap:"10px"},buttonBase:{padding:"10px 16px",fontSize:"14px",fontWeight:"600",border:"none",borderRadius:"8px",cursor:"pointer",transition:"background 0.2s ease-in-out, transform 0.2s ease",boxShadow:"0 2px 4px rgba(145, 142, 142, 0.1)"},buttonDanger:{backgroundColor:"#a5aaa3",color:"#fff"},buttonPrimary:{backgroundColor:"#6f47c5",color:"#fff"},tableContainer:{height:"520px",width:"100%"},agGridHeader:{backgroundColor:"#e6e1f7",color:"#6f47c5",fontWeight:"bold",textAlign:"center",fontSize:"14px"},agGridRow:{fontSize:"12px",textAlign:"center",borderBottom:"1px solid #ddd","&:hover":{backgroundColor:"#f3eefc"}},tabContainer:{display:"flex",justifyContent:"left",marginBottom:"20px",gap:"20px"},tabButton:{padding:"10px 20px",fontSize:"14px",fontWeight:"bold",border:"none",borderBottom:"3px solid transparent",backgroundColor:"transparent",cursor:"pointer"},tabButtonActive:{borderBottom:"3px solid #6f47c5",color:"#6f47c5"}},TD=function(){const[e,n]=(0,t.useState)([]),[i,r]=(0,t.useState)(""),[s,o]=(0,t.useState)(null),[a,l]=(0,t.useState)(!1),[c,u]=(0,t.useState)(!1),[h,d]=(0,t.useState)({title:"",content:"",terms:"",signature:""}),[p,g]=(0,t.useState)(null),f=Q(),m=(0,t.useRef)(null),[v,y]=(0,t.useState)([]),[C,w]=(0,t.useState)([]),[S,b]=(0,t.useState)("waiting"),x=[{field:"id",headerName:"\ubc88\ud638",width:100},{field:"company_name",headerName:"\ud68c\uc0ac\uba85",width:150},{field:"product_name",headerName:"\uc0c1\ud488\uba85",width:150},{field:"contract_date",headerName:"\uacc4\uc57d\uc77c",width:150,valueFormatter:e=>e.value||"\uacc4\uc57d \ub300\uae30"},{field:"warehouse_location",headerName:"\ucc3d\uace0\uc704\uce58",width:150},{field:"warehouse_type",headerName:"\ubcf4\uad00\ucc3d\uace0",width:150},{field:"inbound_quantity",headerName:"\uc785\uace0\uc218\ub7c9",width:150}],_={resizable:!0,suppressMovable:!0},M=async()=>{u(!0);try{const e=i.trim().toLowerCase();let t=ED.filter((t=>t.company_name.toLowerCase().includes(e)||t.product_name.toLowerCase().includes(e)));t=t.map((e=>({...e,contract_date:e.contract_date?e.contract_date:"\uacc4\uc57d \ub300\uae30"}))),n(t)}catch(CF){console.error("Error loading mock contracts:",CF)}finally{u(!1)}};(0,t.useEffect)((()=>{M();const e=setInterval((()=>{M()}),3e4);return()=>clearInterval(e)}),[i]);const E=e=>{console.log("\uc120\ud0dd\ub41c \ud589:",e.data),o(e.data),l(!0)};return(0,st.jsx)("div",{style:RD.container,children:(0,st.jsxs)("div",{style:RD.content,children:[(0,st.jsx)("h2",{style:RD.sectionTitle,children:"\uacc4\uc57d \ud604\ud669"}),(0,st.jsxs)("div",{style:RD.searchContainer,children:[(0,st.jsx)("input",{type:"text",placeholder:"\uac80\uc0c9\uc5b4\ub97c \uc785\ub825\ud558\uc138\uc694",value:i,onChange:e=>r(e.target.value),style:RD.inputField}),(0,st.jsxs)("div",{style:RD.buttonGroup,children:[(0,st.jsx)("button",{onClick:async()=>{const e=m.current.api.getSelectedNodes();if(0===e.length)return void alert("\ucde8\uc18c\ud560 \uacc4\uc57d\uc744 \uc120\ud0dd\ud558\uc138\uc694.");const t=e[0].data.id,n=ED.find((e=>e.id===t));n?(n.contract_date=null,alert(`\uacc4\uc57d ID ${t} \ucde8\uc18c \ucc98\ub9ac\ub428 (Mock)`),M()):alert("\uacc4\uc57d\uc744 \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")},style:{...RD.buttonBase,...RD.buttonDanger},children:"\uacc4\uc57d \ucde8\uc18c"}),(0,st.jsx)("button",{onClick:()=>f("/admin/storage-map"),style:{...RD.buttonBase,...RD.buttonPrimary},children:"\ucc3d\uace0 \ud604\ud669"})]})]}),(0,st.jsxs)("div",{style:RD.tabContainer,children:[(0,st.jsx)("button",{style:{...RD.tabButton,..."waiting"===S?RD.tabButtonActive:{}},onClick:()=>b("waiting"),children:"\uacc4\uc57d \ub300\uae30"}),(0,st.jsx)("button",{style:{...RD.tabButton,..."approved"===S?RD.tabButtonActive:{}},onClick:()=>b("approved"),children:"\uacc4\uc57d \uc2b9\uc778"})]}),"waiting"===S&&(0,st.jsx)("div",{className:"ag-theme-alpine",style:RD.tableContainer,children:(0,st.jsx)(xp,{ref:m,rowData:e.filter((e=>"\uacc4\uc57d \ub300\uae30"===e.contract_date)),columnDefs:x,defaultColDef:_,rowSelection:"single",onRowClicked:E,pagination:!0,paginationPageSize:10})}),"approved"===S&&(0,st.jsx)("div",{className:"ag-theme-alpine",style:RD.tableContainer,children:(0,st.jsx)(xp,{ref:m,rowData:e.filter((e=>"\uacc4\uc57d \ub300\uae30"!==e.contract_date)),columnDefs:x,defaultColDef:_,rowSelection:"single",onRowClicked:E,pagination:!0,paginationPageSize:10})}),s&&a&&(0,st.jsx)(_D,{contract:s,isOpen:a,onClose:()=>l(!1),onContractUpdate:()=>{M()}})]})})},PD=e=>{let{selectedRowData:t,onClose:n}=e;return t?(0,st.jsx)("div",{style:{position:"fixed",top:"50%",left:"50%",width:"50%",height:"600px",transform:"translate(-50%, -50%)",background:"white",borderRadius:"10px",boxShadow:"0 2px 6px rgba(0, 0, 0, 0.1)",zIndex:1e3,width:"400px",overflowY:"hidden"},children:(0,st.jsxs)("div",{style:{overflowY:"scroll",height:"100%",msOverflowStyle:"none",scrollbarWidth:"none"},children:[(0,st.jsx)("h3",{style:{marginBottom:"20px"},children:"\uc0c1\uc138\ubcf4\uae30"}),(0,st.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"15px"},children:[(0,st.jsxs)("div",{children:[(0,st.jsx)("strong",{children:"\uc5c5\uccb4\uba85:"}),(0,st.jsx)("div",{style:{padding:"10px",background:"#f9f9f9",borderRadius:"5px",border:"1px solid #ddd"},children:t.company_name||"N/A"})]}),(0,st.jsxs)("div",{children:[(0,st.jsx)("strong",{children:"\uc0c1\ud488\uba85:"}),(0,st.jsx)("div",{style:{padding:"10px",background:"#f9f9f9",borderRadius:"5px",border:"1px solid #ddd"},children:t.product_name||"N/A"})]}),(0,st.jsxs)("div",{children:[(0,st.jsx)("strong",{children:"\uc81c\ud488 \ubc88\ud638:"}),(0,st.jsx)("div",{style:{padding:"10px",background:"#f9f9f9",borderRadius:"5px",border:"1px solid #ddd"},children:t.warehouse_num||"N/A"})]}),(0,st.jsxs)("div",{children:[(0,st.jsx)("strong",{children:"\uc785\uace0 \uc218\ub7c9:"}),(0,st.jsx)("div",{style:{padding:"10px",background:"#f9f9f9",borderRadius:"5px",border:"1px solid #ddd"},children:t.inbound_quantity||"N/A"})]}),(0,st.jsxs)("div",{children:[(0,st.jsx)("strong",{children:"\ucc3d\uace0 \ud0c0\uc785:"}),(0,st.jsx)("div",{style:{padding:"10px",background:"#f9f9f9",borderRadius:"5px",border:"1px solid #ddd"},children:t.warehouse_type||"N/A"})]}),(0,st.jsxs)("div",{children:[(0,st.jsx)("strong",{children:"\ucc3d\uace0 \uc704\uce58:"}),(0,st.jsx)("div",{style:{padding:"10px",background:"#f9f9f9",borderRadius:"5px",border:"1px solid #ddd"},children:t.warehouse_location||"N/A"})]}),(0,st.jsxs)("div",{children:[(0,st.jsx)("strong",{children:"\ud314\ub808\ud2b8 \uc0ac\uc774\uc988:"}),(0,st.jsx)("div",{style:{padding:"10px",background:"#f9f9f9",borderRadius:"5px",border:"1px solid #ddd"},children:t.pallet_size||"N/A"})]}),(0,st.jsxs)("div",{children:[(0,st.jsx)("strong",{children:"\ud314\ub808\ud2b8 \uc218\ub7c9:"}),(0,st.jsx)("div",{style:{padding:"10px",background:"#f9f9f9",borderRadius:"5px",border:"1px solid #ddd"},children:t.pallet_num||"N/A"})]}),(0,st.jsxs)("div",{children:[(0,st.jsx)("strong",{children:"\ubc14\ucf54\ub4dc \ub118\ubc84:"}),(0,st.jsx)("div",{style:{padding:"10px",background:"#f9f9f9",borderRadius:"5px",border:"1px solid #ddd"},children:t.barcode_num||"N/A"})]}),(0,st.jsxs)("div",{children:[(0,st.jsx)("strong",{children:"\ubc14\ucf54\ub4dc:"}),t.barcode?(0,st.jsx)("img",{src:`/wms_project_frontend/manager/inbound${t.barcode}`,alt:"\ubc14\ucf54\ub4dc",style:{width:"100%",maxHeight:"150px",objectFit:"contain",marginTop:"10px",borderRadius:"5px",border:"1px solid #ddd"}}):(0,st.jsx)("div",{style:{padding:"10px",background:"#f9f9f9",borderRadius:"5px",border:"1px solid #ddd"},children:"N/A"})]})]}),(0,st.jsx)("button",{onClick:n,style:{marginTop:"20px",padding:"10px",background:"#ccc",color:"black",border:"none",borderRadius:"5px",cursor:"pointer",width:"100%"},children:"\ub2eb\uae30"})]})}):null},AD=[{id:1,company_name:"\uc0bc\uc131\uc804\uc790",product_name:"\ub0c9\uc7a5\uace0",inbound_quantity:100,warehouse_location:"\uc11c\uc6b8\ucc3d\uace0",warehouse_type:"\ub0c9\uc7a5",weight:"120kg",inbound_status:"\uc785\uace0 \ub300\uae30",contract_date:null,subscription_inbound_date:"2024-12-01",pallet_size:"110x110",pallet_num:20,barcode_num:"SAMSUNG-001",barcode:"/barcode-images/1.png",warehouse_num:"A-101"},{id:2,company_name:"LG\uc804\uc790",product_name:"\uc138\ud0c1\uae30",inbound_quantity:80,warehouse_location:"\ubd80\uc0b0\ucc3d\uace0",warehouse_type:"\uc0c1\uc628",weight:"90kg",inbound_status:"\uc785\uace0 \uc644\ub8cc",contract_date:"2024-11-15",subscription_inbound_date:"2024-11-20",pallet_size:"100x120",pallet_num:15,barcode_num:"LG-002",barcode:"/barcode-images/2.png",warehouse_num:"B-202"}],FD=()=>{const[e,n]=(0,t.useState)(""),[i,r]=(0,t.useState)([]),[s,o]=(0,t.useState)([]),[a,l]=(0,t.useState)(null),[c,u]=(0,t.useState)(!1),[h,d]=(0,t.useState)(!1),p=Q(),g=async()=>{try{console.log("\ud83d\udce6 MOCK \ub370\uc774\ud130\ub97c \ubd88\ub7ec\uc635\ub2c8\ub2e4."),r(AD)}catch(CF){console.error("MOCK \ub370\uc774\ud130 \ub85c\ub529 \uc2e4\ud328:",CF)}};(0,t.useEffect)((()=>{g()}),[]),(0,t.useEffect)((()=>{o(i)}),[i]);return(0,st.jsxs)("div",{style:DD.container,children:[(0,st.jsxs)("div",{style:{backgroundColor:"#ffffff",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",display:"flex",flexDirection:"column",height:"100vh",padding:"20px",background:"#f8f9fa"},children:[(0,st.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"15px",paddingBottom:"10px",borderBottom:"2px solid #6f47c5"},children:"\uc785\uace0 \uc0c1\ud0dc \uad00\ub9ac"}),(0,st.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,st.jsx)("input",{type:"text",placeholder:"Search",value:e,onChange:e=>{const t=e.target.value.toLowerCase();n(t);const r=i.filter((e=>Object.values(e).some((e=>null===e||void 0===e?void 0:e.toString().toLowerCase().includes(t)))));o(r)},style:{flex:1,padding:"10px",borderRadius:"5px",border:"1px solid #ddd"}}),(0,st.jsx)("button",{onClick:g,style:{padding:"10px 20px",background:"#4caf50",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"\uac80\uc0c9"}),(0,st.jsx)("button",{onClick:()=>p("/admin/contract-status"),style:DD.buttonPrimary,children:"\uacc4\uc57d \ud604\ud669"}),(0,st.jsx)("button",{onClick:()=>{a?u(!0):alert("\ud589\uc744 \uba3c\uc800 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.")},style:{padding:"10px 20px",background:!a||null!==a.contract_date&&"non"!==a.contract_date&&"\uacc4\uc57d\ub300\uae30"!==a.contract_date?"#ccc":"#E74C3C",color:"white",border:"none",borderRadius:"5px",cursor:!a||null!==a.contract_date&&"non"!==a.contract_date&&"\uacc4\uc57d\ub300\uae30"!==a.contract_date?"not-allowed":"pointer"},disabled:!(a&&(null===a.contract_date||"non"===a.contract_date||"\uacc4\uc57d\ub300\uae30"===a.contract_date)),children:"\uc2e4 \uacac\uc801\uc791\uc131"}),(0,st.jsx)("button",{onClick:()=>{a?d(!0):alert("\ud589\uc744 \uba3c\uc800 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.")},style:{padding:"10px 20px",background:"#007bff",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"\uc0c1\uc138\ubcf4\uae30 \uc5f4\uae30"})]}),(0,st.jsx)("div",{className:"ag-theme-alpine",style:{flex:1,marginTop:"20px",borderRadius:"10px"},children:(0,st.jsx)(xp,{rowData:s,columnDefs:[{headerName:"ID",field:"id",sortable:!0,filter:!0},{headerName:"\uc5c5\uccb4\uba85",field:"company_name",sortable:!0,filter:!0},{headerName:"\uc0c1\ud488\uba85",field:"product_name",sortable:!0,filter:!0},{headerName:"\uc218\ub7c9",field:"inbound_quantity",sortable:!0,filter:!0},{headerName:"\ucc3d\uace0 \uc704\uce58",field:"warehouse_location",sortable:!0,filter:!0},{headerName:"\ucc3d\uace0 \ud0c0\uc785",field:"warehouse_type",sortable:!0,filter:!0},{headerName:"\ubb34\uac8c",field:"weight",sortable:!0,filter:!0},{headerName:"\uc785\uace0 \uc0c1\ud0dc",field:"inbound_status",sortable:!0,filter:!0},{headerName:"\uacc4\uc57d\uc77c",field:"contract_date",sortable:!0,filter:!0},{headerName:"\uc785\uace0 \ub0a0\uc9dc",field:"subscription_inbound_date",sortable:!0,filter:!0}],onRowClicked:e=>l(e.data),pagination:!0,paginationPageSize:10,paginationPageSizeSelector:[10,20,50,100]})})]}),(c||h)&&(0,st.jsx)("div",{className:"overlay",onClick:()=>{u(!1),d(!1)}}),c&&(0,st.jsx)("div",{className:"popup-container",children:(0,st.jsx)(_p,{selectedRowData:a,onUpdate:async e=>{try{if(!a||!a.id)return void alert("\uc120\ud0dd\ub41c \ud589\uc758 ID\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.");const t=AD.findIndex((e=>e.id===a.id));if(-1===t)return void alert("\ud574\ub2f9 \ub370\uc774\ud130\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.");AD[t]={...AD[t],...e},alert("\uacac\uc801\uc774 \uc131\uacf5\uc801\uc73c\ub85c \uc5c5\ub370\uc774\ud2b8\ub418\uc5c8\uc2b5\ub2c8\ub2e4! (Mock)"),g(),u(!1),l(null)}catch(CF){console.error("MOCK \uc5c5\ub370\uc774\ud2b8 \uc2e4\ud328:",CF),alert("\uc5c5\ub370\uc774\ud2b8 \uc2e4\ud328")}},onClose:()=>u(!1)})}),h&&(0,st.jsx)("div",{className:"popup-container",children:(0,st.jsx)(PD,{selectedRowData:a,onClose:()=>d(!1)})})]})},DD={container:{padding:"20px"},buttonPrimary:{padding:"10px 20px",background:"#007bff",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"}},LD={container:{padding:"20px"},content:{backgroundColor:"#ffffff",borderRadius:"8px",padding:"20px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},sectionTitle:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"15px",paddingBottom:"10px",borderBottom:"2px solid #6f47c5"},tabContainer:{display:"flex",gap:"10px",marginBottom:"20px"},tabButton:{padding:"8px 16px",fontSize:"14px",fontWeight:"bold",border:"none",borderBottom:"2px solid transparent",backgroundColor:"transparent",cursor:"pointer"},tabButtonActive:{borderBottom:"2px solid #6f47c5",color:"#6f47c5"},searchContainer:{marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},inputField:{flex:"4",padding:"8px",borderRadius:"5px",border:"1px solid #ddd",fontSize:"14px"},buttonPrimary:{flex:"1",padding:"8px 12px",backgroundColor:"#6f47c5",color:"white",border:"none",borderRadius:"5px",cursor:"pointer",fontSize:"14px",fontWeight:"bold",textAlign:"center"},tableContainer:{height:"500px",width:"100%"},agGridHeader:{backgroundColor:"#e6e1f7",color:"#6f47c5",fontWeight:"bold",textAlign:"center",fontSize:"14px"},agGridRow:{fontSize:"12px",textAlign:"center",borderBottom:"1px solid #ddd","&:hover":{backgroundColor:"#f3eefc"}},modalOverlay:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},modalHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},modalBox:{backgroundColor:"white",padding:"24px",borderRadius:"10px",width:"520px",boxShadow:"0 8px 16px rgba(0,0,0,0.15)"},modalTitle:{fontSize:"18px",fontWeight:"bold",color:"#6f47c5",marginBottom:"16px"},modalTable:{width:"100%",borderCollapse:"collapse",marginBottom:"16px"},modalCellHeader:{backgroundColor:"#f9f9f9",padding:"10px",fontWeight:"bold",width:"30%",border:"1px solid #ddd"},modalCellBody:{padding:"10px",border:"1px solid #ddd"},selectBox:{width:"60%",padding:"6px",borderRadius:"4px",border:"1px solid #ccc"},modalButtonGroup:{display:"flex",justifyContent:"flex-end",gap:"10px"},modalSaveButton:{padding:"7px 16px",backgroundColor:"#6f47c5",color:"white",border:"none",borderRadius:"6px",fontWeight:"bold",cursor:"pointer"},modalCloseTop:{fontSize:"22px",background:"transparent",border:"none",color:"#999",cursor:"pointer",fontWeight:"bold",lineHeight:"1"}},ID=()=>{const[e,n]=(0,t.useState)(""),[i,r]=(0,t.useState)([]),[s,o]=(0,t.useState)([]),[a,l]=(0,t.useState)(null),[c,u]=(0,t.useState)("\uc785\uace0 \uc900\ube44"),[h,d]=(0,t.useState)(!1),p=async()=>{try{console.log("\ud83d\udce6 MOCK \ub370\uc774\ud130 \ub85c\ub529 \uc911...");const e=AD.filter((e=>"\uacc4\uc57d\ub300\uae30"!==e.contract_date));r(e)}catch(CF){console.error("MOCK \ub370\uc774\ud130 \ub85c\ub529 \uc2e4\ud328:",CF)}};(0,t.useEffect)((()=>{p()}),[]),(0,t.useEffect)((()=>{const e=i.filter((e=>e.inbound_status===c));o(e)}),[i,c]);null===a||void 0===a||a.inbound_status;return(0,st.jsxs)("div",{style:LD.container,children:[(0,st.jsxs)("div",{style:LD.content,children:[(0,st.jsx)("h2",{style:LD.sectionTitle,children:"\uc785\uace0 \ud604\ud669"}),(0,st.jsx)("div",{style:LD.searchContainer,children:(0,st.jsx)("input",{type:"text",placeholder:"\uac80\uc0c9...",value:e,onChange:e=>{const t=e.target.value.toLowerCase();n(t);const r=i.filter((e=>e.inbound_status===c&&Object.values(e).some((e=>null===e||void 0===e?void 0:e.toString().toLowerCase().includes(t)))));o(r)},style:LD.inputField})}),(0,st.jsx)("div",{style:LD.tabContainer,children:["\uc785\uace0 \uc900\ube44","\uc785\uace0 \ub300\uae30","\uc785\uace0 \uc911","\uc785\uace0 \uc644\ub8cc"].map((e=>(0,st.jsx)("button",{onClick:()=>u(e),style:{...LD.tabButton,...c===e?LD.tabButtonActive:{}},children:e},e)))}),(0,st.jsx)("div",{className:"ag-theme-alpine",style:LD.tableContainer,children:(0,st.jsx)(xp,{rowData:s,columnDefs:[{headerName:"ID",field:"id",sortable:!0,filter:!0,width:"80px"},{headerName:"\uc785\uace0 \uc0c1\ud0dc",field:"inbound_status",sortable:!0,filter:!0,flex:1},{headerName:"\uc5c5\uccb4\uba85",field:"company_name",sortable:!0,filter:!0,flex:1},{headerName:"\uc0c1\ud488\uba85",field:"product_name",sortable:!0,filter:!0,flex:1},{headerName:"\uc218\ub7c9",field:"inbound_quantity",sortable:!0,filter:!0,flex:1},{headerName:"\ucc3d\uace0 \uc704\uce58",field:"warehouse_location",sortable:!0,filter:!0,flex:1},{headerName:"\ucc3d\uace0 \ud0c0\uc785",field:"warehouse_type",sortable:!0,filter:!0,flex:1},{headerName:"\uacc4\uc57d\uc77c",field:"contract_date",sortable:!0,filter:!0,flex:1},{headerName:"\uc785\uace0 \ub0a0\uc9dc",field:"subscription_inbound_date",sortable:!0,filter:!0,flex:1}],defaultColDef:{sortable:!0,filter:!0,resizable:!0,suppressMovable:!0},onRowClicked:e=>{l(e.data),d(!0)},pagination:!0,paginationPageSize:10,paginationPageSizeSelector:[10,20,50,100],domLayout:"autoHeight",gridOptions:{headerHeight:50,rowHeight:40,suppressHorizontalScroll:!0}})})]}),h&&a&&(0,st.jsx)("div",{style:LD.modalOverlay,children:(0,st.jsxs)("div",{style:LD.modalBox,children:[(0,st.jsxs)("div",{style:LD.modalHeader,children:[(0,st.jsxs)("h3",{style:LD.modalTitle,children:[a.company_name," - ",a.product_name]}),(0,st.jsx)("button",{style:LD.modalCloseTop,onClick:()=>d(!1),children:"\xd7"})]}),(0,st.jsx)("table",{style:LD.modalTable,children:(0,st.jsxs)("tbody",{children:[(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:LD.modalCellHeader,children:"\uc5c5\uccb4\uba85"}),(0,st.jsx)("td",{style:LD.modalCellBody,children:a.company_name})]}),(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:LD.modalCellHeader,children:"\uc0c1\ud488\uba85"}),(0,st.jsx)("td",{style:LD.modalCellBody,children:a.product_name})]}),(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:LD.modalCellHeader,children:"\uc218\ub7c9"}),(0,st.jsx)("td",{style:LD.modalCellBody,children:a.inbound_quantity})]}),(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:LD.modalCellHeader,children:"\ucc3d\uace0 \uc704\uce58"}),(0,st.jsx)("td",{style:LD.modalCellBody,children:a.warehouse_location})]}),(0,st.jsxs)("tr",{children:[(0,st.jsx)("td",{style:LD.modalCellHeader,children:"\uc785\uace0 \uc0c1\ud0dc"}),(0,st.jsxs)("td",{style:{...LD.modalCellBody,display:"flex",alignItems:"center",gap:"10px"},children:[(0,st.jsx)("select",{value:a.inbound_status,onChange:e=>l((t=>({...t,inbound_status:e.target.value}))),style:LD.selectBox,children:["\uc785\uace0 \uc900\ube44","\uc785\uace0 \ub300\uae30","\uc785\uace0 \uc911","\uc785\uace0 \uc644\ub8cc"].map((e=>(0,st.jsx)("option",{value:e,children:e},e)))}),(0,st.jsx)("button",{style:LD.modalSaveButton,onClick:()=>(async e=>{if(!a)return;const t=AD.findIndex((e=>e.id===a.id));-1!==t?(AD[t]={...AD[t],inbound_status:e},alert(`\uc0c1\ud0dc\uac00 '${e}'(\uc73c)\ub85c \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4. (Mock)`),p(),d(!1),l(null)):alert("\ud574\ub2f9 \ub370\uc774\ud130\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")})(a.inbound_status),children:"\ubcc0\uacbd"})]})]})]})})]})})]})},kD=[{id:101,company_name:"\uc0bc\uc131\uc804\uc790",product_name:"Z Fold 6",inbound_quantity:50,warehouse_location:"\uc11c\uc6b8 \uc2a4\ub9c8\ud2b8\ucc3d\uace0",warehouse_type:"\ud2b9\uc218",inbound_status:"\uc785\uace0 \uc900\ube44",contract_date:"2024-11-01",inbound_date:null,barcode_num:"CONTRACT002",barcode:"/barcode-images/101.png"},{id:102,company_name:"LG\uc804\uc790",product_name:"Wing 2",inbound_quantity:30,warehouse_location:"\ubd80\uc0b0 \uc2a4\ub9c8\ud2b8\ucc3d\uace0",warehouse_type:"\uc0c1\uc628",inbound_status:"\uc785\uace0 \uc644\ub8cc",contract_date:"2024-10-15",inbound_date:"2024-11-03",barcode_num:"CONTRACT007",barcode:"/barcode-images/102.png"}],OD=()=>{const[e,n]=(0,t.useState)(""),[i,r]=(0,t.useState)([]),[s,o]=(0,t.useState)([]),[a,l]=(0,t.useState)(null),[c,u]=(0,t.useState)(!1),h=async()=>{try{const e=kD.filter((e=>"\uacc4\uc57d\ub300\uae30"!==e.contract_date));r(e)}catch(CF){console.error("MOCK \ub370\uc774\ud130 \ub85c\ub529 \uc2e4\ud328:",CF)}};(0,t.useEffect)((()=>{h()}),[]),(0,t.useEffect)((()=>{o(i)}),[i]);const d=null===a||void 0===a?void 0:a.inbound_status,p="\uc785\uace0 \uc644\ub8cc"===d;return(0,st.jsx)("div",{style:{backgroundColor:"#FFFFFF",width:"96%",marginLeft:"20px",marginTop:"30px",borderRadius:"10px"},children:(0,st.jsxs)("div",{style:{display:"flex",height:"100vh",padding:"10px",background:"#FFFFFF",borderRadius:"10px"},children:[(0,st.jsxs)("div",{style:{flex:2,display:"flex",flexDirection:"column",gap:"20px"},children:[(0,st.jsx)("h3",{style:{fontSize:"18px",marginLeft:"5px"},children:"\uc2a4\ub9c8\ud2b8\ud3f0 \uc785\uace0 \uc870\ud68c"}),(0,st.jsx)("div",{style:{width:"98.5%",backgroundColor:"#6f47c5",border:"1px solid #6f47c5",marginBottom:"10px"}}),(0,st.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,st.jsx)("input",{type:"text",placeholder:"\uac80\uc0c9...",value:e,onChange:e=>{const t=e.target.value.toLowerCase();n(t);const r=i.filter((e=>Object.values(e).some((e=>null===e||void 0===e?void 0:e.toString().toLowerCase().includes(t)))));o(r)},style:{flex:"1",padding:"8px",borderRadius:"5px",border:"1px solid #ddd"}}),(0,st.jsx)("button",{onClick:h,style:{padding:"8px 12px",background:"#4caf50",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"\uac80\uc0c9"}),(0,st.jsx)("button",{onClick:()=>{(async e=>{if(!a)return void alert("\ud589\uc744 \uba3c\uc800 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.");const t=kD.findIndex((e=>e.id===a.id));-1!==t?(kD[t].inbound_status=e,"\uc785\uace0 \uc644\ub8cc"===e&&(kD[t].inbound_date=(new Date).toISOString().split("T")[0]),alert(`\uc0c1\ud0dc\uac00 '${e}'\ub85c \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4. (Mock)`),h(),l(null)):alert("\ud574\ub2f9 \ub370\uc774\ud130\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.")})("\uc785\uace0 \uc900\ube44")},style:{padding:"8px 12px",background:p?"#fbc549":"#ccc",color:"white",border:"none",borderRadius:"5px",cursor:p?"pointer":"not-allowed"},disabled:!p,children:"\uc0c1\ud0dc\ubcc0\uacbd \ucde8\uc18c"}),(0,st.jsx)("button",{onClick:()=>{a?u(!0):alert("\ud589\uc744 \uba3c\uc800 \uc120\ud0dd\ud574\uc8fc\uc138\uc694.")},style:{padding:"8px 12px",background:"#007bff",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"\uc0c1\uc138\ubcf4\uae30 \uc5f4\uae30"})]}),(0,st.jsx)("div",{className:"ag-theme-alpine",style:{flex:1,borderRadius:"10px"},children:(0,st.jsx)(xp,{rowData:s,columnDefs:[{headerName:"ID",field:"id",sortable:!0,filter:!0},{headerName:"\uc785\uace0 \uc0c1\ud0dc",field:"inbound_status",sortable:!0,filter:!0},{headerName:"\uc5c5\uccb4\uba85",field:"company_name",sortable:!0,filter:!0},{headerName:"\uc0c1\ud488\uba85",field:"product_name",sortable:!0,filter:!0},{headerName:"\uc218\ub7c9",field:"inbound_quantity",sortable:!0,filter:!0},{headerName:"\ucc3d\uace0 \uc704\uce58",field:"warehouse_location",sortable:!0,filter:!0},{headerName:"\ucc3d\uace0 \ud0c0\uc785",field:"warehouse_type",sortable:!0,filter:!0},{headerName:"\uacc4\uc57d\uc77c",field:"contract_date",sortable:!0,filter:!0},{headerName:"\uc785\uace0 \ub0a0\uc9dc",field:"inbound_date",sortable:!0,filter:!0}],onRowClicked:e=>l(e.data),pagination:!0,paginationPageSize:10,paginationPageSizeSelector:[10,20,50,100]})})]}),c&&(0,st.jsx)("div",{className:"overlay",onClick:()=>{u(!1)}}),c&&a&&(0,st.jsx)("div",{className:"popup-container",children:(0,st.jsx)(PD,{selectedRowData:a,onClose:()=>u(!1)})})]})})},ND=()=>(0,st.jsx)(mt,{children:(0,st.jsxs)(me,{children:[(0,st.jsx)(ge,{path:"/admin/inbound-status",element:(0,st.jsx)(FD,{})}),(0,st.jsx)(ge,{path:"/admin/SmPhoneInbound",element:(0,st.jsx)(OD,{})}),(0,st.jsx)(ge,{path:"/admin/inbound-status-detail",element:(0,st.jsx)(ID,{})}),(0,st.jsx)(ge,{path:"/admin/contract-status",element:(0,st.jsx)(TD,{})}),(0,st.jsx)(ge,{path:"/admin/storage-map",element:(0,st.jsx)(yD,{})}),(0,st.jsx)(ge,{path:"/admin/storage-map/detail/:id",element:(0,st.jsx)(CD,{})})]})}),BD=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:i,getFCP:r,getLCP:s,getTTFB:o}=t;n(e),i(e),r(e),s(e),o(e)}))};i.createRoot(document.getElementById("root")).render((0,st.jsx)(t.StrictMode,{children:(0,st.jsx)(Ze,{children:(0,st.jsx)(ND,{})})})),BD()})()})();
//# sourceMappingURL=main.6d1d9ac0.js.map